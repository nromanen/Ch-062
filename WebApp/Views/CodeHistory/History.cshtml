@model WebApp.ViewModels.CodeHistoryViewModels

@{
    ViewData["Title"] = "History";
}

<h2>History</h2>
<style>
    input[type=radio],
    input[type=checkbox] {
        /* Hide original inputs */
        visibility: hidden;
        position: absolute;
    }



    .titlecode {
        font-size: 18px;
        color: #808080;
    }

        .titlecode:hover {
            cursor: pointer;
            color: #ffd800;
        }

    .code-example {
        border: 1px solid #cacaca;
        padding: 12px;
    }

    .date, .btn, #collapsecontent {
        color: #808080;
        font-size: 12px;
    }

    #output {
        border: 1px groove #ff6a00;
    }
</style>
<hr />

@for (var i = 0; i < Model.CodeHistory.Count(); i++)
{

    <div class="row">

        <form>
            <div class="col-lg-10">
                <p data-id="@Model.CodeHistory[i].Id" id="@Model.CodeHistory[i].Id" class="form-control titlecode" readonly>@Model.ExerciseName</p>

                <p><textarea data-id="@Model.CodeHistory[i].Id" id="@Model.CodeHistory[i].Id" class="form-control code-example col" rows="15">@Model.CodeHistory[i].CodeText</textarea></p>
                <p>
                    <textarea data-id="@Model.CodeHistory[i].Id" id="@Model.CodeHistory[i].Id" class="form-control code-example col" rows="5" readonly>@if (@Model.CodeHistory[i].Result!=null) {@Model.CodeHistory[i].Result}
                else {
                    @Model.CodeHistory[i].Error
                }</textarea>
                </p>
            </div>
            <div class="col-lg-1 date">
                <div class="row">
                    <p class="col-lg-12">@Model.CodeHistory[i].time</p>
                    <input type="button" class="btn btn-default btn-md col-lg-12" value="save changes" />
                    <input type="button" class="btn btn-default btn-md col-lg-12" value="try to execute" />
                </div>
            </div>
            <div class="checkbox_wrapper col-lg-1">
                <input data-id="@Model.CodeHistory[i].Id" id="icon" value="@Model.CodeHistory[i].IsFavouriteCode" type="checkbox" />
                <label data-id="@Model.CodeHistory[i].Id" for="icon" class="glyphicon glyphicon-heart"></label>
            </div>
            
        </form>
    </div><hr />
}









@section Scripts{
    <script src="~/js/codemirror.js"></script>
    <script src="~/js/matchbrackets.js"></script>
    <script src="~/js/continuecomment.js"></script>
    <script src="~/js/clike.js"></script>
    <script src="//cdn.tinymce.com/4/tinymce.min.js"></script>
    <script>
        var flag = false;
        $(document).ready(function () {
            $(document).on('click', '.titlecode', function (e) {
                e.preventDefault();
                var $this = $(this),
                    parent = $this.parents('form'),
                    showHideEl = parent.find('.code-example');

                showHideEl.slideToggle();
            });
            $(document).on('click', '.glyphicon', function (e) {
                var obj = new Object();
                var $this = $(this),
                    parent = $this.parents('form'),
                    showHideEl = parent.find('.glyphicon');

                codeId = showHideEl.data('id');
                flag = !flag;

                obj.codeId = codeId;
                obj.flag = flag;
                $.ajax({
                    type: "POST",
                    url: "/CodeHistory/setFav",
                    data: obj,

                    success: function (data) {
                        console.log(data.flag);
                        if (data.flag === true)
                            $this.css('color', 'red');
                        else
                            $this.css('color', 'grey');
                    }
                });
            });
        });








    </script>
}
