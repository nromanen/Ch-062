// 4.7.11 (2018-04-11)
!function () { "use strict"; var e, t, n, r, o, i, a, u, s, c, l, f, d, m, p, g, h, v = function (e) { return function () { return e } }, V = { noop: function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t] }, noarg: function (n) { return function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; return n() } }, compose: function (n, r) { return function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; return n(r.apply(null, arguments)) } }, constant: v, identity: function (e) { return e }, tripleEquals: function (e, t) { return e === t }, curry: function (i) { for (var e = [], t = 1; t < arguments.length; t++)e[t - 1] = arguments[t]; for (var a = new Array(arguments.length - 1), n = 1; n < arguments.length; n++)a[n - 1] = arguments[n]; return function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; for (var n = new Array(arguments.length), r = 0; r < n.length; r++)n[r] = arguments[r]; var o = a.concat(n); return i.apply(null, o) } }, not: function (n) { return function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; return !n.apply(null, arguments) } }, die: function (e) { return function () { throw new Error(e) } }, apply: function (e) { return e() }, call: function (e) { e() }, never: v(!1), always: v(!0) }, y = V.never, b = V.always, C = function () { return x }, x = (r = { fold: function (e, t) { return e() }, is: y, isSome: y, isNone: b, getOr: n = function (e) { return e }, getOrThunk: t = function (e) { return e() }, getOrDie: function (e) { throw new Error(e || "error: getOrDie called on none.") }, or: n, orThunk: t, map: C, ap: C, each: function () { }, bind: C, flatten: C, exists: y, forall: b, filter: C, equals: e = function (e) { return e.isNone() }, equals_: e, toArray: function () { return [] }, toString: V.constant("none()") }, Object.freeze && Object.freeze(r), r), w = function (n) { var e = function () { return n }, t = function () { return o }, r = function (e) { return e(n) }, o = { fold: function (e, t) { return t(n) }, is: function (e) { return n === e }, isSome: b, isNone: y, getOr: e, getOrThunk: e, getOrDie: e, or: t, orThunk: t, map: function (e) { return w(e(n)) }, ap: function (e) { return e.fold(C, function (e) { return w(e(n)) }) }, each: function (e) { e(n) }, bind: r, flatten: e, exists: r, forall: r, filter: function (e) { return e(n) ? o : x }, equals: function (e) { return e.is(n) }, equals_: function (e, t) { return e.fold(y, function (e) { return t(n, e) }) }, toArray: function () { return [n] }, toString: function () { return "some(" + n + ")" } }; return o }, A = { some: w, none: C, from: function (e) { return null === e || e === undefined ? x : w(e) } }, N = function (t) { return function (e) { return function (e) { if (null === e) return "null"; var t = typeof e; return "object" === t && Array.prototype.isPrototypeOf(e) ? "array" : "object" === t && String.prototype.isPrototypeOf(e) ? "string" : t }(e) === t } }, E = { isString: N("string"), isObject: N("object"), isArray: N("array"), isNull: N("null"), isBoolean: N("boolean"), isUndefined: N("undefined"), isFunction: N("function"), isNumber: N("number") }, S = (o = Array.prototype.indexOf) === undefined ? function (e, t) { return O(e, t) } : function (e, t) { return o.call(e, t) }, k = function (e, t) { return -1 < S(e, t) }, T = function (e, t) { for (var n = e.length, r = new Array(n), o = 0; o < n; o++) { var i = e[o]; r[o] = t(i, o, e) } return r }, R = function (e, t) { for (var n = 0, r = e.length; n < r; n++)t(e[n], n, e) }, B = function (e, t) { for (var n = e.length - 1; 0 <= n; n--)t(e[n], n, e) }, _ = function (e, t) { for (var n = [], r = 0, o = e.length; r < o; r++) { var i = e[r]; t(i, r, e) && n.push(i) } return n }, D = function (e, t) { for (var n = 0, r = e.length; n < r; n++)if (t(e[n], n, e)) return A.some(n); return A.none() }, O = function (e, t) { for (var n = 0, r = e.length; n < r; ++n)if (e[n] === t) return n; return -1 }, P = Array.prototype.push, L = function (e) { for (var t = [], n = 0, r = e.length; n < r; ++n) { if (!Array.prototype.isPrototypeOf(e[n])) throw new Error("Arr.flatten item " + n + " was not an array, input: " + e); P.apply(t, e[n]) } return t }, I = function (e, t) { for (var n = 0, r = e.length; n < r; ++n)if (!0 !== t(e[n], n, e)) return !1; return !0 }, M = Array.prototype.slice, F = E.isFunction(Array.from) ? Array.from : function (e) { return M.call(e) }, H = { map: T, each: R, eachr: B, partition: function (e, t) { for (var n = [], r = [], o = 0, i = e.length; o < i; o++) { var a = e[o]; (t(a, o, e) ? n : r).push(a) } return { pass: n, fail: r } }, filter: _, groupBy: function (e, t) { if (0 === e.length) return []; for (var n = t(e[0]), r = [], o = [], i = 0, a = e.length; i < a; i++) { var u = e[i], s = t(u); s !== n && (r.push(o), o = []), n = s, o.push(u) } return 0 !== o.length && r.push(o), r }, indexOf: function (e, t) { var n = S(e, t); return -1 === n ? A.none() : A.some(n) }, foldr: function (e, t, n) { return B(e, function (e) { n = t(n, e) }), n }, foldl: function (e, t, n) { return R(e, function (e) { n = t(n, e) }), n }, find: function (e, t) { for (var n = 0, r = e.length; n < r; n++) { var o = e[n]; if (t(o, n, e)) return A.some(o) } return A.none() }, findIndex: D, flatten: L, bind: function (e, t) { var n = T(e, t); return L(n) }, forall: I, exists: function (e, t) { return D(e, t).isSome() }, contains: k, equal: function (e, n) { return e.length === n.length && I(e, function (e, t) { return e === n[t] }) }, reverse: function (e) { var t = M.call(e, 0); return t.reverse(), t }, chunk: function (e, t) { for (var n = [], r = 0; r < e.length; r += t) { var o = e.slice(r, r + t); n.push(o) } return n }, difference: function (e, t) { return _(e, function (e) { return !k(t, e) }) }, mapToObject: function (e, t) { for (var n = {}, r = 0, o = e.length; r < o; r++) { var i = e[r]; n[String(i)] = t(i, r) } return n }, pure: function (e) { return [e] }, sort: function (e, t) { var n = M.call(e, 0); return n.sort(t), n }, range: function (e, t) { for (var n = [], r = 0; r < e; r++)n.push(t(r)); return n }, head: function (e) { return 0 === e.length ? A.none() : A.some(e[0]) }, last: function (e) { return 0 === e.length ? A.none() : A.some(e[e.length - 1]) }, from: F }, z = "undefined" != typeof window ? window : Function("return this;")(), U = function (e, t) { for (var n = t !== undefined && null !== t ? t : z, r = 0; r < e.length && n !== undefined && null !== n; ++r)n = n[e[r]]; return n }, q = function (e, t) { var n = e.split("."); return U(n, t) }, j = { getOrDie: function (e, t) { var n = q(e, t); if (n === undefined || null === n) throw e + " not available on this browser"; return n } }, $ = function () { return j.getOrDie("URL") }, W = { createObjectURL: function (e) { return $().createObjectURL(e) }, revokeObjectURL: function (e) { $().revokeObjectURL(e) } }, K = navigator, X = K.userAgent, Y = function (e) { return "matchMedia" in window && matchMedia(e).matches }; d = /Android/.test(X), a = (a = !(i = /WebKit/.test(X)) && /MSIE/gi.test(X) && /Explorer/gi.test(K.appName)) && /MSIE (\w+)\./.exec(X)[1], u = -1 !== X.indexOf("Trident/") && (-1 !== X.indexOf("rv:") || -1 !== K.appName.indexOf("Netscape")) && 11, s = -1 !== X.indexOf("Edge/") && !a && !u && 12, a = a || u || s, c = !i && !u && /Gecko/.test(X), l = -1 !== X.indexOf("Mac"), f = /(iPad|iPhone)/.test(X), m = "FormData" in window && "FileReader" in window && "URL" in window && !!W.createObjectURL, p = Y("only screen and (max-device-width: 480px)") && (d || f), g = Y("only screen and (min-width: 800px)") && (d || f), h = -1 !== X.indexOf("Windows Phone"), s && (i = !1); var G, J, Q, Z, ee, te, ne, re, oe, ie, ae, ue, se, ce, le, fe, de, me, pe, ge = { opera: !1, webkit: i, ie: a, gecko: c, mac: l, iOS: f, android: d, contentEditable: !f || m || 534 <= parseInt(X.match(/AppleWebKit\/(\d*)/)[1], 10), transparentSrc: "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7", caretAfter: 8 !== a, range: window.getSelection && "Range" in window, documentMode: a && !s ? document.documentMode || 7 : 10, fileApi: m, ceFalse: !1 === a || 8 < a, cacheSuffix: null, container: null, overrideViewPort: null, experimentalShadowDom: !1, canHaveCSP: !1 === a || 11 < a, desktop: !p && !g, windowsPhone: h }, he = window.Promise ? window.Promise : function () { function r(e, t) { return function () { e.apply(t, arguments) } } var e = Array.isArray || function (e) { return "[object Array]" === Object.prototype.toString.call(e) }, i = function (e) { if ("object" != typeof this) throw new TypeError("Promises must be constructed via new"); if ("function" != typeof e) throw new TypeError("not a function"); this._state = null, this._value = null, this._deferreds = [], l(e, r(o, this), r(u, this)) }, t = i.immediateFn || "function" == typeof setImmediate && setImmediate || function (e) { setTimeout(e, 1) }; function a(r) { var o = this; null !== this._state ? t(function () { var e = o._state ? r.onFulfilled : r.onRejected; if (null !== e) { var t; try { t = e(o._value) } catch (n) { return void r.reject(n) } r.resolve(t) } else (o._state ? r.resolve : r.reject)(o._value) }) : this._deferreds.push(r) } function o(e) { try { if (e === this) throw new TypeError("A promise cannot be resolved with itself."); if (e && ("object" == typeof e || "function" == typeof e)) { var t = e.then; if ("function" == typeof t) return void l(r(t, e), r(o, this), r(u, this)) } this._state = !0, this._value = e, s.call(this) } catch (n) { u.call(this, n) } } function u(e) { this._state = !1, this._value = e, s.call(this) } function s() { for (var e = 0, t = this._deferreds.length; e < t; e++)a.call(this, this._deferreds[e]); this._deferreds = null } function c(e, t, n, r) { this.onFulfilled = "function" == typeof e ? e : null, this.onRejected = "function" == typeof t ? t : null, this.resolve = n, this.reject = r } function l(e, t, n) { var r = !1; try { e(function (e) { r || (r = !0, t(e)) }, function (e) { r || (r = !0, n(e)) }) } catch (o) { if (r) return; r = !0, n(o) } } return i.prototype["catch"] = function (e) { return this.then(null, e) }, i.prototype.then = function (n, r) { var o = this; return new i(function (e, t) { a.call(o, new c(n, r, e, t)) }) }, i.all = function () { var s = Array.prototype.slice.call(1 === arguments.length && e(arguments[0]) ? arguments[0] : arguments); return new i(function (o, i) { if (0 === s.length) return o([]); var a = s.length; function u(t, e) { try { if (e && ("object" == typeof e || "function" == typeof e)) { var n = e.then; if ("function" == typeof n) return void n.call(e, function (e) { u(t, e) }, i) } s[t] = e, 0 == --a && o(s) } catch (r) { i(r) } } for (var e = 0; e < s.length; e++)u(e, s[e]) }) }, i.resolve = function (t) { return t && "object" == typeof t && t.constructor === i ? t : new i(function (e) { e(t) }) }, i.reject = function (n) { return new i(function (e, t) { t(n) }) }, i.race = function (o) { return new i(function (e, t) { for (var n = 0, r = o.length; n < r; n++)o[n].then(e, t) }) }, i }(), ve = function (e, t) { return "number" != typeof t && (t = 0), setTimeout(e, t) }, ye = function (e, t) { return "number" != typeof t && (t = 1), setInterval(e, t) }, be = function (t, n) { var r, e; return (e = function () { var e = arguments; clearTimeout(r), r = ve(function () { t.apply(this, e) }, n) }).stop = function () { clearTimeout(r) }, e }, Ce = { requestAnimationFrame: function (e, t) { G ? G.then(e) : G = new he(function (e) { t || (t = document.body), function (e, t) { var n, r = window.requestAnimationFrame, o = ["ms", "moz", "webkit"]; for (n = 0; n < o.length && !r; n++)r = window[o[n] + "RequestAnimationFrame"]; r || (r = function (e) { window.setTimeout(e, 0) }), r(e, t) }(e, t) }).then(e) }, setTimeout: ve, setInterval: ye, setEditorTimeout: function (e, t, n) { return ve(function () { e.removed || t() }, n) }, setEditorInterval: function (e, t, n) { var r; return r = ye(function () { e.removed ? clearInterval(r) : t() }, n) }, debounce: be, throttle: be, clearInterval: function (e) { return clearInterval(e) }, clearTimeout: function (e) { return clearTimeout(e) } }, xe = /^(?:mouse|contextmenu)|click/, we = { keyLocation: 1, layerX: 1, layerY: 1, returnValue: 1, webkitMovementX: 1, webkitMovementY: 1, keyIdentifier: 1 }, Ne = function () { return !1 }, Ee = function () { return !0 }, Se = function (e, t, n, r) { e.addEventListener ? e.addEventListener(t, n, r || !1) : e.attachEvent && e.attachEvent("on" + t, n) }, ke = function (e, t, n, r) { e.removeEventListener ? e.removeEventListener(t, n, r || !1) : e.detachEvent && e.detachEvent("on" + t, n) }, Te = function (e, t) { var n, r, o, i, a, u, s = t || {}; for (n in e) we[n] || (s[n] = e[n]); if (s.target || (s.target = s.srcElement || document), ge.experimentalShadowDom && (s.target = (r = e, o = s.target, a = o, (i = r.path) && 0 < i.length && (a = i[0]), r.composedPath && (i = r.composedPath()) && 0 < i.length && (a = i[0]), a)), e && xe.test(e.type) && e.pageX === undefined && e.clientX !== undefined) { var c = s.target.ownerDocument || document, l = c.documentElement, f = c.body; s.pageX = e.clientX + (l && l.scrollLeft || f && f.scrollLeft || 0) - (l && l.clientLeft || f && f.clientLeft || 0), s.pageY = e.clientY + (l && l.scrollTop || f && f.scrollTop || 0) - (l && l.clientTop || f && f.clientTop || 0) } return s.preventDefault = function () { s.isDefaultPrevented = Ee, e && (e.preventDefault ? e.preventDefault() : e.returnValue = !1) }, s.stopPropagation = function () { s.isPropagationStopped = Ee, e && (e.stopPropagation ? e.stopPropagation() : e.cancelBubble = !0) }, !(s.stopImmediatePropagation = function () { s.isImmediatePropagationStopped = Ee, s.stopPropagation() }) == ((u = s).isDefaultPrevented === Ee || u.isDefaultPrevented === Ne) && (s.isDefaultPrevented = Ne, s.isPropagationStopped = Ne, s.isImmediatePropagationStopped = Ne), "undefined" == typeof s.metaKey && (s.metaKey = !1), s }, Ae = function (e, t, n) { var r = e.document, o = { type: "ready" }; if (n.domLoaded) t(o); else { var i = function () { return "complete" === r.readyState || "interactive" === r.readyState && r.body }, a = function () { n.domLoaded || (n.domLoaded = !0, t(o)) }, u = function () { i() && (ke(r, "readystatechange", u), a()) }, s = function () { try { r.documentElement.doScroll("left") } catch (e) { return void Ce.setTimeout(s) } a() }; !r.addEventListener || ge.ie && ge.ie < 11 ? (Se(r, "readystatechange", u), r.documentElement.doScroll && e.self === e.top && s()) : i() ? a() : Se(e, "DOMContentLoaded", a), Se(e, "load", a) } }, Re = function () { var m, p, g, h, v, y = this, b = {}; p = "mce-data-" + (+new Date).toString(32), h = "onmouseenter" in document.documentElement, g = "onfocusin" in document.documentElement, v = { mouseenter: "mouseover", mouseleave: "mouseout" }, m = 1, y.domLoaded = !1, y.events = b; var C = function (e, t) { var n, r, o, i, a = b[t]; if (n = a && a[e.type]) for (r = 0, o = n.length; r < o; r++)if ((i = n[r]) && !1 === i.func.call(i.scope, e) && e.preventDefault(), e.isImmediatePropagationStopped()) return }; y.bind = function (e, t, n, r) { var o, i, a, u, s, c, l, f = window, d = function (e) { C(Te(e || f.event), o) }; if (e && 3 !== e.nodeType && 8 !== e.nodeType) { for (e[p] ? o = e[p] : (o = m++ , e[p] = o, b[o] = {}), r = r || e, a = (t = t.split(" ")).length; a--;)c = d, s = l = !1, "DOMContentLoaded" === (u = t[a]) && (u = "ready"), y.domLoaded && "ready" === u && "complete" === e.readyState ? n.call(r, Te({ type: u })) : (h || (s = v[u]) && (c = function (e) { var t, n; if (t = e.currentTarget, (n = e.relatedTarget) && t.contains) n = t.contains(n); else for (; n && n !== t;)n = n.parentNode; n || ((e = Te(e || f.event)).type = "mouseout" === e.type ? "mouseleave" : "mouseenter", e.target = t, C(e, o)) }), g || "focusin" !== u && "focusout" !== u || (l = !0, s = "focusin" === u ? "focus" : "blur", c = function (e) { (e = Te(e || f.event)).type = "focus" === e.type ? "focusin" : "focusout", C(e, o) }), (i = b[o][u]) ? "ready" === u && y.domLoaded ? n({ type: u }) : i.push({ func: n, scope: r }) : (b[o][u] = i = [{ func: n, scope: r }], i.fakeName = s, i.capture = l, i.nativeHandler = c, "ready" === u ? Ae(e, c, y) : Se(e, s || u, c, l))); return e = i = 0, n } }, y.unbind = function (e, t, n) { var r, o, i, a, u, s; if (!e || 3 === e.nodeType || 8 === e.nodeType) return y; if (r = e[p]) { if (s = b[r], t) { for (i = (t = t.split(" ")).length; i--;)if (o = s[u = t[i]]) { if (n) for (a = o.length; a--;)if (o[a].func === n) { var c = o.nativeHandler, l = o.fakeName, f = o.capture; (o = o.slice(0, a).concat(o.slice(a + 1))).nativeHandler = c, o.fakeName = l, o.capture = f, s[u] = o } n && 0 !== o.length || (delete s[u], ke(e, o.fakeName || u, o.nativeHandler, o.capture)) } } else { for (u in s) o = s[u], ke(e, o.fakeName || u, o.nativeHandler, o.capture); s = {} } for (u in s) return y; delete b[r]; try { delete e[p] } catch (d) { e[p] = null } } return y }, y.fire = function (e, t, n) { var r; if (!e || 3 === e.nodeType || 8 === e.nodeType) return y; for ((n = Te(null, n)).type = t, n.target = e; (r = e[p]) && C(n, r), (e = e.parentNode || e.ownerDocument || e.defaultView || e.parentWindow) && !n.isPropagationStopped();); return y }, y.clean = function (e) { var t, n, r = y.unbind; if (!e || 3 === e.nodeType || 8 === e.nodeType) return y; if (e[p] && r(e), e.getElementsByTagName || (e = e.document), e && e.getElementsByTagName) for (r(e), t = (n = e.getElementsByTagName("*")).length; t--;)(e = n[t])[p] && r(e); return y }, y.destroy = function () { b = {} }, y.cancel = function (e) { return e && (e.preventDefault(), e.stopImmediatePropagation()), !1 } }; Re.Event = new Re, Re.Event.bind(window, "ready", function () { }); var Be = "sizzle" + -new Date, _e = window.document, De = 0, Oe = 0, Pe = mt(), Le = mt(), Ie = mt(), Me = function (e, t) { return e === t && (ue = !0), 0 }, Fe = typeof undefined, ze = 1 << 31, Ue = {}.hasOwnProperty, qe = [], Ve = qe.pop, He = qe.push, je = qe.push, $e = qe.slice, We = qe.indexOf || function (e) { for (var t = 0, n = this.length; t < n; t++)if (this[t] === e) return t; return -1 }, Ke = "[\\x20\\t\\r\\n\\f]", Xe = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+", Ye = "\\[" + Ke + "*(" + Xe + ")(?:" + Ke + "*([*^$|!~]?=)" + Ke + "*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + Xe + "))|)" + Ke + "*\\]", Ge = ":(" + Xe + ")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|" + Ye + ")*)|.*)\\)|)", Je = new RegExp("^" + Ke + "+|((?:^|[^\\\\])(?:\\\\.)*)" + Ke + "+$", "g"), Qe = new RegExp("^" + Ke + "*," + Ke + "*"), Ze = new RegExp("^" + Ke + "*([>+~]|" + Ke + ")" + Ke + "*"), et = new RegExp("=" + Ke + "*([^\\]'\"]*?)" + Ke + "*\\]", "g"), tt = new RegExp(Ge), nt = new RegExp("^" + Xe + "$"), rt = { ID: new RegExp("^#(" + Xe + ")"), CLASS: new RegExp("^\\.(" + Xe + ")"), TAG: new RegExp("^(" + Xe + "|[*])"), ATTR: new RegExp("^" + Ye), PSEUDO: new RegExp("^" + Ge), CHILD: new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + Ke + "*(even|odd|(([+-]|)(\\d*)n|)" + Ke + "*(?:([+-]|)" + Ke + "*(\\d+)|))" + Ke + "*\\)|)", "i"), bool: new RegExp("^(?:checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped)$", "i"), needsContext: new RegExp("^" + Ke + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + Ke + "*((?:-\\d)?\\d*)" + Ke + "*\\)|)(?=[^-]|$)", "i") }, ot = /^(?:input|select|textarea|button)$/i, it = /^h\d$/i, at = /^[^{]+\{\s*\[native \w/, ut = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/, st = /[+~]/, ct = /'|\\/g, lt = new RegExp("\\\\([\\da-f]{1,6}" + Ke + "?|(" + Ke + ")|.)", "ig"), ft = function (e, t, n) { var r = "0x" + t - 65536; return r != r || n ? t : r < 0 ? String.fromCharCode(r + 65536) : String.fromCharCode(r >> 10 | 55296, 1023 & r | 56320) }; try { je.apply(qe = $e.call(_e.childNodes), _e.childNodes), qe[_e.childNodes.length].nodeType } catch (Zx) { je = { apply: qe.length ? function (e, t) { He.apply(e, $e.call(t)) } : function (e, t) { for (var n = e.length, r = 0; e[n++] = t[r++];); e.length = n - 1 } } } var dt = function (e, t, n, r) { var o, i, a, u, s, c, l, f, d, m; if ((t ? t.ownerDocument || t : _e) !== ce && se(t), n = n || [], !e || "string" != typeof e) return n; if (1 !== (u = (t = t || ce).nodeType) && 9 !== u) return []; if (fe && !r) { if (o = ut.exec(e)) if (a = o[1]) { if (9 === u) { if (!(i = t.getElementById(a)) || !i.parentNode) return n; if (i.id === a) return n.push(i), n } else if (t.ownerDocument && (i = t.ownerDocument.getElementById(a)) && pe(t, i) && i.id === a) return n.push(i), n } else { if (o[2]) return je.apply(n, t.getElementsByTagName(e)), n; if ((a = o[3]) && Q.getElementsByClassName) return je.apply(n, t.getElementsByClassName(a)), n } if (Q.qsa && (!de || !de.test(e))) { if (f = l = Be, d = t, m = 9 === u && e, 1 === u && "object" !== t.nodeName.toLowerCase()) { for (c = ne(e), (l = t.getAttribute("id")) ? f = l.replace(ct, "\\$&") : t.setAttribute("id", f), f = "[id='" + f + "'] ", s = c.length; s--;)c[s] = f + xt(c[s]); d = st.test(e) && bt(t.parentNode) || t, m = c.join(",") } if (m) try { return je.apply(n, d.querySelectorAll(m)), n } catch (p) { } finally { l || t.removeAttribute("id") } } } return oe(e.replace(Je, "$1"), t, n, r) }; function mt() { var r = []; return function e(t, n) { return r.push(t + " ") > Z.cacheLength && delete e[r.shift()], e[t + " "] = n } } function pt(e) { return e[Be] = !0, e } function gt(e, t) { var n = t && e, r = n && 1 === e.nodeType && 1 === t.nodeType && (~t.sourceIndex || ze) - (~e.sourceIndex || ze); if (r) return r; if (n) for (; n = n.nextSibling;)if (n === t) return -1; return e ? 1 : -1 } function ht(t) { return function (e) { return "input" === e.nodeName.toLowerCase() && e.type === t } } function vt(n) { return function (e) { var t = e.nodeName.toLowerCase(); return ("input" === t || "button" === t) && e.type === n } } function yt(a) { return pt(function (i) { return i = +i, pt(function (e, t) { for (var n, r = a([], e.length, i), o = r.length; o--;)e[n = r[o]] && (e[n] = !(t[n] = e[n])) }) }) } function bt(e) { return e && typeof e.getElementsByTagName !== Fe && e } for (J in Q = dt.support = {}, te = dt.isXML = function (e) { var t = e && (e.ownerDocument || e).documentElement; return !!t && "HTML" !== t.nodeName }, se = dt.setDocument = function (e) { var t, s = e ? e.ownerDocument || e : _e, n = s.defaultView; return s !== ce && 9 === s.nodeType && s.documentElement ? (le = (ce = s).documentElement, fe = !te(s), n && n !== function (e) { try { return e.top } catch (t) { } return null }(n) && (n.addEventListener ? n.addEventListener("unload", function () { se() }, !1) : n.attachEvent && n.attachEvent("onunload", function () { se() })), Q.attributes = !0, Q.getElementsByTagName = !0, Q.getElementsByClassName = at.test(s.getElementsByClassName), Q.getById = !0, Z.find.ID = function (e, t) { if (typeof t.getElementById !== Fe && fe) { var n = t.getElementById(e); return n && n.parentNode ? [n] : [] } }, Z.filter.ID = function (e) { var t = e.replace(lt, ft); return function (e) { return e.getAttribute("id") === t } }, Z.find.TAG = Q.getElementsByTagName ? function (e, t) { if (typeof t.getElementsByTagName !== Fe) return t.getElementsByTagName(e) } : function (e, t) { var n, r = [], o = 0, i = t.getElementsByTagName(e); if ("*" === e) { for (; n = i[o++];)1 === n.nodeType && r.push(n); return r } return i }, Z.find.CLASS = Q.getElementsByClassName && function (e, t) { if (fe) return t.getElementsByClassName(e) }, me = [], de = [], Q.disconnectedMatch = !0, de = de.length && new RegExp(de.join("|")), me = me.length && new RegExp(me.join("|")), t = at.test(le.compareDocumentPosition), pe = t || at.test(le.contains) ? function (e, t) { var n = 9 === e.nodeType ? e.documentElement : e, r = t && t.parentNode; return e === r || !(!r || 1 !== r.nodeType || !(n.contains ? n.contains(r) : e.compareDocumentPosition && 16 & e.compareDocumentPosition(r))) } : function (e, t) { if (t) for (; t = t.parentNode;)if (t === e) return !0; return !1 }, Me = t ? function (e, t) { if (e === t) return ue = !0, 0; var n = !e.compareDocumentPosition - !t.compareDocumentPosition; return n || (1 & (n = (e.ownerDocument || e) === (t.ownerDocument || t) ? e.compareDocumentPosition(t) : 1) || !Q.sortDetached && t.compareDocumentPosition(e) === n ? e === s || e.ownerDocument === _e && pe(_e, e) ? -1 : t === s || t.ownerDocument === _e && pe(_e, t) ? 1 : ae ? We.call(ae, e) - We.call(ae, t) : 0 : 4 & n ? -1 : 1) } : function (e, t) { if (e === t) return ue = !0, 0; var n, r = 0, o = e.parentNode, i = t.parentNode, a = [e], u = [t]; if (!o || !i) return e === s ? -1 : t === s ? 1 : o ? -1 : i ? 1 : ae ? We.call(ae, e) - We.call(ae, t) : 0; if (o === i) return gt(e, t); for (n = e; n = n.parentNode;)a.unshift(n); for (n = t; n = n.parentNode;)u.unshift(n); for (; a[r] === u[r];)r++; return r ? gt(a[r], u[r]) : a[r] === _e ? -1 : u[r] === _e ? 1 : 0 }, s) : ce }, dt.matches = function (e, t) { return dt(e, null, null, t) }, dt.matchesSelector = function (e, t) { if ((e.ownerDocument || e) !== ce && se(e), t = t.replace(et, "='$1']"), Q.matchesSelector && fe && (!me || !me.test(t)) && (!de || !de.test(t))) try { var n = (void 0).call(e, t); if (n || Q.disconnectedMatch || e.document && 11 !== e.document.nodeType) return n } catch (Zx) { } return 0 < dt(t, ce, null, [e]).length }, dt.contains = function (e, t) { return (e.ownerDocument || e) !== ce && se(e), pe(e, t) }, dt.attr = function (e, t) { (e.ownerDocument || e) !== ce && se(e); var n = Z.attrHandle[t.toLowerCase()], r = n && Ue.call(Z.attrHandle, t.toLowerCase()) ? n(e, t, !fe) : undefined; return r !== undefined ? r : Q.attributes || !fe ? e.getAttribute(t) : (r = e.getAttributeNode(t)) && r.specified ? r.value : null }, dt.error = function (e) { throw new Error("Syntax error, unrecognized expression: " + e) }, dt.uniqueSort = function (e) { var t, n = [], r = 0, o = 0; if (ue = !Q.detectDuplicates, ae = !Q.sortStable && e.slice(0), e.sort(Me), ue) { for (; t = e[o++];)t === e[o] && (r = n.push(o)); for (; r--;)e.splice(n[r], 1) } return ae = null, e }, ee = dt.getText = function (e) { var t, n = "", r = 0, o = e.nodeType; if (o) { if (1 === o || 9 === o || 11 === o) { if ("string" == typeof e.textContent) return e.textContent; for (e = e.firstChild; e; e = e.nextSibling)n += ee(e) } else if (3 === o || 4 === o) return e.nodeValue } else for (; t = e[r++];)n += ee(t); return n }, (Z = dt.selectors = { cacheLength: 50, createPseudo: pt, match: rt, attrHandle: {}, find: {}, relative: { ">": { dir: "parentNode", first: !0 }, " ": { dir: "parentNode" }, "+": { dir: "previousSibling", first: !0 }, "~": { dir: "previousSibling" } }, preFilter: { ATTR: function (e) { return e[1] = e[1].replace(lt, ft), e[3] = (e[3] || e[4] || e[5] || "").replace(lt, ft), "~=" === e[2] && (e[3] = " " + e[3] + " "), e.slice(0, 4) }, CHILD: function (e) { return e[1] = e[1].toLowerCase(), "nth" === e[1].slice(0, 3) ? (e[3] || dt.error(e[0]), e[4] = +(e[4] ? e[5] + (e[6] || 1) : 2 * ("even" === e[3] || "odd" === e[3])), e[5] = +(e[7] + e[8] || "odd" === e[3])) : e[3] && dt.error(e[0]), e }, PSEUDO: function (e) { var t, n = !e[6] && e[2]; return rt.CHILD.test(e[0]) ? null : (e[3] ? e[2] = e[4] || e[5] || "" : n && tt.test(n) && (t = ne(n, !0)) && (t = n.indexOf(")", n.length - t) - n.length) && (e[0] = e[0].slice(0, t), e[2] = n.slice(0, t)), e.slice(0, 3)) } }, filter: { TAG: function (e) { var t = e.replace(lt, ft).toLowerCase(); return "*" === e ? function () { return !0 } : function (e) { return e.nodeName && e.nodeName.toLowerCase() === t } }, CLASS: function (e) { var t = Pe[e + " "]; return t || (t = new RegExp("(^|" + Ke + ")" + e + "(" + Ke + "|$)")) && Pe(e, function (e) { return t.test("string" == typeof e.className && e.className || typeof e.getAttribute !== Fe && e.getAttribute("class") || "") }) }, ATTR: function (n, r, o) { return function (e) { var t = dt.attr(e, n); return null == t ? "!=" === r : !r || (t += "", "=" === r ? t === o : "!=" === r ? t !== o : "^=" === r ? o && 0 === t.indexOf(o) : "*=" === r ? o && -1 < t.indexOf(o) : "$=" === r ? o && t.slice(-o.length) === o : "~=" === r ? -1 < (" " + t + " ").indexOf(o) : "|=" === r && (t === o || t.slice(0, o.length + 1) === o + "-")) } }, CHILD: function (m, e, t, p, g) { var h = "nth" !== m.slice(0, 3), v = "last" !== m.slice(-4), y = "of-type" === e; return 1 === p && 0 === g ? function (e) { return !!e.parentNode } : function (e, t, n) { var r, o, i, a, u, s, c = h !== v ? "nextSibling" : "previousSibling", l = e.parentNode, f = y && e.nodeName.toLowerCase(), d = !n && !y; if (l) { if (h) { for (; c;) { for (i = e; i = i[c];)if (y ? i.nodeName.toLowerCase() === f : 1 === i.nodeType) return !1; s = c = "only" === m && !s && "nextSibling" } return !0 } if (s = [v ? l.firstChild : l.lastChild], v && d) { for (u = (r = (o = l[Be] || (l[Be] = {}))[m] || [])[0] === De && r[1], a = r[0] === De && r[2], i = u && l.childNodes[u]; i = ++u && i && i[c] || (a = u = 0) || s.pop();)if (1 === i.nodeType && ++a && i === e) { o[m] = [De, u, a]; break } } else if (d && (r = (e[Be] || (e[Be] = {}))[m]) && r[0] === De) a = r[1]; else for (; (i = ++u && i && i[c] || (a = u = 0) || s.pop()) && ((y ? i.nodeName.toLowerCase() !== f : 1 !== i.nodeType) || !++a || (d && ((i[Be] || (i[Be] = {}))[m] = [De, a]), i !== e));); return (a -= g) === p || a % p == 0 && 0 <= a / p } } }, PSEUDO: function (e, i) { var t, a = Z.pseudos[e] || Z.setFilters[e.toLowerCase()] || dt.error("unsupported pseudo: " + e); return a[Be] ? a(i) : 1 < a.length ? (t = [e, e, "", i], Z.setFilters.hasOwnProperty(e.toLowerCase()) ? pt(function (e, t) { for (var n, r = a(e, i), o = r.length; o--;)e[n = We.call(e, r[o])] = !(t[n] = r[o]) }) : function (e) { return a(e, 0, t) }) : a } }, pseudos: { not: pt(function (e) { var r = [], o = [], u = re(e.replace(Je, "$1")); return u[Be] ? pt(function (e, t, n, r) { for (var o, i = u(e, null, r, []), a = e.length; a--;)(o = i[a]) && (e[a] = !(t[a] = o)) }) : function (e, t, n) { return r[0] = e, u(r, null, n, o), !o.pop() } }), has: pt(function (t) { return function (e) { return 0 < dt(t, e).length } }), contains: pt(function (t) { return t = t.replace(lt, ft), function (e) { return -1 < (e.textContent || e.innerText || ee(e)).indexOf(t) } }), lang: pt(function (n) { return nt.test(n || "") || dt.error("unsupported lang: " + n), n = n.replace(lt, ft).toLowerCase(), function (e) { var t; do { if (t = fe ? e.lang : e.getAttribute("xml:lang") || e.getAttribute("lang")) return (t = t.toLowerCase()) === n || 0 === t.indexOf(n + "-") } while ((e = e.parentNode) && 1 === e.nodeType); return !1 } }), target: function (e) { var t = window.location && window.location.hash; return t && t.slice(1) === e.id }, root: function (e) { return e === le }, focus: function (e) { return e === ce.activeElement && (!ce.hasFocus || ce.hasFocus()) && !!(e.type || e.href || ~e.tabIndex) }, enabled: function (e) { return !1 === e.disabled }, disabled: function (e) { return !0 === e.disabled }, checked: function (e) { var t = e.nodeName.toLowerCase(); return "input" === t && !!e.checked || "option" === t && !!e.selected }, selected: function (e) { return e.parentNode && e.parentNode.selectedIndex, !0 === e.selected }, empty: function (e) { for (e = e.firstChild; e; e = e.nextSibling)if (e.nodeType < 6) return !1; return !0 }, parent: function (e) { return !Z.pseudos.empty(e) }, header: function (e) { return it.test(e.nodeName) }, input: function (e) { return ot.test(e.nodeName) }, button: function (e) { var t = e.nodeName.toLowerCase(); return "input" === t && "button" === e.type || "button" === t }, text: function (e) { var t; return "input" === e.nodeName.toLowerCase() && "text" === e.type && (null == (t = e.getAttribute("type")) || "text" === t.toLowerCase()) }, first: yt(function () { return [0] }), last: yt(function (e, t) { return [t - 1] }), eq: yt(function (e, t, n) { return [n < 0 ? n + t : n] }), even: yt(function (e, t) { for (var n = 0; n < t; n += 2)e.push(n); return e }), odd: yt(function (e, t) { for (var n = 1; n < t; n += 2)e.push(n); return e }), lt: yt(function (e, t, n) { for (var r = n < 0 ? n + t : n; 0 <= --r;)e.push(r); return e }), gt: yt(function (e, t, n) { for (var r = n < 0 ? n + t : n; ++r < t;)e.push(r); return e }) } }).pseudos.nth = Z.pseudos.eq, { radio: !0, checkbox: !0, file: !0, password: !0, image: !0 }) Z.pseudos[J] = ht(J); for (J in { submit: !0, reset: !0 }) Z.pseudos[J] = vt(J); function Ct() { } function xt(e) { for (var t = 0, n = e.length, r = ""; t < n; t++)r += e[t].value; return r } function wt(a, e, t) { var u = e.dir, s = t && "parentNode" === u, c = Oe++; return e.first ? function (e, t, n) { for (; e = e[u];)if (1 === e.nodeType || s) return a(e, t, n) } : function (e, t, n) { var r, o, i = [De, c]; if (n) { for (; e = e[u];)if ((1 === e.nodeType || s) && a(e, t, n)) return !0 } else for (; e = e[u];)if (1 === e.nodeType || s) { if ((r = (o = e[Be] || (e[Be] = {}))[u]) && r[0] === De && r[1] === c) return i[2] = r[2]; if ((o[u] = i)[2] = a(e, t, n)) return !0 } } } function Nt(o) { return 1 < o.length ? function (e, t, n) { for (var r = o.length; r--;)if (!o[r](e, t, n)) return !1; return !0 } : o[0] } function Et(e, t, n, r, o) { for (var i, a = [], u = 0, s = e.length, c = null != t; u < s; u++)(i = e[u]) && (n && !n(i, r, o) || (a.push(i), c && t.push(u))); return a } function St(m, p, g, h, v, e) { return h && !h[Be] && (h = St(h)), v && !v[Be] && (v = St(v, e)), pt(function (e, t, n, r) { var o, i, a, u = [], s = [], c = t.length, l = e || function (e, t, n) { for (var r = 0, o = t.length; r < o; r++)dt(e, t[r], n); return n }(p || "*", n.nodeType ? [n] : n, []), f = !m || !e && p ? l : Et(l, u, m, n, r), d = g ? v || (e ? m : c || h) ? [] : t : f; if (g && g(f, d, n, r), h) for (o = Et(d, s), h(o, [], n, r), i = o.length; i--;)(a = o[i]) && (d[s[i]] = !(f[s[i]] = a)); if (e) { if (v || m) { if (v) { for (o = [], i = d.length; i--;)(a = d[i]) && o.push(f[i] = a); v(null, d = [], o, r) } for (i = d.length; i--;)(a = d[i]) && -1 < (o = v ? We.call(e, a) : u[i]) && (e[o] = !(t[o] = a)) } } else d = Et(d === t ? d.splice(c, d.length) : d), v ? v(null, t, d, r) : je.apply(t, d) }) } function kt(e) { for (var r, t, n, o = e.length, i = Z.relative[e[0].type], a = i || Z.relative[" "], u = i ? 1 : 0, s = wt(function (e) { return e === r }, a, !0), c = wt(function (e) { return -1 < We.call(r, e) }, a, !0), l = [function (e, t, n) { return !i && (n || t !== ie) || ((r = t).nodeType ? s(e, t, n) : c(e, t, n)) }]; u < o; u++)if (t = Z.relative[e[u].type]) l = [wt(Nt(l), t)]; else { if ((t = Z.filter[e[u].type].apply(null, e[u].matches))[Be]) { for (n = ++u; n < o && !Z.relative[e[n].type]; n++); return St(1 < u && Nt(l), 1 < u && xt(e.slice(0, u - 1).concat({ value: " " === e[u - 2].type ? "*" : "" })).replace(Je, "$1"), t, u < n && kt(e.slice(u, n)), n < o && kt(e = e.slice(n)), n < o && xt(e)) } l.push(t) } return Nt(l) } Ct.prototype = Z.filters = Z.pseudos, Z.setFilters = new Ct, ne = dt.tokenize = function (e, t) { var n, r, o, i, a, u, s, c = Le[e + " "]; if (c) return t ? 0 : c.slice(0); for (a = e, u = [], s = Z.preFilter; a;) { for (i in n && !(r = Qe.exec(a)) || (r && (a = a.slice(r[0].length) || a), u.push(o = [])), n = !1, (r = Ze.exec(a)) && (n = r.shift(), o.push({ value: n, type: r[0].replace(Je, " ") }), a = a.slice(n.length)), Z.filter) !(r = rt[i].exec(a)) || s[i] && !(r = s[i](r)) || (n = r.shift(), o.push({ value: n, type: i, matches: r }), a = a.slice(n.length)); if (!n) break } return t ? a.length : a ? dt.error(e) : Le(e, u).slice(0) }, re = dt.compile = function (e, t) { var n, h, v, y, b, r, o = [], i = [], a = Ie[e + " "]; if (!a) { for (t || (t = ne(e)), n = t.length; n--;)(a = kt(t[n]))[Be] ? o.push(a) : i.push(a); (a = Ie(e, (h = i, y = 0 < (v = o).length, b = 0 < h.length, r = function (e, t, n, r, o) { var i, a, u, s = 0, c = "0", l = e && [], f = [], d = ie, m = e || b && Z.find.TAG("*", o), p = De += null == d ? 1 : Math.random() || .1, g = m.length; for (o && (ie = t !== ce && t); c !== g && null != (i = m[c]); c++) { if (b && i) { for (a = 0; u = h[a++];)if (u(i, t, n)) { r.push(i); break } o && (De = p) } y && ((i = !u && i) && s-- , e && l.push(i)) } if (s += c, y && c !== s) { for (a = 0; u = v[a++];)u(l, f, t, n); if (e) { if (0 < s) for (; c--;)l[c] || f[c] || (f[c] = Ve.call(r)); f = Et(f) } je.apply(r, f), o && !e && 0 < f.length && 1 < s + v.length && dt.uniqueSort(r) } return o && (De = p, ie = d), l }, y ? pt(r) : r))).selector = e } return a }, oe = dt.select = function (e, t, n, r) { var o, i, a, u, s, c = "function" == typeof e && e, l = !r && ne(e = c.selector || e); if (n = n || [], 1 === l.length) { if (2 < (i = l[0] = l[0].slice(0)).length && "ID" === (a = i[0]).type && Q.getById && 9 === t.nodeType && fe && Z.relative[i[1].type]) { if (!(t = (Z.find.ID(a.matches[0].replace(lt, ft), t) || [])[0])) return n; c && (t = t.parentNode), e = e.slice(i.shift().value.length) } for (o = rt.needsContext.test(e) ? 0 : i.length; o-- && (a = i[o], !Z.relative[u = a.type]);)if ((s = Z.find[u]) && (r = s(a.matches[0].replace(lt, ft), st.test(i[0].type) && bt(t.parentNode) || t))) { if (i.splice(o, 1), !(e = r.length && xt(i))) return je.apply(n, r), n; break } } return (c || re(e, l))(r, t, !fe, n, st.test(e) && bt(t.parentNode) || t), n }, Q.sortStable = Be.split("").sort(Me).join("") === Be, Q.detectDuplicates = !!ue, se(), Q.sortDetached = !0; var Tt = Array.isArray, At = function (e, t, n) { var r, o; if (!e) return 0; if (n = n || e, e.length !== undefined) { for (r = 0, o = e.length; r < o; r++)if (!1 === t.call(n, e[r], r, e)) return 0 } else for (r in e) if (e.hasOwnProperty(r) && !1 === t.call(n, e[r], r, e)) return 0; return 1 }, Rt = function (e, t, n) { var r, o; for (r = 0, o = e.length; r < o; r++)if (t.call(n, e[r], r, e)) return r; return -1 }, Bt = { isArray: Tt, toArray: function (e) { var t, n, r = e; if (!Tt(e)) for (r = [], t = 0, n = e.length; t < n; t++)r[t] = e[t]; return r }, each: At, map: function (n, r) { var o = []; return At(n, function (e, t) { o.push(r(e, t, n)) }), o }, filter: function (n, r) { var o = []; return At(n, function (e, t) { r && !r(e, t, n) || o.push(e) }), o }, indexOf: function (e, t) { var n, r; if (e) for (n = 0, r = e.length; n < r; n++)if (e[n] === t) return n; return -1 }, reduce: function (e, t, n, r) { var o = 0; for (arguments.length < 3 && (n = e[0]); o < e.length; o++)n = t.call(r, n, e[o], o); return n }, findIndex: Rt, find: function (e, t, n) { var r = Rt(e, t, n); return -1 !== r ? e[r] : undefined }, last: function (e) { return e[e.length - 1] } }, _t = /^\s*|\s*$/g, Dt = function (e) { return null === e || e === undefined ? "" : ("" + e).replace(_t, "") }, Ot = function (e, t) { return t ? !("array" !== t || !Bt.isArray(e)) || typeof e === t : e !== undefined }, Pt = function (e, n, r, o) { o = o || this, e && (r && (e = e[r]), Bt.each(e, function (e, t) { if (!1 === n.call(o, e, t, r)) return !1; Pt(e, n, r, o) })) }, Lt = { trim: Dt, isArray: Bt.isArray, is: Ot, toArray: Bt.toArray, makeMap: function (e, t, n) { var r; for (t = t || ",", "string" == typeof (e = e || []) && (e = e.split(t)), n = n || {}, r = e.length; r--;)n[e[r]] = {}; return n }, each: Bt.each, map: Bt.map, grep: Bt.filter, inArray: Bt.indexOf, hasOwn: function (e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, extend: function (e, t) { for (var n, r, o, i = [], a = 2; a < arguments.length; a++)i[a - 2] = arguments[a]; var u, s = arguments; for (n = 1, r = s.length; n < r; n++)for (o in t = s[n]) t.hasOwnProperty(o) && (u = t[o]) !== undefined && (e[o] = u); return e }, create: function (e, t, n) { var r, o, i, a, u, s = this, c = 0; if (e = /^((static) )?([\w.]+)(:([\w.]+))?/.exec(e), i = e[3].match(/(^|\.)(\w+)$/i)[2], !(o = s.createNS(e[3].replace(/\.\w+$/, ""), n))[i]) { if ("static" === e[2]) return o[i] = t, void (this.onCreate && this.onCreate(e[2], e[3], o[i])); t[i] || (t[i] = function () { }, c = 1), o[i] = t[i], s.extend(o[i].prototype, t), e[5] && (r = s.resolve(e[5]).prototype, a = e[5].match(/\.(\w+)$/i)[1], u = o[i], o[i] = c ? function () { return r[a].apply(this, arguments) } : function () { return this.parent = r[a], u.apply(this, arguments) }, o[i].prototype[i] = o[i], s.each(r, function (e, t) { o[i].prototype[t] = r[t] }), s.each(t, function (e, t) { r[t] ? o[i].prototype[t] = function () { return this.parent = r[t], e.apply(this, arguments) } : t !== i && (o[i].prototype[t] = e) })), s.each(t["static"], function (e, t) { o[i][t] = e }) } }, walk: Pt, createNS: function (e, t) { var n, r; for (t = t || window, e = e.split("."), n = 0; n < e.length; n++)t[r = e[n]] || (t[r] = {}), t = t[r]; return t }, resolve: function (e, t) { var n, r; for (t = t || window, n = 0, r = (e = e.split(".")).length; n < r && (t = t[e[n]]); n++); return t }, explode: function (e, t) { return !e || Ot(e, "array") ? e : Bt.map(e.split(t || ","), Dt) }, _addCacheSuffix: function (e) { var t = ge.cacheSuffix; return t && (e += (-1 === e.indexOf("?") ? "?" : "&") + t), e } }, It = document, Mt = Array.prototype.push, Ft = Array.prototype.slice, zt = /^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/, Ut = Re.Event, qt = Lt.makeMap("children,contents,next,prev"), Vt = function (e) { return void 0 !== e }, Ht = function (e) { return "string" == typeof e }, jt = function (e, t) { var n, r, o; for (o = (t = t || It).createElement("div"), n = t.createDocumentFragment(), o.innerHTML = e; r = o.firstChild;)n.appendChild(r); return n }, $t = function (e, t, n, r) { var o; if (Ht(t)) t = jt(t, an(e[0])); else if (t.length && !t.nodeType) { if (t = en.makeArray(t), r) for (o = t.length - 1; 0 <= o; o--)$t(e, t[o], n, r); else for (o = 0; o < t.length; o++)$t(e, t[o], n, r); return e } if (t.nodeType) for (o = e.length; o--;)n.call(e[o], t); return e }, Wt = function (e, t) { return e && t && -1 !== (" " + e.className + " ").indexOf(" " + t + " ") }, Kt = function (e, t, n) { var r, o; return t = en(t)[0], e.each(function () { var e = this; n && r === e.parentNode || (r = e.parentNode, o = t.cloneNode(!1), e.parentNode.insertBefore(o, e)), o.appendChild(e) }), e }, Xt = Lt.makeMap("fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom", " "), Yt = Lt.makeMap("checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected", " "), Gt = { "for": "htmlFor", "class": "className", readonly: "readOnly" }, Jt = { "float": "cssFloat" }, Qt = {}, Zt = {}, en = function (e, t) { return new en.fn.init(e, t) }, tn = /^\s*|\s*$/g, nn = function (e) { return null === e || e === undefined ? "" : ("" + e).replace(tn, "") }, rn = function (e, t) { var n, r, o, i; if (e) if ((n = e.length) === undefined) { for (r in e) if (e.hasOwnProperty(r) && (i = e[r], !1 === t.call(i, r, i))) break } else for (o = 0; o < n && (i = e[o], !1 !== t.call(i, o, i)); o++); return e }, on = function (e, n) { var r = []; return rn(e, function (e, t) { n(t, e) && r.push(t) }), r }, an = function (e) { return e ? 9 === e.nodeType ? e : e.ownerDocument : It }; en.fn = en.prototype = { constructor: en, selector: "", context: null, length: 0, init: function (e, t) { var n, r, o = this; if (!e) return o; if (e.nodeType) return o.context = o[0] = e, o.length = 1, o; if (t && t.nodeType) o.context = t; else { if (t) return en(e).attr(t); o.context = t = document } if (Ht(e)) { if (!(n = "<" === (o.selector = e).charAt(0) && ">" === e.charAt(e.length - 1) && 3 <= e.length ? [null, e, null] : zt.exec(e))) return en(t).find(e); if (n[1]) for (r = jt(e, an(t)).firstChild; r;)Mt.call(o, r), r = r.nextSibling; else { if (!(r = an(t).getElementById(n[2]))) return o; if (r.id !== n[2]) return o.find(e); o.length = 1, o[0] = r } } else this.add(e, !1); return o }, toArray: function () { return Lt.toArray(this) }, add: function (e, t) { var n, r, o = this; if (Ht(e)) return o.add(en(e)); if (!1 !== t) for (n = en.unique(o.toArray().concat(en.makeArray(e))), o.length = n.length, r = 0; r < n.length; r++)o[r] = n[r]; else Mt.apply(o, en.makeArray(e)); return o }, attr: function (t, n) { var e, r = this; if ("object" == typeof t) rn(t, function (e, t) { r.attr(e, t) }); else { if (!Vt(n)) { if (r[0] && 1 === r[0].nodeType) { if ((e = Qt[t]) && e.get) return e.get(r[0], t); if (Yt[t]) return r.prop(t) ? t : undefined; null === (n = r[0].getAttribute(t, 2)) && (n = undefined) } return n } this.each(function () { var e; if (1 === this.nodeType) { if ((e = Qt[t]) && e.set) return void e.set(this, n); null === n ? this.removeAttribute(t, 2) : this.setAttribute(t, n, 2) } }) } return r }, removeAttr: function (e) { return this.attr(e, null) }, prop: function (e, t) { var n = this; if ("object" == typeof (e = Gt[e] || e)) rn(e, function (e, t) { n.prop(e, t) }); else { if (!Vt(t)) return n[0] && n[0].nodeType && e in n[0] ? n[0][e] : t; this.each(function () { 1 === this.nodeType && (this[e] = t) }) } return n }, css: function (n, r) { var e, o, i = this, t = function (e) { return e.replace(/-(\D)/g, function (e, t) { return t.toUpperCase() }) }, a = function (e) { return e.replace(/[A-Z]/g, function (e) { return "-" + e }) }; if ("object" == typeof n) rn(n, function (e, t) { i.css(e, t) }); else if (Vt(r)) n = t(n), "number" != typeof r || Xt[n] || (r = r.toString() + "px"), i.each(function () { var e = this.style; if ((o = Zt[n]) && o.set) o.set(this, r); else { try { this.style[Jt[n] || n] = r } catch (t) { } null !== r && "" !== r || (e.removeProperty ? e.removeProperty(a(n)) : e.removeAttribute(n)) } }); else { if (e = i[0], (o = Zt[n]) && o.get) return o.get(e); if (!e.ownerDocument.defaultView) return e.currentStyle ? e.currentStyle[t(n)] : ""; try { return e.ownerDocument.defaultView.getComputedStyle(e, null).getPropertyValue(a(n)) } catch (u) { return undefined } } return i }, remove: function () { for (var e, t = this.length; t--;)e = this[t], Ut.clean(e), e.parentNode && e.parentNode.removeChild(e); return this }, empty: function () { for (var e, t = this.length; t--;)for (e = this[t]; e.firstChild;)e.removeChild(e.firstChild); return this }, html: function (e) { var t, n = this; if (Vt(e)) { t = n.length; try { for (; t--;)n[t].innerHTML = e } catch (r) { en(n[t]).empty().append(e) } return n } return n[0] ? n[0].innerHTML : "" }, text: function (e) { var t, n = this; if (Vt(e)) { for (t = n.length; t--;)"innerText" in n[t] ? n[t].innerText = e : n[0].textContent = e; return n } return n[0] ? n[0].innerText || n[0].textContent : "" }, append: function () { return $t(this, arguments, function (e) { (1 === this.nodeType || this.host && 1 === this.host.nodeType) && this.appendChild(e) }) }, prepend: function () { return $t(this, arguments, function (e) { (1 === this.nodeType || this.host && 1 === this.host.nodeType) && this.insertBefore(e, this.firstChild) }, !0) }, before: function () { return this[0] && this[0].parentNode ? $t(this, arguments, function (e) { this.parentNode.insertBefore(e, this) }) : this }, after: function () { return this[0] && this[0].parentNode ? $t(this, arguments, function (e) { this.parentNode.insertBefore(e, this.nextSibling) }, !0) : this }, appendTo: function (e) { return en(e).append(this), this }, prependTo: function (e) { return en(e).prepend(this), this }, replaceWith: function (e) { return this.before(e).remove() }, wrap: function (e) { return Kt(this, e) }, wrapAll: function (e) { return Kt(this, e, !0) }, wrapInner: function (e) { return this.each(function () { en(this).contents().wrapAll(e) }), this }, unwrap: function () { return this.parent().each(function () { en(this).replaceWith(this.childNodes) }) }, clone: function () { var e = []; return this.each(function () { e.push(this.cloneNode(!0)) }), en(e) }, addClass: function (e) { return this.toggleClass(e, !0) }, removeClass: function (e) { return this.toggleClass(e, !1) }, toggleClass: function (o, i) { var e = this; return "string" != typeof o || (-1 !== o.indexOf(" ") ? rn(o.split(" "), function () { e.toggleClass(this, i) }) : e.each(function (e, t) { var n, r; (r = Wt(t, o)) !== i && (n = t.className, r ? t.className = nn((" " + n + " ").replace(" " + o + " ", " ")) : t.className += n ? " " + o : o) })), e }, hasClass: function (e) { return Wt(this[0], e) }, each: function (e) { return rn(this, e) }, on: function (e, t) { return this.each(function () { Ut.bind(this, e, t) }) }, off: function (e, t) { return this.each(function () { Ut.unbind(this, e, t) }) }, trigger: function (e) { return this.each(function () { "object" == typeof e ? Ut.fire(this, e.type, e) : Ut.fire(this, e) }) }, show: function () { return this.css("display", "") }, hide: function () { return this.css("display", "none") }, slice: function () { return new en(Ft.apply(this, arguments)) }, eq: function (e) { return -1 === e ? this.slice(e) : this.slice(e, +e + 1) }, first: function () { return this.eq(0) }, last: function () { return this.eq(-1) }, find: function (e) { var t, n, r = []; for (t = 0, n = this.length; t < n; t++)en.find(e, this[t], r); return en(r) }, filter: function (n) { return en("function" == typeof n ? on(this.toArray(), function (e, t) { return n(t, e) }) : en.filter(n, this.toArray())) }, closest: function (n) { var r = []; return n instanceof en && (n = n[0]), this.each(function (e, t) { for (; t;) { if ("string" == typeof n && en(t).is(n)) { r.push(t); break } if (t === n) { r.push(t); break } t = t.parentNode } }), en(r) }, offset: function (e) { var t, n, r, o, i = 0, a = 0; return e ? this.css(e) : ((t = this[0]) && (r = (n = t.ownerDocument).documentElement, t.getBoundingClientRect && (i = (o = t.getBoundingClientRect()).left + (r.scrollLeft || n.body.scrollLeft) - r.clientLeft, a = o.top + (r.scrollTop || n.body.scrollTop) - r.clientTop)), { left: i, top: a }) }, push: Mt, sort: [].sort, splice: [].splice }, Lt.extend(en, { extend: Lt.extend, makeArray: function (e) { return (t = e) && t === t.window || e.nodeType ? [e] : Lt.toArray(e); var t }, inArray: function (e, t) { var n; if (t.indexOf) return t.indexOf(e); for (n = t.length; n--;)if (t[n] === e) return n; return -1 }, isArray: Lt.isArray, each: rn, trim: nn, grep: on, find: dt, expr: dt.selectors, unique: dt.uniqueSort, text: dt.getText, contains: dt.contains, filter: function (e, t, n) { var r = t.length; for (n && (e = ":not(" + e + ")"); r--;)1 !== t[r].nodeType && t.splice(r, 1); return t = 1 === t.length ? en.find.matchesSelector(t[0], e) ? [t[0]] : [] : en.find.matches(e, t) } }); var un = function (e, t, n) { var r = [], o = e[t]; for ("string" != typeof n && n instanceof en && (n = n[0]); o && 9 !== o.nodeType;) { if (n !== undefined) { if (o === n) break; if ("string" == typeof n && en(o).is(n)) break } 1 === o.nodeType && r.push(o), o = o[t] } return r }, sn = function (e, t, n, r) { var o = []; for (r instanceof en && (r = r[0]); e; e = e[t])if (!n || e.nodeType === n) { if (r !== undefined) { if (e === r) break; if ("string" == typeof r && en(e).is(r)) break } o.push(e) } return o }, cn = function (e, t, n) { for (e = e[t]; e; e = e[t])if (e.nodeType === n) return e; return null }; rn({ parent: function (e) { var t = e.parentNode; return t && 11 !== t.nodeType ? t : null }, parents: function (e) { return un(e, "parentNode") }, next: function (e) { return cn(e, "nextSibling", 1) }, prev: function (e) { return cn(e, "previousSibling", 1) }, children: function (e) { return sn(e.firstChild, "nextSibling", 1) }, contents: function (e) { return Lt.toArray(("iframe" === e.nodeName ? e.contentDocument || e.contentWindow.document : e).childNodes) } }, function (e, r) { en.fn[e] = function (t) { var n = []; return this.each(function () { var e = r.call(n, this, t, n); e && (en.isArray(e) ? n.push.apply(n, e) : n.push(e)) }), 1 < this.length && (qt[e] || (n = en.unique(n)), 0 === e.indexOf("parents") && (n = n.reverse())), n = en(n), t ? n.filter(t) : n } }), rn({ parentsUntil: function (e, t) { return un(e, "parentNode", t) }, nextUntil: function (e, t) { return sn(e, "nextSibling", 1, t).slice(1) }, prevUntil: function (e, t) { return sn(e, "previousSibling", 1, t).slice(1) } }, function (r, o) { en.fn[r] = function (t, e) { var n = []; return this.each(function () { var e = o.call(n, this, t, n); e && (en.isArray(e) ? n.push.apply(n, e) : n.push(e)) }), 1 < this.length && (n = en.unique(n), 0 !== r.indexOf("parents") && "prevUntil" !== r || (n = n.reverse())), n = en(n), e ? n.filter(e) : n } }), en.fn.is = function (e) { return !!e && 0 < this.filter(e).length }, en.fn.init.prototype = en.fn, en.overrideDefaults = function (n) { var r, o = function (e, t) { return r = r || n(), 0 === arguments.length && (e = r.element), t || (t = r.context), new o.fn.init(e, t) }; return en.extend(o, this), o }; var ln = function (n, r, e) { rn(e, function (e, t) { n[e] = n[e] || {}, n[e][r] = t }) }; ge.ie && ge.ie < 8 && (ln(Qt, "get", { maxlength: function (e) { var t = e.maxLength; return 2147483647 === t ? undefined : t }, size: function (e) { var t = e.size; return 20 === t ? undefined : t }, "class": function (e) { return e.className }, style: function (e) { var t = e.style.cssText; return 0 === t.length ? undefined : t } }), ln(Qt, "set", { "class": function (e, t) { e.className = t }, style: function (e, t) { e.style.cssText = t } })), ge.ie && ge.ie < 9 && (Jt["float"] = "styleFloat", ln(Zt, "set", { opacity: function (e, t) { var n = e.style; null === t || "" === t ? n.removeAttribute("filter") : (n.zoom = 1, n.filter = "alpha(opacity=" + 100 * t + ")") } })), en.attrHooks = Qt, en.cssHooks = Zt; var fn, dn = function (e) { var t, n = !1; return function () { return n || (n = !0, t = e.apply(null, arguments)), t } }, mn = function (e, t) { var n = function (e, t) { for (var n = 0; n < e.length; n++) { var r = e[n]; if (r.test(t)) return r } return undefined }(e, t); if (!n) return { major: 0, minor: 0 }; var r = function (e) { return Number(t.replace(n, "$" + e)) }; return gn(r(1), r(2)) }, pn = function () { return gn(0, 0) }, gn = function (e, t) { return { major: e, minor: t } }, hn = { nu: gn, detect: function (e, t) { var n = String(t).toLowerCase(); return 0 === e.length ? pn() : mn(e, n) }, unknown: pn }, vn = "Firefox", yn = function (e, t) { return function () { return t === e } }, bn = function (e) { var t = e.current; return { current: t, version: e.version, isEdge: yn("Edge", t), isChrome: yn("Chrome", t), isIE: yn("IE", t), isOpera: yn("Opera", t), isFirefox: yn(vn, t), isSafari: yn("Safari", t) } }, Cn = { unknown: function () { return bn({ current: undefined, version: hn.unknown() }) }, nu: bn, edge: V.constant("Edge"), chrome: V.constant("Chrome"), ie: V.constant("IE"), opera: V.constant("Opera"), firefox: V.constant(vn), safari: V.constant("Safari") }, xn = "Windows", wn = "Android", Nn = "Solaris", En = "FreeBSD", Sn = function (e, t) { return function () { return t === e } }, kn = function (e) { var t = e.current; return { current: t, version: e.version, isWindows: Sn(xn, t), isiOS: Sn("iOS", t), isAndroid: Sn(wn, t), isOSX: Sn("OSX", t), isLinux: Sn("Linux", t), isSolaris: Sn(Nn, t), isFreeBSD: Sn(En, t) } }, Tn = { unknown: function () { return kn({ current: undefined, version: hn.unknown() }) }, nu: kn, windows: V.constant(xn), ios: V.constant("iOS"), android: V.constant(wn), linux: V.constant("Linux"), osx: V.constant("OSX"), solaris: V.constant(Nn), freebsd: V.constant(En) }, An = function (e, t) { var n = String(t).toLowerCase(); return H.find(e, function (e) { return e.search(n) }) }, Rn = function (e, n) { return An(e, n).map(function (e) { var t = hn.detect(e.versionRegexes, n); return { current: e.name, version: t } }) }, Bn = function (e, n) { return An(e, n).map(function (e) { var t = hn.detect(e.versionRegexes, n); return { current: e.name, version: t } }) }, _n = function (e, t) { return -1 !== e.indexOf(t) }, Dn = function (e) { return e.replace(/^\s+|\s+$/g, "") }, On = /.*?version\/\ ?([0-9]+)\.([0-9]+).*/, Pn = function (t) { return function (e) { return _n(e, t) } }, Ln = [{ name: "Edge", versionRegexes: [/.*?edge\/ ?([0-9]+)\.([0-9]+)$/], search: function (e) { return _n(e, "edge/") && _n(e, "chrome") && _n(e, "safari") && _n(e, "applewebkit") } }, { name: "Chrome", versionRegexes: [/.*?chrome\/([0-9]+)\.([0-9]+).*/, On], search: function (e) { return _n(e, "chrome") && !_n(e, "chromeframe") } }, { name: "IE", versionRegexes: [/.*?msie\ ?([0-9]+)\.([0-9]+).*/, /.*?rv:([0-9]+)\.([0-9]+).*/], search: function (e) { return _n(e, "msie") || _n(e, "trident") } }, { name: "Opera", versionRegexes: [On, /.*?opera\/([0-9]+)\.([0-9]+).*/], search: Pn("opera") }, { name: "Firefox", versionRegexes: [/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/], search: Pn("firefox") }, { name: "Safari", versionRegexes: [On, /.*?cpu os ([0-9]+)_([0-9]+).*/], search: function (e) { return (_n(e, "safari") || _n(e, "mobile/")) && _n(e, "applewebkit") } }], In = [{ name: "Windows", search: Pn("win"), versionRegexes: [/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/] }, { name: "iOS", search: function (e) { return _n(e, "iphone") || _n(e, "ipad") }, versionRegexes: [/.*?version\/\ ?([0-9]+)\.([0-9]+).*/, /.*cpu os ([0-9]+)_([0-9]+).*/, /.*cpu iphone os ([0-9]+)_([0-9]+).*/] }, { name: "Android", search: Pn("android"), versionRegexes: [/.*?android\ ?([0-9]+)\.([0-9]+).*/] }, { name: "OSX", search: Pn("os x"), versionRegexes: [/.*?os\ x\ ?([0-9]+)_([0-9]+).*/] }, { name: "Linux", search: Pn("linux"), versionRegexes: [] }, { name: "Solaris", search: Pn("sunos"), versionRegexes: [] }, { name: "FreeBSD", search: Pn("freebsd"), versionRegexes: [] }], Mn = { browsers: V.constant(Ln), oses: V.constant(In) }, Fn = function (e) { var t, n, r, o, i, a, u, s, c, l, f, d = Mn.browsers(), m = Mn.oses(), p = Rn(d, e).fold(Cn.unknown, Cn.nu), g = Bn(m, e).fold(Tn.unknown, Tn.nu); return { browser: p, os: g, deviceType: (n = p, r = e, o = (t = g).isiOS() && !0 === /ipad/i.test(r), i = t.isiOS() && !o, a = t.isAndroid() && 3 === t.version.major, u = t.isAndroid() && 4 === t.version.major, s = o || a || u && !0 === /mobile/i.test(r), c = t.isiOS() || t.isAndroid(), l = c && !s, f = n.isSafari() && t.isiOS() && !1 === /safari/i.test(r), { isiPad: V.constant(o), isiPhone: V.constant(i), isTablet: V.constant(s), isPhone: V.constant(l), isTouch: V.constant(c), isAndroid: t.isAndroid, isiOS: t.isiOS, isWebView: V.constant(f) }) } }, zn = { detect: dn(function () { var e = navigator.userAgent; return Fn(e) }) }, Un = function (e) { if (null === e || e === undefined) throw new Error("Node cannot be null or undefined"); return { dom: V.constant(e) } }, qn = { fromHtml: function (e, t) { var n = (t || document).createElement("div"); if (n.innerHTML = e, !n.hasChildNodes() || 1 < n.childNodes.length) throw console.error("HTML does not have a single root node", e), "HTML must have a single root node"; return Un(n.childNodes[0]) }, fromTag: function (e, t) { var n = (t || document).createElement(e); return Un(n) }, fromText: function (e, t) { var n = (t || document).createTextNode(e); return Un(n) }, fromDom: Un, fromPoint: function (e, t, n) { return A.from(e.dom().elementFromPoint(t, n)).map(Un) } }, Vn = 8, Hn = 9, jn = 1, $n = 3, Wn = function (e) { return e.dom().nodeName.toLowerCase() }, Kn = function (e) { return e.dom().nodeType }, Xn = function (t) { return function (e) { return Kn(e) === t } }, Yn = Xn(jn), Gn = Xn($n), Jn = Xn(Hn), Qn = { name: Wn, type: Kn, value: function (e) { return e.dom().nodeValue }, isElement: Yn, isText: Gn, isDocument: Jn, isComment: function (e) { return Kn(e) === Vn || "#comment" === Wn(e) } }, Zn = (fn = Object.keys) === undefined ? function (e) { var t = []; for (var n in e) e.hasOwnProperty(n) && t.push(n); return t } : fn, er = function (e, t) { for (var n = Zn(e), r = 0, o = n.length; r < o; r++) { var i = n[r]; t(e[i], i, e) } }, tr = function (r, o) { var i = {}; return er(r, function (e, t) { var n = o(e, t, r); i[n.k] = n.v }), i }, nr = function (e, n) { var r = []; return er(e, function (e, t) { r.push(n(e, t)) }), r }, rr = function (e) { return nr(e, function (e) { return e }) }, or = { bifilter: function (e, n) { var r = {}, o = {}; return er(e, function (e, t) { (n(e, t) ? r : o)[t] = e }), { t: r, f: o } }, each: er, map: function (e, r) { return tr(e, function (e, t, n) { return { k: t, v: r(e, t, n) } }) }, mapToArray: nr, tupleMap: tr, find: function (e, t) { for (var n = Zn(e), r = 0, o = n.length; r < o; r++) { var i = n[r], a = e[i]; if (t(a, i, e)) return A.some(a) } return A.none() }, keys: Zn, values: rr, size: function (e) { return rr(e).length } }, ir = function (e, t, n) { if (!(E.isString(n) || E.isBoolean(n) || E.isNumber(n))) throw console.error("Invalid call to Attr.set. Key ", t, ":: Value ", n, ":: Element ", e), new Error("Attribute value was not simple"); e.setAttribute(t, n + "") }, ar = function (e, t, n) { ir(e.dom(), t, n) }, ur = function (e, t) { var n = e.dom().getAttribute(t); return null === n ? undefined : n }, sr = function (e, t) { var n = e.dom(); return !(!n || !n.hasAttribute) && n.hasAttribute(t) }, cr = { clone: function (e) { return H.foldl(e.dom().attributes, function (e, t) { return e[t.name] = t.value, e }, {}) }, set: ar, setAll: function (e, t) { var n = e.dom(); or.each(t, function (e, t) { ir(n, t, e) }) }, get: ur, has: sr, remove: function (e, t) { e.dom().removeAttribute(t) }, hasNone: function (e) { var t = e.dom().attributes; return t === undefined || null === t || 0 === t.length }, transfer: function (o, i, e) { Qn.isElement(o) && Qn.isElement(i) && H.each(e, function (e) { var t, n, r; n = i, sr(t = o, r = e) && !sr(n, r) && ar(n, r, ur(t, r)) }) } }, lr = dn(function () { return fr(qn.fromDom(document)) }), fr = function (e) { var t = e.dom().body; if (null === t || t === undefined) throw "Body is not available yet"; return qn.fromDom(t) }, dr = { body: lr, getBody: fr, inBody: function (e) { var t = Qn.isText(e) ? e.dom().parentNode : e.dom(); return t !== undefined && null !== t && t.ownerDocument.body.contains(t) } }, mr = function (e) { return e.style !== undefined }, pr = function (e, t, n) { if (!E.isString(n)) throw console.error("Invalid call to CSS.set. Property ", t, ":: Value ", n, ":: Element ", e), new Error("CSS value must be a string: " + n); mr(e) && e.style.setProperty(t, n) }, gr = function (e, t) { return mr(e) ? e.style.getPropertyValue(t) : "" }, hr = function (e, t) { var n = e.dom(), r = gr(n, t); return A.from(r).filter(function (e) { return 0 < e.length }) }, vr = function (e, t) { var n = e.dom(); or.each(t, function (e, t) { pr(n, t, e) }) }, yr = function (e, t) { var n = e.dom(), r = window.getComputedStyle(n).getPropertyValue(t), o = "" !== r || dr.inBody(e) ? r : gr(n, t); return null === o ? undefined : o }, br = hr, Cr = function (e) { return e.slice(0).sort() }, xr = { sort: Cr, reqMessage: function (e, t) { throw new Error("All required keys (" + Cr(e).join(", ") + ") were not specified. Specified keys were: " + Cr(t).join(", ") + ".") }, unsuppMessage: function (e) { throw new Error("Unsupported keys for object: " + Cr(e).join(", ")) }, validateStrArr: function (t, e) { if (!E.isArray(e)) throw new Error("The " + t + " fields must be an array. Was: " + e + "."); H.each(e, function (e) { if (!E.isString(e)) throw new Error("The value " + e + " in the " + t + " fields was not a string.") }) }, invalidTypeMessage: function (e, t) { throw new Error("All values need to be of type: " + t + ". Keys (" + Cr(e).join(", ") + ") were not.") }, checkDupes: function (e) { var n = Cr(e); H.find(n, function (e, t) { return t < n.length - 1 && e === n[t + 1] }).each(function (e) { throw new Error("The field: " + e + " occurs more than once in the combined fields: [" + n.join(", ") + "].") }) } }, wr = { immutable: function () { for (var t = [], e = 0; e < arguments.length; e++)t[e] = arguments[e]; return function () { for (var n = [], e = 0; e < arguments.length; e++)n[e] = arguments[e]; if (t.length !== n.length) throw new Error('Wrong number of arguments to struct. Expected "[' + t.length + ']", got ' + n.length + " arguments"); var r = {}; return H.each(t, function (e, t) { r[e] = V.constant(n[t]) }), r } }, immutableBag: function (o, i) { var a = o.concat(i); if (0 === a.length) throw new Error("You must specify at least one required or optional field."); return xr.validateStrArr("required", o), xr.validateStrArr("optional", i), xr.checkDupes(a), function (t) { var n = or.keys(t); H.forall(o, function (e) { return H.contains(n, e) }) || xr.reqMessage(o, n); var e = H.filter(n, function (e) { return !H.contains(a, e) }); 0 < e.length && xr.unsuppMessage(e); var r = {}; return H.each(o, function (e) { r[e] = V.constant(t[e]) }), H.each(i, function (e) { r[e] = V.constant(Object.prototype.hasOwnProperty.call(t, e) ? A.some(t[e]) : A.none()) }), r } } }, Nr = function (e, t) { for (var n = [], r = function (e) { return n.push(e), t(e) }, o = t(e); (o = o.bind(r)).isSome();); return n }, Er = function () { return j.getOrDie("Node") }, Sr = function (e, t, n) { return 0 != (e.compareDocumentPosition(t) & n) }, kr = function (e, t) { return Sr(e, t, Er().DOCUMENT_POSITION_CONTAINED_BY) }, Tr = jn, Ar = Hn, Rr = function (e) { return e.nodeType !== Tr && e.nodeType !== Ar || 0 === e.childElementCount }, Br = { all: function (e, t) { var n = t === undefined ? document : t.dom(); return Rr(n) ? [] : H.map(n.querySelectorAll(e), qn.fromDom) }, is: function (e, t) { var n = e.dom(); if (n.nodeType !== Tr) return !1; if (n.matches !== undefined) return n.matches(t); if (n.msMatchesSelector !== undefined) return n.msMatchesSelector(t); if (n.webkitMatchesSelector !== undefined) return n.webkitMatchesSelector(t); if (n.mozMatchesSelector !== undefined) return n.mozMatchesSelector(t); throw new Error("Browser lacks native selectors") }, one: function (e, t) { var n = t === undefined ? document : t.dom(); return Rr(n) ? A.none() : A.from(n.querySelector(e)).map(qn.fromDom) } }, _r = function (e, t) { return e.dom() === t.dom() }, Dr = zn.detect().browser.isIE() ? function (e, t) { return kr(e.dom(), t.dom()) } : function (e, t) { var n = e.dom(), r = t.dom(); return n !== r && n.contains(r) }, Or = { eq: _r, isEqualNode: function (e, t) { return e.dom().isEqualNode(t.dom()) }, member: function (e, t) { return H.exists(t, V.curry(_r, e)) }, contains: Dr, is: Br.is }, Pr = function (e) { return qn.fromDom(e.dom().ownerDocument) }, Lr = function (e) { var t = e.dom(); return A.from(t.parentNode).map(qn.fromDom) }, Ir = function (e) { var t = e.dom(); return A.from(t.previousSibling).map(qn.fromDom) }, Mr = function (e) { var t = e.dom(); return A.from(t.nextSibling).map(qn.fromDom) }, Fr = function (e) { var t = e.dom(); return H.map(t.childNodes, qn.fromDom) }, zr = function (e, t) { var n = e.dom().childNodes; return A.from(n[t]).map(qn.fromDom) }, Ur = wr.immutable("element", "offset"), qr = { owner: Pr, defaultView: function (e) { var t = e.dom().ownerDocument.defaultView; return qn.fromDom(t) }, documentElement: function (e) { var t = Pr(e); return qn.fromDom(t.dom().documentElement) }, parent: Lr, findIndex: function (n) { return Lr(n).bind(function (e) { var t = Fr(e); return H.findIndex(t, function (e) { return Or.eq(n, e) }) }) }, parents: function (e, t) { for (var n = E.isFunction(t) ? t : V.constant(!1), r = e.dom(), o = []; null !== r.parentNode && r.parentNode !== undefined;) { var i = r.parentNode, a = qn.fromDom(i); if (o.push(a), !0 === n(a)) break; r = i } return o }, siblings: function (t) { return Lr(t).map(Fr).map(function (e) { return H.filter(e, function (e) { return !Or.eq(t, e) }) }).getOr([]) }, prevSibling: Ir, offsetParent: function (e) { var t = e.dom(); return A.from(t.offsetParent).map(qn.fromDom) }, prevSiblings: function (e) { return H.reverse(Nr(e, Ir)) }, nextSibling: Mr, nextSiblings: function (e) { return Nr(e, Mr) }, children: Fr, child: zr, firstChild: function (e) { return zr(e, 0) }, lastChild: function (e) { return zr(e, e.dom().childNodes.length - 1) }, childNodesCount: function (e) { return e.dom().childNodes.length }, hasChildNodes: function (e) { return e.dom().hasChildNodes() }, leaf: function (e, t) { var n = Fr(e); return 0 < n.length && t < n.length ? Ur(n[t], 0) : Ur(e, t) } }, Vr = zn.detect().browser, Hr = function (e) { return H.find(e, Qn.isElement) }, jr = { getPos: function (e, t, n) { var r, o, i, a = 0, u = 0, s = e.ownerDocument; if (n = n || e, t) { if (n === e && t.getBoundingClientRect && "static" === yr(qn.fromDom(e), "position")) return { x: a = (o = t.getBoundingClientRect()).left + (s.documentElement.scrollLeft || e.scrollLeft) - s.documentElement.clientLeft, y: u = o.top + (s.documentElement.scrollTop || e.scrollTop) - s.documentElement.clientTop }; for (r = t; r && r !== n && r.nodeType;)a += r.offsetLeft || 0, u += r.offsetTop || 0, r = r.offsetParent; for (r = t.parentNode; r && r !== n && r.nodeType;)a -= r.scrollLeft || 0, u -= r.scrollTop || 0, r = r.parentNode; u += (i = qn.fromDom(t), Vr.isFirefox() && "table" === Qn.name(i) ? Hr(qr.children(i)).filter(function (e) { return "caption" === Qn.name(e) }).bind(function (o) { return Hr(qr.nextSiblings(o)).map(function (e) { var t = e.dom().offsetTop, n = o.dom().offsetTop, r = o.dom().offsetHeight; return t <= n ? -r : 0 }) }).getOr(0) : 0) } return { x: a, y: u } } }, $r = function (e) { var n = A.none(), t = [], r = function (e) { o() ? a(e) : t.push(e) }, o = function () { return n.isSome() }, i = function (e) { H.each(e, a) }, a = function (t) { n.each(function (e) { setTimeout(function () { t(e) }, 0) }) }; return e(function (e) { n = A.some(e), i(t), t = [] }), { get: r, map: function (n) { return $r(function (t) { r(function (e) { t(n(e)) }) }) }, isReady: o } }, Wr = { nu: $r, pure: function (t) { return $r(function (e) { e(t) }) } }, Kr = function (n) { return function () { var e = Array.prototype.slice.call(arguments), t = this; setTimeout(function () { n.apply(t, e) }, 0) } }, Xr = function (t) { var e = function (e) { t(Kr(e)) }; return { map: function (r) { return Xr(function (n) { e(function (e) { var t = r(e); n(t) }) }) }, bind: function (n) { return Xr(function (t) { e(function (e) { n(e).get(t) }) }) }, anonBind: function (n) { return Xr(function (t) { e(function (e) { n.get(t) }) }) }, toLazy: function () { return Wr.nu(e) }, get: e } }, Yr = { nu: Xr, pure: function (t) { return Xr(function (e) { e(t) }) } }, Gr = function (a, e) { return e(function (r) { var o = [], i = 0; 0 === a.length ? r([]) : H.each(a, function (e, t) { var n; e.get((n = t, function (e) { o[n] = e, ++i >= a.length && r(o) })) }) }) }, Jr = function (e) { return Gr(e, Yr.nu) }, Qr = { par: Jr, mapM: function (e, t) { var n = H.map(e, t); return Jr(n) }, compose: function (t, n) { return function (e) { return n(e).bind(t) } } }, Zr = function (n) { return { is: function (e) { return n === e }, isValue: V.always, isError: V.never, getOr: V.constant(n), getOrThunk: V.constant(n), getOrDie: V.constant(n), or: function (e) { return Zr(n) }, orThunk: function (e) { return Zr(n) }, fold: function (e, t) { return t(n) }, map: function (e) { return Zr(e(n)) }, each: function (e) { e(n) }, bind: function (e) { return e(n) }, exists: function (e) { return e(n) }, forall: function (e) { return e(n) }, toOption: function () { return A.some(n) } } }, eo = function (n) { return { is: V.never, isValue: V.never, isError: V.always, getOr: V.identity, getOrThunk: function (e) { return e() }, getOrDie: function () { return V.die(String(n))() }, or: function (e) { return e }, orThunk: function (e) { return e() }, fold: function (e, t) { return e(n) }, map: function (e) { return eo(n) }, each: V.noop, bind: function (e) { return eo(n) }, exists: V.never, forall: V.always, toOption: A.none } }, to = { value: Zr, error: eo }; function no(e, u) { var t = e, n = function (e, t, n, r) { var o, i; if (e) { if (!r && e[t]) return e[t]; if (e !== u) { if (o = e[n]) return o; for (i = e.parentNode; i && i !== u; i = i.parentNode)if (o = i[n]) return o } } }; this.current = function () { return t }, this.next = function (e) { return t = n(t, "firstChild", "nextSibling", e) }, this.prev = function (e) { return t = n(t, "lastChild", "previousSibling", e) }, this.prev2 = function (e) { return t = function (e, t, n, r) { var o, i, a; if (e) { if (o = e[n], u && o === u) return; if (o) { if (!r) for (a = o[t]; a; a = a[t])if (!a[t]) return a; return o } if ((i = e.parentNode) && i !== u) return i } }(t, "lastChild", "previousSibling", e) } } var ro, oo, io, ao = function (t) { var n; return function (e) { return (n = n || H.mapToObject(t, V.constant(!0))).hasOwnProperty(Qn.name(e)) } }, uo = ao(["h1", "h2", "h3", "h4", "h5", "h6"]), so = ao(["article", "aside", "details", "div", "dt", "figcaption", "footer", "form", "fieldset", "header", "hgroup", "html", "main", "nav", "section", "summary", "body", "p", "dl", "multicol", "dd", "figure", "address", "center", "blockquote", "h1", "h2", "h3", "h4", "h5", "h6", "listing", "xmp", "pre", "plaintext", "menu", "dir", "ul", "ol", "li", "hr", "table", "tbody", "thead", "tfoot", "th", "tr", "td", "caption"]), co = function (e) { return Qn.isElement(e) && !so(e) }, lo = function (e) { return Qn.isElement(e) && "br" === Qn.name(e) }, fo = ao(["h1", "h2", "h3", "h4", "h5", "h6", "p", "div", "address", "pre", "form", "blockquote", "center", "dir", "fieldset", "header", "footer", "article", "section", "hgroup", "aside", "nav", "figure"]), mo = ao(["ul", "ol", "dl"]), po = ao(["li", "dd", "dt"]), go = ao(["area", "base", "basefont", "br", "col", "frame", "hr", "img", "input", "isindex", "link", "meta", "param", "embed", "source", "wbr", "track"]), ho = ao(["thead", "tbody", "tfoot"]), vo = ao(["td", "th"]), yo = function (t) { return function (e) { return !!e && e.nodeType === t } }, bo = yo(1), Co = function (e) { var r = e.toLowerCase().split(" "); return function (e) { var t, n; if (e && e.nodeType) for (n = e.nodeName.toLowerCase(), t = 0; t < r.length; t++)if (n === r[t]) return !0; return !1 } }, xo = function (t) { return function (e) { if (bo(e)) { if (e.contentEditable === t) return !0; if (e.getAttribute("data-mce-contenteditable") === t) return !0 } return !1 } }, wo = yo(3), No = yo(8), Eo = yo(9), So = Co("br"), ko = xo("true"), To = xo("false"), Ao = { isText: wo, isElement: bo, isComment: No, isDocument: Eo, isBr: So, isContentEditableTrue: ko, isContentEditableFalse: To, matchNodeNames: Co, hasPropValue: function (t, n) { return function (e) { return bo(e) && e[t] === n } }, hasAttribute: function (t, e) { return function (e) { return bo(e) && e.hasAttribute(t) } }, hasAttributeValue: function (t, n) { return function (e) { return bo(e) && e.getAttribute(t) === n } }, matchStyleValues: function (r, e) { var o = e.toLowerCase().split(" "); return function (e) { var t; if (bo(e)) for (t = 0; t < o.length; t++) { var n = e.ownerDocument.defaultView.getComputedStyle(e, null); if ((n ? n.getPropertyValue(r) : null) === o[t]) return !0 } return !1 } }, isBogus: function (e) { return bo(e) && e.hasAttribute("data-mce-bogus") }, isBogusAll: function (e) { return bo(e) && "all" === e.getAttribute("data-mce-bogus") }, isTable: function (e) { return bo(e) && "TABLE" === e.tagName } }, Ro = function (e) { return e && "SPAN" === e.tagName && "bookmark" === e.getAttribute("data-mce-type") }, Bo = function (e, t) { var n, r = t.childNodes; if (!Ao.isElement(t) || !Ro(t)) { for (n = r.length - 1; 0 <= n; n--)Bo(e, r[n]); if (!1 === Ao.isDocument(t)) { if (Ao.isText(t) && 0 < t.nodeValue.length) { var o = Lt.trim(t.nodeValue).length; if (e.isBlock(t.parentNode) || 0 < o) return; if (0 === o && (a = (i = t).previousSibling && "SPAN" === i.previousSibling.nodeName, u = i.nextSibling && "SPAN" === i.nextSibling.nodeName, a && u)) return } else if (Ao.isElement(t) && (1 === (r = t.childNodes).length && Ro(r[0]) && t.parentNode.insertBefore(r[0], t), r.length || go(qn.fromDom(t)))) return; e.remove(t) } var i, a, u; return t } }, _o = { trimNode: Bo }, Do = Lt.makeMap, Oo = /[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g, Po = /[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g, Lo = /[<>&\"\']/g, Io = /&#([a-z0-9]+);?|&([a-z0-9]+);/gi, Mo = { 128: "\u20ac", 130: "\u201a", 131: "\u0192", 132: "\u201e", 133: "\u2026", 134: "\u2020", 135: "\u2021", 136: "\u02c6", 137: "\u2030", 138: "\u0160", 139: "\u2039", 140: "\u0152", 142: "\u017d", 145: "\u2018", 146: "\u2019", 147: "\u201c", 148: "\u201d", 149: "\u2022", 150: "\u2013", 151: "\u2014", 152: "\u02dc", 153: "\u2122", 154: "\u0161", 155: "\u203a", 156: "\u0153", 158: "\u017e", 159: "\u0178" }; oo = { '"': "&quot;", "'": "&#39;", "<": "&lt;", ">": "&gt;", "&": "&amp;", "`": "&#96;" }, io = { "&lt;": "<", "&gt;": ">", "&amp;": "&", "&quot;": '"', "&apos;": "'" }; var Fo = function (e, t) { var n, r, o, i = {}; if (e) { for (e = e.split(","), t = t || 10, n = 0; n < e.length; n += 2)r = String.fromCharCode(parseInt(e[n], t)), oo[r] || (o = "&" + e[n + 1] + ";", i[r] = o, i[o] = r); return i } }; ro = Fo("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro", 32); var zo = function (e, t) { return e.replace(t ? Oo : Po, function (e) { return oo[e] || e }) }, Uo = function (e, t) { return e.replace(t ? Oo : Po, function (e) { return 1 < e.length ? "&#" + (1024 * (e.charCodeAt(0) - 55296) + (e.charCodeAt(1) - 56320) + 65536) + ";" : oo[e] || "&#" + e.charCodeAt(0) + ";" }) }, qo = function (e, t, n) { return n = n || ro, e.replace(t ? Oo : Po, function (e) { return oo[e] || n[e] || e }) }, Vo = { encodeRaw: zo, encodeAllRaw: function (e) { return ("" + e).replace(Lo, function (e) { return oo[e] || e }) }, encodeNumeric: Uo, encodeNamed: qo, getEncodeFunc: function (e, t) { var n = Fo(t) || ro, r = Do(e.replace(/\+/g, ",")); return r.named && r.numeric ? function (e, t) { return e.replace(t ? Oo : Po, function (e) { return oo[e] !== undefined ? oo[e] : n[e] !== undefined ? n[e] : 1 < e.length ? "&#" + (1024 * (e.charCodeAt(0) - 55296) + (e.charCodeAt(1) - 56320) + 65536) + ";" : "&#" + e.charCodeAt(0) + ";" }) } : r.named ? t ? function (e, t) { return qo(e, t, n) } : qo : r.numeric ? Uo : zo }, decode: function (e) { return e.replace(Io, function (e, t) { return t ? 65535 < (t = "x" === t.charAt(0).toLowerCase() ? parseInt(t.substr(1), 16) : parseInt(t, 10)) ? (t -= 65536, String.fromCharCode(55296 + (t >> 10), 56320 + (1023 & t))) : Mo[t] || String.fromCharCode(t) : io[e] || ro[e] || (n = e, (r = qn.fromTag("div").dom()).innerHTML = n, r.textContent || r.innerText || n); var n, r }) } }, Ho = {}, jo = {}, $o = Lt.makeMap, Wo = Lt.each, Ko = Lt.extend, Xo = Lt.explode, Yo = Lt.inArray, Go = function (e, t) { return (e = Lt.trim(e)) ? e.split(t || " ") : [] }, Jo = function (e) { var u, t, n, r, o, i, s = {}, a = function (e, t, n) { var r, o, i, a = function (e, t) { var n, r, o = {}; for (n = 0, r = e.length; n < r; n++)o[e[n]] = t || {}; return o }; for (t = t || "", "string" == typeof (n = n || []) && (n = Go(n)), r = (e = Go(e)).length; r--;)i = { attributes: a(o = Go([u, t].join(" "))), attributesOrder: o, children: a(n, jo) }, s[e[r]] = i }, c = function (e, t) { var n, r, o, i; for (n = (e = Go(e)).length, t = Go(t); n--;)for (r = s[e[n]], o = 0, i = t.length; o < i; o++)r.attributes[t[o]] = {}, r.attributesOrder.push(t[o]) }; return Ho[e] ? Ho[e] : (u = "id accesskey class dir lang style tabindex title role", t = "address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul", n = "a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment", "html4" !== e && (u += " contenteditable contextmenu draggable dropzone hidden spellcheck translate", t += " article aside details dialog figure header footer hgroup section nav", n += " audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"), "html5-strict" !== e && (u += " xml:lang", n = [n, i = "acronym applet basefont big font strike tt"].join(" "), Wo(Go(i), function (e) { a(e, "", n) }), t = [t, o = "center dir isindex noframes"].join(" "), r = [t, n].join(" "), Wo(Go(o), function (e) { a(e, "", r) })), r = r || [t, n].join(" "), a("html", "manifest", "head body"), a("head", "", "base command link meta noscript script style title"), a("title hr noscript br"), a("base", "href target"), a("link", "href rel media hreflang type sizes hreflang"), a("meta", "name http-equiv content charset"), a("style", "media type scoped"), a("script", "src async defer type charset"), a("body", "onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload", r), a("address dt dd div caption", "", r), a("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn", "", n), a("blockquote", "cite", r), a("ol", "reversed start type", "li"), a("ul", "", "li"), a("li", "value", r), a("dl", "", "dt dd"), a("a", "href target rel media hreflang type", n), a("q", "cite", n), a("ins del", "cite datetime", r), a("img", "src sizes srcset alt usemap ismap width height"), a("iframe", "src name width height", r), a("embed", "src type width height"), a("object", "data type typemustmatch name usemap form width height", [r, "param"].join(" ")), a("param", "name value"), a("map", "name", [r, "area"].join(" ")), a("area", "alt coords shape href target rel media hreflang type"), a("table", "border", "caption colgroup thead tfoot tbody tr" + ("html4" === e ? " col" : "")), a("colgroup", "span", "col"), a("col", "span"), a("tbody thead tfoot", "", "tr"), a("tr", "", "td th"), a("td", "colspan rowspan headers", r), a("th", "colspan rowspan headers scope abbr", r), a("form", "accept-charset action autocomplete enctype method name novalidate target", r), a("fieldset", "disabled form name", [r, "legend"].join(" ")), a("label", "form for", n), a("input", "accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"), a("button", "disabled form formaction formenctype formmethod formnovalidate formtarget name type value", "html4" === e ? r : n), a("select", "disabled form multiple name required size", "option optgroup"), a("optgroup", "disabled label", "option"), a("option", "disabled label selected value"), a("textarea", "cols dirname disabled form maxlength name readonly required rows wrap"), a("menu", "type label", [r, "li"].join(" ")), a("noscript", "", r), "html4" !== e && (a("wbr"), a("ruby", "", [n, "rt rp"].join(" ")), a("figcaption", "", r), a("mark rt rp summary bdi", "", n), a("canvas", "width height", r), a("video", "src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered", [r, "track source"].join(" ")), a("audio", "src crossorigin preload autoplay mediagroup loop muted controls buffered volume", [r, "track source"].join(" ")), a("picture", "", "img source"), a("source", "src srcset type media sizes"), a("track", "kind src srclang label default"), a("datalist", "", [n, "option"].join(" ")), a("article section nav aside header footer", "", r), a("hgroup", "", "h1 h2 h3 h4 h5 h6"), a("figure", "", [r, "figcaption"].join(" ")), a("time", "datetime", n), a("dialog", "open", r), a("command", "type label icon disabled checked radiogroup command"), a("output", "for form name", n), a("progress", "value max", n), a("meter", "value min max low high optimum", n), a("details", "open", [r, "summary"].join(" ")), a("keygen", "autofocus challenge disabled form keytype name")), "html5-strict" !== e && (c("script", "language xml:space"), c("style", "xml:space"), c("object", "declare classid code codebase codetype archive standby align border hspace vspace"), c("embed", "align name hspace vspace"), c("param", "valuetype type"), c("a", "charset name rev shape coords"), c("br", "clear"), c("applet", "codebase archive code object alt name width height align hspace vspace"), c("img", "name longdesc align border hspace vspace"), c("iframe", "longdesc frameborder marginwidth marginheight scrolling align"), c("font basefont", "size color face"), c("input", "usemap align"), c("select", "onchange"), c("textarea"), c("h1 h2 h3 h4 h5 h6 div p legend caption", "align"), c("ul", "type compact"), c("li", "type"), c("ol dl menu dir", "compact"), c("pre", "width xml:space"), c("hr", "align noshade size width"), c("isindex", "prompt"), c("table", "summary width frame rules cellspacing cellpadding align bgcolor"), c("col", "width align char charoff valign"), c("colgroup", "width align char charoff valign"), c("thead", "align char charoff valign"), c("tr", "align char charoff valign bgcolor"), c("th", "axis align char charoff valign nowrap bgcolor width height"), c("form", "accept"), c("td", "abbr axis scope align char charoff valign nowrap bgcolor width height"), c("tfoot", "align char charoff valign"), c("tbody", "align char charoff valign"), c("area", "nohref"), c("body", "background bgcolor text link vlink alink")), "html4" !== e && (c("input button select textarea", "autofocus"), c("input textarea", "placeholder"), c("a", "download"), c("link script img", "crossorigin"), c("iframe", "sandbox seamless allowfullscreen")), Wo(Go("a form meter progress dfn"), function (e) { s[e] && delete s[e].children[e] }), delete s.caption.children.table, delete s.script, Ho[e] = s) }, Qo = function (e, n) { var r; return e && (r = {}, "string" == typeof e && (e = { "*": e }), Wo(e, function (e, t) { r[t] = r[t.toUpperCase()] = "map" === n ? $o(e, /[, ]/) : Xo(e, /[, ]/) })), r }; function Zo(i) { var e, t, n, r, o, a, u, s, c, l, f, d, m, N = {}, p = {}, E = [], g = {}, h = {}, v = function (e, t, n) { var r = i[e]; return r ? r = $o(r, /[, ]/, $o(r.toUpperCase(), /[, ]/)) : (r = Ho[e]) || (r = $o(t, " ", $o(t.toUpperCase(), " ")), r = Ko(r, n), Ho[e] = r), r }; n = Jo((i = i || {}).schema), !1 === i.verify_html && (i.valid_elements = "*[*]"), e = Qo(i.valid_styles), t = Qo(i.invalid_styles, "map"), s = Qo(i.valid_classes, "map"), r = v("whitespace_elements", "pre script noscript style textarea video audio iframe object code"), o = v("self_closing_elements", "colgroup dd dt li option p td tfoot th thead tr"), a = v("short_ended_elements", "area base basefont br col frame hr img input isindex link meta param embed source wbr track"), u = v("boolean_attributes", "checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls"), l = v("non_empty_elements", "td th iframe video audio object script pre code", a), f = v("move_caret_before_on_enter_elements", "table", l), d = v("text_block_elements", "h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside nav figure"), c = v("block_elements", "hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption", d), m = v("text_inline_elements", "span strong b em i font strike u var cite dfn code mark q sup sub samp"), Wo((i.special || "script noscript noframes noembed title style textarea xmp").split(" "), function (e) { h[e] = new RegExp("</" + e + "[^>]*>", "gi") }); var S = function (e) { return new RegExp("^" + e.replace(/([?+*])/g, ".$1") + "$") }, y = function (e) { var t, n, r, o, i, a, u, s, c, l, f, d, m, p, g, h, v, y, b, C = /^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)\])?$/, x = /^([!\-])?(\w+[\\:]:\w+|[^=:<]+)?(?:([=:<])(.*))?$/, w = /[*?+]/; if (e) for (e = Go(e, ","), N["@"] && (h = N["@"].attributes, v = N["@"].attributesOrder), t = 0, n = e.length; t < n; t++)if (i = C.exec(e[t])) { if (p = i[1], c = i[2], g = i[3], s = i[5], a = { attributes: d = {}, attributesOrder: m = [] }, "#" === p && (a.paddEmpty = !0), "-" === p && (a.removeEmpty = !0), "!" === i[4] && (a.removeEmptyAttrs = !0), h) { for (y in h) d[y] = h[y]; m.push.apply(m, v) } if (s) for (r = 0, o = (s = Go(s, "|")).length; r < o; r++)if (i = x.exec(s[r])) { if (u = {}, f = i[1], l = i[2].replace(/[\\:]:/g, ":"), p = i[3], b = i[4], "!" === f && (a.attributesRequired = a.attributesRequired || [], a.attributesRequired.push(l), u.required = !0), "-" === f) { delete d[l], m.splice(Yo(m, l), 1); continue } p && ("=" === p && (a.attributesDefault = a.attributesDefault || [], a.attributesDefault.push({ name: l, value: b }), u.defaultValue = b), ":" === p && (a.attributesForced = a.attributesForced || [], a.attributesForced.push({ name: l, value: b }), u.forcedValue = b), "<" === p && (u.validValues = $o(b, "?"))), w.test(l) ? (a.attributePatterns = a.attributePatterns || [], u.pattern = S(l), a.attributePatterns.push(u)) : (d[l] || m.push(l), d[l] = u) } h || "@" !== c || (h = d, v = m), g && (a.outputName = c, N[g] = a), w.test(c) ? (a.pattern = S(c), E.push(a)) : N[c] = a } }, b = function (e) { N = {}, E = [], y(e), Wo(n, function (e, t) { p[t] = e.children }) }, C = function (e) { var a = /^(~)?(.+)$/; e && (Ho.text_block_elements = Ho.block_elements = null, Wo(Go(e, ","), function (e) { var t = a.exec(e), n = "~" === t[1], r = n ? "span" : "div", o = t[2]; if (p[o] = p[r], g[o] = r, n || (c[o.toUpperCase()] = {}, c[o] = {}), !N[o]) { var i = N[r]; delete (i = Ko({}, i)).removeEmptyAttrs, delete i.removeEmpty, N[o] = i } Wo(p, function (e, t) { e[r] && (p[t] = e = Ko({}, p[t]), e[o] = e[r]) }) })) }, x = function (e) { var o = /^([+\-]?)(\w+)\[([^\]]+)\]$/; Ho[i.schema] = null, e && Wo(Go(e, ","), function (e) { var t, n, r = o.exec(e); r && (n = r[1], t = n ? p[r[2]] : p[r[2]] = { "#comment": {} }, t = p[r[2]], Wo(Go(r[3], "|"), function (e) { "-" === n ? delete t[e] : t[e] = {} })) }) }, w = function (e) { var t, n = N[e]; if (n) return n; for (t = E.length; t--;)if ((n = E[t]).pattern.test(e)) return n }; return i.valid_elements ? b(i.valid_elements) : (Wo(n, function (e, t) { N[t] = { attributes: e.attributes, attributesOrder: e.attributesOrder }, p[t] = e.children }), "html5" !== i.schema && Wo(Go("strong/b em/i"), function (e) { e = Go(e, "/"), N[e[1]].outputName = e[0] }), Wo(Go("ol ul sub sup blockquote span font a table tbody tr strong em b i"), function (e) { N[e] && (N[e].removeEmpty = !0) }), Wo(Go("p h1 h2 h3 h4 h5 h6 th td pre div address caption li"), function (e) { N[e].paddEmpty = !0 }), Wo(Go("span"), function (e) { N[e].removeEmptyAttrs = !0 })), C(i.custom_elements), x(i.valid_children), y(i.extended_valid_elements), x("+ol[ul|ol],+ul[ul|ol]"), Wo({ dd: "dl", dt: "dl", li: "ul ol", td: "tr", th: "tr", tr: "tbody thead tfoot", tbody: "table", thead: "table", tfoot: "table", legend: "fieldset", area: "map", param: "video audio object" }, function (e, t) { N[t] && (N[t].parentsRequired = Go(e)) }), i.invalid_elements && Wo(Xo(i.invalid_elements), function (e) { N[e] && delete N[e] }), w("span") || y("span[!data-mce-type|*]"), { children: p, elements: N, getValidStyles: function () { return e }, getValidClasses: function () { return s }, getBlockElements: function () { return c }, getInvalidStyles: function () { return t }, getShortEndedElements: function () { return a }, getTextBlockElements: function () { return d }, getTextInlineElements: function () { return m }, getBoolAttrs: function () { return u }, getElementRule: w, getSelfClosingElements: function () { return o }, getNonEmptyElements: function () { return l }, getMoveCaretBeforeOnEnterElements: function () { return f }, getWhiteSpaceElements: function () { return r }, getSpecialElements: function () { return h }, isValidChild: function (e, t) { var n = p[e.toLowerCase()]; return !(!n || !n[t.toLowerCase()]) }, isValid: function (e, t) { var n, r, o = w(e); if (o) { if (!t) return !0; if (o.attributes[t]) return !0; if (n = o.attributePatterns) for (r = n.length; r--;)if (n[r].pattern.test(e)) return !0 } return !1 }, getCustomElements: function () { return g }, addValidElements: y, setValidElements: b, addCustomElements: C, addValidChildren: x } } var ei = function (e, t, n, r) { var o = function (e) { return 1 < (e = parseInt(e, 10).toString(16)).length ? e : "0" + e }; return "#" + o(t) + o(n) + o(r) }; function ti(b, e) { var C, t, c, l, x = /rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi, w = /(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi, N = /\s*([^:]+):\s*([^;]+);?/g, E = /\s+$/, S = {}, k = "\ufeff"; for (b = b || {}, e && (c = e.getValidStyles(), l = e.getInvalidStyles()), t = ("\\\" \\' \\; \\: ; : " + k).split(" "), C = 0; C < t.length; C++)S[t[C]] = k + C, S[k + C] = t[C]; return { toHex: function (e) { return e.replace(x, ei) }, parse: function (e) { var t, n, r, o, i, a, u, s, c = {}, l = b.url_converter, f = b.url_converter_scope || this, d = function (e, t, n) { var r, o, i, a; if ((r = c[e + "-top" + t]) && (o = c[e + "-right" + t]) && (i = c[e + "-bottom" + t]) && (a = c[e + "-left" + t])) { var u = [r, o, i, a]; for (C = u.length - 1; C-- && u[C] === u[C + 1];); -1 < C && n || (c[e + t] = -1 === C ? u[0] : u.join(" "), delete c[e + "-top" + t], delete c[e + "-right" + t], delete c[e + "-bottom" + t], delete c[e + "-left" + t]) } }, m = function (e) { var t, n = c[e]; if (n) { for (t = (n = n.split(" ")).length; t--;)if (n[t] !== n[0]) return !1; return c[e] = n[0], !0 } }, p = function (e) { return o = !0, S[e] }, g = function (e, t) { return o && (e = e.replace(/\uFEFF[0-9]/g, function (e) { return S[e] })), t || (e = e.replace(/\\([\'\";:])/g, "$1")), e }, h = function (e) { return String.fromCharCode(parseInt(e.slice(1), 16)) }, v = function (e) { return e.replace(/\\[0-9a-f]+/gi, h) }, y = function (e, t, n, r, o, i) { if (o = o || i) return "'" + (o = g(o)).replace(/\'/g, "\\'") + "'"; if (t = g(t || n || r), !b.allow_script_urls) { var a = t.replace(/[\s\r\n]+/g, ""); if (/(java|vb)script:/i.test(a)) return ""; if (!b.allow_svg_data_urls && /^data:image\/svg/i.test(a)) return "" } return l && (t = l.call(f, t, "style")), "url('" + t.replace(/\'/g, "\\'") + "')" }; if (e) { for (e = (e = e.replace(/[\u0000-\u001F]/g, "")).replace(/\\[\"\';:\uFEFF]/g, p).replace(/\"[^\"]+\"|\'[^\']+\'/g, function (e) { return e.replace(/[;:]/g, p) }); t = N.exec(e);)if (N.lastIndex = t.index + t[0].length, n = t[1].replace(E, "").toLowerCase(), r = t[2].replace(E, ""), n && r) { if (n = v(n), r = v(r), -1 !== n.indexOf(k) || -1 !== n.indexOf('"')) continue; if (!b.allow_script_urls && ("behavior" === n || /expression\s*\(|\/\*|\*\//.test(r))) continue; "font-weight" === n && "700" === r ? r = "bold" : "color" !== n && "background-color" !== n || (r = r.toLowerCase()), r = (r = r.replace(x, ei)).replace(w, y), c[n] = o ? g(r, !0) : r } d("border", "", !0), d("border", "-width"), d("border", "-color"), d("border", "-style"), d("padding", ""), d("margin", ""), i = "border", u = "border-style", s = "border-color", m(a = "border-width") && m(u) && m(s) && (c[i] = c[a] + " " + c[u] + " " + c[s], delete c[a], delete c[u], delete c[s]), "medium none" === c.border && delete c.border, "none" === c["border-image"] && delete c["border-image"] } return c }, serialize: function (i, e) { var t, n, r, o, a, u = "", s = function (e) { var t, n, r, o; if (t = c[e]) for (n = 0, r = t.length; n < r; n++)e = t[n], (o = i[e]) && (u += (0 < u.length ? " " : "") + e + ": " + o + ";") }; if (e && c) s("*"), s(e); else for (t in i) !(n = i[t]) || l && (r = t, o = e, a = void 0, (a = l["*"]) && a[r] || (a = l[o]) && a[r]) || (u += (0 < u.length ? " " : "") + t + ": " + n + ";"); return u } } } var ni, ri = Lt.each, oi = Lt.grep, ii = ge.ie, ai = /^([a-z0-9],?)+$/i, ui = /^[ \t\r\n]*$/, si = function (n, r, o) { var e = {}, i = r.keep_values, t = { set: function (e, t, n) { r.url_converter && (t = r.url_converter.call(r.url_converter_scope || o(), t, n, e[0])), e.attr("data-mce-" + n, t).attr(n, t) }, get: function (e, t) { return e.attr("data-mce-" + t) || e.attr(t) } }; return e = { style: { set: function (e, t) { null === t || "object" != typeof t ? (i && e.attr("data-mce-style", t), e.attr("style", t)) : e.css(t) }, get: function (e) { var t = e.attr("data-mce-style") || e.attr("style"); return t = n.serialize(n.parse(t), e[0].nodeName) } } }, i && (e.href = e.src = t), e }, ci = function (e, t) { var n = t.attr("style"), r = e.serialize(e.parse(n), t[0].nodeName); r || (r = null), t.attr("data-mce-style", r) }, li = function (e, t) { var n, r, o = 0; if (e) for (n = e.nodeType, e = e.previousSibling; e; e = e.previousSibling)r = e.nodeType, (!t || 3 !== r || r !== n && e.nodeValue.length) && (o++ , n = r); return o }; function fi(a, u) { var s, c = this; void 0 === u && (u = {}); var r = {}, i = window, o = {}, t = 0, e = function (m, e) { var p, g = 0, h = {}; p = (e = e || {}).maxLoadTime || 5e3; var v = function (e) { m.getElementsByTagName("head")[0].appendChild(e) }, n = function (e, t, n) { var o, r, i, a, u = function () { for (var e = a.passed, t = e.length; t--;)e[t](); a.status = 2, a.passed = [], a.failed = [] }, s = function () { for (var e = a.failed, t = e.length; t--;)e[t](); a.status = 3, a.passed = [], a.failed = [] }, c = function (e, t) { e() || ((new Date).getTime() - i < p ? Ce.setTimeout(t) : s()) }, l = function () { c(function () { for (var e, t, n = m.styleSheets, r = n.length; r--;)if ((t = (e = n[r]).ownerNode ? e.ownerNode : e.owningElement) && t.id === o.id) return u(), !0 }, l) }, f = function () { c(function () { try { var e = r.sheet.cssRules; return u(), !!e } catch (t) { } }, f) }; if (e = Lt._addCacheSuffix(e), h[e] ? a = h[e] : (a = { passed: [], failed: [] }, h[e] = a), t && a.passed.push(t), n && a.failed.push(n), 1 !== a.status) if (2 !== a.status) if (3 !== a.status) { if (a.status = 1, (o = m.createElement("link")).rel = "stylesheet", o.type = "text/css", o.id = "u" + g++ , o.async = !1, o.defer = !1, i = (new Date).getTime(), "onload" in o && !((d = navigator.userAgent.match(/WebKit\/(\d*)/)) && parseInt(d[1], 10) < 536)) o.onload = l, o.onerror = s; else { if (0 < navigator.userAgent.indexOf("Firefox")) return (r = m.createElement("style")).textContent = '@import "' + e + '"', f(), void v(r); l() } var d; v(o), o.href = e } else s(); else u() }, t = function (t) { return Yr.nu(function (e) { n(t, V.compose(e, V.constant(to.value(t))), V.compose(e, V.constant(to.error(t)))) }) }, o = function (e) { return e.fold(V.identity, V.identity) }; return { load: n, loadAll: function (e, n, r) { Qr.par(H.map(e, t)).get(function (e) { var t = H.partition(e, function (e) { return e.isValue() }); 0 < t.fail.length ? r(t.fail.map(o)) : n(t.pass.map(o)) }) } } }(a), l = [], f = u.schema ? u.schema : Zo({}), d = ti({ url_converter: u.url_converter, url_converter_scope: u.url_converter_scope }, u.schema), m = u.ownEvents ? new Re(u.proxy) : Re.Event, n = f.getBlockElements(), p = en.overrideDefaults(function () { return { context: a, element: q.getRoot() } }), g = function (e) { if (e && a && "string" == typeof e) { var t = a.getElementById(e); return t && t.id !== e ? a.getElementsByName(e)[1] : t } return e }, h = function (e) { return "string" == typeof e && (e = g(e)), p(e) }, v = function (e, t, n) { var r, o, i = h(e); return i.length && (o = (r = s[t]) && r.get ? r.get(i, t) : i.attr(t)), void 0 === o && (o = n || ""), o }, y = function (e) { var t = g(e); return t ? t.attributes : [] }, b = function (e, t, n) { var r, o; "" === n && (n = null); var i = h(e); r = i.attr(t), i.length && ((o = s[t]) && o.set ? o.set(i, n, t) : i.attr(t, n), r !== n && u.onSetAttrib && u.onSetAttrib({ attrElm: i, attrName: t, attrValue: n })) }, C = function () { return u.root_element || a.body }, x = function (e, t) { return jr.getPos(a.body, g(e), t) }, w = function (e, t, n) { var r = h(e); return n ? r.css(t) : ("float" === (t = t.replace(/-(\D)/g, function (e, t) { return t.toUpperCase() })) && (t = ge.ie && ge.ie < 12 ? "styleFloat" : "cssFloat"), r[0] && r[0].style ? r[0].style[t] : undefined) }, N = function (e) { var t, n; return e = g(e), t = w(e, "width"), n = w(e, "height"), -1 === t.indexOf("px") && (t = 0), -1 === n.indexOf("px") && (n = 0), { w: parseInt(t, 10) || e.offsetWidth || e.clientWidth, h: parseInt(n, 10) || e.offsetHeight || e.clientHeight } }, E = function (e, t) { var n; if (!e) return !1; if (!Array.isArray(e)) { if ("*" === t) return 1 === e.nodeType; if (ai.test(t)) { var r = t.toLowerCase().split(/,/), o = e.nodeName.toLowerCase(); for (n = r.length - 1; 0 <= n; n--)if (r[n] === o) return !0; return !1 } if (e.nodeType && 1 !== e.nodeType) return !1 } var i = Array.isArray(e) ? e : [e]; return 0 < dt(t, i[0].ownerDocument || i[0], null, i).length }, S = function (e, t, n, r) { var o, i = [], a = g(e); for (r = r === undefined, n = n || ("BODY" !== C().nodeName ? C().parentNode : null), Lt.is(t, "string") && (t = "*" === (o = t) ? function (e) { return 1 === e.nodeType } : function (e) { return E(e, o) }); a && a !== n && a.nodeType && 9 !== a.nodeType;) { if (!t || "function" == typeof t && t(a)) { if (!r) return [a]; i.push(a) } a = a.parentNode } return r ? i : null }, k = function (e, t, n) { var r = t; if (e) for ("string" == typeof t && (r = function (e) { return E(e, t) }), e = e[n]; e; e = e[n])if ("function" == typeof r && r(e)) return e; return null }, T = function (e, n, r) { var o, t = "string" == typeof e ? g(e) : e; if (!t) return !1; if (Lt.isArray(t) && (t.length || 0 === t.length)) return o = [], ri(t, function (e, t) { e && ("string" == typeof e && (e = g(e)), o.push(n.call(r, e, t))) }), o; var i = r || c; return n.call(i, t) }, A = function (e, t) { h(e).each(function (e, n) { ri(t, function (e, t) { b(n, t, e) }) }) }, R = function (e, r) { var t = h(e); ii ? t.each(function (e, t) { if (!1 !== t.canHaveHTML) { for (; t.firstChild;)t.removeChild(t.firstChild); try { t.innerHTML = "<br>" + r, t.removeChild(t.firstChild) } catch (n) { en("<div></div>").html("<br>" + r).contents().slice(1).appendTo(t) } return r } }) : t.html(r) }, B = function (e, n, r, o, i) { return T(e, function (e) { var t = "string" == typeof n ? a.createElement(n) : n; return A(t, r), o && ("string" != typeof o && o.nodeType ? t.appendChild(o) : "string" == typeof o && R(t, o)), i ? t : e.appendChild(t) }) }, _ = function (e, t, n) { return B(a.createElement(e), e, t, n, !0) }, D = Vo.decode, O = Vo.encodeAllRaw, P = function (e, t) { var n = h(e); return t ? n.each(function () { for (var e; e = this.firstChild;)3 === e.nodeType && 0 === e.data.length ? this.removeChild(e) : this.parentNode.insertBefore(e, this) }).remove() : n.remove(), 1 < n.length ? n.toArray() : n[0] }, L = function (e, t, n) { h(e).toggleClass(t, n).each(function () { "" === this.className && en(this).attr("class", null) }) }, I = function (t, e, n) { return T(e, function (e) { return Lt.is(e, "array") && (t = t.cloneNode(!0)), n && ri(oi(e.childNodes), function (e) { t.appendChild(e) }), e.parentNode.replaceChild(t, e) }) }, M = function () { return a.createRange() }, F = function (e, t, n, r) { if (Lt.isArray(e)) { for (var o = e.length; o--;)e[o] = F(e[o], t, n, r); return e } return !u.collect || e !== a && e !== i || l.push([e, t, n, r]), m.bind(e, t, n, r || q) }, z = function (e, t, n) { var r; if (Lt.isArray(e)) { for (r = e.length; r--;)e[r] = z(e[r], t, n); return e } if (l && (e === a || e === i)) for (r = l.length; r--;) { var o = l[r]; e !== o[0] || t && t !== o[1] || n && n !== o[2] || m.unbind(o[0], o[1], o[2]) } return m.unbind(e, t, n) }, U = function (e) { if (e && Ao.isElement(e)) { var t = e.getAttribute("data-mce-contenteditable"); return t && "inherit" !== t ? t : "inherit" !== e.contentEditable ? e.contentEditable : null } return null }, q = { doc: a, settings: u, win: i, files: o, stdMode: !0, boxModel: !0, styleSheetLoader: e, boundEvents: l, styles: d, schema: f, events: m, isBlock: function (e) { if ("string" == typeof e) return !!n[e]; if (e) { var t = e.nodeType; if (t) return !(1 !== t || !n[e.nodeName]) } return !1 }, $: p, $$: h, root: null, clone: function (t, e) { if (!ii || 1 !== t.nodeType || e) return t.cloneNode(e); if (!e) { var n = a.createElement(t.nodeName); return ri(y(t), function (e) { b(n, e.nodeName, v(t, e.nodeName)) }), n } return null }, getRoot: C, getViewPort: function (e) { var t = e || i, n = t.document, r = n.documentElement; return { x: t.pageXOffset || r.scrollLeft, y: t.pageYOffset || r.scrollTop, w: t.innerWidth || r.clientWidth, h: t.innerHeight || r.clientHeight } }, getRect: function (e) { var t, n; return e = g(e), t = x(e), n = N(e), { x: t.x, y: t.y, w: n.w, h: n.h } }, getSize: N, getParent: function (e, t, n) { var r = S(e, t, n, !1); return r && 0 < r.length ? r[0] : null }, getParents: S, get: g, getNext: function (e, t) { return k(e, t, "nextSibling") }, getPrev: function (e, t) { return k(e, t, "previousSibling") }, select: function (e, t) { return dt(e, g(t) || u.root_element || a, []) }, is: E, add: B, create: _, createHTML: function (e, t, n) { var r, o = ""; for (r in o += "<" + e, t) t.hasOwnProperty(r) && null !== t[r] && "undefined" != typeof t[r] && (o += " " + r + '="' + O(t[r]) + '"'); return void 0 !== n ? o + ">" + n + "</" + e + ">" : o + " />" }, createFragment: function (e) { var t, n = a.createElement("div"), r = a.createDocumentFragment(); for (e && (n.innerHTML = e); t = n.firstChild;)r.appendChild(t); return r }, remove: P, setStyle: function (e, t, n) { var r = h(e).css(t, n); u.update_styles && ci(d, r) }, getStyle: w, setStyles: function (e, t) { var n = h(e).css(t); u.update_styles && ci(d, n) }, removeAllAttribs: function (e) { return T(e, function (e) { var t, n = e.attributes; for (t = n.length - 1; 0 <= t; t--)e.removeAttributeNode(n.item(t)) }) }, setAttrib: b, setAttribs: A, getAttrib: v, getPos: x, parseStyle: function (e) { return d.parse(e) }, serializeStyle: function (e, t) { return d.serialize(e, t) }, addStyle: function (e) { var t, n; if (q !== fi.DOM && a === document) { if (r[e]) return; r[e] = !0 } (n = a.getElementById("mceDefaultStyles")) || ((n = a.createElement("style")).id = "mceDefaultStyles", n.type = "text/css", (t = a.getElementsByTagName("head")[0]).firstChild ? t.insertBefore(n, t.firstChild) : t.appendChild(n)), n.styleSheet ? n.styleSheet.cssText += e : n.appendChild(a.createTextNode(e)) }, loadCSS: function (e) { var n; q === fi.DOM || a !== document ? (e || (e = ""), n = a.getElementsByTagName("head")[0], ri(e.split(","), function (e) { var t; e = Lt._addCacheSuffix(e), o[e] || (o[e] = !0, t = _("link", { rel: "stylesheet", href: e }), n.appendChild(t)) })) : fi.DOM.loadCSS(e) }, addClass: function (e, t) { h(e).addClass(t) }, removeClass: function (e, t) { L(e, t, !1) }, hasClass: function (e, t) { return h(e).hasClass(t) }, toggleClass: L, show: function (e) { h(e).show() }, hide: function (e) { h(e).hide() }, isHidden: function (e) { return "none" === h(e).css("display") }, uniqueId: function (e) { return (e || "mce_") + t++ }, setHTML: R, getOuterHTML: function (e) { var t = "string" == typeof e ? g(e) : e; return Ao.isElement(t) ? t.outerHTML : en("<div></div>").append(en(t).clone()).html() }, setOuterHTML: function (e, t) { h(e).each(function () { try { if ("outerHTML" in this) return void (this.outerHTML = t) } catch (e) { } P(en(this).html(t), !0) }) }, decode: D, encode: O, insertAfter: function (e, t) { var r = g(t); return T(e, function (e) { var t, n; return t = r.parentNode, (n = r.nextSibling) ? t.insertBefore(e, n) : t.appendChild(e), e }) }, replace: I, rename: function (t, e) { var n; return t.nodeName !== e.toUpperCase() && (n = _(e), ri(y(t), function (e) { b(n, e.nodeName, v(t, e.nodeName)) }), I(n, t, !0)), n || t }, findCommonAncestor: function (e, t) { for (var n, r = e; r;) { for (n = t; n && r !== n;)n = n.parentNode; if (r === n) break; r = r.parentNode } return !r && e.ownerDocument ? e.ownerDocument.documentElement : r }, toHex: function (e) { return d.toHex(Lt.trim(e)) }, run: T, getAttribs: y, isEmpty: function (e, t) { var n, r, o, i, a, u, s = 0; if (e = e.firstChild) { a = new no(e, e.parentNode), t = t || (f ? f.getNonEmptyElements() : null), i = f ? f.getWhiteSpaceElements() : {}; do { if (o = e.nodeType, Ao.isElement(e)) { var c = e.getAttribute("data-mce-bogus"); if (c) { e = a.next("all" === c); continue } if (u = e.nodeName.toLowerCase(), t && t[u]) { if ("br" === u) { s++ , e = a.next(); continue } return !1 } for (n = (r = y(e)).length; n--;)if ("name" === (u = r[n].nodeName) || "data-mce-bookmark" === u) return !1 } if (8 === o) return !1; if (3 === o && !ui.test(e.nodeValue)) return !1; if (3 === o && e.parentNode && i[e.parentNode.nodeName] && ui.test(e.nodeValue)) return !1; e = a.next() } while (e) } return s <= 1 }, createRng: M, nodeIndex: li, split: function (e, t, n) { var r, o, i, a = M(); if (e && t) return a.setStart(e.parentNode, li(e)), a.setEnd(t.parentNode, li(t)), r = a.extractContents(), (a = M()).setStart(t.parentNode, li(t) + 1), a.setEnd(e.parentNode, li(e) + 1), o = a.extractContents(), (i = e.parentNode).insertBefore(_o.trimNode(q, r), e), n ? i.insertBefore(n, e) : i.insertBefore(t, e), i.insertBefore(_o.trimNode(q, o), e), P(e), n || t }, bind: F, unbind: z, fire: function (e, t, n) { return m.fire(e, t, n) }, getContentEditable: U, getContentEditableParent: function (e) { for (var t = C(), n = null; e && e !== t && null === (n = U(e)); e = e.parentNode); return n }, destroy: function () { if (l) for (var e = l.length; e--;) { var t = l[e]; m.unbind(t[0], t[1], t[2]) } dt.setDocument && dt.setDocument() }, isChildOf: function (e, t) { for (; e;) { if (t === e) return !0; e = e.parentNode } return !1 }, dumpRng: function (e) { return "startContainer: " + e.startContainer.nodeName + ", startOffset: " + e.startOffset + ", endContainer: " + e.endContainer.nodeName + ", endOffset: " + e.endOffset } }; return s = si(d, u, function () { return q }), q } (ni = fi || (fi = {})).DOM = ni(document), ni.nodeIndex = li; var di = fi, mi = di.DOM, pi = Lt.each, gi = Lt.grep, hi = function (e) { return "function" == typeof e }, vi = function () { var f = {}, o = [], i = {}, a = [], d = 0; this.isDone = function (e) { return 2 === f[e] }, this.markDone = function (e) { f[e] = 2 }, this.add = this.load = function (e, t, n, r) { f[e] === undefined && (o.push(e), f[e] = 0), t && (i[e] || (i[e] = []), i[e].push({ success: t, failure: r, scope: n || this })) }, this.remove = function (e) { delete f[e], delete i[e] }, this.loadQueue = function (e, t, n) { this.loadScripts(o, e, t, n) }, this.loadScripts = function (n, e, t, r) { var s, c = [], l = function (t, e) { pi(i[e], function (e) { hi(e[t]) && e[t].call(e.scope) }), i[e] = undefined }; a.push({ success: e, failure: r, scope: t || this }), (s = function () { var e = gi(n); if (n.length = 0, pi(e, function (e) { var t, n, r, o, i, a, u; 2 !== f[e] ? 3 !== f[e] ? 1 !== f[e] && (f[e] = 1, d++ , t = e, n = function () { f[e] = 2, d-- , l("success", e), s() }, r = function () { f[e] = 3, d-- , c.push(e), l("failure", e), s() }, u = function () { a.remove(i), o && (o.onreadystatechange = o.onload = o = null), n() }, i = (a = mi).uniqueId(), (o = document.createElement("script")).id = i, o.type = "text/javascript", o.src = Lt._addCacheSuffix(t), "onreadystatechange" in o ? o.onreadystatechange = function () { /loaded|complete/.test(o.readyState) && u() } : o.onload = u, o.onerror = function () { hi(r) ? r() : "undefined" != typeof console && console.log && console.log("Failed to load script: " + t) }, (document.getElementsByTagName("head")[0] || document.body).appendChild(o)) : l("failure", e) : l("success", e) }), !d) { var t = a.slice(0); a.length = 0, pi(t, function (e) { 0 === c.length ? hi(e.success) && e.success.call(e.scope) : hi(e.failure) && e.failure.call(e.scope, c) }) } })() } }; vi.ScriptLoader = new vi; var yi, bi = Lt.each; function Ci() { var r = this, o = [], a = {}, u = {}, i = [], s = function (e) { var t; return u[e] && (t = u[e].dependencies), t || [] }, c = function (e, t) { return "object" == typeof t ? t : "string" == typeof e ? { prefix: "", resource: t, suffix: "" } : { prefix: e.prefix, resource: t, suffix: e.suffix } }, l = function (n, e, t) { var r = s(name); bi(r, function (e) { var t = c(n, e); f(t.resource, t, undefined, undefined) }), e && (t ? e.call(t) : e.call(vi)) }, f = function (e, t, n, r, o) { if (!a[e]) { var i = "string" == typeof t ? t : t.prefix + t.resource + t.suffix; 0 !== i.indexOf("/") && -1 === i.indexOf("://") && (i = Ci.baseURL + "/" + i), a[e] = i.substring(0, i.lastIndexOf("/")), u[e] ? l(t, n, r) : vi.ScriptLoader.add(i, function () { return l(t, n, r) }, r, o) } }; return { items: o, urls: a, lookup: u, _listeners: i, get: function (e) { return u[e] ? u[e].instance : undefined }, dependencies: s, requireLangPack: function (e, t) { var n = Ci.language; if (n && !1 !== Ci.languageLoad) { if (t) if (-1 !== (t = "," + t + ",").indexOf("," + n.substr(0, 2) + ",")) n = n.substr(0, 2); else if (-1 === t.indexOf("," + n + ",")) return; vi.ScriptLoader.add(a[e] + "/langs/" + n + ".js") } }, add: function (t, e, n) { o.push(e), u[t] = { instance: e, dependencies: n }; var r = H.partition(i, function (e) { return e.name === t }); return i = r.fail, bi(r.pass, function (e) { e.callback() }), e }, remove: function (e) { delete a[e], delete u[e] }, createUrl: c, addComponents: function (e, t) { var n = r.urls[e]; bi(t, function (e) { vi.ScriptLoader.add(n + "/" + e) }) }, load: f, waitFor: function (e, t) { u.hasOwnProperty(e) ? t() : i.push({ name: e, callback: t }) } } } (yi = Ci || (Ci = {})).PluginManager = yi(), yi.ThemeManager = yi(); var xi, wi = "\ufeff", Ni = function (e) { return e === wi }, Ei = wi, Si = function (e) { return e.replace(new RegExp(wi, "g"), "") }, ki = Ao.isElement, Ti = Ao.isText, Ai = function (e) { return Ti(e) && (e = e.parentNode), ki(e) && e.hasAttribute("data-mce-caret") }, Ri = function (e) { return Ti(e) && Ni(e.data) }, Bi = function (e) { return Ai(e) || Ri(e) }, _i = function (e) { return e.firstChild !== e.lastChild || !Ao.isBr(e.firstChild) }, Di = function (e) { var t = e.container(); return e && Ao.isText(t) && t.data.charAt(e.offset()) === Ei }, Oi = function (e) { var t = e.container(); return e && Ao.isText(t) && t.data.charAt(e.offset() - 1) === Ei }, Pi = function (e, t, n) { var r, o, i; return (r = t.ownerDocument.createElement(e)).setAttribute("data-mce-caret", n ? "before" : "after"), r.setAttribute("data-mce-bogus", "all"), r.appendChild(((i = document.createElement("br")).setAttribute("data-mce-bogus", "1"), i)), o = t.parentNode, n ? o.insertBefore(r, t) : t.nextSibling ? o.insertBefore(r, t.nextSibling) : o.appendChild(r), r }, Li = function (e) { return Ti(e) && e.data[0] === Ei }, Ii = function (e) { return Ti(e) && e.data[e.data.length - 1] === Ei }, Mi = function (e) { return e && e.hasAttribute("data-mce-caret") ? (t = e.getElementsByTagName("br"), n = t[t.length - 1], Ao.isBogus(n) && n.parentNode.removeChild(n), e.removeAttribute("data-mce-caret"), e.removeAttribute("data-mce-bogus"), e.removeAttribute("style"), e.removeAttribute("_moz_abspos"), e) : null; var t, n }, Fi = Ao.isContentEditableTrue, zi = Ao.isContentEditableFalse, Ui = Ao.isBr, qi = Ao.isText, Vi = Ao.matchNodeNames("script style textarea"), Hi = Ao.matchNodeNames("img input textarea hr iframe video audio object"), ji = Ao.matchNodeNames("table"), $i = Bi, Wi = function (e) { return !$i(e) && (qi(e) ? !Vi(e.parentNode) : Hi(e) || Ui(e) || ji(e) || Ki(e)) }, Ki = function (e) { return !1 === (t = e, Ao.isElement(t) && "true" === t.getAttribute("unselectable")) && zi(e); var t }, Xi = function (e, t) { return Wi(e) && function (e, t) { for (e = e.parentNode; e && e !== t; e = e.parentNode) { if (Ki(e)) return !1; if (Fi(e)) return !0 } return !0 }(e, t) }, Yi = Math.round, Gi = function (e) { return e ? { left: Yi(e.left), top: Yi(e.top), bottom: Yi(e.bottom), right: Yi(e.right), width: Yi(e.width), height: Yi(e.height) } : { left: 0, top: 0, bottom: 0, right: 0, width: 0, height: 0 } }, Ji = function (e, t) { return e = Gi(e), t || (e.left = e.left + e.width), e.right = e.left, e.width = 0, e }, Qi = function (e, t, n) { return 0 <= e && e <= Math.min(t.height, n.height) / 2 }, Zi = function (e, t) { return e.bottom - e.height / 2 < t.top || !(e.top > t.bottom) && Qi(t.top - e.bottom, e, t) }, ea = function (e, t) { return e.top > t.bottom || !(e.bottom < t.top) && Qi(t.bottom - e.top, e, t) }, ta = function (e) { var t = e.startContainer, n = e.startOffset; return t.hasChildNodes() && e.endOffset === n + 1 ? t.childNodes[n] : null }, na = function (e, t) { return 1 === e.nodeType && e.hasChildNodes() && (t >= e.childNodes.length && (t = e.childNodes.length - 1), e = e.childNodes[t]), e }, ra = new RegExp("[\u0300-\u036f\u0483-\u0487\u0488-\u0489\u0591-\u05bd\u05bf\u05c1-\u05c2\u05c4-\u05c5\u05c7\u0610-\u061a\u064b-\u065f\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7-\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0859-\u085b\u08e3-\u0902\u093a\u093c\u0941-\u0948\u094d\u0951-\u0957\u0962-\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2-\u09e3\u0a01-\u0a02\u0a3c\u0a41-\u0a42\u0a47-\u0a48\u0a4b-\u0a4d\u0a51\u0a70-\u0a71\u0a75\u0a81-\u0a82\u0abc\u0ac1-\u0ac5\u0ac7-\u0ac8\u0acd\u0ae2-\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62-\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c00\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55-\u0c56\u0c62-\u0c63\u0c81\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc-\u0ccd\u0cd5-\u0cd6\u0ce2-\u0ce3\u0d01\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62-\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb-\u0ebc\u0ec8-\u0ecd\u0f18-\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86-\u0f87\u0f8d-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039-\u103a\u103d-\u103e\u1058-\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085-\u1086\u108d\u109d\u135d-\u135f\u1712-\u1714\u1732-\u1734\u1752-\u1753\u1772-\u1773\u17b4-\u17b5\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927-\u1928\u1932\u1939-\u193b\u1a17-\u1a18\u1a1b\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1ab0-\u1abd\u1abe\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80-\u1b81\u1ba2-\u1ba5\u1ba8-\u1ba9\u1bab-\u1bad\u1be6\u1be8-\u1be9\u1bed\u1bef-\u1bf1\u1c2c-\u1c33\u1c36-\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1cf4\u1cf8-\u1cf9\u1dc0-\u1df5\u1dfc-\u1dff\u200c-\u200d\u20d0-\u20dc\u20dd-\u20e0\u20e1\u20e2-\u20e4\u20e5-\u20f0\u2cef-\u2cf1\u2d7f\u2de0-\u2dff\u302a-\u302d\u302e-\u302f\u3099-\u309a\ua66f\ua670-\ua672\ua674-\ua67d\ua69e-\ua69f\ua6f0-\ua6f1\ua802\ua806\ua80b\ua825-\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\ua9e5\uaa29-\uaa2e\uaa31-\uaa32\uaa35-\uaa36\uaa43\uaa4c\uaa7c\uaab0\uaab2-\uaab4\uaab7-\uaab8\uaabe-\uaabf\uaac1\uaaec-\uaaed\uaaf6\uabe5\uabe8\uabed\ufb1e\ufe00-\ufe0f\ufe20-\ufe2f\uff9e-\uff9f]"), oa = function (e) { return "string" == typeof e && 768 <= e.charCodeAt(0) && ra.test(e) }, ia = [].slice, aa = function (e) { for (var t = [], n = 1; n < arguments.length; n++)t[n - 1] = arguments[n]; var r = ia.call(arguments); return r.length - 1 >= e.length ? e.apply(this, r.slice(1)) : function () { var e = r.concat([].slice.call(arguments)); return aa.apply(this, e) } }, ua = { constant: function (e) { return function () { return e } }, negate: function (t) { return function (e) { return !t(e) } }, and: function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; var n = ia.call(arguments); return function (e) { for (var t = 0; t < n.length; t++)if (!n[t](e)) return !1; return !0 } }, or: function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; var n = ia.call(arguments); return function (e) { for (var t = 0; t < n.length; t++)if (n[t](e)) return !0; return !1 } }, curry: aa, compose: function (t, n) { return function (e) { return t(n(e)) } }, noop: function () { } }, sa = function (e, t) { for (var n = [], r = 0; r < e.length; r++) { var o = e[r]; if (!o.isSome()) return A.none(); n.push(o.getOrDie()) } return A.some(t.apply(null, n)) }, ca = Ao.isElement, la = Wi, fa = Ao.matchStyleValues("display", "block table"), da = Ao.matchStyleValues("float", "left right"), ma = ua.and(ca, la, ua.negate(da)), pa = ua.negate(Ao.matchStyleValues("white-space", "pre pre-line pre-wrap")), ga = Ao.isText, ha = Ao.isBr, va = di.nodeIndex, ya = na, ba = function (e) { return "createRange" in e ? e.createRange() : di.DOM.createRng() }, Ca = function (e) { return e && /[\r\n\t ]/.test(e) }, xa = function (e) { return !!e.setStart && !!e.setEnd }, wa = function (e) { var t, n = e.startContainer, r = e.startOffset; return !!(Ca(e.toString()) && pa(n.parentNode) && Ao.isText(n) && (t = n.data, Ca(t[r - 1]) || Ca(t[r + 1]))) }, Na = function (e) { return 0 === e.left && 0 === e.right && 0 === e.top && 0 === e.bottom }, Ea = function (e) { var t, n, r, o, i, a, u, s; return t = 0 < (n = e.getClientRects()).length ? Gi(n[0]) : Gi(e.getBoundingClientRect()), !xa(e) && ha(e) && Na(t) ? (i = (r = e).ownerDocument, a = ba(i), u = i.createTextNode("\xa0"), (s = r.parentNode).insertBefore(u, r), a.setStart(u, 0), a.setEnd(u, 1), o = Gi(a.getBoundingClientRect()), s.removeChild(u), o) : Na(t) && xa(e) ? function (e) { var t = e.startContainer, n = e.endContainer, r = e.startOffset, o = e.endOffset; if (t === n && Ao.isText(n) && 0 === r && 1 === o) { var i = e.cloneRange(); return i.setEndAfter(n), Ea(i) } return null }(e) : t }, Sa = function (e, t) { var n = Ji(e, t); return n.width = 1, n.right = n.left + 1, n }, ka = function (e) { var t, n, r = [], o = function (e) { var t, n; 0 !== e.height && (0 < r.length && (t = e, n = r[r.length - 1], t.left === n.left && t.top === n.top && t.bottom === n.bottom && t.right === n.right) || r.push(e)) }, i = function (e, t) { var n = ba(e.ownerDocument); if (t < e.data.length) { if (oa(e.data[t])) return r; if (oa(e.data[t - 1]) && (n.setStart(e, t), n.setEnd(e, t + 1), !wa(n))) return o(Sa(Ea(n), !1)), r } 0 < t && (n.setStart(e, t - 1), n.setEnd(e, t), wa(n) || o(Sa(Ea(n), !1))), t < e.data.length && (n.setStart(e, t), n.setEnd(e, t + 1), wa(n) || o(Sa(Ea(n), !0))) }; if (ga(e.container())) return i(e.container(), e.offset()), r; if (ca(e.container())) if (e.isAtEnd()) n = ya(e.container(), e.offset()), ga(n) && i(n, n.data.length), ma(n) && !ha(n) && o(Sa(Ea(n), !1)); else { if (n = ya(e.container(), e.offset()), ga(n) && i(n, 0), ma(n) && e.isAtEnd()) return o(Sa(Ea(n), !1)), r; t = ya(e.container(), e.offset() - 1), ma(t) && !ha(t) && (fa(t) || fa(n) || !ma(n)) && o(Sa(Ea(t), !1)), ma(n) && o(Sa(Ea(n), !0)) } return r }; function Ta(t, n, e) { var r = function () { return e || (e = ka(Ta(t, n))), e }; return { container: ua.constant(t), offset: ua.constant(n), toRange: function () { var e; return (e = ba(t.ownerDocument)).setStart(t, n), e.setEnd(t, n), e }, getClientRects: r, isVisible: function () { return 0 < r().length }, isAtStart: function () { return ga(t), 0 === n }, isAtEnd: function () { return ga(t) ? n >= t.data.length : n >= t.childNodes.length }, isEqual: function (e) { return e && t === e.container() && n === e.offset() }, getNode: function (e) { return ya(t, e ? n - 1 : n) } } } (xi = Ta || (Ta = {})).fromRangeStart = function (e) { return xi(e.startContainer, e.startOffset) }, xi.fromRangeEnd = function (e) { return xi(e.endContainer, e.endOffset) }, xi.after = function (e) { return xi(e.parentNode, va(e) + 1) }, xi.before = function (e) { return xi(e.parentNode, va(e)) }, xi.isAbove = function (e, t) { return sa([H.head(t.getClientRects()), H.last(e.getClientRects())], Zi).getOr(!1) }, xi.isBelow = function (e, t) { return sa([H.last(t.getClientRects()), H.head(e.getClientRects())], ea).getOr(!1) }, xi.isAtStart = function (e) { return !!e && e.isAtStart() }, xi.isAtEnd = function (e) { return !!e && e.isAtEnd() }, xi.isTextPosition = function (e) { return !!e && Ao.isText(e.container()) }, xi.isElementPosition = function (e) { return !1 === xi.isTextPosition(e) }; var Aa, Ra, Ba = Ta, _a = Ao.isElement, Da = Ao.isText, Oa = function (e) { var t = e.parentNode; t && t.removeChild(e) }, Pa = function (e, t) { 0 === t.length ? Oa(e) : e.nodeValue = t }, La = function (e) { var t = Si(e); return { count: e.length - t.length, text: t } }, Ia = function (e, t) { return za(e), t }, Ma = function (e, t) { return Da(e) && t.container() === e ? (r = t, o = La((n = e).data.substr(0, r.offset())), i = La(n.data.substr(r.offset())), 0 < (a = o.text + i.text).length ? (Pa(n, a), Ba(n, r.offset() - o.count)) : r) : Ia(e, t); var n, r, o, i, a }, Fa = function (e, t) { return t.container() === e.parentNode ? (n = e, o = (r = t).container(), i = H.indexOf(H.from(o.childNodes), n).map(function (e) { return e < r.offset() ? Ba(o, r.offset() - 1) : r }).getOr(r), za(n), i) : Ia(e, t); var n, r, o, i }, za = function (e) { if (_a(e) && Bi(e) && (_i(e) ? e.removeAttribute("data-mce-caret") : Oa(e)), Da(e)) { var t = Si(function (e) { try { return e.nodeValue } catch (t) { return "" } }(e)); Pa(e, t) } }, Ua = { removeAndReposition: function (e, t) { return Ba.isTextPosition(t) ? Ma(e, t) : Fa(e, t) }, remove: za }, qa = function (e) { return Ba.isTextPosition(e) ? 0 === e.offset() : Wi(e.getNode()) }, Va = function (e) { if (Ba.isTextPosition(e)) { var t = e.container(); return e.offset() === t.data.length } return Wi(e.getNode(!0)) }, Ha = function (e, t) { return !Ba.isTextPosition(e) && !Ba.isTextPosition(t) && e.getNode() === t.getNode(!0) }, ja = function (e, t, n) { return e ? !Ha(t, n) && (r = t, !(!Ba.isTextPosition(r) && Ao.isBr(r.getNode()))) && Va(t) && qa(n) : !Ha(n, t) && qa(t) && Va(n); var r }, $a = function (e, t, n) { var r = js(t); return A.from(e ? r.next(n) : r.prev(n)) }, Wa = function (e, t) { var n, r, o, i, a, u = e ? t.firstChild : t.lastChild; return Ao.isText(u) ? A.some(Ba(u, e ? 0 : u.data.length)) : u ? Wi(u) ? A.some(e ? Ba.before(u) : (a = u, Ao.isBr(a) ? Ba.before(a) : Ba.after(a))) : (r = t, o = u, i = (n = e) ? Ba.before(o) : Ba.after(o), $a(n, r, i)) : A.none() }, Ka = { fromPosition: $a, nextPosition: V.curry($a, !0), prevPosition: V.curry($a, !1), navigate: function (t, n, r) { return $a(t, n, r).bind(function (e) { return ps(r, e, n) && ja(t, r, e) ? $a(t, n, e) : A.some(e) }) }, positionIn: Wa, firstPositionIn: V.curry(Wa, !0), lastPositionIn: V.curry(Wa, !1) }, Xa = Ao.isContentEditableTrue, Ya = Ao.isContentEditableFalse, Ga = function (e, t, n, r, o) { return t._selectionOverrides.showCaret(e, n, r, o) }, Ja = function (e, t) { var n, r; return e.fire("BeforeObjectSelected", { target: t }).isDefaultPrevented() ? null : ((r = (n = t).ownerDocument.createRange()).selectNode(n), r) }, Qa = function (e, t, n) { var r = Cs(1, e.getBody(), t), o = Ba.fromRangeStart(r), i = o.getNode(); if (Ya(i)) return Ga(1, e, i, !o.isAtEnd(), !1); var a = o.getNode(!0); if (Ya(a)) return Ga(1, e, a, !1, !1); var u = e.dom.getParent(o.getNode(), function (e) { return Ya(e) || Xa(e) }); return Ya(u) ? Ga(1, e, u, !1, n) : null }, Za = function (e, t, n) { if (!t || !t.collapsed) return t; var r = Qa(e, t, n); return r || t }; (Ra = Aa || (Aa = {}))[Ra.Br = 0] = "Br", Ra[Ra.Block = 1] = "Block", Ra[Ra.Wrap = 2] = "Wrap", Ra[Ra.Eol = 3] = "Eol"; var eu, tu, nu = function (e, t) { return e === eu.Backwards ? t.reverse() : t }, ru = function (e, t, n, r) { for (var o, i, a, u, s, c, l = js(n), f = r, d = []; f && (s = l, c = f, o = t === eu.Forwards ? s.next(c) : s.prev(c));) { if (Ao.isBr(o.getNode(!1))) return t === eu.Forwards ? { positions: nu(t, d).concat([o]), breakType: Aa.Br, breakAt: A.some(o) } : { positions: nu(t, d), breakType: Aa.Br, breakAt: A.some(o) }; if (o.isVisible()) { if (e(f, o)) { var m = (i = t, a = f, u = o, Ao.isBr(u.getNode(i === eu.Forwards)) ? Aa.Br : !1 === ps(a, u) ? Aa.Block : Aa.Wrap); return { positions: nu(t, d), breakType: m, breakAt: A.some(o) } } d.push(o), f = o } else f = o } return { positions: nu(t, d), breakType: Aa.Eol, breakAt: A.none() } }, ou = function (n, r, o, e) { return r(o, e).breakAt.map(function (e) { var t = r(o, e).positions; return n === eu.Backwards ? t.concat(e) : [e].concat(t) }).getOr([]) }, iu = function (e, i) { return H.foldl(e, function (e, o) { return e.fold(function () { return A.some(o) }, function (r) { return sa([H.head(r.getClientRects()), H.head(o.getClientRects())], function (e, t) { var n = Math.abs(i - e.left); return Math.abs(i - t.left) <= n ? o : r }).or(e) }) }, A.none()) }, au = function (t, e) { return H.head(e.getClientRects()).bind(function (e) { return iu(t, e.left) }) }, uu = V.curry(ru, Ta.isAbove, -1), su = V.curry(ru, Ta.isBelow, 1), cu = V.curry(ou, -1, uu), lu = V.curry(ou, 1, su), fu = function (e, t) { return Br.all(t, e) }, du = function (e, t, n, r, o) { var i, a, u, s, c, l = fu(qn.fromDom(n), "td,th").map(function (e) { return e.dom() }), f = H.filter((i = e, a = l, H.bind(a, function (e) { var t, n, r = (t = e.getBoundingClientRect(), n = -1, { left: t.left - n, top: t.top - n, right: t.right + 2 * n, bottom: t.bottom + 2 * n, width: t.width + n, height: t.height + n }); return [{ x: r.left, y: i(r), cell: e }, { x: r.right, y: i(r), cell: e }] })), function (e) { return t(e, o) }); return (u = f, s = r, c = o, H.foldl(u, function (e, r) { return e.fold(function () { return A.some(r) }, function (e) { var t = Math.sqrt(Math.abs(e.x - s) + Math.abs(e.y - c)), n = Math.sqrt(Math.abs(r.x - s) + Math.abs(r.y - c)); return A.some(n < t ? r : e) }) }, A.none())).map(function (e) { return e.cell }) }, mu = V.curry(du, function (e) { return e.bottom }, function (e, t) { return e.y < t }), pu = V.curry(du, function (e) { return e.top }, function (e, t) { return e.y > t }), gu = function (t, n) { return H.head(n.getClientRects()).bind(function (e) { return mu(t, e.left, e.top) }).bind(function (e) { return au((t = e, Ka.lastPositionIn(t).map(function (e) { return uu(t, e).positions.concat(e) }).getOr([])), n); var t }) }, hu = function (t, n) { return H.last(n.getClientRects()).bind(function (e) { return pu(t, e.left, e.top) }).bind(function (e) { return au((t = e, Ka.firstPositionIn(t).map(function (e) { return [e].concat(su(t, e).positions) }).getOr([])), n); var t }) }, vu = function (e) { for (var t = 0, n = 0, r = e; r && r.nodeType;)t += r.offsetLeft || 0, n += r.offsetTop || 0, r = r.offsetParent; return { x: t, y: n } }, yu = function (e, t, n) { var r, o, i, a, u, s = e.dom, c = s.getRoot(), l = 0; if (u = { elm: t, alignToTop: n }, e.fire("scrollIntoView", u), !u.isDefaultPrevented() && Ao.isElement(t)) { if (!1 === n && (l = t.offsetHeight), "BODY" !== c.nodeName) { var f = e.selection.getScrollContainer(); if (f) return r = vu(t).y - vu(f).y + l, a = f.clientHeight, void ((r < (i = f.scrollTop) || i + a < r + 25) && (f.scrollTop = r < i ? r : r - a + 25)) } o = s.getViewPort(e.getWin()), r = s.getPos(t).y + l, i = o.y, a = o.h, (r < o.y || i + a < r + 25) && e.getWin().scrollTo(0, r < i ? r : r - a + 25) } }, bu = function (d, e) { H.head(Ta.fromRangeStart(e).getClientRects()).each(function (e) { var t, n, r, o, i, a, u, s, c, l = function (e) { if (e.inline) return e.getBody().getBoundingClientRect(); var t = e.getWin(); return { left: 0, right: t.innerWidth, top: 0, bottom: t.innerHeight, width: t.innerWidth, height: t.innerHeight } }(d), f = { x: (i = t = l, a = n = e, a.left > i.left && a.right < i.right ? 0 : a.left < i.left ? a.left - i.left : a.right - i.right), y: (r = t, o = n, o.top > r.top && o.bottom < r.bottom ? 0 : o.top < r.top ? o.top - r.top : o.bottom - r.bottom) }; s = 0 !== f.x ? 0 < f.x ? f.x + 4 : f.x - 4 : 0, c = 0 !== f.y ? 0 < f.y ? f.y + 4 : f.y - 4 : 0, (u = d).inline ? (u.getBody().scrollLeft += s, u.getBody().scrollTop += c) : u.getWin().scrollBy(s, c) }) }, Cu = function (e, t, n) { var r = e.getParam(t, n); if (-1 !== r.indexOf("=")) { var o = e.getParam(t, "", "hash"); return o.hasOwnProperty(e.id) ? o[e.id] : n } return r }, xu = function (e) { return e.getParam("iframe_attrs", {}) }, wu = function (e) { return e.getParam("doctype", "<!DOCTYPE html>") }, Nu = function (e) { return e.getParam("document_base_url", "") }, Eu = function (e) { return Cu(e, "body_id", "tinymce") }, Su = function (e) { return Cu(e, "body_class", "") }, ku = function (e) { return e.getParam("content_security_policy", "") }, Tu = function (e) { return e.getParam("br_in_pre", !0) }, Au = function (e) { if (e.getParam("force_p_newlines", !1)) return "p"; var t = e.getParam("forced_root_block", "p"); return !1 === t ? "" : t }, Ru = function (e) { return e.getParam("forced_root_block_attrs", {}) }, Bu = function (e) { return e.getParam("br_newline_selector", ".mce-toc h2,figcaption,caption") }, _u = function (e) { return e.getParam("no_newline_selector", "") }, Du = function (e) { return e.getParam("keep_styles", !0) }, Ou = function (e) { return e.getParam("end_container_on_empty_block", !1) }, Pu = function (e) { return Lt.explode(e.getParam("font_size_style_values", "")) }, Lu = function (e) { return Lt.explode(e.getParam("font_size_classes", "")) }, Iu = function (t, n) { qr.parent(t).each(function (e) { e.dom().insertBefore(n.dom(), t.dom()) }) }, Mu = function (e, t) { e.dom().appendChild(t.dom()) }, Fu = { before: Iu, after: function (e, t) { qr.nextSibling(e).fold(function () { qr.parent(e).each(function (e) { Mu(e, t) }) }, function (e) { Iu(e, t) }) }, prepend: function (t, n) { qr.firstChild(t).fold(function () { Mu(t, n) }, function (e) { t.dom().insertBefore(n.dom(), e.dom()) }) }, append: Mu, appendAt: function (e, t, n) { qr.child(e, n).fold(function () { Mu(e, t) }, function (e) { Iu(e, t) }) }, wrap: function (e, t) { Iu(e, t), Mu(t, e) } }, zu = zn.detect().browser, Uu = function () { return zu.isIE() || zu.isEdge() || zu.isFirefox() }, qu = function (e, t) { e.selection.setRng(t), bu(e, t) }, Vu = function (t, n, e) { var r = t(n, e); return r.breakType === Aa.Wrap && 0 === r.positions.length ? r.breakAt.map(function (e) { return t(n, e).breakAt.isNone() }).getOr(!0) : r.breakAt.isNone() }, Hu = ua.curry(Vu, uu), ju = ua.curry(Vu, su), $u = function (e, t, n, r) { var o, i, a, u, s = e.selection.getRng(), c = t ? 1 : -1; if (Uu() && (o = t, i = s, a = n, u = Ba.fromRangeStart(i), Ka.positionIn(!o, a).map(function (e) { return e.isEqual(u) }).getOr(!1))) { var l = Ga(c, e, n, !t, !0); return qu(e, l), !0 } return !1 }, Wu = function (e, t) { var n = t.getNode(e); return Ao.isElement(n) && "TABLE" === n.nodeName ? A.some(n) : A.none() }, Ku = function (u, s, c) { var e = Wu(!!s, c), t = !1 === s; e.fold(function () { return qu(u, c.toRange()) }, function (a) { return Ka.positionIn(t, u.getBody()).filter(function (e) { return e.isEqual(c) }).fold(function () { return qu(u, c.toRange()) }, function (e) { return n = s, o = a, t = c, void ((i = Au(r = u)) ? r.undoManager.transact(function () { var e = qn.fromTag(i); cr.setAll(e, Ru(r)), Fu.append(e, qn.fromTag("br")), n ? Fu.after(qn.fromDom(o), e) : Fu.before(qn.fromDom(o), e); var t = r.dom.createRng(); t.setStart(e.dom(), 0), t.setEnd(e.dom(), 0), qu(r, t) }) : qu(r, t.toRange())); var n, r, o, t, i }) }) }, Xu = function (e, t, n, r) { var o, i, a, u, s, c, l = e.selection.getRng(), f = Ba.fromRangeStart(l), d = e.getBody(); if (!t && Hu(r, f)) { var m = (u = d, gu(s = n, c = f).orThunk(function () { return H.head(c.getClientRects()).bind(function (e) { return iu(cu(u, Ba.before(s)), e.left) }) }).getOr(Ba.before(s))); return Ku(e, t, m), !0 } return !(!t || !ju(r, f)) && (o = d, m = hu(i = n, a = f).orThunk(function () { return H.head(a.getClientRects()).bind(function (e) { return iu(lu(o, Ba.after(i)), e.left) }) }).getOr(Ba.after(i)), Ku(e, t, m), !0) }, Yu = function (t, n) { return function () { return A.from(t.dom.getParent(t.selection.getNode(), "td,th")).bind(function (e) { return A.from(t.dom.getParent(e, "table")).map(function (e) { return $u(t, n, e) }) }).getOr(!1) } }, Gu = function (n, r) { return function () { return A.from(n.dom.getParent(n.selection.getNode(), "td,th")).bind(function (t) { return A.from(n.dom.getParent(t, "table")).map(function (e) { return Xu(n, r, e, t) }) }).getOr(!1) } }, Ju = function (e) { var t = e, n = function () { return t }; return { get: n, set: function (e) { t = e }, clone: function () { return Ju(n()) } } }, Qu = Ao.isContentEditableFalse, Zu = function (e, t, n) { var r, o, i, a, u, s = Ji(t.getBoundingClientRect(), n); return "BODY" === e.tagName ? (r = e.ownerDocument.documentElement, o = e.scrollLeft || r.scrollLeft, i = e.scrollTop || r.scrollTop) : (u = e.getBoundingClientRect(), o = e.scrollLeft - u.left, i = e.scrollTop - u.top), s.left += o, s.right += o, s.top += i, s.bottom += i, s.width = 1, 0 < (a = t.offsetWidth - t.clientWidth) && (n && (a *= -1), s.left += a, s.right += a), s }, es = function (a, u, e) { var t, s, c = Ju(A.none()), l = function () { !function (e) { var t, n, r, o, i; for (t = en("*[contentEditable=false]", e), o = 0; o < t.length; o++)r = (n = t[o]).previousSibling, Ii(r) && (1 === (i = r.data).length ? r.parentNode.removeChild(r) : r.deleteData(i.length - 1, 1)), r = n.nextSibling, Li(r) && (1 === (i = r.data).length ? r.parentNode.removeChild(r) : r.deleteData(0, 1)) }(a), s && (Ua.remove(s), s = null), c.get().each(function (e) { en(e.caret).remove(), c.set(A.none()) }), clearInterval(t) }, f = function () { t = Ce.setInterval(function () { e() ? en("div.mce-visual-caret", a).toggleClass("mce-visual-caret-hidden") : en("div.mce-visual-caret", a).addClass("mce-visual-caret-hidden") }, 500) }; return { show: function (t, e) { var n, r, o; if (l(), o = e, Ao.isElement(o) && /^(TD|TH)$/i.test(o.tagName)) return null; if (!u(e)) return s = function (e, t) { var n, r, o; if (r = e.ownerDocument.createTextNode(Ei), o = e.parentNode, t) { if (n = e.previousSibling, Ti(n)) { if (Bi(n)) return n; if (Ii(n)) return n.splitText(n.data.length - 1) } o.insertBefore(r, e) } else { if (n = e.nextSibling, Ti(n)) { if (Bi(n)) return n; if (Li(n)) return n.splitText(1), n } e.nextSibling ? o.insertBefore(r, e.nextSibling) : o.appendChild(r) } return r }(e, t), r = e.ownerDocument.createRange(), Qu(s.nextSibling) ? (r.setStart(s, 0), r.setEnd(s, 0)) : (r.setStart(s, 1), r.setEnd(s, 1)), r; s = Pi("p", e, t), n = Zu(a, e, t), en(s).css("top", n.top); var i = en('<div class="mce-visual-caret" data-mce-bogus="all"></div>').css(n).appendTo(a)[0]; return c.set(A.some({ caret: i, element: e, before: t })), c.get().each(function (e) { t && en(e.caret).addClass("mce-visual-caret-before") }), f(), (r = e.ownerDocument.createRange()).setStart(s, 0), r.setEnd(s, 0), r }, hide: l, getCss: function () { return ".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}" }, reposition: function () { c.get().each(function (e) { var t = Zu(a, e.element, e.before); en(e.caret).css(t) }) }, destroy: function () { return Ce.clearInterval(t) } } }, ts = function (e) { return Qu(e) || Ao.isTable(e) && Uu() }, ns = Ao.isContentEditableFalse, rs = Ao.matchStyleValues("display", "block table table-cell table-caption list-item"), os = Bi, is = Ai, as = ua.curry, us = Ao.isElement, ss = Wi, cs = function (e) { return 0 < e }, ls = function (e) { return e < 0 }, fs = function (e, t) { for (var n; n = e(t);)if (!is(n)) return n; return null }, ds = function (e, t, n, r, o) { var i = new no(e, r); if (ls(t)) { if ((ns(e) || is(e)) && n(e = fs(i.prev, !0))) return e; for (; e = fs(i.prev, o);)if (n(e)) return e } if (cs(t)) { if ((ns(e) || is(e)) && n(e = fs(i.next, !0))) return e; for (; e = fs(i.next, o);)if (n(e)) return e } return null }, ms = function (e, t) { for (; e && e !== t;) { if (rs(e)) return e; e = e.parentNode } return null }, ps = function (e, t, n) { return ms(e.container(), n) === ms(t.container(), n) }, gs = function (e, t) { var n, r; return t ? (n = t.container(), r = t.offset(), us(n) ? n.childNodes[r + e] : null) : null }, hs = function (e, t) { var n = t.ownerDocument.createRange(); return e ? (n.setStartBefore(t), n.setEndBefore(t)) : (n.setStartAfter(t), n.setEndAfter(t)), n }, vs = function (e, t, n) { var r, o, i, a; for (o = e ? "previousSibling" : "nextSibling"; n && n !== t;) { if (r = n[o], os(r) && (r = r[o]), ns(r)) { if (a = n, ms(r, i = t) === ms(a, i)) return r; break } if (ss(r)) break; n = n.parentNode } return null }, ys = as(hs, !0), bs = as(hs, !1), Cs = function (e, t, n) { var r, o, i, a, u = as(vs, !0, t), s = as(vs, !1, t); if (o = n.startContainer, i = n.startOffset, Ai(o)) { if (us(o) || (o = o.parentNode), "before" === (a = o.getAttribute("data-mce-caret")) && (r = o.nextSibling, ts(r))) return ys(r); if ("after" === a && (r = o.previousSibling, ts(r))) return bs(r) } if (!n.collapsed) return n; if (Ao.isText(o)) { if (os(o)) { if (1 === e) { if (r = s(o)) return ys(r); if (r = u(o)) return bs(r) } if (-1 === e) { if (r = u(o)) return bs(r); if (r = s(o)) return ys(r) } return n } if (Ii(o) && i >= o.data.length - 1) return 1 === e && (r = s(o)) ? ys(r) : n; if (Li(o) && i <= 1) return -1 === e && (r = u(o)) ? bs(r) : n; if (i === o.data.length) return (r = s(o)) ? ys(r) : n; if (0 === i) return (r = u(o)) ? bs(r) : n } return n }, xs = function (e, t) { var n = gs(e, t); return ns(n) && !Ao.isBogusAll(n) }, ws = function (e, t) { return Ao.isTable(gs(e, t)) }, Ns = function (e, t) { return A.from(gs(e ? 0 : -1, t)).filter(ns) }, Es = function (e, t, n) { var r = Cs(e, t, n); return -1 === e ? Ta.fromRangeStart(r) : Ta.fromRangeEnd(r) }, Ss = as(xs, 0), ks = as(xs, -1), Ts = as(ws, 0), As = as(ws, -1); (tu = eu || (eu = {}))[tu.Backwards = -1] = "Backwards", tu[tu.Forwards = 1] = "Forwards"; var Rs, Bs, _s, Ds, Os, Ps = Ao.isContentEditableFalse, Ls = Ao.isText, Is = Ao.isElement, Ms = Ao.isBr, Fs = Wi, zs = function (e) { return Hi(e) || !!Ki(t = e) && !0 !== Bt.reduce(t.getElementsByTagName("*"), function (e, t) { return e || Fi(t) }, !1); var t }, Us = Xi, qs = function (e, t) { return e.hasChildNodes() && t < e.childNodes.length ? e.childNodes[t] : null }, Vs = function (e, t) { if (cs(e)) { if (Fs(t.previousSibling) && !Ls(t.previousSibling)) return Ba.before(t); if (Ls(t)) return Ba(t, 0) } if (ls(e)) { if (Fs(t.nextSibling) && !Ls(t.nextSibling)) return Ba.after(t); if (Ls(t)) return Ba(t, t.data.length) } return ls(e) ? Ms(t) ? Ba.before(t) : Ba.after(t) : Ba.before(t) }, Hs = function (e, t, n) { var r, o, i, a, u; if (!Is(n) || !t) return null; if (t.isEqual(Ba.after(n)) && n.lastChild) { if (u = Ba.after(n.lastChild), ls(e) && Fs(n.lastChild) && Is(n.lastChild)) return Ms(n.lastChild) ? Ba.before(n.lastChild) : u } else u = t; var s, c, l, f = u.container(), d = u.offset(); if (Ls(f)) { if (ls(e) && 0 < d) return Ba(f, --d); if (cs(e) && d < f.length) return Ba(f, ++d); r = f } else { if (ls(e) && 0 < d && (o = qs(f, d - 1), Fs(o))) return !zs(o) && (i = ds(o, e, Us, o)) ? Ls(i) ? Ba(i, i.data.length) : Ba.after(i) : Ls(o) ? Ba(o, o.data.length) : Ba.before(o); if (cs(e) && d < f.childNodes.length && (o = qs(f, d), Fs(o))) return Ms(o) && n.lastChild === o ? null : (s = o, c = n, Ao.isBr(s) && (l = Hs(1, Ba.after(s), c)) && !ps(Ba.before(s), Ba.before(l), c) ? Hs(e, Ba.after(o), n) : !zs(o) && (i = ds(o, e, Us, o)) ? Ls(i) ? Ba(i, 0) : Ba.before(i) : Ls(o) ? Ba(o, 0) : Ba.after(o)); r = o || u.getNode() } return (cs(e) && u.isAtEnd() || ls(e) && u.isAtStart()) && (r = ds(r, e, ua.constant(!0), n, !0), Us(r, n)) ? Vs(e, r) : (o = ds(r, e, Us, n), !(a = Bt.last(Bt.filter(function (e, t) { for (var n = []; e && e !== t;)n.push(e), e = e.parentNode; return n }(f, n), Ps))) || o && a.contains(o) ? o ? Vs(e, o) : null : u = cs(e) ? Ba.after(a) : Ba.before(a)) }, js = function (t) { return { next: function (e) { return Hs(eu.Forwards, e, t) }, prev: function (e) { return Hs(eu.Backwards, e, t) } } }, $s = function (e) { return Lt.grep(e.childNodes, function (e) { return "LI" === e.nodeName }) }, Ws = function (e) { return e && e.firstChild && e.firstChild === e.lastChild && ("\xa0" === (t = e.firstChild).data || Ao.isBr(t)); var t }, Ks = function (e) { return 0 < e.length && (!(t = e[e.length - 1]).firstChild || Ws(t)) ? e.slice(0, -1) : e; var t }, Xs = function (e, t) { var n = e.getParent(t, e.isBlock); return n && "LI" === n.nodeName ? n : null }, Ys = function (e, t) { var n = Ba.after(e), r = js(t).prev(n); return r ? r.toRange() : null }, Gs = function (t, e, n) { var r, o, i, a, u = t.parentNode; return Lt.each(e, function (e) { u.insertBefore(e, t) }), r = t, o = n, i = Ba.before(r), (a = js(o).next(i)) ? a.toRange() : null }, Js = function (e, t) { var n, r, o, i, a, u, s = t.firstChild, c = t.lastChild; return s && "meta" === s.name && (s = s.next), c && "mce_marker" === c.attr("id") && (c = c.prev), r = c, u = (n = e).getNonEmptyElements(), r && (r.isEmpty(u) || (o = r, n.getBlockElements()[o.name] && (a = o).firstChild && a.firstChild === a.lastChild && ("br" === (i = o.firstChild).name || "\xa0" === i.value))) && (c = c.prev), !(!s || s !== c || "ul" !== s.name && "ol" !== s.name) }, Qs = function (e, o, i, t) { var n, r, a, u, s, c, l, f, d, m, p, g, h, v, y, b, C, x, w, N = (n = o, r = t, c = e.serialize(r), l = n.createFragment(c), u = (a = l).firstChild, s = a.lastChild, u && "META" === u.nodeName && u.parentNode.removeChild(u), s && "mce_marker" === s.id && s.parentNode.removeChild(s), a), E = Xs(o, i.startContainer), S = Ks($s(N.firstChild)), k = o.getRoot(), T = function (e) { var t = Ba.fromRangeStart(i), n = js(o.getRoot()), r = 1 === e ? n.prev(t) : n.next(t); return !r || Xs(o, r.getNode()) !== E }; return T(1) ? Gs(E, S, k) : T(2) ? (f = E, d = S, m = k, o.insertAfter(d.reverse(), f), Ys(d[0], m)) : (g = S, h = k, v = p = E, b = (y = i).cloneRange(), C = y.cloneRange(), b.setStartBefore(v), C.setEndAfter(v), x = [b.cloneContents(), C.cloneContents()], (w = p.parentNode).insertBefore(x[0], p), Lt.each(g, function (e) { w.insertBefore(e, p) }), w.insertBefore(x[1], p), w.removeChild(p), Ys(g[g.length - 1], h)) }, Zs = function (e, t) { return !!Xs(e, t) }, ec = Ao.isText, tc = Ao.isBogus, nc = di.nodeIndex, rc = function (e) { var t = e.parentNode; return tc(t) ? rc(t) : t }, oc = function (e) { return e ? Bt.reduce(e.childNodes, function (e, t) { return tc(t) && "BR" !== t.nodeName ? e = e.concat(oc(t)) : e.push(t), e }, []) : [] }, ic = function (t) { return function (e) { return t === e } }, ac = function (e) { var t, r, n, o; return (ec(e) ? "text()" : e.nodeName.toLowerCase()) + "[" + (r = oc(rc(t = e)), n = Bt.findIndex(r, ic(t), t), r = r.slice(0, n + 1), o = Bt.reduce(r, function (e, t, n) { return ec(t) && ec(r[n - 1]) && e++ , e }, 0), r = Bt.filter(r, Ao.matchNodeNames(t.nodeName)), (n = Bt.findIndex(r, ic(t), t)) - o) + "]" }, uc = function (e, t) { var n, r, o, i, a, u = []; return n = t.container(), r = t.offset(), ec(n) ? o = function (e, t) { for (; (e = e.previousSibling) && ec(e);)t += e.data.length; return t }(n, r) : (r >= (i = n.childNodes).length ? (o = "after", r = i.length - 1) : o = "before", n = i[r]), u.push(ac(n)), a = function (e, t, n) { var r = []; for (t = t.parentNode; !(t === e || n && n(t)); t = t.parentNode)r.push(t); return r }(e, n), a = Bt.filter(a, ua.negate(Ao.isBogus)), (u = u.concat(Bt.map(a, function (e) { return ac(e) }))).reverse().join("/") + "," + o }, sc = function (e, t) { var n, r, o; return t ? (t = (n = t.split(","))[0].split("/"), o = 1 < n.length ? n[1] : "before", (r = Bt.reduce(t, function (e, t) { return (t = /([\w\-\(\)]+)\[([0-9]+)\]/.exec(t)) ? ("text()" === t[1] && (t[1] = "#text"), n = e, r = t[1], o = parseInt(t[2], 10), i = oc(n), i = Bt.filter(i, function (e, t) { return !ec(e) || !ec(i[t - 1]) }), (i = Bt.filter(i, Ao.matchNodeNames(r)))[o]) : null; var n, r, o, i }, e)) ? ec(r) ? function (e, t) { for (var n, r = e, o = 0; ec(r);) { if (n = r.data.length, o <= t && t <= o + n) { e = r, t -= o; break } if (!ec(r.nextSibling)) { e = r, t = n; break } o += n, r = r.nextSibling } return ec(e) && t > e.data.length && (t = e.data.length), Ba(e, t) }(r, parseInt(o, 10)) : (o = "after" === o ? nc(r) + 1 : nc(r), Ba(r.parentNode, o)) : null) : null }, cc = Ao.isContentEditableFalse, lc = function (e, t, n, r, o) { var i, a = r[o ? "startContainer" : "endContainer"], u = r[o ? "startOffset" : "endOffset"], s = [], c = 0, l = e.getRoot(); for (Ao.isText(a) ? s.push(n ? function (e, t, n) { var r, o; for (o = e(t.data.slice(0, n)).length, r = t.previousSibling; r && Ao.isText(r); r = r.previousSibling)o += e(r.data).length; return o }(t, a, u) : u) : (u >= (i = a.childNodes).length && i.length && (c = 1, u = Math.max(0, i.length - 1)), s.push(e.nodeIndex(i[u], n) + c)); a && a !== l; a = a.parentNode)s.push(e.nodeIndex(a, n)); return s }, fc = function (e) { Ao.isText(e) && 0 === e.data.length && e.parentNode.removeChild(e) }, dc = function (e, t, n) { var r = 0; return Lt.each(e.select(t), function (e) { if ("all" !== e.getAttribute("data-mce-bogus")) return e !== n && void r++ }), r }, mc = function (e, t) { var n, r, o, i = t ? "start" : "end"; n = e[i + "Container"], r = e[i + "Offset"], Ao.isElement(n) && "TR" === n.nodeName && (n = (o = n.childNodes)[Math.min(t ? r : r - 1, o.length - 1)]) && (r = t ? 0 : n.childNodes.length, e["set" + (t ? "Start" : "End")](n, r)) }, pc = function (e) { return mc(e, !0), mc(e, !1), e }, gc = function (e, t) { var n; if (Ao.isElement(e) && (e = na(e, t), cc(e))) return e; if (Bi(e)) { if (Ao.isText(e) && Ai(e) && (e = e.parentNode), n = e.previousSibling, cc(n)) return n; if (n = e.nextSibling, cc(n)) return n } }, hc = function (e, t, n) { var r = n.getNode(), o = r ? r.nodeName : null, i = n.getRng(); if (cc(r) || "IMG" === o) return { name: o, index: dc(n.dom, o, r) }; var a, u, s, c, l, f, d, m = gc((a = i).startContainer, a.startOffset) || gc(a.endContainer, a.endOffset); return m ? { name: o = m.tagName, index: dc(n.dom, o, m) } : (u = e, c = t, l = i, f = (s = n).dom, (d = {}).start = lc(f, u, c, l, !0), s.isCollapsed() || (d.end = lc(f, u, c, l, !1)), d) }, vc = function (e, t, n) { var r = { "data-mce-type": "bookmark", id: t, style: "overflow:hidden;line-height:0px" }; return n ? e.create("span", r, "&#xFEFF;") : e.create("span", r) }, yc = function (e, t) { var n = e.dom, r = e.getRng(), o = n.uniqueId(), i = e.isCollapsed(), a = e.getNode(), u = a.nodeName; if ("IMG" === u) return { name: u, index: dc(n, u, a) }; var s = pc(r.cloneRange()); if (!i) { s.collapse(!1); var c = vc(n, o + "_end", t); s.insertNode(c), fc(c.nextSibling) } (r = pc(r)).collapse(!0); var l = vc(n, o + "_start", t); return r.insertNode(l), fc(l.previousSibling), e.moveToBookmark({ id: o, keep: 1 }), { id: o } }, bc = { getBookmark: function (e, t, n) { return 2 === t ? hc(Si, n, e) : 3 === t ? (o = (r = e).getRng(), { start: uc(r.dom.getRoot(), Ba.fromRangeStart(o)), end: uc(r.dom.getRoot(), Ba.fromRangeEnd(o)) }): t?{ rng: e.getRng() } : yc(e, !1); var r, o }, getUndoBookmark: V.curry(hc, V.identity, !0), getPersistentBookmark: yc }, Cc = "_mce_caret", xc = function (e) { return Ao.isElement(e) && e.id === Cc }, wc = function (e, t) { for (; t && t !== e;) { if (t.id === Cc) return t; t = t.parentNode } return null }, Nc = function (e, t) { return !e.isBlock(t) || t.innerHTML || ge.ie || (t.innerHTML = '<br data-mce-bogus="1" />'), t }, Ec = function (e, t) { return Ka.lastPositionIn(e).fold(function () { return !1 }, function (e) { return t.setStart(e.container(), e.offset()), t.setEnd(e.container(), e.offset()), !0 }) }, Sc = function (e, t, n) { return !(!1 !== t.hasChildNodes() || !wc(e, t) || (o = n, i = (r = t).ownerDocument.createTextNode(Ei), r.appendChild(i), o.setStart(i, 0), o.setEnd(i, 0), 0)); var r, o, i }, kc = function (e, t, n, r) { var o, i, a, u, s = n[t ? "start" : "end"], c = e.getRoot(); if (s) { for (a = s[0], i = c, o = s.length - 1; 1 <= o; o--) { if (u = i.childNodes, Sc(c, i, r)) return !0; if (s[o] > u.length - 1) return !!Sc(c, i, r) || Ec(i, r); i = u[s[o]] } 3 === i.nodeType && (a = Math.min(s[0], i.nodeValue.length)), 1 === i.nodeType && (a = Math.min(s[0], i.childNodes.length)), t ? r.setStart(i, a) : r.setEnd(i, a) } return !0 }, Tc = function (e) { return Ao.isText(e) && 0 < e.data.length }, Ac = function (e, t, n) { var r, o, i, a, u, s, c = e.get(n.id + "_" + t), l = n.keep; if (c) { if (r = c.parentNode, "start" === t ? l ? c.hasChildNodes() ? (r = c.firstChild, o = 1) : Tc(c.nextSibling) ? (r = c.nextSibling, o = 0) : Tc(c.previousSibling) ? (r = c.previousSibling, o = c.previousSibling.data.length) : (r = c.parentNode, o = e.nodeIndex(c) + 1) : o = e.nodeIndex(c) : l ? c.hasChildNodes() ? (r = c.firstChild, o = 1) : Tc(c.previousSibling) ? (r = c.previousSibling, o = c.previousSibling.data.length) : (r = c.parentNode, o = e.nodeIndex(c)) : o = e.nodeIndex(c), u = r, s = o, !l) { for (a = c.previousSibling, i = c.nextSibling, Lt.each(Lt.grep(c.childNodes), function (e) { Ao.isText(e) && (e.nodeValue = e.nodeValue.replace(/\uFEFF/g, "")) }); c = e.get(n.id + "_" + t);)e.remove(c, !0); a && i && a.nodeType === i.nodeType && Ao.isText(a) && !ge.opera && (o = a.nodeValue.length, a.appendData(i.nodeValue), e.remove(i), u = a, s = o) } return A.some(Ba(u, s)) } return A.none() }, Rc = function (e, t) { var n, r, o, i, a, u, s, c, l, f, d, m, p, g, h, v, y = e.dom; if (t) { if (v = t, Lt.isArray(v.start)) return g = t, h = (p = y).createRng(), kc(p, !0, g, h) && kc(p, !1, g, h) ? A.some(h) : A.none(); if ("string" == typeof t.start) return A.some((f = t, d = (l = y).createRng(), m = sc(l.getRoot(), f.start), d.setStart(m.container(), m.offset()), m = sc(l.getRoot(), f.end), d.setEnd(m.container(), m.offset()), d)); if (t.hasOwnProperty("id")) return s = Ac(o = y, "start", i = t), c = Ac(o, "end", i), sa([s, (a = c, u = s, a.isSome() ? a : u)], function (e, t) { var n = o.createRng(); return n.setStart(Nc(o, e.container()), e.offset()), n.setEnd(Nc(o, t.container()), t.offset()), n }); if (t.hasOwnProperty("name")) return n = y, r = t, A.from(n.select(r.name)[r.index]).map(function (e) { var t = n.createRng(); return t.selectNode(e), t }); if (t.hasOwnProperty("rng")) return A.some(t.rng) } return A.none() }, Bc = { getBookmark: function (e, t, n) { return bc.getBookmark(e, t, n) }, moveToBookmark: function (t, e) { Rc(t, e).each(function (e) { t.setRng(e) }) }, isBookmarkNode: function (e) { return Ao.isElement(e) && "SPAN" === e.tagName && "bookmark" === e.getAttribute("data-mce-type") } }, _c = Lt.each, Dc = function (o) { this.compare = function (e, t) { if (e.nodeName !== t.nodeName) return !1; var n = function (n) { var r = {}; return _c(o.getAttribs(n), function (e) { var t = e.nodeName.toLowerCase(); 0 !== t.indexOf("_") && "style" !== t && 0 !== t.indexOf("data-") && (r[t] = o.getAttrib(n, t)) }), r }, r = function (e, t) { var n, r; for (r in e) if (e.hasOwnProperty(r)) { if (void 0 === (n = t[r])) return !1; if (e[r] !== n) return !1; delete t[r] } for (r in t) if (t.hasOwnProperty(r)) return !1; return !0 }; return !(!r(n(e), n(t)) || !r(o.parseStyle(o.getAttrib(e, "style")), o.parseStyle(o.getAttrib(t, "style"))) || Bc.isBookmarkNode(e) || Bc.isBookmarkNode(t)) } }, Oc = function (t, e) { H.each(e, function (e) { Fu.before(t, e) }) }, Pc = function (t, e) { H.each(e, function (e) { Fu.append(t, e) }) }, Lc = function (e) { var t = e.dom(); null !== t.parentNode && t.parentNode.removeChild(t) }, Ic = { empty: function (e) { e.dom().textContent = "", H.each(qr.children(e), function (e) { Lc(e) }) }, remove: Lc, unwrap: function (e) { var t = qr.children(e); 0 < t.length && Oc(e, t), Lc(e) } }, Mc = (Rs = Qn.isText, Bs = "text", _s = function (e) { return Rs(e) ? A.from(e.dom().nodeValue) : A.none() }, Ds = zn.detect().browser, { get: function (e) { if (!Rs(e)) throw new Error("Can only get " + Bs + " value of a " + Bs + " node"); return Os(e).getOr("") }, getOption: Os = Ds.isIE() && 10 === Ds.version.major ? function (e) { try { return _s(e) } catch (Zx) { return A.none() } } : _s, set: function (e, t) { if (!Rs(e)) throw new Error("Can only set raw " + Bs + " value of a " + Bs + " node"); e.dom().nodeValue = t } }), Fc = function (e) { return Mc.get(e) }, zc = function (e) { var t = fu(e, "br"), n = H.filter(function (e) { for (var t = [], n = e.dom(); n;)t.push(qn.fromDom(n)), n = n.lastChild; return t }(e).slice(-1), lo); t.length === n.length && H.each(n, Ic.remove) }, Uc = function (e) { Ic.empty(e), Fu.append(e, qn.fromHtml('<br data-mce-bogus="1">')) }, qc = function (n) { qr.lastChild(n).each(function (t) { qr.prevSibling(t).each(function (e) { so(n) && lo(t) && so(e) && Ic.remove(t) }) }) }, Vc = Lt.makeMap; function Hc(e) { var u, s, c, l, f, d = []; return u = (e = e || {}).indent, s = Vc(e.indent_before || ""), c = Vc(e.indent_after || ""), l = Vo.getEncodeFunc(e.entity_encoding || "raw", e.entities), f = "html" === e.element_format, { start: function (e, t, n) { var r, o, i, a; if (u && s[e] && 0 < d.length && 0 < (a = d[d.length - 1]).length && "\n" !== a && d.push("\n"), d.push("<", e), t) for (r = 0, o = t.length; r < o; r++)i = t[r], d.push(" ", i.name, '="', l(i.value, !0), '"'); d[d.length] = !n || f ? ">" : " />", n && u && c[e] && 0 < d.length && 0 < (a = d[d.length - 1]).length && "\n" !== a && d.push("\n") }, end: function (e) { var t; d.push("</", e, ">"), u && c[e] && 0 < d.length && 0 < (t = d[d.length - 1]).length && "\n" !== t && d.push("\n") }, text: function (e, t) { 0 < e.length && (d[d.length] = t ? e : l(e)) }, cdata: function (e) { d.push("<![CDATA[", e, "]]>") }, comment: function (e) { d.push("\x3c!--", e, "--\x3e") }, pi: function (e, t) { t ? d.push("<?", e, " ", l(t), "?>") : d.push("<?", e, "?>"), u && d.push("\n") }, doctype: function (e) { d.push("<!DOCTYPE", e, ">", u ? "\n" : "") }, reset: function () { d.length = 0 }, getContent: function () { return d.join("").replace(/\n$/, "") } } } function jc(t, p) { void 0 === p && (p = Zo()); var g = Hc(t); return (t = t || {}).validate = !("validate" in t) || t.validate, { serialize: function (e) { var f, d; d = t.validate, f = { 3: function (e) { g.text(e.value, e.raw) }, 8: function (e) { g.comment(e.value) }, 7: function (e) { g.pi(e.name, e.value) }, 10: function (e) { g.doctype(e.value) }, 4: function (e) { g.cdata(e.value) }, 11: function (e) { if (e = e.firstChild) for (; m(e), e = e.next;); } }, g.reset(); var m = function (e) { var t, n, r, o, i, a, u, s, c, l = f[e.type]; if (l) l(e); else { if (t = e.name, n = e.shortEnded, r = e.attributes, d && r && 1 < r.length && ((a = []).map = {}, c = p.getElementRule(e.name))) { for (u = 0, s = c.attributesOrder.length; u < s; u++)(o = c.attributesOrder[u]) in r.map && (i = r.map[o], a.map[o] = i, a.push({ name: o, value: i })); for (u = 0, s = r.length; u < s; u++)(o = r[u].name) in a.map || (i = r.map[o], a.map[o] = i, a.push({ name: o, value: i })); r = a } if (g.start(e.name, r, n), !n) { if (e = e.firstChild) for (; m(e), e = e.next;); g.end(t) } } }; return 1 !== e.type || t.inner ? f[11](e) : m(e), g.getContent() } } } var $c = function (a) { var u = Ba.fromRangeStart(a), s = Ba.fromRangeEnd(a), c = a.commonAncestorContainer; return Ka.fromPosition(!1, c, s).map(function (e) { return !ps(u, s, c) && ps(u, e, c) ? (t = u.container(), n = u.offset(), r = e.container(), o = e.offset(), (i = document.createRange()).setStart(t, n), i.setEnd(r, o), i) : a; var t, n, r, o, i }).getOr(a) }, Wc = function (e) { return e.collapsed ? e : $c(e) }, Kc = Ao.matchNodeNames("td th"), Xc = function (o, e, t) { var n, r, i, a, u, s, c, l, f, d, m, p, g = o.schema.getTextInlineElements(), h = o.selection, v = o.dom; if (/^ | $/.test(e) && (e = function (e) { var t, n, r; t = h.getRng(), n = t.startContainer, r = t.startOffset; var o = function (e) { return n[e] && 3 === n[e].nodeType }; return 3 === n.nodeType && (0 < r ? e = e.replace(/^&nbsp;/, " ") : o("previousSibling") || (e = e.replace(/^ /, "&nbsp;")), r < n.length ? e = e.replace(/&nbsp;(<br>|)$/, " ") : o("nextSibling") || (e = e.replace(/(&nbsp;| )(<br>|)$/, "&nbsp;"))), e }(e)), n = o.parser, p = t.merge, r = jc({ validate: o.settings.validate }, o.schema), m = '<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;&#x200B;</span>', s = { content: e, format: "html", selection: !0, paste: t.paste }, (s = o.fire("BeforeSetContent", s)).isDefaultPrevented()) o.fire("SetContent", { content: s.content, format: "html", selection: !0, paste: t.paste }); else { -1 === (e = s.content).indexOf("{$caret}") && (e += "{$caret}"), e = e.replace(/\{\$caret\}/, m); var y, b, C, x, w = (l = h.getRng()).startContainer || (l.parentElement ? l.parentElement() : null), N = o.getBody(); w === N && h.isCollapsed() && v.isBlock(N.firstChild) && (y = N.firstChild) && !o.schema.getShortEndedElements()[y.nodeName] && v.isEmpty(N.firstChild) && ((l = v.createRng()).setStart(N.firstChild, 0), l.setEnd(N.firstChild, 0), h.setRng(l)), h.isCollapsed() || (o.selection.setRng(Wc(o.selection.getRng())), o.getDoc().execCommand("Delete", !1, null), C = (b = h.getRng()).startContainer, x = b.startOffset, 3 === C.nodeType && b.collapsed && ("\xa0" === C.data[x] ? (C.deleteData(x, 1), /[\u00a0| ]$/.test(e) || (e += " ")) : "\xa0" === C.data[x - 1] && (C.deleteData(x - 1, 1), /[\u00a0| ]$/.test(e) || (e = " " + e)))); var E, S, k, T = { context: (i = h.getNode()).nodeName.toLowerCase(), data: t.data, insert: !0 }; if (u = n.parse(e, T), !0 === t.paste && Js(o.schema, u) && Zs(v, i)) return l = Qs(r, v, o.selection.getRng(), u), o.selection.setRng(l), void o.fire("SetContent", s); if (function (e) { for (var t = e; t = t.walk();)1 === t.type && t.attr("data-mce-fragment", "1") }(u), "mce_marker" === (f = u.lastChild).attr("id")) for (f = (c = f).prev; f; f = f.walk(!0))if (3 === f.type || !v.isBlock(f.name)) { o.schema.isValidChild(f.parent.name, "span") && f.parent.insert(c, f, "br" === f.name); break } if (o._selectionOverrides.showBlockCaretContainer(i), T.invalid) { for (h.setContent(m), i = h.getNode(), a = o.getBody(), 9 === i.nodeType ? i = f = a : f = i; f !== a;)f = (i = f).parentNode; e = i === a ? a.innerHTML : v.getOuterHTML(i), e = r.serialize(n.parse(e.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i, function () { return r.serialize(u) }))), i === a ? v.setHTML(a, e) : v.setOuterHTML(i, e) } else e = r.serialize(u), function (e, t, n) { if ("all" === n.getAttribute("data-mce-bogus")) n.parentNode.insertBefore(e.dom.createFragment(t), n); else { var r = n.firstChild, o = n.lastChild; !r || r === o && "BR" === r.nodeName ? e.dom.setHTML(n, t) : e.selection.setContent(t) } }(o, e, i); !function () { if (p) { var n = o.getBody(), r = new Dc(v); Lt.each(v.select("*[data-mce-fragment]"), function (e) { for (var t = e.parentNode; t && t !== n; t = t.parentNode)g[e.nodeName.toLowerCase()] && r.compare(t, e) && v.remove(e, !0) }) } }(), function (e) { var t, n, r; if (e) { if (h.scrollIntoView(e), t = function (e) { for (var t = o.getBody(); e && e !== t; e = e.parentNode)if ("false" === o.dom.getContentEditable(e)) return e; return null }(e)) return v.remove(e), h.select(t); l = v.createRng(), (f = e.previousSibling) && 3 === f.nodeType ? (l.setStart(f, f.nodeValue.length), ge.ie || (d = e.nextSibling) && 3 === d.nodeType && (f.appendData(d.data), d.parentNode.removeChild(d))) : (l.setStartBefore(e), l.setEndBefore(e)), n = v.getParent(e, v.isBlock), v.remove(e), n && v.isEmpty(n) && (o.$(n).empty(), l.setStart(n, 0), l.setEnd(n, 0), Kc(n) || n.getAttribute("data-mce-fragment") || !(r = function (e) { var t = Ba.fromRangeStart(e); if (t = js(o.getBody()).next(t)) return t.toRange() }(l)) ? v.add(n, v.create("br", { "data-mce-bogus": "1" })) : (l = r, v.remove(n))), h.setRng(l) } }(v.get("mce_marker")), E = o.getBody(), Lt.each(E.getElementsByTagName("*"), function (e) { e.removeAttribute("data-mce-fragment") }), S = o.dom, k = o.selection.getStart(), A.from(S.getParent(k, "td,th")).map(qn.fromDom).each(qc), o.fire("SetContent", s), o.addVisual() } }, Yc = { insertAtCaret: function (e, t) { var n, r, o = "string" != typeof (n = t) ? (r = Lt.extend({ paste: n.paste, data: { paste: n.paste } }, n), { content: n.content, details: r }) : { content: n, details: {} }; Xc(e, o.content, o.details) } }; function Gc(e, t, n, r, o) { return e(n, r) ? A.some(n) : E.isFunction(o) && o(n) ? A.none() : t(n, r, o) } var Jc = function (e, t, n) { for (var r = e.dom(), o = E.isFunction(n) ? n : V.constant(!1); r.parentNode;) { r = r.parentNode; var i = qn.fromDom(r); if (t(i)) return A.some(i); if (o(i)) break } return A.none() }, Qc = function (e, t) { return H.find(e.dom().childNodes, V.compose(t, qn.fromDom)).map(qn.fromDom) }, Zc = function (e, r) { var o = function (e) { for (var t = 0; t < e.childNodes.length; t++) { if (r(qn.fromDom(e.childNodes[t]))) return A.some(qn.fromDom(e.childNodes[t])); var n = o(e.childNodes[t]); if (n.isSome()) return n } return A.none() }; return o(e.dom()) }, el = { first: function (e) { return Zc(dr.body(), e) }, ancestor: Jc, closest: function (e, t, n) { return Gc(function (e) { return t(e) }, Jc, e, t, n) }, sibling: function (t, n) { var e = t.dom(); return e.parentNode ? Qc(qn.fromDom(e.parentNode), function (e) { return !Or.eq(t, e) && n(e) }) : A.none() }, child: Qc, descendant: Zc }, tl = wr.immutable("sections", "settings"), nl = zn.detect().deviceType.isTouch(), rl = ["lists", "autolink", "autosave"], ol = { theme: "mobile" }, il = function (e) { var t = E.isArray(e) ? e.join(" ") : e, n = H.map(E.isString(t) ? t.split(" ") : [], Dn); return H.filter(n, function (e) { return 0 < e.length }) }, al = function (e, t) { return e.sections().hasOwnProperty(t) }, ul = function (e, t, n, r) { var o, i, a = il(n.forced_plugins), u = il(r.plugins), s = e && al(t, "mobile") ? (o = u, H.filter(o, V.curry(H.contains, rl))) : u, c = (i = s, [].concat(il(a)).concat(il(i))); return Lt.extend(r, { plugins: c.join(" ") }) }, sl = function (e, t, n, r) { var o, i, a, u, s, c, l, f, d, m, p, g, h, v = (o = ["mobile"], i = r, a = or.bifilter(i, function (e, t) { return H.contains(o, t) }), tl(a.t, a.f)), y = Lt.extend(t, n, v.settings(), (p = e, h = (g = v).settings().inline, p && al(g, "mobile") && !h ? (l = "mobile", f = ol, d = v.sections(), m = d.hasOwnProperty(l) ? d[l] : {}, Lt.extend({}, f, m)) : {}), { validate: !0, content_editable: v.settings().inline, external_plugins: (u = n, s = v.settings(), c = s.external_plugins ? s.external_plugins : {}, u && u.external_plugins ? Lt.extend({}, u.external_plugins, c) : c) }); return ul(e, v, n, y) }, cl = function (e, t, n) { return A.from(t.settings[n]).filter(e) }, ll = V.curry(cl, E.isString), fl = function (e, t, n, r) { var o, i, a, u = t in e.settings ? e.settings[t] : n; return "hash" === r ? (a = {}, "string" == typeof (i = u) ? H.each(0 < i.indexOf("=") ? i.split(/[;,](?![^=;,]*(?:[;,]|$))/) : i.split(","), function (e) { var t = e.split("="); 1 < t.length ? a[Lt.trim(t[0])] = Lt.trim(t[1]) : a[Lt.trim(t[0])] = Lt.trim(t) }) : a = i, a) : "string" === r ? cl(E.isString, e, t).getOr(n) : "number" === r ? cl(E.isNumber, e, t).getOr(n) : "boolean" === r ? cl(E.isBoolean, e, t).getOr(n) : "object" === r ? cl(E.isObject, e, t).getOr(n) : "array" === r ? cl(E.isArray, e, t).getOr(n) : "string[]" === r ? cl((o = E.isString, function (e) { return E.isArray(e) && H.forall(e, o) }), e, t).getOr(n) : "function" === r ? cl(E.isFunction, e, t).getOr(n) : u }, dl = /[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/, ml = function (e, t) { var n = t.container(), r = t.offset(); return e ? Ri(n) ? Ao.isText(n.nextSibling) ? Ba(n.nextSibling, 0) : Ba.after(n) : Di(t) ? Ba(n, r + 1) : t : Ri(n) ? Ao.isText(n.previousSibling) ? Ba(n.previousSibling, n.previousSibling.data.length) : Ba.before(n) : Oi(t) ? Ba(n, r - 1) : t }, pl = { isInlineTarget: function (e, t) { var n = ll(e, "inline_boundaries_selector").getOr("a[href],code"); return Br.is(qn.fromDom(t), n) }, findRootInline: function (e, t, n) { var r, o, i, a = (r = e, o = t, i = n, H.filter(di.DOM.getParents(i.container(), "*", o), r)); return A.from(a[a.length - 1]) }, isRtl: function (e) { return "rtl" === di.DOM.getStyle(e, "direction", !0) || (t = e.textContent, dl.test(t)); var t }, isAtZwsp: function (e) { return Di(e) || Oi(e) }, normalizePosition: ml, normalizeForwards: V.curry(ml, !0), normalizeBackwards: V.curry(ml, !1), hasSameParentBlock: function (e, t, n) { var r = ms(t, e), o = ms(n, e); return r && r === o } }, gl = function (e, t) { return Or.contains(e, t) ? el.closest(t, function (e) { return fo(e) || po(e) }, (n = e, function (e) { return Or.eq(n, qn.fromDom(e.dom().parentNode)) })) : A.none(); var n }, hl = function (e) { var t, n, r; e.dom.isEmpty(e.getBody()) && (e.setContent(""), n = (t = e).getBody(), r = n.firstChild && t.dom.isBlock(n.firstChild) ? n.firstChild : n, t.selection.setCursorLocation(r, 0)) }, vl = function (i, a, u) { return sa([Ka.firstPositionIn(u), Ka.lastPositionIn(u)], function (e, t) { var n = pl.normalizePosition(!0, e), r = pl.normalizePosition(!1, t), o = pl.normalizePosition(!1, a); return i ? Ka.nextPosition(u, o).map(function (e) { return e.isEqual(r) && a.isEqual(n) }).getOr(!1) : Ka.prevPosition(u, o).map(function (e) { return e.isEqual(n) && a.isEqual(r) }).getOr(!1) }).getOr(!0) }, yl = function (e, t, n) { return el.ancestor(e, function (e) { return Br.is(e, t) }, n) }, bl = yl, Cl = function (e, t) { return Br.one(t, e) }, xl = function (e, t, n) { return Gc(Br.is, yl, e, t, n) }, wl = function (e, t, n) { return bl(e, t, n).isSome() }, Nl = function (e, t) { return Ao.isText(t) && /^[ \t\r\n]*$/.test(t.data) && !1 === (n = e, r = t, o = qn.fromDom(n), i = qn.fromDom(r), wl(i, "pre,code", V.curry(Or.eq, o))); var n, r, o, i }, El = function (e, t) { return Wi(t) && !1 === Nl(e, t) || (n = t, Ao.isElement(n) && "A" === n.nodeName && n.hasAttribute("name")) || Sl(t); var n }, Sl = Ao.hasAttribute("data-mce-bookmark"), kl = Ao.hasAttribute("data-mce-bogus"), Tl = Ao.hasAttributeValue("data-mce-bogus", "all"), Al = function (e) { return function (e) { var t, n, r = 0; if (El(e, e)) return !1; if (!(n = e.firstChild)) return !0; t = new no(n, e); do { if (Tl(n)) n = t.next(!0); else if (kl(n)) n = t.next(); else if (Ao.isBr(n)) r++ , n = t.next(); else { if (El(e, n)) return !1; n = t.next() } } while (n); return r <= 1 }(e.dom()) }, Rl = wr.immutable("block", "position"), Bl = wr.immutable("from", "to"), _l = function (e, t) { var n = qn.fromDom(e), r = qn.fromDom(t.container()); return gl(n, r).map(function (e) { return Rl(e, t) }) }, Dl = function (o, i, e) { var t = _l(o, Ba.fromRangeStart(e)), n = t.bind(function (e) { return Ka.fromPosition(i, o, e.position()).bind(function (e) { return _l(o, e).map(function (e) { return t = o, n = i, r = e, Ao.isBr(r.position().getNode()) && !1 === Al(r.block()) ? Ka.positionIn(!1, r.block().dom()).bind(function (e) { return e.isEqual(r.position()) ? Ka.fromPosition(n, t, e).bind(function (e) { return _l(t, e) }) : A.some(r) }).getOr(r) : r; var t, n, r }) }) }); return sa([t, n], Bl).filter(function (e) { return r = e, !1 === Or.eq(r.from().block(), r.to().block()) && (n = e, qr.parent(n.from().block()).bind(function (t) { return qr.parent(n.to().block()).filter(function (e) { return Or.eq(t, e) }) }).isSome()) && (t = e, !1 === Ao.isContentEditableFalse(t.from().block()) && !1 === Ao.isContentEditableFalse(t.to().block())); var t, n, r }) }, Ol = function (e, t, n) { return n.collapsed ? Dl(e, t, n) : A.none() }, Pl = function (e, t, n) { return Or.contains(t, e) ? qr.parents(e, function (e) { return n(e) || Or.eq(e, t) }).slice(0, -1) : [] }, Ll = function (e, t) { return Pl(e, t, V.constant(!1)) }, Il = Ll, Ml = function (e, t) { return [e].concat(Ll(e, t)) }, Fl = function (e) { var t, n, r = (t = e, n = qr.children(t), H.findIndex(n, so).fold(function () { return n }, function (e) { return n.slice(0, e) })); return H.each(r, function (e) { Ic.remove(e) }), r }, zl = function (e, t) { Ka.positionIn(e, t.dom()).each(function (e) { var t = e.getNode(); Ao.isBr(t) && Ic.remove(qn.fromDom(t)) }) }, Ul = function (e, t) { var n = Ml(t, e); return H.find(n.reverse(), Al).each(Ic.remove) }, ql = function (o, i) { return Or.contains(i, o) ? qr.parent(o).bind(function (e) { return Or.eq(e, i) ? A.some(o) : (t = i, n = o, r = qr.parents(n, function (e) { return Or.eq(e, t) }), A.from(r[r.length - 2])); var t, n, r }) : A.none() }, Vl = function (n, r, o) { if (Al(o)) return Ic.remove(o), Al(r) && Uc(r), Ka.firstPositionIn(r.dom()); zl(!0, r), zl(!1, o); var i = Fl(r); return ql(r, o).fold(function () { Ul(n, r); var e = Ka.lastPositionIn(o.dom()); return H.each(i, function (e) { Fu.append(o, e) }), e }, function (t) { var e = Ka.prevPosition(o.dom(), Ba.before(t.dom())); return H.each(i, function (e) { Fu.before(t, e) }), Ul(n, r), e }) }, Hl = function (e, t, n, r) { return t ? Vl(e, r, n) : Vl(e, n, r) }, jl = function (t, n) { var e, r = qn.fromDom(t.getBody()); return (e = Ol(r.dom(), n, t.selection.getRng()).bind(function (e) { return Hl(r, n, e.from().block(), e.to().block()) })).each(function (e) { t.selection.setRng(e.toRange()) }), e.isSome() }, $l = function (e, t) { var n = qn.fromDom(t), r = V.curry(Or.eq, e); return el.ancestor(n, vo, r).isSome() }, Wl = function (e, t) { var n, r, o = Ka.prevPosition(e.dom(), Ba.fromRangeStart(t)).isNone(), i = Ka.nextPosition(e.dom(), Ba.fromRangeEnd(t)).isNone(); return !($l(n = e, (r = t).startContainer) || $l(n, r.endContainer)) && o && i }, Kl = function (e) { var n, r, o, t, i = qn.fromDom(e.getBody()), a = e.selection.getRng(); return Wl(i, a) ? ((t = e).setContent(""), t.selection.setCursorLocation(), !0) : (n = i, r = e.selection, o = r.getRng(), sa([gl(n, qn.fromDom(o.startContainer)), gl(n, qn.fromDom(o.endContainer))], function (e, t) { return !1 === Or.eq(e, t) && (o.deleteContents(), Hl(n, !0, e, t).each(function (e) { r.setRng(e.toRange()) }), !0) }).getOr(!1)) }, Xl = function (e, t) { return !e.selection.isCollapsed() && Kl(e) }, Yl = function (a) { if (!E.isArray(a)) throw new Error("cases must be an array"); if (0 === a.length) throw new Error("there must be at least one case"); var u = [], n = {}; return H.each(a, function (e, r) { var t = or.keys(e); if (1 !== t.length) throw new Error("one and only one name per case"); var o = t[0], i = e[o]; if (n[o] !== undefined) throw new Error("duplicate key detected:" + o); if ("cata" === o) throw new Error("cannot have a case named cata (sorry)"); if (!E.isArray(i)) throw new Error("case arguments must be an array"); u.push(o), n[o] = function () { var e = arguments.length; if (e !== i.length) throw new Error("Wrong number of arguments to case " + o + ". Expected " + i.length + " (" + i + "), got " + e); for (var n = new Array(e), t = 0; t < n.length; t++)n[t] = arguments[t]; return { fold: function () { if (arguments.length !== a.length) throw new Error("Wrong number of arguments to fold. Expected " + a.length + ", got " + arguments.length); return arguments[r].apply(null, n) }, match: function (e) { var t = or.keys(e); if (u.length !== t.length) throw new Error("Wrong number of arguments to match. Expected: " + u.join(",") + "\nActual: " + t.join(",")); if (!H.forall(u, function (e) { return H.contains(t, e) })) throw new Error("Not all branches were specified when using match. Specified: " + t.join(", ") + "\nRequired: " + u.join(", ")); return e[o].apply(null, n) }, log: function (e) { console.log(e, { constructors: u, constructor: o, params: n }) } } } }), n }, Gl = Yl([{ remove: ["element"] }, { moveToElement: ["element"] }, { moveToPosition: ["position"] }]), Jl = function (e, t, n, r) { var o = r.getNode(!1 === t); return gl(qn.fromDom(e), qn.fromDom(n.getNode())).map(function (e) { return Al(e) ? Gl.remove(e.dom()) : Gl.moveToElement(o) }).orThunk(function () { return A.some(Gl.moveToElement(o)) }) }, Ql = function (u, s, c) { return Ka.fromPosition(s, u, c).bind(function (e) { return a = e.getNode(), vo(qn.fromDom(a)) || po(qn.fromDom(a)) ? A.none() : (t = u, o = e, i = function (e) { return co(qn.fromDom(e)) && !ps(r, o, t) }, Ns(!(n = s), r = c).fold(function () { return Ns(n, o).fold(V.constant(!1), i) }, i) ? A.none() : s && Ao.isContentEditableFalse(e.getNode()) ? Jl(u, s, c, e) : !1 === s && Ao.isContentEditableFalse(e.getNode(!0)) ? Jl(u, s, c, e) : s && ks(c) ? A.some(Gl.moveToPosition(e)) : !1 === s && Ss(c) ? A.some(Gl.moveToPosition(e)) : A.none()); var t, n, r, o, i, a }) }, Zl = function (r, e, o) { return i = e, a = o.getNode(!1 === i), u = i ? "after" : "before", Ao.isElement(a) && a.getAttribute("data-mce-caret") === u ? (t = e, n = o.getNode(!1 === e), t && Ao.isContentEditableFalse(n.nextSibling) ? A.some(Gl.moveToElement(n.nextSibling)) : !1 === t && Ao.isContentEditableFalse(n.previousSibling) ? A.some(Gl.moveToElement(n.previousSibling)) : A.none()).fold(function () { return Ql(r, e, o) }, A.some) : Ql(r, e, o).bind(function (e) { return t = r, n = o, e.fold(function (e) { return A.some(Gl.remove(e)) }, function (e) { return A.some(Gl.moveToElement(e)) }, function (e) { return ps(n, e, t) ? A.none() : A.some(Gl.moveToPosition(e)) }); var t, n }); var t, n, i, a, u }, ef = function (e, t) { return r = e, o = (n = t).container(), i = n.offset(), !1 === Ba.isTextPosition(n) && o === r.parentNode && i > Ba.before(r).offset() ? Ba(t.container(), t.offset() - 1) : t; var n, r, o, i }, tf = function (e) { return Wi(e.previousSibling) ? A.some((t = e.previousSibling, Ao.isText(t) ? Ba(t, t.data.length) : Ba.after(t))) : e.previousSibling ? Ka.lastPositionIn(e.previousSibling) : A.none(); var t }, nf = function (e) { return Wi(e.nextSibling) ? A.some((t = e.nextSibling, Ao.isText(t) ? Ba(t, 0) : Ba.before(t))) : e.nextSibling ? Ka.firstPositionIn(e.nextSibling) : A.none(); var t }, rf = function (r, o) { return tf(o).orThunk(function () { return nf(o) }).orThunk(function () { return e = r, t = o, n = Ba.before(t.previousSibling ? t.previousSibling : t.parentNode), Ka.prevPosition(e, n).fold(function () { return Ka.nextPosition(e, Ba.after(t)) }, A.some); var e, t, n }) }, of = function (n, r) { return nf(r).orThunk(function () { return tf(r) }).orThunk(function () { return e = n, t = r, Ka.nextPosition(e, Ba.after(t)).fold(function () { return Ka.prevPosition(e, Ba.before(t)) }, A.some); var e, t }) }, af = function (e, t, n) { return (r = e, o = t, i = n, r ? of(o, i) : rf(o, i)).map(V.curry(ef, n)); var r, o, i }, uf = function (t, n, e) { e.fold(function () { t.focus() }, function (e) { t.selection.setRng(e.toRange(), n) }) }, sf = function (e, t) { return t && e.schema.getBlockElements().hasOwnProperty(Qn.name(t)) }, cf = function (e) { if (Al(e)) { var t = qn.fromHtml('<br data-mce-bogus="1">'); return Ic.empty(e), Fu.append(e, t), A.some(Ba.before(t.dom())) } return A.none() }, lf = function (t, n, e) { var r, a, o, i = af(n, t.getBody(), e.dom()), u = el.ancestor(e, V.curry(sf, t), (r = t.getBody(), function (e) { return e.dom() === r })), s = (a = e, o = i, sa([qr.prevSibling(a), qr.nextSibling(a), o], function (e, t, n) { var r, o = e.dom(), i = t.dom(); return Ao.isText(o) && Ao.isText(i) ? (r = o.data.length, o.appendData(i.data), Ic.remove(t), Ic.remove(a), n.container() === i ? Ba(o, r) : n) : (Ic.remove(a), n) }).orThunk(function () { return Ic.remove(a), o })); t.dom.isEmpty(t.getBody()) ? (t.setContent(""), t.selection.setCursorLocation()) : u.bind(cf).fold(function () { uf(t, n, s) }, function (e) { uf(t, n, A.some(e)) }) }, ff = function (a, u) { var e, t, n, r, o; return (e = a.getBody(), t = u, n = a.selection.getRng(), r = Cs(t ? 1 : -1, e, n), o = Ba.fromRangeStart(r), !1 === t && ks(o) ? A.some(Gl.remove(o.getNode(!0))) : t && Ss(o) ? A.some(Gl.remove(o.getNode())) : Zl(e, t, o)).map(function (e) { return e.fold((o = a, i = u, function (e) { return o._selectionOverrides.hideFakeCaret(), lf(o, i, qn.fromDom(e)), !0 }), (n = a, r = u, function (e) { var t = r ? Ba.before(e) : Ba.after(e); return n.selection.setRng(t.toRange()), !0 }), (t = a, function (e) { return t.selection.setRng(e.toRange()), !0 })); var t, n, r, o, i }).getOr(!1) }, df = function (e, t) { var n, r = e.selection.getNode(); return !!Ao.isContentEditableFalse(r) && (n = qn.fromDom(e.getBody()), H.each(fu(n, ".mce-offscreen-selection"), Ic.remove), lf(e, t, qn.fromDom(e.selection.getNode())), hl(e), !0) }, mf = function (e, t) { return e.selection.isCollapsed() ? ff(e, t) : df(e, t) }, pf = function (e) { var t, n = function (e, t) { for (; t && t !== e;) { if (Ao.isContentEditableTrue(t) || Ao.isContentEditableFalse(t)) return t; t = t.parentNode } return null }(e.getBody(), e.selection.getNode()); return Ao.isContentEditableTrue(n) && e.dom.isBlock(n) && e.dom.isEmpty(n) && (t = e.dom.create("br", { "data-mce-bogus": "1" }), e.dom.setHTML(n, ""), n.appendChild(t), e.selection.setRng(Ba.before(t).toRange())), !0 }, gf = Ao.isText, hf = function (e) { return gf(e) && e.data[0] === Ei }, vf = function (e) { return gf(e) && e.data[e.data.length - 1] === Ei }, yf = function (e) { return e.ownerDocument.createTextNode(Ei) }, bf = function (e, t) { return e ? function (e) { if (gf(e.previousSibling)) return vf(e.previousSibling) || e.previousSibling.appendData(Ei), e.previousSibling; if (gf(e)) return hf(e) || e.insertData(0, Ei), e; var t = yf(e); return e.parentNode.insertBefore(t, e), t }(t) : function (e) { if (gf(e.nextSibling)) return hf(e.nextSibling) || e.nextSibling.insertData(0, Ei), e.nextSibling; if (gf(e)) return vf(e) || e.appendData(Ei), e; var t = yf(e); return e.nextSibling ? e.parentNode.insertBefore(t, e.nextSibling) : e.parentNode.appendChild(t), t }(t) }, Cf = V.curry(bf, !0), xf = V.curry(bf, !1), wf = function (e, t) { return Ao.isText(e.container()) ? bf(t, e.container()) : bf(t, e.getNode()) }, Nf = function (e, t) { var n = t.get(); return n && e.container() === n && Ri(n) }, Ef = function (n, e) { return e.fold(function (e) { Ua.remove(n.get()); var t = Cf(e); return n.set(t), A.some(Ba(t, t.length - 1)) }, function (e) { return Ka.firstPositionIn(e).map(function (e) { if (Nf(e, n)) return Ba(n.get(), 1); Ua.remove(n.get()); var t = wf(e, !0); return n.set(t), Ba(t, 1) }) }, function (e) { return Ka.lastPositionIn(e).map(function (e) { if (Nf(e, n)) return Ba(n.get(), n.get().length - 1); Ua.remove(n.get()); var t = wf(e, !1); return n.set(t), Ba(t, t.length - 1) }) }, function (e) { Ua.remove(n.get()); var t = xf(e); return n.set(t), A.some(Ba(t, 1)) }) }, Sf = function (e, t) { for (var n = 0; n < e.length; n++) { var r = e[n].apply(null, t); if (r.isSome()) return r } return A.none() }, kf = Yl([{ before: ["element"] }, { start: ["element"] }, { end: ["element"] }, { after: ["element"] }]), Tf = function (e, t) { var n = ms(t, e); return n || e }, Af = function (e, t, n) { var r = pl.normalizeForwards(n), o = Tf(t, r.container()); return pl.findRootInline(e, o, r).fold(function () { return Ka.nextPosition(o, r).bind(V.curry(pl.findRootInline, e, o)).map(function (e) { return kf.before(e) }) }, A.none) }, Rf = function (e, t) { return null === wc(e, t) }, Bf = function (e, t, n) { return pl.findRootInline(e, t, n).filter(V.curry(Rf, t)) }, _f = function (e, t, n) { var r = pl.normalizeBackwards(n); return Bf(e, t, r).bind(function (e) { return Ka.prevPosition(e, r).isNone() ? A.some(kf.start(e)) : A.none() }) }, Df = function (e, t, n) { var r = pl.normalizeForwards(n); return Bf(e, t, r).bind(function (e) { return Ka.nextPosition(e, r).isNone() ? A.some(kf.end(e)) : A.none() }) }, Of = function (e, t, n) { var r = pl.normalizeBackwards(n), o = Tf(t, r.container()); return pl.findRootInline(e, o, r).fold(function () { return Ka.prevPosition(o, r).bind(V.curry(pl.findRootInline, e, o)).map(function (e) { return kf.after(e) }) }, A.none) }, Pf = function (e) { return !1 === pl.isRtl(If(e)) }, Lf = function (e, t, n) { return Sf([Af, _f, Df, Of], [e, t, n]).filter(Pf) }, If = function (e) { return e.fold(V.identity, V.identity, V.identity, V.identity) }, Mf = function (e) { return e.fold(V.constant("before"), V.constant("start"), V.constant("end"), V.constant("after")) }, Ff = function (e) { return e.fold(kf.before, kf.before, kf.after, kf.after) }, zf = function (n, e, r, t, o, i) { return sa([pl.findRootInline(e, r, t), pl.findRootInline(e, r, o)], function (e, t) { return e !== t && pl.hasSameParentBlock(r, e, t) ? kf.after(n ? e : t) : i }).getOr(i) }, Uf = function (e, r) { return e.fold(V.constant(!0), function (e) { return n = r, !(Mf(t = e) === Mf(n) && If(t) === If(n)); var t, n }) }, qf = function (e, t) { return e ? t.fold(V.compose(A.some, kf.start), A.none, V.compose(A.some, kf.after), A.none) : t.fold(A.none, V.compose(A.some, kf.before), A.none, V.compose(A.some, kf.end)) }, Vf = function (a, u, s, c) { var e = pl.normalizePosition(a, c), l = Lf(u, s, e); return Lf(u, s, e).bind(V.curry(qf, a)).orThunk(function () { return t = a, n = u, r = s, o = l, e = c, i = pl.normalizePosition(t, e), Ka.fromPosition(t, r, i).map(V.curry(pl.normalizePosition, t)).fold(function () { return o.map(Ff) }, function (e) { return Lf(n, r, e).map(V.curry(zf, t, n, r, i, e)).filter(V.curry(Uf, o)) }).filter(Pf); var t, n, r, o, e, i }) }, Hf = Lf, jf = Vf, $f = (V.curry(Vf, !1), V.curry(Vf, !0), Ff), Wf = function (e) { return e.fold(kf.start, kf.start, kf.end, kf.end) }, Kf = function (e) { return E.isFunction(e.selection.getSel().modify) }, Xf = function (e, t, n) { var r = e ? 1 : -1; return t.setRng(Ba(n.container(), n.offset() + r).toRange()), t.getSel().modify("move", e ? "forward" : "backward", "word"), !0 }, Yf = function (e, t) { var n = t.selection.getRng(), r = e ? Ba.fromRangeEnd(n) : Ba.fromRangeStart(n); return !!Kf(t) && (e && Di(r) ? Xf(!0, t.selection, r) : !(e || !Oi(r)) && Xf(!1, t.selection, r)) }, Gf = function (e, t) { var n = e.dom.createRng(); n.setStart(t.container(), t.offset()), n.setEnd(t.container(), t.offset()), e.selection.setRng(n) }, Jf = function (e) { return !1 !== e.settings.inline_boundaries }, Qf = function (e, t) { e ? t.setAttribute("data-mce-selected", "inline-boundary") : t.removeAttribute("data-mce-selected") }, Zf = function (t, e, n) { return Ef(e, n).map(function (e) { return Gf(t, e), n }) }, ed = function (e, t, n) { return function () { return !!Jf(t) && Yf(e, t) } }, td = { move: function (a, u, s) { return function () { return !!Jf(a) && (t = a, n = u, e = s, r = t.getBody(), o = Ba.fromRangeStart(t.selection.getRng()), i = V.curry(pl.isInlineTarget, t), jf(e, i, r, o).bind(function (e) { return Zf(t, n, e) })).isSome(); var t, n, e, r, o, i } }, moveNextWord: V.curry(ed, !0), movePrevWord: V.curry(ed, !1), setupSelectedState: function (a) { var u = Ju(null), s = V.curry(pl.isInlineTarget, a); return a.on("NodeChange", function (e) { var t, n, r, o, i; Jf(a) && (t = s, n = a.dom, r = e.parents, o = H.filter(n.select('*[data-mce-selected="inline-boundary"]'), t), i = H.filter(r, t), H.each(H.difference(o, i), V.curry(Qf, !1)), H.each(H.difference(i, o), V.curry(Qf, !0)), function (e, t) { if (e.selection.isCollapsed() && !0 !== e.composing && t.get()) { var n = Ba.fromRangeStart(e.selection.getRng()); Ba.isTextPosition(n) && !1 === pl.isAtZwsp(n) && (Gf(e, Ua.removeAndReposition(t.get(), n)), t.set(null)) } }(a, u), function (n, r, o, e) { if (r.selection.isCollapsed()) { var t = H.filter(e, n); H.each(t, function (e) { var t = Ba.fromRangeStart(r.selection.getRng()); Hf(n, r.getBody(), t).bind(function (e) { return Zf(r, o, e) }) }) } }(s, a, u, e.parents)) }), u }, setCaretPosition: Gf }, nd = function (t, n) { return function (e) { return Ef(n, e).map(function (e) { return td.setCaretPosition(t, e), !0 }).getOr(!1) } }, rd = function (r, o, i, a) { var u = r.getBody(), s = V.curry(pl.isInlineTarget, r); r.undoManager.ignore(function () { var e, t, n; r.selection.setRng((e = i, t = a, (n = document.createRange()).setStart(e.container(), e.offset()), n.setEnd(t.container(), t.offset()), n)), r.execCommand("Delete"), Hf(s, u, Ba.fromRangeStart(r.selection.getRng())).map(Wf).map(nd(r, o)) }), r.nodeChanged() }, od = function (n, r, i, o) { var e, t, a = (e = n.getBody(), t = o.container(), ms(t, e) || e), u = V.curry(pl.isInlineTarget, n), s = Hf(u, a, o); return s.bind(function (e) { return i ? e.fold(V.constant(A.some(Wf(e))), A.none, V.constant(A.some($f(e))), A.none) : e.fold(A.none, V.constant(A.some($f(e))), A.none, V.constant(A.some(Wf(e)))) }).map(nd(n, r)).getOrThunk(function () { var t = Ka.navigate(i, a, o), e = t.bind(function (e) { return Hf(u, a, e) }); return s.isSome() && e.isSome() ? pl.findRootInline(u, a, o).map(function (e) { return o = e, !!sa([Ka.firstPositionIn(o), Ka.lastPositionIn(o)], function (e, t) { var n = pl.normalizePosition(!0, e), r = pl.normalizePosition(!1, t); return Ka.nextPosition(o, n).map(function (e) { return e.isEqual(r) }).getOr(!0) }).getOr(!0) && (lf(n, i, qn.fromDom(e)), !0); var o }).getOr(!1) : e.bind(function (e) { return t.map(function (e) { return i ? rd(n, r, o, e) : rd(n, r, e, o), !0 }) }).getOr(!1) }) }, id = function (e, t, n) { if (e.selection.isCollapsed() && !1 !== e.settings.inline_boundaries) { var r = Ba.fromRangeStart(e.selection.getRng()); return od(e, t, n, r) } return !1 }, ad = wr.immutable("start", "end"), ud = wr.immutable("rng", "table", "cells"), sd = Yl([{ removeTable: ["element"] }, { emptyCells: ["cells"] }]), cd = function (e, t) { return xl(qn.fromDom(e), "td,th", t) }, ld = function (e, t) { return bl(e, "table", t) }, fd = function (e) { return !1 === Or.eq(e.start(), e.end()) }, dd = function (e, n) { return ld(e.start(), n).bind(function (t) { return ld(e.end(), n).bind(function (e) { return Or.eq(t, e) ? A.some(t) : A.none() }) }) }, md = function (e) { return fu(e, "td,th") }, pd = function (r, e) { var t = cd(e.startContainer, r), n = cd(e.endContainer, r); return e.collapsed ? A.none() : sa([t, n], ad).fold(function () { return t.fold(function () { return n.bind(function (t) { return ld(t, r).bind(function (e) { return H.head(md(e)).map(function (e) { return ad(e, t) }) }) }) }, function (t) { return ld(t, r).bind(function (e) { return H.last(md(e)).map(function (e) { return ad(t, e) }) }) }) }, function (e) { return gd(r, e) ? A.none() : (n = r, ld((t = e).start(), n).bind(function (e) { return H.last(md(e)).map(function (e) { return ad(t.start(), e) }) })); var t, n }) }, gd = function (e, t) { return dd(t, e).isSome() }, hd = function (e, t) { var n, r, o, i, a, u = (n = e, V.curry(Or.eq, n)); return (r = t, o = u, i = cd(r.startContainer, o), a = cd(r.endContainer, o), sa([i, a], ad).filter(fd).filter(function (e) { return gd(o, e) }).orThunk(function () { return pd(o, r) })).bind(function (e) { return dd(t = e, u).map(function (e) { return ud(t, e, md(e)) }); var t }) }, vd = function (e, t) { return H.findIndex(e, function (e) { return Or.eq(e, t) }) }, yd = function (n) { return (r = n, sa([vd(r.cells(), r.rng().start()), vd(r.cells(), r.rng().end())], function (e, t) { return r.cells().slice(e, t + 1) })).map(function (e) { var t = n.cells(); return e.length === t.length ? sd.removeTable(n.table()) : sd.emptyCells(e) }); var r }, bd = function (e, t) { return hd(e, t).bind(yd) }, Cd = function (e) { var t = []; if (e) for (var n = 0; n < e.rangeCount; n++)t.push(e.getRangeAt(n)); return t }, xd = Cd, wd = function (e) { return H.bind(e, function (e) { var t = ta(e); return t ? [qn.fromDom(t)] : [] }) }, Nd = function (e) { return 1 < Cd(e).length }, Ed = function (e) { return H.filter(wd(e), vo) }, Sd = function (e) { return fu(e, "td[data-mce-selected],th[data-mce-selected]") }, kd = function (e, t) { var n = Sd(t), r = Ed(e); return 0 < n.length ? n : r }, Td = kd, Ad = function (e) { return kd(xd(e.selection.getSel()), qn.fromDom(e.getBody())) }, Rd = function (e, t) { return H.each(t, Uc), e.selection.setCursorLocation(t[0].dom(), 0), !0 }, Bd = function (e, t) { return lf(e, !1, t), !0 }, _d = function (n, e, r, t) { return Od(e, t).fold(function () { return t = n, bd(e, r).map(function (e) { return e.fold(V.curry(Bd, t), V.curry(Rd, t)) }); var t }, function (e) { return Pd(n, e) }).getOr(!1) }, Dd = function (e, t) { return H.find(Ml(t, e), vo) }, Od = function (e, t) { return H.find(Ml(t, e), function (e) { return "caption" === Qn.name(e) }) }, Pd = function (e, t) { return Uc(t), e.selection.setCursorLocation(t.dom(), 0), A.some(!0) }, Ld = function (u, s, c, l, f) { return Ka.navigate(c, u.getBody(), f).bind(function (e) { return r = l, o = c, i = f, a = e, Ka.firstPositionIn(r.dom()).bind(function (t) { return Ka.lastPositionIn(r.dom()).map(function (e) { return o ? i.isEqual(t) && a.isEqual(e) : i.isEqual(e) && a.isEqual(t) }) }).getOr(!0) ? Pd(u, l) : (t = l, n = e, Od(s, qn.fromDom(n.getNode())).map(function (e) { return !1 === Or.eq(e, t) })); var t, n, r, o, i, a }).or(A.some(!0)) }, Id = function (a, u, s, e) { var c = Ba.fromRangeStart(a.selection.getRng()); return Dd(s, e).bind(function (e) { return Al(e) ? Pd(a, e) : (t = a, n = s, r = u, o = e, i = c, Ka.navigate(r, t.getBody(), i).bind(function (e) { return Dd(n, qn.fromDom(e.getNode())).map(function (e) { return !1 === Or.eq(e, o) }) })); var t, n, r, o, i }) }, Md = function (a, u, e) { var s = qn.fromDom(a.getBody()); return Od(s, e).fold(function () { return Id(a, u, s, e) }, function (e) { return t = a, n = u, r = s, o = e, i = Ba.fromRangeStart(t.selection.getRng()), Al(o) ? Pd(t, o) : Ld(t, r, n, o, i); var t, n, r, o, i }).getOr(!1) }, Fd = function (e, t) { var n, r, o, i, a, u = qn.fromDom(e.selection.getStart(!0)), s = Ad(e); return e.selection.isCollapsed() && 0 === s.length ? Md(e, t, u) : (n = e, r = u, o = qn.fromDom(n.getBody()), i = n.selection.getRng(), 0 !== (a = Ad(n)).length ? Rd(n, a) : _d(n, o, i, r)) }, zd = function (e, t) { e.getDoc().execCommand(t, !1, null) }, Ud = { deleteCommand: function (e) { mf(e, !1) || id(e, !1) || jl(e, !1) || Fd(e) || Xl(e, !1) || (zd(e, "Delete"), hl(e)) }, forwardDeleteCommand: function (e) { mf(e, !0) || id(e, !0) || jl(e, !0) || Fd(e) || Xl(e, !0) || zd(e, "ForwardDelete") } }, qd = function (s) { return function (u, e) { return A.from(e).map(qn.fromDom).filter(Qn.isElement).bind(function (e) { return (r = s, o = u, i = e.dom(), a = function (e) { return br(e, r) }, el.closest(qn.fromDom(i), function (e) { return a(e).isSome() }, function (e) { return Or.eq(qn.fromDom(o), e) }).bind(a)).or((t = s, n = e.dom(), A.from(di.DOM.getStyle(n, t, !0)))); var t, n, r, o, i, a }).getOr("") } }, Vd = { getFontSize: qd("font-size"), getFontFamily: V.compose(function (e) { return e.replace(/[\'\"\\]/g, "").replace(/,\s+/g, ",") }, qd("font-family")), toPt: function (e, t) { return /[0-9.]+px$/.test(e) ? (n = 72 * parseInt(e, 10) / 96, r = t || 0, o = Math.pow(10, r), Math.round(n * o) / o + "pt") : e; var n, r, o } }, Hd = function (e) { return Ka.firstPositionIn(e.getBody()).map(function (e) { var t = e.container(); return Ao.isText(t) ? t.parentNode : t }) }, jd = function (o) { return A.from(o.selection.getRng()).bind(function (e) { var t, n, r = o.getBody(); return n = r, (t = e).startContainer === n && 0 === t.startOffset ? A.none() : A.from(o.selection.getStart(!0)) }) }, $d = function (e, t) { var n = parseInt(t, 10); if (1 <= n && n <= 7) { var r = Pu(e), o = Lu(e); return o ? o[n - 1] || t : r[n - 1] || t } return t }, Wd = function (e, t) { e.formatter.toggle("fontname", { value: $d(e, t) }), e.nodeChanged() }, Kd = function (t) { return jd(t).fold(function () { return Hd(t).map(function (e) { return Vd.getFontFamily(t.getBody(), e) }).getOr("") }, function (e) { return Vd.getFontFamily(t.getBody(), e) }) }, Xd = function (e, t) { e.formatter.toggle("fontsize", { value: $d(e, t) }), e.nodeChanged() }, Yd = function (t) { return jd(t).fold(function () { return Hd(t).map(function (e) { return Vd.getFontSize(t.getBody(), e) }).getOr("") }, function (e) { return Vd.getFontSize(t.getBody(), e) }) }, Gd = { isEq: function (e, t) { return e && t && e.startContainer === t.startContainer && e.startOffset === t.startOffset && e.endContainer === t.endContainer && e.endOffset === t.endOffset } }, Jd = function (e, t, n) { return null !== function (e, t, n) { for (; e && e !== t;) { if (n(e)) return e; e = e.parentNode } return null }(e, t, n) }, Qd = function (e, t, n) { return Jd(e, t, function (e) { return e.nodeName === n }) }, Zd = function (e) { return e && "TABLE" === e.nodeName }, em = function (e, t, n) { for (var r = new no(t, e.getParent(t.parentNode, e.isBlock) || e.getRoot()); t = r[n ? "prev" : "next"]();)if (Ao.isBr(t)) return !0 }, tm = function (e, t, n, r, o) { var i, a, u, s, c, l, f = e.getRoot(), d = e.schema.getNonEmptyElements(); if (u = e.getParent(o.parentNode, e.isBlock) || f, r && Ao.isBr(o) && t && e.isEmpty(u)) return A.some(Ta(o.parentNode, e.nodeIndex(o))); for (i = new no(o, u); s = i[r ? "prev" : "next"]();) { if ("false" === e.getContentEditableParent(s) || (l = f, Bi(c = s) && !1 === Jd(c, l, xc))) return A.none(); if (Ao.isText(s) && 0 < s.nodeValue.length) return !1 === Qd(s, f, "A") ? A.some(Ta(s, r ? s.nodeValue.length : 0)) : A.none(); if (e.isBlock(s) || d[s.nodeName.toLowerCase()]) return A.none(); a = s } return n && a ? A.some(Ta(a, 0)) : A.none() }, nm = function (e, t, n, r) { var o, i, a, u, s, c, l, f, d, m, p = e.getRoot(), g = !1; if (o = r[(n ? "start" : "end") + "Container"], i = r[(n ? "start" : "end") + "Offset"], l = Ao.isElement(o) && i === o.childNodes.length, s = e.schema.getNonEmptyElements(), c = n, Bi(o)) return A.none(); if (Ao.isElement(o) && i > o.childNodes.length - 1 && (c = !1), Ao.isDocument(o) && (o = p, i = 0), o === p) { if (c && (u = o.childNodes[0 < i ? i - 1 : 0])) { if (Bi(u)) return A.none(); if (s[u.nodeName] || Zd(u)) return A.none() } if (o.hasChildNodes()) { if (i = Math.min(!c && 0 < i ? i - 1 : i, o.childNodes.length - 1), o = o.childNodes[i], i = Ao.isText(o) && l ? o.data.length : 0, !t && o === p.lastChild && Zd(o)) return A.none(); if (function (e, t) { for (; t && t !== e;) { if (Ao.isContentEditableFalse(t)) return !0; t = t.parentNode } return !1 }(p, o) || Bi(o)) return A.none(); if (o.hasChildNodes() && !1 === Zd(o)) { a = new no(u = o, p); do { if (Ao.isContentEditableFalse(u) || Bi(u)) { g = !1; break } if (Ao.isText(u) && 0 < u.nodeValue.length) { i = c ? 0 : u.nodeValue.length, o = u, g = !0; break } if (s[u.nodeName.toLowerCase()] && (!(f = u) || !/^(TD|TH|CAPTION)$/.test(f.nodeName))) { i = e.nodeIndex(u), o = u.parentNode, c || i++ , g = !0; break } } while (u = c ? a.next() : a.prev()) } } } return t && (Ao.isText(o) && 0 === i && tm(e, l, t, !0, o).each(function (e) { o = e.container(), i = e.offset(), g = !0 }), Ao.isElement(o) && ((u = o.childNodes[i]) || (u = o.childNodes[i - 1]), !u || !Ao.isBr(u) || (m = "A", (d = u).previousSibling && d.previousSibling.nodeName === m) || em(e, u, !1) || em(e, u, !0) || tm(e, l, t, !0, u).each(function (e) { o = e.container(), i = e.offset(), g = !0 }))), c && !t && Ao.isText(o) && i === o.nodeValue.length && tm(e, l, t, !1, o).each(function (e) { o = e.container(), i = e.offset(), g = !0 }), g ? A.some(Ta(o, i)) : A.none() }, rm = { normalize: function (e, t) { var n = t.collapsed, r = t.cloneRange(), o = Ta.fromRangeStart(t); return nm(e, n, !0, r).each(function (e) { n && Ta.isAbove(o, e) || r.setStart(e.container(), e.offset()) }), n || nm(e, n, !1, r).each(function (e) { r.setEnd(e.container(), e.offset()) }), n && r.collapse(!0), Gd.isEq(t, r) ? A.none() : A.some(r) } }, om = function (e, t, n) { var r = e.create("span", {}, "&nbsp;"); n.parentNode.insertBefore(r, n), t.scrollIntoView(r), e.remove(r) }, im = function (e, t, n, r) { var o = e.createRng(); r ? (o.setStartBefore(n), o.setEndBefore(n)) : (o.setStartAfter(n), o.setEndAfter(n)), t.setRng(o) }, am = function (e, t) { var n, r, o = e.selection, i = e.dom, a = o.getRng(); rm.normalize(i, a).each(function (e) { a.setStart(e.startContainer, e.startOffset), a.setEnd(e.endContainer, e.endOffset) }); var u = a.startOffset, s = a.startContainer; if (1 === s.nodeType && s.hasChildNodes()) { var c = u > s.childNodes.length - 1; s = s.childNodes[Math.min(u, s.childNodes.length - 1)] || s, u = c && 3 === s.nodeType ? s.nodeValue.length : 0 } var l = i.getParent(s, i.isBlock), f = l ? i.getParent(l.parentNode, i.isBlock) : null, d = f ? f.nodeName.toUpperCase() : "", m = t && t.ctrlKey; "LI" !== d || m || (l = f), s && 3 === s.nodeType && u >= s.nodeValue.length && (function (e, t, n) { for (var r, o = new no(t, n), i = e.getNonEmptyElements(); r = o.next();)if (i[r.nodeName.toLowerCase()] || 0 < r.length) return !0 }(e.schema, s, l) || (n = i.create("br"), a.insertNode(n), a.setStartAfter(n), a.setEndAfter(n), r = !0)), n = i.create("br"), a.insertNode(n), om(i, o, n), im(i, o, n, r), e.undoManager.add() }, um = function (e, t) { var n = qn.fromTag("br"); Fu.before(qn.fromDom(t), n), e.undoManager.add() }, sm = function (e, t) { cm(e.getBody(), t) || Fu.after(qn.fromDom(t), qn.fromTag("br")); var n = qn.fromTag("br"); Fu.after(qn.fromDom(t), n), om(e.dom, e.selection, n.dom()), im(e.dom, e.selection, n.dom(), !1), e.undoManager.add() }, cm = function (e, t) { return n = Ba.after(t), !!Ao.isBr(n.getNode()) || Ka.nextPosition(e, Ba.after(t)).map(function (e) { return Ao.isBr(e.getNode()) }).getOr(!1); var n }, lm = function (e) { return e && "A" === e.nodeName && "href" in e }, fm = function (e) { return e.fold(V.constant(!1), lm, lm, V.constant(!1)) }, dm = function (e, t) { t.fold(V.noop, V.curry(um, e), V.curry(sm, e), V.noop) }, mm = { insert: function (e, t) { var n, r, o, i = (n = e, r = V.curry(pl.isInlineTarget, n), o = Ba.fromRangeStart(n.selection.getRng()), Hf(r, n.getBody(), o).filter(fm)); i.isSome() ? i.each(V.curry(dm, e)) : am(e, t) } }, pm = Yl([{ before: ["element"] }, { on: ["element", "offset"] }, { after: ["element"] }]), gm = (pm.before, pm.on, pm.after, function (e) { return e.fold(V.identity, V.identity, V.identity) }), hm = Yl([{ domRange: ["rng"] }, { relative: ["startSitu", "finishSitu"] }, { exact: ["start", "soffset", "finish", "foffset"] }]), vm = wr.immutable("start", "soffset", "finish", "foffset"), ym = { domRange: hm.domRange, relative: hm.relative, exact: hm.exact, exactFromRange: function (e) { return hm.exact(e.start(), e.soffset(), e.finish(), e.foffset()) }, range: vm, getWin: function (e) { var t = e.match({ domRange: function (e) { return qn.fromDom(e.startContainer) }, relative: function (e, t) { return gm(e) }, exact: function (e, t, n, r) { return e } }); return qr.defaultView(t) } }, bm = zn.detect().browser, Cm = function (e, t) { var n = Qn.isText(t) ? Fc(t).length : qr.children(t).length + 1; return n < e ? n : e < 0 ? 0 : e }, xm = function (e) { return ym.range(e.start(), Cm(e.soffset(), e.start()), e.finish(), Cm(e.foffset(), e.finish())) }, wm = function (e, t) { return Or.contains(e, t) || Or.eq(e, t) }, Nm = function (t) { return function (e) { return wm(t, e.start()) && wm(t, e.finish()) } }, Em = function (e) { return !0 === e.inline || bm.isIE() }, Sm = function (e) { return ym.range(qn.fromDom(e.startContainer), e.startOffset, qn.fromDom(e.endContainer), e.endOffset) }, km = function (e) { var t = e.getSelection(); return (t && 0 !== t.rangeCount ? A.from(t.getRangeAt(0)) : A.none()).map(Sm) }, Tm = function (e) { var t = qr.defaultView(e); return km(t.dom()).filter(Nm(e)) }, Am = function (e, t) { return A.from(t).filter(Nm(e)).map(xm) }, Rm = function (e) { var t = document.createRange(); try { return t.setStart(e.start().dom(), e.soffset()), t.setEnd(e.finish().dom(), e.foffset()), A.some(t) } catch (n) { return A.none() } }, Bm = function (e) { return (e.bookmark ? e.bookmark : A.none()).bind(V.curry(Am, qn.fromDom(e.getBody()))).bind(Rm) }, _m = { store: function (e) { var t = Em(e) ? Tm(qn.fromDom(e.getBody())) : A.none(); e.bookmark = t.isSome() ? t : e.bookmark }, storeNative: function (e, t) { var n = qn.fromDom(e.getBody()), r = (Em(e) ? A.from(t) : A.none()).map(Sm).filter(Nm(n)); e.bookmark = r.isSome() ? r : e.bookmark }, readRange: km, restore: function (t) { Bm(t).each(function (e) { t.selection.setRng(e) }) }, getRng: Bm, getBookmark: Tm, validate: Am }, Dm = function (e, t) { var n = e.settings, r = e.dom, o = e.selection, i = e.formatter, a = /[a-z%]+$/i.exec(n.indentation)[0], u = parseInt(n.indentation, 10), s = e.getParam("indent_use_margin", !1); e.queryCommandState("InsertUnorderedList") || e.queryCommandState("InsertOrderedList") || (n.forced_root_block || r.getParent(o.getNode(), r.isBlock) || i.apply("div"), H.each(o.getSelectedBlocks(), function (e) { return function (e, t, n, r, o, i) { if ("false" !== e.getContentEditable(i) && "LI" !== i.nodeName) { var a = n ? "margin" : "padding"; if (a = "TABLE" === i.nodeName ? "margin" : a, a += "rtl" === e.getStyle(i, "direction", !0) ? "Right" : "Left", "outdent" === t) { var u = Math.max(0, parseInt(i.style[a] || 0, 10) - r); e.setStyle(i, a, u ? u + o : "") } else u = parseInt(i.style[a] || 0, 10) + r + o, e.setStyle(i, a, u) } }(r, t, s, u, a, e) })) }, Om = Lt.each, Pm = Lt.extend, Lm = Lt.map, Im = Lt.inArray; function Mm(s) { var o, i, a, t, c = { state: {}, exec: {}, value: {} }, n = s.settings; s.on("PreInit", function () { o = s.dom, i = s.selection, n = s.settings, a = s.formatter }); var r = function (e) { var t; if (!s.quirks.isHidden() && !s.removed) { if (e = e.toLowerCase(), t = c.state[e]) return t(e); try { return s.getDoc().queryCommandState(e) } catch (n) { } return !1 } }, e = function (e, n) { n = n || "exec", Om(e, function (t, e) { Om(e.toLowerCase().split(","), function (e) { c[n][e] = t }) }) }, u = function (e, t, n) { e = e.toLowerCase(), c.value[e] = function () { return t.call(n || s) } }; Pm(this, { execCommand: function (t, n, r, e) { var o, i, a = !1; if (!s.removed) { if (/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(t) || e && e.skip_focus ? _m.restore(s) : s.focus(), (e = s.fire("BeforeExecCommand", { command: t, ui: n, value: r })).isDefaultPrevented()) return !1; if (i = t.toLowerCase(), o = c.exec[i]) return o(i, n, r), s.fire("ExecCommand", { command: t, ui: n, value: r }), !0; if (Om(s.plugins, function (e) { if (e.execCommand && e.execCommand(t, n, r)) return s.fire("ExecCommand", { command: t, ui: n, value: r }), !(a = !0) }), a) return a; if (s.theme && s.theme.execCommand && s.theme.execCommand(t, n, r)) return s.fire("ExecCommand", { command: t, ui: n, value: r }), !0; try { a = s.getDoc().execCommand(t, n, r) } catch (u) { } return !!a && (s.fire("ExecCommand", { command: t, ui: n, value: r }), !0) } }, queryCommandState: r, queryCommandValue: function (e) { var t; if (!s.quirks.isHidden() && !s.removed) { if (e = e.toLowerCase(), t = c.value[e]) return t(e); try { return s.getDoc().queryCommandValue(e) } catch (n) { } } }, queryCommandSupported: function (e) { if (e = e.toLowerCase(), c.exec[e]) return !0; try { return s.getDoc().queryCommandSupported(e) } catch (t) { } return !1 }, addCommands: e, addCommand: function (e, o, i) { e = e.toLowerCase(), c.exec[e] = function (e, t, n, r) { return o.call(i || s, t, n, r) } }, addQueryStateHandler: function (e, t, n) { e = e.toLowerCase(), c.state[e] = function () { return t.call(n || s) } }, addQueryValueHandler: u, hasCustomCommand: function (e) { return e = e.toLowerCase(), !!c.exec[e] } }); var l = function (e, t, n) { return t === undefined && (t = !1), n === undefined && (n = null), s.getDoc().execCommand(e, t, n) }, f = function (e) { return a.match(e) }, d = function (e, t) { a.toggle(e, t ? { value: t } : undefined), s.nodeChanged() }, m = function (e) { t = i.getBookmark(e) }, p = function () { i.moveToBookmark(t) }; e({ "mceResetDesignMode,mceBeginUndoLevel": function () { }, "mceEndUndoLevel,mceAddUndoLevel": function () { s.undoManager.add() }, "Cut,Copy,Paste": function (e) { var t, n = s.getDoc(); try { l(e) } catch (o) { t = !0 } if ("paste" !== e || n.queryCommandEnabled(e) || (t = !0), t || !n.queryCommandSupported(e)) { var r = s.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead."); ge.mac && (r = r.replace(/Ctrl\+/g, "\u2318+")), s.notificationManager.open({ text: r, type: "error" }) } }, unlink: function () { if (i.isCollapsed()) { var e = s.dom.getParent(s.selection.getStart(), "a"); e && s.dom.remove(e, !0) } else a.remove("link") }, "JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone": function (e) { var t = e.substring(7); "full" === t && (t = "justify"), Om("left,center,right,justify".split(","), function (e) { t !== e && a.remove("align" + e) }), "none" !== t && d("align" + t) }, "InsertUnorderedList,InsertOrderedList": function (e) { var t, n; l(e), (t = o.getParent(i.getNode(), "ol,ul")) && (n = t.parentNode, /^(H[1-6]|P|ADDRESS|PRE)$/.test(n.nodeName) && (m(), o.split(n, t), p())) }, "Bold,Italic,Underline,Strikethrough,Superscript,Subscript": function (e) { d(e) }, "ForeColor,HiliteColor": function (e, t, n) { d(e, n) }, FontName: function (e, t, n) { Wd(s, n) }, FontSize: function (e, t, n) { Xd(s, n) }, RemoveFormat: function (e) { a.remove(e) }, mceBlockQuote: function () { d("blockquote") }, FormatBlock: function (e, t, n) { return d(n || "p") }, mceCleanup: function () { var e = i.getBookmark(); s.setContent(s.getContent()), i.moveToBookmark(e) }, mceRemoveNode: function (e, t, n) { var r = n || i.getNode(); r !== s.getBody() && (m(), s.dom.remove(r, !0), p()) }, mceSelectNodeDepth: function (e, t, n) { var r = 0; o.getParent(i.getNode(), function (e) { if (1 === e.nodeType && r++ === n) return i.select(e), !1 }, s.getBody()) }, mceSelectNode: function (e, t, n) { i.select(n) }, mceInsertContent: function (e, t, n) { Yc.insertAtCaret(s, n) }, mceInsertRawHTML: function (e, t, n) { var r = s.getContent(); i.setContent("tiny_mce_marker"), s.setContent(r.replace(/tiny_mce_marker/g, function () { return n })) }, mceToggleFormat: function (e, t, n) { d(n) }, mceSetContent: function (e, t, n) { s.setContent(n) }, "Indent,Outdent": function (e) { Dm(s, e) }, mceRepaint: function () { }, InsertHorizontalRule: function () { s.execCommand("mceInsertContent", !1, "<hr />") }, mceToggleVisualAid: function () { s.hasVisual = !s.hasVisual, s.addVisual() }, mceReplaceContent: function (e, t, n) { s.execCommand("mceInsertContent", !1, n.replace(/\{\$selection\}/g, i.getContent({ format: "text" }))) }, mceInsertLink: function (e, t, n) { var r; "string" == typeof n && (n = { href: n }), r = o.getParent(i.getNode(), "a"), n.href = n.href.replace(" ", "%20"), r && n.href || a.remove("link"), n.href && a.apply("link", n, r) }, selectAll: function () { var e = o.getParent(i.getStart(), Ao.isContentEditableTrue); if (e) { var t = o.createRng(); t.selectNodeContents(e), i.setRng(t) } }, "delete": function () { Ud.deleteCommand(s) }, forwardDelete: function () { Ud.forwardDeleteCommand(s) }, mceNewDocument: function () { s.setContent("") }, InsertLineBreak: function (e, t, n) { return mm.insert(s, n), !0 } }), e({ "JustifyLeft,JustifyCenter,JustifyRight,JustifyFull": function (e) { var t = "align" + e.substring(7), n = i.isCollapsed() ? [o.getParent(i.getNode(), o.isBlock)] : i.getSelectedBlocks(), r = Lm(n, function (e) { return !!a.matchNode(e, t) }); return -1 !== Im(r, !0) }, "Bold,Italic,Underline,Strikethrough,Superscript,Subscript": function (e) { return f(e) }, mceBlockQuote: function () { return f("blockquote") }, Outdent: function () { var e; if (n.inline_styles) { if ((e = o.getParent(i.getStart(), o.isBlock)) && 0 < parseInt(e.style.paddingLeft, 10)) return !0; if ((e = o.getParent(i.getEnd(), o.isBlock)) && 0 < parseInt(e.style.paddingLeft, 10)) return !0 } return r("InsertUnorderedList") || r("InsertOrderedList") || !n.inline_styles && !!o.getParent(i.getNode(), "BLOCKQUOTE") }, "InsertUnorderedList,InsertOrderedList": function (e) { var t = o.getParent(i.getNode(), "ul,ol"); return t && ("insertunorderedlist" === e && "UL" === t.tagName || "insertorderedlist" === e && "OL" === t.tagName) } }, "state"), e({ Undo: function () { s.undoManager.undo() }, Redo: function () { s.undoManager.redo() } }), u("FontName", function () { return Kd(s) }, this), u("FontSize", function () { return Yd(s) }, this) } var Fm = Lt.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend", " "), zm = function (a) { var u, s, c = this, l = {}, f = function () { return !1 }, d = function () { return !0 }; u = (a = a || {}).scope || c, s = a.toggleEvent || f; var r = function (e, t, n, r) { var o, i, a; if (!1 === t && (t = f), t) for (t = { func: t }, r && Lt.extend(t, r), a = (i = e.toLowerCase().split(" ")).length; a--;)e = i[a], (o = l[e]) || (o = l[e] = [], s(e, !0)), n ? o.unshift(t) : o.push(t); return c }, m = function (e, t) { var n, r, o, i, a; if (e) for (n = (i = e.toLowerCase().split(" ")).length; n--;) { if (e = i[n], r = l[e], !e) { for (o in l) s(o, !1), delete l[o]; return c } if (r) { if (t) for (a = r.length; a--;)r[a].func === t && (r = r.slice(0, a).concat(r.slice(a + 1)), l[e] = r); else r.length = 0; r.length || (s(e, !1), delete l[e]) } } else { for (e in l) s(e, !1); l = {} } return c }; c.fire = function (e, t) { var n, r, o, i; if (e = e.toLowerCase(), (t = t || {}).type = e, t.target || (t.target = u), t.preventDefault || (t.preventDefault = function () { t.isDefaultPrevented = d }, t.stopPropagation = function () { t.isPropagationStopped = d }, t.stopImmediatePropagation = function () { t.isImmediatePropagationStopped = d }, t.isDefaultPrevented = f, t.isPropagationStopped = f, t.isImmediatePropagationStopped = f), a.beforeFire && a.beforeFire(t), n = l[e]) for (r = 0, o = n.length; r < o; r++) { if ((i = n[r]).once && m(e, i.func), t.isImmediatePropagationStopped()) return t.stopPropagation(), t; if (!1 === i.func.call(u, t)) return t.preventDefault(), t } return t }, c.on = r, c.off = m, c.once = function (e, t, n) { return r(e, t, n, { once: !0 }) }, c.has = function (e) { return e = e.toLowerCase(), !(!l[e] || 0 === l[e].length) } }; zm.isNative = function (e) { return !!Fm[e.toLowerCase()] }; var Um, qm = function (n) { return n._eventDispatcher || (n._eventDispatcher = new zm({ scope: n, toggleEvent: function (e, t) { zm.isNative(e) && n.toggleNativeEvent && n.toggleNativeEvent(e, t) } })), n._eventDispatcher }, Vm = { fire: function (e, t, n) { if (this.removed && "remove" !== e) return t; if (t = qm(this).fire(e, t, n), !1 !== n && this.parent) for (var r = this.parent(); r && !t.isPropagationStopped();)r.fire(e, t, !1), r = r.parent(); return t }, on: function (e, t, n) { return qm(this).on(e, t, n) }, off: function (e, t) { return qm(this).off(e, t) }, once: function (e, t) { return qm(this).once(e, t) }, hasEventListeners: function (e) { return qm(this).has(e) } }, Hm = di.DOM, jm = function (e, t) { return "selectionchange" === t ? e.getDoc() : !e.inline && /^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(t) ? e.getDoc().documentElement : e.settings.event_root ? (e.eventRoot || (e.eventRoot = Hm.select(e.settings.event_root)[0]), e.eventRoot) : e.getBody() }, $m = function (i, a) { var e, t, u = function (e) { return !e.hidden && !e.readonly }; if (i.delegates || (i.delegates = {}), !i.delegates[a] && !i.removed) if (e = jm(i, a), i.settings.event_root) { if (Um || (Um = {}, i.editorManager.on("removeEditor", function () { var e; if (!i.editorManager.activeEditor && Um) { for (e in Um) i.dom.unbind(jm(i, e)); Um = null } })), Um[a]) return; t = function (e) { for (var t = e.target, n = i.editorManager.get(), r = n.length; r--;) { var o = n[r].getBody(); (o === t || Hm.isChildOf(t, o)) && u(n[r]) && n[r].fire(a, e) } }, Um[a] = t, Hm.bind(e, a, t) } else t = function (e) { u(i) && i.fire(a, e) }, Hm.bind(e, a, t), i.delegates[a] = t }, Wm = { bindPendingEventDelegates: function () { var t = this; Lt.each(t._pendingNativeEvents, function (e) { $m(t, e) }) }, toggleNativeEvent: function (e, t) { var n = this; "focus" !== e && "blur" !== e && (t ? n.initialized ? $m(n, e) : n._pendingNativeEvents ? n._pendingNativeEvents.push(e) : n._pendingNativeEvents = [e] : n.initialized && (n.dom.unbind(jm(n, e), e, n.delegates[e]), delete n.delegates[e])) }, unbindAllNativeEvents: function () { var e, t = this, n = t.getBody(), r = t.dom; if (t.delegates) { for (e in t.delegates) t.dom.unbind(jm(t, e), e, t.delegates[e]); delete t.delegates } !t.inline && n && r && (n.onload = null, r.unbind(t.getWin()), r.unbind(t.getDoc())), r && (r.unbind(n), r.unbind(t.getContainer())) } }, Km = Wm = Lt.extend({}, Vm, Wm), Xm = function (e, t, n) { try { e.getDoc().execCommand(t, !1, n) } catch (r) { } }, Ym = function (e, t) { var n, r, o; e._clickBlocker && (e._clickBlocker.unbind(), e._clickBlocker = null), t ? (e._clickBlocker = (r = (n = e).getBody(), o = function (e) { 0 < n.dom.getParents(e.target, "a").length && e.preventDefault() }, n.dom.bind(r, "click", o), { unbind: function () { n.dom.unbind(r, "click", o) } }), e.selection.controlSelection.hideResizeRect(), e.readonly = !0, e.getBody().contentEditable = !1) : (e.readonly = !1, e.getBody().contentEditable = !0, Xm(e, "StyleWithCSS", !1), Xm(e, "enableInlineTableEditing", !1), Xm(e, "enableObjectResizing", !1), e.focus(), e.nodeChanged()) }, Gm = function (e, t) { var n = e.readonly ? "readonly" : "design"; t !== n && (e.initialized ? Ym(e, "readonly" === t) : e.on("init", function () { Ym(e, "readonly" === t) }), e.fire("SwitchMode", { mode: t })) }, Jm = Lt.each, Qm = Lt.explode, Zm = { f9: 120, f10: 121, f11: 122 }, ep = Lt.makeMap("alt,ctrl,shift,meta,access"); function tp(i) { var a = {}, r = [], u = function (e) { var t, n, r = {}; for (n in Jm(Qm(e, "+"), function (e) { e in ep ? r[e] = !0 : /^[0-9]{2,}$/.test(e) ? r.keyCode = parseInt(e, 10) : (r.charCode = e.charCodeAt(0), r.keyCode = Zm[e] || e.toUpperCase().charCodeAt(0)) }), t = [r.keyCode], ep) r[n] ? t.push(n) : r[n] = !1; return r.id = t.join(","), r.access && (r.alt = !0, ge.mac ? r.ctrl = !0 : r.shift = !0), r.meta && (ge.mac ? r.meta = !0 : (r.ctrl = !0, r.meta = !1)), r }, s = function (e, t, n, r) { var o; return (o = Lt.map(Qm(e, ">"), u))[o.length - 1] = Lt.extend(o[o.length - 1], { func: n, scope: r || i }), Lt.extend(o[0], { desc: i.translate(t), subpatterns: o.slice(1) }) }, o = function (e, t) { return !!t && t.ctrl === e.ctrlKey && t.meta === e.metaKey && t.alt === e.altKey && t.shift === e.shiftKey && !!(e.keyCode === t.keyCode || e.charCode && e.charCode === t.charCode) && (e.preventDefault(), !0) }, c = function (e) { return e.func ? e.func.call(e.scope) : null }; i.on("keyup keypress keydown", function (t) { var e, n; ((n = t).altKey || n.ctrlKey || n.metaKey || "keydown" === (e = t).type && 112 <= e.keyCode && e.keyCode <= 123) && !t.isDefaultPrevented() && (Jm(a, function (e) { if (o(t, e)) return r = e.subpatterns.slice(0), "keydown" === t.type && c(e), !0 }), o(t, r[0]) && (1 === r.length && "keydown" === t.type && c(r[0]), r.shift())) }), this.add = function (e, n, r, o) { var t; return "string" == typeof (t = r) ? r = function () { i.execCommand(t, !1, null) } : Lt.isArray(t) && (r = function () { i.execCommand(t[0], t[1], t[2]) }), Jm(Qm(Lt.trim(e.toLowerCase())), function (e) { var t = s(e, n, r, o); a[t.id] = t }), !0 }, this.remove = function (e) { var t = s(e); return !!a[t.id] && (delete a[t.id], !0) } } var np = function (e) { var t = e !== undefined ? e.dom() : document; return A.from(t.activeElement).map(qn.fromDom) }, rp = function (e) { var t = qr.owner(e).dom(); return e.dom() === t.activeElement }, op = function (t) { return np(qr.owner(t)).filter(function (e) { return t.dom().contains(e.dom()) }) }, ip = function (t, e) { return (n = e, n.collapsed ? A.from(na(n.startContainer, n.startOffset)).map(qn.fromDom) : A.none()).bind(function (e) { return ho(e) ? A.some(e) : !1 === Or.contains(t, e) ? A.some(t) : A.none() }); var n }, ap = function (t, e) { ip(qn.fromDom(t.getBody()), e).bind(function (e) { return Ka.firstPositionIn(e.dom()) }).fold(function () { t.selection.normalize() }, function (e) { return t.selection.setRng(e.toRange()) }) }, up = function (e) { if (e.setActive) try { e.setActive() } catch (t) { e.focus() } else e.focus() }, sp = function (e) { var t, n = e.getBody(); return n && (t = qn.fromDom(n), rp(t) || op(t).isSome()) }, cp = function (e) { return e.inline ? sp(e) : (t = e).iframeElement && rp(qn.fromDom(t.iframeElement)); var t }, lp = function (e) { return e.editorManager.setActive(e) }, fp = function (e, t) { e.removed || (t ? lp(e) : function (t) { var e = t.selection, n = t.settings.content_editable, r = t.getBody(), o = e.getRng(); t.quirks.refreshContentEditable(); var i, a, u = (i = t, a = e.getNode(), i.dom.getParent(a, function (e) { return "true" === i.dom.getContentEditable(e) })); if (t.$.contains(r, u)) return up(u), ap(t, o), lp(t); t.bookmark !== undefined && !1 === cp(t) && _m.getRng(t).each(function (e) { t.selection.setRng(e), o = e }), n || (ge.opera || up(r), t.getWin().focus()), (ge.gecko || n) && (up(r), ap(t, o)), lp(t) }(e)) }, dp = cp, mp = function (e, t) { return t.dom()[e] }, pp = function (e, t) { return parseInt(yr(t, e), 10) }, gp = V.curry(mp, "clientWidth"), hp = V.curry(mp, "clientHeight"), vp = V.curry(pp, "margin-top"), yp = V.curry(pp, "margin-left"), bp = { isXYInContentArea: function (e, t, n) { var r, o, i, a, u, s, c, l, f, d, m = qn.fromDom(e.getBody()), p = e.inline ? m : qr.documentElement(m), g = (r = e.inline, i = t, a = n, u = (o = p).dom().getBoundingClientRect(), { x: i - (r ? u.left + o.dom().clientLeft + yp(o) : 0), y: a - (r ? u.top + o.dom().clientTop + vp(o) : 0) }); return c = g.x, l = g.y, f = gp(s = p), d = hp(s), 0 <= c && 0 <= l && c <= f && l <= d }, isEditorAttachedToDom: function (e) { var t, n = e.inline ? e.getBody() : e.getContentAreaContainer(); return (t = n, A.from(t).map(qn.fromDom)).map(function (e) { return Or.contains(qr.owner(e), e) }).getOr(!1) } }; function Cp(n) { var t, o = [], i = function () { var e, t = n.theme; return t && t.getNotificationManagerImpl ? t.getNotificationManagerImpl() : { open: e = function () { throw new Error("Theme did not provide a NotificationManager implementation.") }, close: e, reposition: e, getArgs: e } }, a = function () { 0 < o.length && i().reposition(o) }, u = function (t) { H.findIndex(o, function (e) { return e === t }).each(function (e) { o.splice(e, 1) }) }, r = function (r) { if (!n.removed && bp.isEditorAttachedToDom(n)) return H.find(o, function (e) { return t = i().getArgs(e), n = r, !(t.type !== n.type || t.text !== n.text || t.progressBar || t.timeout || n.progressBar || n.timeout); var t, n }).getOrThunk(function () { n.editorManager.setActive(n); var e, t = i().open(r, function () { u(t), a() }); return e = t, o.push(e), a(), t }) }; return (t = n).on("SkinLoaded", function () { var e = t.settings.service_message; e && r({ text: e, type: "warning", timeout: 0, icon: "" }) }), t.on("ResizeEditor ResizeWindow", function () { Ce.requestAnimationFrame(a) }), t.on("remove", function () { H.each(o, function (e) { i().close(e) }) }), { open: r, close: function () { A.from(o[0]).each(function (e) { i().close(e), u(e), a() }) }, getNotifications: function () { return o } } } function xp(r) { var o = [], i = function () { var e, t = r.theme; return t && t.getWindowManagerImpl ? t.getWindowManagerImpl() : { open: e = function () { throw new Error("Theme did not provide a WindowManager implementation.") }, alert: e, confirm: e, close: e, getParams: e, setParams: e } }, a = function (e, t) { return function () { return t ? t.apply(e, arguments) : undefined } }, u = function (e) { var t; o.push(e), t = e, r.fire("OpenWindow", { win: t }) }, s = function (n) { H.findIndex(o, function (e) { return e === n }).each(function (e) { var t; o.splice(e, 1), t = n, r.fire("CloseWindow", { win: t }), 0 === o.length && r.focus() }) }, e = function () { return A.from(o[o.length - 1]) }; return r.on("remove", function () { H.each(o.slice(0), function (e) { i().close(e) }) }), { windows: o, open: function (e, t) { r.editorManager.setActive(r), _m.store(r); var n = i().open(e, t, s); return u(n), n }, alert: function (e, t, n) { var r = i().alert(e, a(n || this, t), s); u(r) }, confirm: function (e, t, n) { var r = i().confirm(e, a(n || this, t), s); u(r) }, close: function () { e().each(function (e) { i().close(e), s(e) }) }, getParams: function () { return e().map(i().getParams).getOr(null) }, setParams: function (t) { e().each(function (e) { i().setParams(e, t) }) }, getWindows: function () { return o } } } var wp = Ci.PluginManager, Np = function (e, t) { var n = function (e, t) { for (var n in wp.urls) if (wp.urls[n] + "/plugin" + t + ".js" === e) return n; return null }(t, e.suffix); return n ? "Failed to load plugin: " + n + " from url " + t : "Failed to load plugin url: " + t }, Ep = function (e, t) { e.notificationManager.open({ type: "error", text: t }) }, Sp = function (e, t) { e._skinLoaded ? Ep(e, t) : e.on("SkinLoaded", function () { Ep(e, t) }) }, kp = { pluginLoadError: function (e, t) { Sp(e, Np(e, t)) }, uploadError: function (e, t) { Sp(e, "Failed to upload image: " + t) }, displayError: Sp, initError: function (e) { for (var t = [], n = 1; n < arguments.length; n++)t[n - 1] = arguments[n]; var r = window.console; r && (r.error ? r.error.apply(r, arguments) : r.log.apply(r, arguments)) } }, Tp = Ci.PluginManager, Ap = Ci.ThemeManager; function Rp() { return new (j.getOrDie("XMLHttpRequest")) } function Bp(u, s) { var r = {}, n = function (e, r, o, t) { var i, n; (i = new Rp).open("POST", s.url), i.withCredentials = s.credentials, i.upload.onprogress = function (e) { t(e.loaded / e.total * 100) }, i.onerror = function () { o("Image upload failed due to a XHR Transport error. Code: " + i.status) }, i.onload = function () { var e, t, n; i.status < 200 || 300 <= i.status ? o("HTTP Error: " + i.status) : (e = JSON.parse(i.responseText)) && "string" == typeof e.location ? r((t = s.basePath, n = e.location, t ? t.replace(/\/$/, "") + "/" + n.replace(/^\//, "") : n)) : o("Invalid JSON: " + i.responseText) }, (n = new FormData).append("file", e.blob(), e.filename()), i.send(n) }, c = function (e, t) { return { url: t, blobInfo: e, status: !0 } }, l = function (e, t) { return { url: "", blobInfo: e, status: !1, error: t } }, f = function (e, t) { Lt.each(r[e], function (e) { e(t) }), delete r[e] }, o = function (e, n) { return e = Lt.grep(e, function (e) { return !u.isUploaded(e.blobUri()) }), he.all(Lt.map(e, function (e) { return u.isPending(e.blobUri()) ? (t = e.blobUri(), new he(function (e) { r[t] = r[t] || [], r[t].push(e) })) : (o = e, i = s.handler, a = n, u.markPending(o.blobUri()), new he(function (t) { var n; try { var r = function () { n && n.close() }; i(o, function (e) { r(), u.markUploaded(o.blobUri(), e), f(o.blobUri(), c(o, e)), t(c(o, e)) }, function (e) { r(), u.removeFailed(o.blobUri()), f(o.blobUri(), l(o, e)), t(l(o, e)) }, function (e) { e < 0 || 100 < e || (n || (n = a()), n.progressBar.value(e)) }) } catch (e) { t(l(o, e.message)) } })); var o, i, a, t })) }; return s = Lt.extend({ credentials: !1, handler: n }, s), { upload: function (e, t) { return s.url || s.handler !== n ? o(e, t) : new he(function (e) { e([]) }) } } } function _p(e, t) { return new (j.getOrDie("Blob"))(e, t) } function Dp() { return new (j.getOrDie("FileReader")) } function Op(e) { return new (j.getOrDie("Uint8Array"))(e) } var Pp = function (e) { return j.getOrDie("atob")(e) }, Lp = function (e) { var t, n; return e = decodeURIComponent(e).split(","), (n = /data:([^;]+)/.exec(e[0])) && (t = n[1]), { type: t, data: e[1] } }, Ip = function (e) { return 0 === e.indexOf("blob:") ? (i = e, new he(function (e, t) { var n = function () { t("Cannot convert " + i + " to Blob. Resource might not exist or is inaccessible.") }; try { var r = new Rp; r.open("GET", i, !0), r.responseType = "blob", r.onload = function () { 200 === this.status ? e(this.response) : n() }, r.onerror = n, r.send() } catch (o) { n() } })) : 0 === e.indexOf("data:") ? (o = e, new he(function (e) { var t, n, r; o = Lp(o); try { t = Pp(o.data) } catch (Zx) { return void e(new _p([])) } for (n = new Op(t.length), r = 0; r < n.length; r++)n[r] = t.charCodeAt(r); e(new _p([n], { type: o.type })) })) : null; var i, o }, Mp = function (n) { return new he(function (e) { var t = new Dp; t.onloadend = function () { e(t.result) }, t.readAsDataURL(n) }) }, Fp = Lp, zp = 0, Up = function (e) { return (e || "blobid") + zp++ }, qp = function (n, r, o, t) { var i, a; 0 !== r.src.indexOf("blob:") ? (i = Fp(r.src).data, (a = n.findFirst(function (e) { return e.base64() === i })) ? o({ image: r, blobInfo: a }) : Ip(r.src).then(function (e) { a = n.create(Up(), e, i), n.add(a), o({ image: r, blobInfo: a }) }, function (e) { t(e) })) : (a = n.getByUri(r.src)) ? o({ image: r, blobInfo: a }) : Ip(r.src).then(function (t) { Mp(t).then(function (e) { i = Fp(e).data, a = n.create(Up(), t, i), n.add(a), o({ image: r, blobInfo: a }) }) }, function (e) { t(e) }) }, Vp = function (e) { return e ? e.getElementsByTagName("img") : [] }, Hp = 0, jp = { uuid: function (e) { return e + Hp++ + (t = function () { return Math.round(4294967295 * Math.random()).toString(36) }, "s" + (new Date).getTime().toString(36) + t() + t() + t()); var t } }; function $p(u) { var n, o, i, t, e, a, r, s, c, l, f = (n = [], o = ua.constant, i = function (e) { var t, n, r; if (!e.blob || !e.base64) throw new Error("blob and base64 representations of the image are required for BlobInfo to be created"); return t = e.id || jp.uuid("blobid"), n = e.name || t, { id: o(t), name: o(n), filename: o(n + "." + (r = e.blob.type, { "image/jpeg": "jpg", "image/jpg": "jpg", "image/gif": "gif", "image/png": "png" }[r.toLowerCase()] || "dat")), blob: o(e.blob), base64: o(e.base64), blobUri: o(e.blobUri || W.createObjectURL(e.blob)), uri: o(e.uri) } }, { create: function (e, t, n, r) { return i("object" == typeof e ? e : { id: e, name: r, blob: t, base64: n }) }, add: function (e) { t(e.id()) || n.push(e) }, get: t = function (t) { return e(function (e) { return e.id() === t }) }, getByUri: function (t) { return e(function (e) { return e.blobUri() === t }) }, findFirst: e = function (e) { return Bt.filter(n, e)[0] }, removeByUri: function (t) { n = Bt.filter(n, function (e) { return e.blobUri() !== t || (W.revokeObjectURL(e.blobUri()), !1) }) }, destroy: function () { Bt.each(n, function (e) { W.revokeObjectURL(e.blobUri()) }), n = [] } }), d = u.settings, m = (s = {}, c = function (e, t) { return { status: e, resultUri: t } }, { hasBlobUri: l = function (e) { return e in s }, getResultUri: function (e) { var t = s[e]; return t ? t.resultUri : null }, isPending: function (e) { return !!l(e) && 1 === s[e].status }, isUploaded: function (e) { return !!l(e) && 2 === s[e].status }, markPending: function (e) { s[e] = c(1, null) }, markUploaded: function (e, t) { s[e] = c(2, t) }, removeFailed: function (e) { delete s[e] }, destroy: function () { s = {} } }), p = function (t) { return function (e) { return u.selection ? t(e) : [] } }, g = function (e, t, n) { for (var r = 0; -1 !== (r = e.indexOf(t, r)) && (e = e.substring(0, r) + n + e.substr(r + t.length), r += n.length - t.length + 1), -1 !== r;); return e }, h = function (e, t, n) { return e = g(e, 'src="' + t + '"', 'src="' + n + '"'), e = g(e, 'data-mce-src="' + t + '"', 'data-mce-src="' + n + '"') }, v = function (t, n) { Bt.each(u.undoManager.data, function (e) { "fragmented" === e.type ? e.fragments = Bt.map(e.fragments, function (e) { return h(e, t, n) }) : e.content = h(e.content, t, n) }) }, y = function () { return u.notificationManager.open({ text: u.translate("Image uploading..."), type: "info", timeout: -1, progressBar: !0 }) }, b = function (e, t) { f.removeByUri(e.src), v(e.src, t), u.$(e).attr({ src: d.images_reuse_filename ? t + "?" + (new Date).getTime() : t, "data-mce-src": u.convertURL(t, "src") }) }, C = function (n) { return a || (a = Bp(m, { url: d.images_upload_url, basePath: d.images_upload_base_path, credentials: d.images_upload_credentials, handler: d.images_upload_handler })), N().then(p(function (r) { var e; return e = Bt.map(r, function (e) { return e.blobInfo }), a.upload(e, y).then(p(function (e) { var t = Bt.map(e, function (e, t) { var n = r[t].image; return e.status && !1 !== u.settings.images_replace_blob_uris ? b(n, e.url) : e.error && kp.uploadError(u, e.error), { element: n, status: e.status } }); return n && n(t), t })) })) }, x = function (e) { if (!1 !== d.automatic_uploads) return C(e) }, w = function (e) { return !d.images_dataimg_filter || d.images_dataimg_filter(e) }, N = function () { var o, i, a; return r || (o = m, i = f, a = {}, r = { findAll: function (e, n) { var t; n || (n = ua.constant(!0)), t = Bt.filter(Vp(e), function (e) { var t = e.src; return !!ge.fileApi && !e.hasAttribute("data-mce-bogus") && !e.hasAttribute("data-mce-placeholder") && !(!t || t === ge.transparentSrc) && (0 === t.indexOf("blob:") ? !o.isUploaded(t) : 0 === t.indexOf("data:") && n(e)) }); var r = Bt.map(t, function (n) { if (a[n.src]) return new he(function (t) { a[n.src].then(function (e) { if ("string" == typeof e) return e; t({ image: n, blobInfo: e.blobInfo }) }) }); var e = new he(function (e, t) { qp(i, n, e, t) }).then(function (e) { return delete a[e.image.src], e })["catch"](function (e) { return delete a[n.src], e }); return a[n.src] = e }); return he.all(r) } }), r.findAll(u.getBody(), w).then(p(function (e) { return e = Bt.filter(e, function (e) { return "string" != typeof e || (kp.displayError(u, e), !1) }), Bt.each(e, function (e) { v(e.image.src, e.blobInfo.blobUri()), e.image.src = e.blobInfo.blobUri(), e.image.removeAttribute("data-mce-src") }), e })) }, E = function (e) { return e.replace(/src="(blob:[^"]+)"/g, function (e, n) { var t = m.getResultUri(n); if (t) return 'src="' + t + '"'; var r = f.getByUri(n); return r || (r = Bt.reduce(u.editorManager.get(), function (e, t) { return e || t.editorUpload && t.editorUpload.blobCache.getByUri(n) }, null)), r ? 'src="data:' + r.blob().type + ";base64," + r.base64() + '"' : e }) }; return u.on("setContent", function () { !1 !== u.settings.automatic_uploads ? x() : N() }), u.on("RawSaveContent", function (e) { e.content = E(e.content) }), u.on("getContent", function (e) { e.source_view || "raw" === e.format || (e.content = E(e.content)) }), u.on("PostRender", function () { u.parser.addNodeFilter("img", function (e) { Bt.each(e, function (e) { var t = e.attr("src"); if (!f.getByUri(t)) { var n = m.getResultUri(t); n && e.attr("src", n) } }) }) }), { blobCache: f, uploadImages: C, uploadImagesAuto: x, scanForImages: N, destroy: function () { f.destroy(), m.destroy(), r = a = null } } } var Wp = function (e, t) { return e.hasOwnProperty(t.nodeName) }, Kp = function (e, t) { if (Ao.isText(t)) { if (0 === t.nodeValue.length) return !0; if (/^\s+$/.test(t.nodeValue) && (!t.nextSibling || Wp(e, t.nextSibling))) return !0 } return !1 }, Xp = function (e) { var t, n, r, o, i, a, u, s, c, l, f, d = e.settings, m = e.dom, p = e.selection, g = e.schema, h = g.getBlockElements(), v = p.getStart(), y = e.getBody(); if (f = d.forced_root_block, v && Ao.isElement(v) && f && (l = y.nodeName.toLowerCase(), g.isValidChild(l, f.toLowerCase()) && (b = h, C = y, x = v, !H.exists(Il(qn.fromDom(x), qn.fromDom(C)), function (e) { return Wp(b, e.dom()) })))) { var b, C, x, w, N; for (n = (t = p.getRng()).startContainer, r = t.startOffset, o = t.endContainer, i = t.endOffset, c = dp(e), v = y.firstChild; v;)if (w = h, N = v, Ao.isText(N) || Ao.isElement(N) && !Wp(w, N) && !Bc.isBookmarkNode(N)) { if (Kp(h, v)) { v = (u = v).nextSibling, m.remove(u); continue } a || (a = m.create(f, e.settings.forced_root_block_attrs), v.parentNode.insertBefore(a, v), s = !0), v = (u = v).nextSibling, a.appendChild(u) } else a = null, v = v.nextSibling; s && c && (t.setStart(n, r), t.setEnd(o, i), p.setRng(t), e.nodeChanged()) } }, Yp = function (e) { e.settings.forced_root_block && e.on("NodeChange", V.curry(Xp, e)) }; function Gp(i) { var r, o = []; "onselectionchange" in i.getDoc() || i.on("NodeChange Click MouseUp KeyUp Focus", function (e) { var t, n; n = { startContainer: (t = i.selection.getRng()).startContainer, startOffset: t.startOffset, endContainer: t.endContainer, endOffset: t.endOffset }, "nodechange" !== e.type && Gd.isEq(n, r) || i.fire("SelectionChange"), r = n }), i.on("contextmenu", function () { i.fire("SelectionChange") }), i.on("SelectionChange", function () { var e = i.selection.getStart(!0); !e || !ge.range && i.selection.isCollapsed() || !function (e) { var t, n; if ((n = i.$(e).parentsUntil(i.getBody()).add(e)).length === o.length) { for (t = n.length; 0 <= t && n[t] === o[t]; t--); if (-1 === t) return o = n, !0 } return o = n, !1 }(e) && i.dom.isChildOf(e, i.getBody()) && i.nodeChanged({ selectionChange: !0 }) }), i.on("MouseUp", function (e) { e.isDefaultPrevented() || ("IMG" === i.selection.getNode().nodeName ? Ce.setEditorTimeout(i, function () { i.nodeChanged() }) : i.nodeChanged()) }), this.nodeChanged = function (e) { var t, n, r, o = i.selection; i.initialized && o && !i.settings.disable_nodechange && !i.readonly && (r = i.getBody(), (t = o.getStart(!0) || r).ownerDocument === i.getDoc() && i.dom.isChildOf(t, r) || (t = r), n = [], i.dom.getParent(t, function (e) { if (e === r) return !0; n.push(e) }), (e = e || {}).element = t, e.parents = n, i.fire("NodeChange", e)) } } var Jp, Qp, Zp = function (e) { var t, n, r, o; return o = e.getBoundingClientRect(), n = (t = e.ownerDocument).documentElement, r = t.defaultView, { top: o.top + r.pageYOffset - n.clientTop, left: o.left + r.pageXOffset - n.clientLeft } }, eg = function (e, t) { return n = (u = e).inline ? Zp(u.getBody()) : { left: 0, top: 0 }, a = (i = e).getBody(), r = i.inline ? { left: a.scrollLeft, top: a.scrollTop } : { left: 0, top: 0 }, { pageX: (o = function (e, t) { if (t.target.ownerDocument !== e.getDoc()) { var n = Zp(e.getContentAreaContainer()), r = (i = (o = e).getBody(), a = o.getDoc().documentElement, u = { left: i.scrollLeft, top: i.scrollTop }, s = { left: i.scrollLeft || a.scrollLeft, top: i.scrollTop || a.scrollTop }, o.inline ? u : s); return { left: t.pageX - n.left + r.left, top: t.pageY - n.top + r.top } } var o, i, a, u, s; return { left: t.pageX, top: t.pageY } }(e, t)).left - n.left + r.left, pageY: o.top - n.top + r.top }; var n, r, o, i, a, u }, tg = Ao.isContentEditableFalse, ng = Ao.isContentEditableTrue, rg = function (e) { e && e.parentNode && e.parentNode.removeChild(e) }, og = function (u, s) { return function (e) { if (0 === e.button) { var t = Bt.find(s.dom.getParents(e.target), ua.or(tg, ng)); if (i = s.getBody(), tg(a = t) && a !== i) { var n = s.dom.getPos(t), r = s.getBody(), o = s.getDoc().documentElement; u.element = t, u.screenX = e.screenX, u.screenY = e.screenY, u.maxX = (s.inline ? r.scrollWidth : o.offsetWidth) - 2, u.maxY = (s.inline ? r.scrollHeight : o.offsetHeight) - 2, u.relX = e.pageX - n.x, u.relY = e.pageY - n.y, u.width = t.offsetWidth, u.height = t.offsetHeight, u.ghost = function (e, t, n, r) { var o = t.cloneNode(!0); e.dom.setStyles(o, { width: n, height: r }), e.dom.setAttrib(o, "data-mce-selected", null); var i = e.dom.create("div", { "class": "mce-drag-container", "data-mce-bogus": "all", unselectable: "on", contenteditable: "false" }); return e.dom.setStyles(i, { position: "absolute", opacity: .5, overflow: "hidden", border: 0, padding: 0, margin: 0, width: n, height: r }), e.dom.setStyles(o, { margin: 0, boxSizing: "border-box" }), i.appendChild(o), i }(s, t, u.width, u.height) } } var i, a } }, ig = function (l, f) { return function (e) { if (l.dragging && (s = (i = f).selection, c = s.getSel().getRangeAt(0).startContainer, a = 3 === c.nodeType ? c.parentNode : c, u = l.element, a !== u && !i.dom.isChildOf(a, u) && !tg(a))) { var t = (r = l.element, (o = r.cloneNode(!0)).removeAttribute("data-mce-selected"), o), n = f.fire("drop", { targetClone: t, clientX: e.clientX, clientY: e.clientY }); n.isDefaultPrevented() || (t = n.targetClone, f.undoManager.transact(function () { rg(l.element), f.insertContent(f.dom.getOuterHTML(t)), f._selectionOverrides.hideFakeCaret() })) } var r, o, i, a, u, s, c; ag(l) } }, ag = function (e) { e.dragging = !1, e.element = null, rg(e.ghost) }, ug = function (e) { var t, n, r, o, i, a, g, h, v, u, s, c = {}; t = di.DOM, a = document, n = og(c, e), g = c, h = e, v = Ce.throttle(function (e, t) { h._selectionOverrides.hideFakeCaret(), h.selection.placeCaretAt(e, t) }, 0), r = function (e) { var t, n, r, o, i, a, u, s, c, l, f, d, m = Math.max(Math.abs(e.screenX - g.screenX), Math.abs(e.screenY - g.screenY)); if (g.element && !g.dragging && 10 < m) { if (h.fire("dragstart", { target: g.element }).isDefaultPrevented()) return; g.dragging = !0, h.focus() } if (g.dragging) { var p = (f = g, { pageX: (d = eg(h, e)).pageX - f.relX, pageY: d.pageY + 5 }); c = g.ghost, l = h.getBody(), c.parentNode !== l && l.appendChild(c), t = g.ghost, n = p, r = g.width, o = g.height, i = g.maxX, a = g.maxY, s = u = 0, t.style.left = n.pageX + "px", t.style.top = n.pageY + "px", n.pageX + r > i && (u = n.pageX + r - i), n.pageY + o > a && (s = n.pageY + o - a), t.style.width = r - u + "px", t.style.height = o - s + "px", v(e.clientX, e.clientY) } }, o = ig(c, e), u = c, i = function () { ag(u), u.dragging && s.fire("dragend") }, (s = e).on("mousedown", n), e.on("mousemove", r), e.on("mouseup", o), t.bind(a, "mousemove", r), t.bind(a, "mouseup", i), e.on("remove", function () { t.unbind(a, "mousemove", r), t.unbind(a, "mouseup", i) }) }, sg = function (e) { var n; ug(e), (n = e).on("drop", function (e) { var t = "undefined" != typeof e.clientX ? n.getDoc().elementFromPoint(e.clientX, e.clientY) : null; (tg(t) || tg(n.dom.getContentEditableParent(t))) && e.preventDefault() }) }, cg = function (e) { return Bt.reduce(e, function (e, t) { return e.concat(function (t) { var e = function (e) { return Bt.map(e, function (e) { return (e = Gi(e)).node = t, e }) }; if (Ao.isElement(t)) return e(t.getClientRects()); if (Ao.isText(t)) { var n = t.ownerDocument.createRange(); return n.setStart(t, 0), n.setEnd(t, t.data.length), e(n.getClientRects()) } }(t)) }, []) }; (Qp = Jp || (Jp = {}))[Qp.Up = -1] = "Up", Qp[Qp.Down = 1] = "Down"; var lg = function (o, i, a, e, u, t) { var n, s, c = 0, l = [], r = function (e) { var t, n, r; for (r = cg([e]), -1 === o && (r = r.reverse()), t = 0; t < r.length; t++)if (n = r[t], !a(n, s)) { if (0 < l.length && i(n, Bt.last(l)) && c++ , n.line = c, u(n)) return !0; l.push(n) } }; return (s = Bt.last(t.getClientRects())) && (r(n = t.getNode()), function (e, t, n, r) { for (; r = ds(r, e, Xi, t);)if (n(r)) return }(o, e, r, n)), l }, fg = V.curry(lg, Jp.Up, Zi, ea), dg = V.curry(lg, Jp.Down, ea, Zi), mg = function (n) { return function (e) { return t = n, e.line > t; var t } }, pg = function (n) { return function (e) { return t = n, e.line === t; var t } }, gg = Ao.isContentEditableFalse, hg = ds, vg = function (e, t) { return Math.abs(e.left - t) }, yg = function (e, t) { return Math.abs(e.right - t) }, bg = function (e, t) { return e >= t.left && e <= t.right }, Cg = function (e, o) { return Bt.reduce(e, function (e, t) { var n, r; return n = Math.min(vg(e, o), yg(e, o)), r = Math.min(vg(t, o), yg(t, o)), bg(o, t) ? t : bg(o, e) ? e : r === n && gg(t.node) ? t : r < n ? t : e }) }, xg = function (e, t, n, r) { for (; r = hg(r, e, Xi, t);)if (n(r)) return }, wg = function (e, t, n) { var r, o, i, a, u, s, c, l, f = cg((o = e, Bt.filter(Bt.toArray(o.getElementsByTagName("*")), ts))), d = Bt.filter(f, function (e) { return n >= e.top && n <= e.bottom }); return (r = Cg(d, t)) && (r = Cg((u = e, l = function (t, e) { var n; return n = Bt.filter(cg([e]), function (e) { return !t(e, s) }), c = c.concat(n), 0 === n.length }, (c = []).push(s = r), xg(Jp.Up, u, V.curry(l, Zi), s.node), xg(Jp.Down, u, V.curry(l, ea), s.node), c), t)) && ts(r.node) ? (a = t, { node: (i = r).node, before: vg(i, a) < yg(i, a) }) : null }, Ng = function (i, a, e) { return !e.collapsed && H.foldl(e.getClientRects(), function (e, t) { return e || (o = a, (r = i) >= (n = t).left && r <= n.right && o >= n.top && o <= n.bottom); var n, r, o }, !1) }, Eg = function (t, n) { var r = null; return { cancel: function () { null !== r && (clearTimeout(r), r = null) }, throttle: function () { var e = arguments; null === r && (r = setTimeout(function () { t.apply(null, e), e = r = null }, n)) } } }, Sg = function (t) { var e = Eg(function () { if (!t.removed && t.selection.getRng().collapsed) { var e = Za(t, t.selection.getRng(), !1); t.selection.setRng(e) } }, 0); t.on("focus", function () { e.throttle() }), t.on("blur", function () { e.cancel() }) }, kg = { BACKSPACE: 8, DELETE: 46, DOWN: 40, ENTER: 13, LEFT: 37, RIGHT: 39, SPACEBAR: 32, TAB: 9, UP: 38, modifierPressed: function (e) { return e.shiftKey || e.ctrlKey || e.altKey || this.metaKeyPressed(e) }, metaKeyPressed: function (e) { return ge.mac ? e.metaKey : e.ctrlKey && !e.altKey } }, Tg = Ao.isContentEditableTrue, Ag = Ao.isContentEditableFalse, Rg = ks, Bg = Ss, _g = function (e, t) { for (var n = e.getBody(); t && t !== n;) { if (Tg(t) || Ag(t)) return t; t = t.parentNode } return null }, Dg = function (p) { var g, e, t, a = p.getBody(), o = es(p.getBody(), function (e) { return p.dom.isBlock(e) }, function () { return dp(p) }), h = "sel-" + p.dom.uniqueId(), u = function (e) { e && p.selection.setRng(e) }, s = function () { return p.selection.getRng() }, v = function (e, t, n, r) { return void 0 === r && (r = !0), p.fire("ShowCaret", { target: t, direction: e, before: n }).isDefaultPrevented() ? null : (r && p.selection.scrollIntoView(t, -1 === e), o.show(n, t)) }, y = function (e, t) { return t = Cs(e, a, t), -1 === e ? Ba.fromRangeStart(t) : Ba.fromRangeEnd(t) }, n = function (e) { return Bi(e) || Li(e) || Ii(e) }, b = function (e) { return n(e.startContainer) || n(e.endContainer) }, c = function (e, t) { var n, r, o, i, a, u, s, c, l, f, d = p.$, m = p.dom; if (!e) return null; if (e.collapsed) { if (!b(e)) if (!1 === t) { if (c = y(-1, e), ts(c.getNode(!0))) return v(-1, c.getNode(!0), !1, !1); if (ts(c.getNode())) return v(-1, c.getNode(), !c.isAtEnd(), !1) } else { if (c = y(1, e), ts(c.getNode())) return v(1, c.getNode(), !c.isAtEnd(), !1); if (ts(c.getNode(!0))) return v(1, c.getNode(!0), !1, !1) } return null } return i = e.startContainer, a = e.startOffset, u = e.endOffset, 3 === i.nodeType && 0 === a && Ag(i.parentNode) && (i = i.parentNode, a = m.nodeIndex(i), i = i.parentNode), 1 !== i.nodeType ? null : (u === a + 1 && (n = i.childNodes[a]), Ag(n) ? (l = f = n.cloneNode(!0), (s = p.fire("ObjectSelected", { target: n, targetClone: l })).isDefaultPrevented() ? null : (r = Cl(qn.fromDom(p.getBody()), "#" + h).fold(function () { return d([]) }, function (e) { return d([e.dom()]) }), l = s.targetClone, 0 === r.length && (r = d('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>').attr("id", h)).appendTo(p.getBody()), e = p.dom.createRng(), l === f && ge.ie ? (r.empty().append('<p style="font-size: 0" data-mce-bogus="all">\xa0</p>').append(l), e.setStartAfter(r[0].firstChild.firstChild), e.setEndAfter(l)) : (r.empty().append("\xa0").append(l).append("\xa0"), e.setStart(r[0].firstChild, 1), e.setEnd(r[0].lastChild, 0)), r.css({ top: m.getPos(n, p.getBody()).y }), r[0].focus(), (o = p.selection.getSel()).removeAllRanges(), o.addRange(e), H.each(fu(qn.fromDom(p.getBody()), "*[data-mce-selected]"), function (e) { cr.remove(e, "data-mce-selected") }), n.setAttribute("data-mce-selected", "1"), g = n, C(), e)) : null) }, l = function () { g && (g.removeAttribute("data-mce-selected"), Cl(qn.fromDom(p.getBody()), "#" + h).each(Ic.remove), g = null) }, C = function () { o.hide() }; return ge.ceFalse && (function () { p.on("mouseup", function (e) { var t = s(); t.collapsed && bp.isXYInContentArea(p, e.clientX, e.clientY) && u(Qa(p, t, !1)) }), p.on("click", function (e) { var t; (t = _g(p, e.target)) && (Ag(t) && (e.preventDefault(), p.focus()), Tg(t) && p.dom.isChildOf(t, p.selection.getNode()) && l()) }), p.on("blur NewBlock", function () { l() }), p.on("ResizeWindow FullscreenStateChanged", function () { return o.reposition() }); var n, r, i = function (e, t) { var n, r, o = p.dom.getParent(e, p.dom.isBlock), i = p.dom.getParent(t, p.dom.isBlock); return !(!o || !p.dom.isChildOf(o, i) || !1 !== Ag(_g(p, o))) || o && (n = o, r = i, !(p.dom.getParent(n, p.dom.isBlock) === p.dom.getParent(r, p.dom.isBlock))) && function (e) { var t = js(e); if (!e.firstChild) return !1; var n = Ba.before(e.firstChild), r = t.next(n); return r && !Bg(r) && !Rg(r) }(o) }; r = !1, (n = p).on("touchstart", function () { r = !1 }), n.on("touchmove", function () { r = !0 }), n.on("touchend", function (e) { var t = _g(n, e.target); Ag(t) && (r || (e.preventDefault(), c(Ja(n, t)))) }), p.on("mousedown", function (e) { var t, n = e.target; if ((n === a || "HTML" === n.nodeName || p.dom.isChildOf(n, a)) && !1 !== bp.isXYInContentArea(p, e.clientX, e.clientY)) if (t = _g(p, n)) Ag(t) ? (e.preventDefault(), c(Ja(p, t))) : (l(), Tg(t) && e.shiftKey || Ng(e.clientX, e.clientY, p.selection.getRng()) || p.selection.placeCaretAt(e.clientX, e.clientY)); else if (!1 === ts(n)) { l(), C(); var r = wg(a, e.clientX, e.clientY); if (r && !i(e.target, r.node)) { e.preventDefault(); var o = v(1, r.node, r.before, !1); p.getBody().focus(), u(o) } } }), p.on("keypress", function (e) { kg.modifierPressed(e) || (e.keyCode, Ag(p.selection.getNode()) && e.preventDefault()) }), p.on("getSelectionRange", function (e) { var t = e.range; if (g) { if (!g.parentNode) return void (g = null); (t = t.cloneRange()).selectNode(g), e.range = t } }), p.on("setSelectionRange", function (e) { var t; (t = c(e.range, e.forward)) && (e.range = t) }), p.on("AfterSetSelectionRange", function (e) { var t, n = e.range; b(n) || C(), t = n.startContainer.parentNode, p.dom.hasClass(t, "mce-offscreen-selection") || l() }), p.on("copy", function (e) { var t, n = e.clipboardData; if (!e.isDefaultPrevented() && e.clipboardData && !ge.ie) { var r = (t = p.dom.get(h)) ? t.getElementsByTagName("*")[0] : t; r && (e.preventDefault(), n.clearData(), n.setData("text/html", r.outerHTML), n.setData("text/plain", r.outerText)) } }), sg(p), Sg(p) }(), e = p.contentStyles, t = ".mce-content-body", e.push(o.getCss()), e.push(t + " .mce-offscreen-selection {position: absolute;left: -9999999999px;max-width: 1000000px;}" + t + " *[contentEditable=false] {cursor: default;}" + t + " *[contentEditable=true] {cursor: text;}")), { showCaret: v, showBlockCaretContainer: function (e) { e.hasAttribute("data-mce-caret") && (Mi(e), u(s()), p.selection.scrollIntoView(e[0])) }, hideFakeCaret: C, destroy: function () { o.destroy(), g = null } } }, Og = Lt.each, Pg = function (e) { return 0 === e.indexOf("data-") || 0 === e.indexOf("aria-") }, Lg = function (e) { return e.replace(/<!--|-->/g, "") }, Ig = function (e, t, n) { var r, o, i, a, u = 1; for (a = e.getShortEndedElements(), (i = /<([!?\/])?([A-Za-z0-9\-_\:\.]+)((?:\s+[^"\'>]+(?:(?:"[^"]*")|(?:\'[^\']*\')|[^>]*))*|\/|\s+)>/g).lastIndex = r = n; o = i.exec(t);) { if (r = i.lastIndex, "/" === o[1]) u--; else if (!o[1]) { if (o[2] in a) continue; u++ } if (0 === u) break } return r }; function Mg(z, U) { void 0 === U && (U = Zo()); var t = function () { }; !1 !== (z = z || {}).fix_self_closing && (z.fix_self_closing = !0), Og("comment cdata text start end pi doctype".split(" "), function (e) { e && (self[e] = z[e] || t) }); var q = z.comment ? z.comment : t, V = z.cdata ? z.cdata : t, H = z.text ? z.text : t, j = z.start ? z.start : t, $ = z.end ? z.end : t, W = z.pi ? z.pi : t, K = z.doctype ? z.doctype : t; return { parse: function (e) { var t, n, r, c, o, i, a, l, u, s, f, d, m, p, g, h, v, y, b, C, x, w, N, E, S, k, T, A, R, B = 0, _ = [], D = 0, O = Vo.decode, P = Lt.makeMap("src,href,data,background,formaction,poster"), L = /((java|vb)script|mhtml):/i, I = /^data:/i, M = function (e) { var t, n; for (t = _.length; t-- && _[t].name !== e;); if (0 <= t) { for (n = _.length - 1; t <= n; n--)(e = _[n]).valid && $(e.name); _.length = t } }, F = function (e, t, n, r, o) { var i, a; if (n = (t = t.toLowerCase()) in f ? t : O(n || r || o || ""), m && !l && !1 === Pg(t)) { if (!(i = y[t]) && b) { for (a = b.length; a-- && !(i = b[a]).pattern.test(t);); -1 === a && (i = null) } if (!i) return; if (i.validValues && !(n in i.validValues)) return } if (P[t] && !z.allow_script_urls) { var u = n.replace(/[\s\u0000-\u001F]+/g, ""); try { u = decodeURIComponent(u) } catch (s) { u = unescape(u) } if (L.test(u)) return; if (!z.allow_html_data_urls && I.test(u) && !/^data:image\//i.test(u)) return } l && (t in P || 0 === t.indexOf("on")) || (c.map[t] = n, c.push({ name: t, value: n })) }; for (S = new RegExp("<(?:(?:!--([\\w\\W]*?)--\x3e)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:!DOCTYPE([\\w\\W]*?)>)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)>)|(?:([A-Za-z][A-Za-z0-9\\-_\\:\\.]*)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>))", "g"), k = /([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:[^\"])*)\")|(?:\'((?:[^\'])*)\')|([^>\s]+)))?/g, s = U.getShortEndedElements(), E = z.self_closing_elements || U.getSelfClosingElements(), f = U.getBoolAttrs(), m = z.validate, u = z.remove_internals, R = z.fix_self_closing, T = U.getSpecialElements(), N = e + ">"; t = S.exec(N);) { if (B < t.index && H(O(e.substr(B, t.index - B))), n = t[6]) ":" === (n = n.toLowerCase()).charAt(0) && (n = n.substr(1)), M(n); else if (n = t[7]) { if (t.index + t[0].length > e.length) { H(O(e.substr(t.index))), B = t.index + t[0].length; continue } if (":" === (n = n.toLowerCase()).charAt(0) && (n = n.substr(1)), d = n in s, R && E[n] && 0 < _.length && _[_.length - 1].name === n && M(n), !m || (p = U.getElementRule(n))) { if (g = !0, m && (y = p.attributes, b = p.attributePatterns), (v = t[8]) ? ((l = -1 !== v.indexOf("data-mce-type")) && u && (g = !1), (c = []).map = {}, v.replace(k, F)) : (c = []).map = {}, m && !l) { if (C = p.attributesRequired, x = p.attributesDefault, w = p.attributesForced, p.removeEmptyAttrs && !c.length && (g = !1), w) for (o = w.length; o--;)a = (h = w[o]).name, "{$uid}" === (A = h.value) && (A = "mce_" + D++), c.map[a] = A, c.push({ name: a, value: A }); if (x) for (o = x.length; o--;)(a = (h = x[o]).name) in c.map || ("{$uid}" === (A = h.value) && (A = "mce_" + D++), c.map[a] = A, c.push({ name: a, value: A })); if (C) { for (o = C.length; o-- && !(C[o] in c.map);); -1 === o && (g = !1) } if (h = c.map["data-mce-bogus"]) { if ("all" === h) { B = Ig(U, e, S.lastIndex), S.lastIndex = B; continue } g = !1 } } g && j(n, c, d) } else g = !1; if (r = T[n]) { r.lastIndex = B = t.index + t[0].length, (t = r.exec(e)) ? (g && (i = e.substr(B, t.index - B)), B = t.index + t[0].length) : (i = e.substr(B), B = e.length), g && (0 < i.length && H(i, !0), $(n)), S.lastIndex = B; continue } d || (v && v.indexOf("/") === v.length - 1 ? g && $(n) : _.push({ name: n, valid: g })) } else (n = t[1]) ? (">" === n.charAt(0) && (n = " " + n), z.allow_conditional_comments || "[if" !== n.substr(0, 3).toLowerCase() || (n = " " + n), q(n)) : (n = t[2]) ? V(Lg(n)) : (n = t[3]) ? K(n) : (n = t[4]) && W(n, t[5]); B = t.index + t[0].length } for (B < e.length && H(O(e.substr(B))), o = _.length - 1; 0 <= o; o--)(n = _[o]).valid && $(n.name) } } } (Mg || (Mg = {})).findEndTag = Ig; var Fg = Mg, zg = function (e, t) { var n, r, o, i, a, u, s, c, l = t, f = /<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g, d = e.schema; for (u = e.getTempAttrs(), s = l, c = new RegExp(["\\s?(" + u.join("|") + ')="[^"]+"'].join("|"), "gi"), l = s.replace(c, ""), a = d.getShortEndedElements(); i = f.exec(l);)r = f.lastIndex, o = i[0].length, n = a[i[1]] ? r : Fg.findEndTag(d, l, r), l = l.substring(0, r - o) + l.substring(n), f.lastIndex = r - o; return Si(l) }, Ug = { trimExternal: zg, trimInternal: zg }, qg = 0, Vg = 2, Hg = 1, jg = function (p, g) { var e = p.length + g.length + 2, h = new Array(e), v = new Array(e), c = function (e, t, n, r, o) { var i = l(e, t, n, r); if (null === i || i.start === t && i.diag === t - r || i.end === e && i.diag === e - n) for (var a = e, u = n; a < t || u < r;)a < t && u < r && p[a] === g[u] ? (o.push([0, p[a]]), ++a, ++u) : r - n < t - e ? (o.push([2, p[a]]), ++a) : (o.push([1, g[u]]), ++u); else { c(e, i.start, n, i.start - i.diag, o); for (var s = i.start; s < i.end; ++s)o.push([0, p[s]]); c(i.end, t, i.end - i.diag, r, o) } }, y = function (e, t, n, r) { for (var o = e; o - t < r && o < n && p[o] === g[o - t];)++o; return { start: e, end: o, diag: t } }, l = function (e, t, n, r) { var o = t - e, i = r - n; if (0 === o || 0 === i) return null; var a, u, s, c, l, f = o - i, d = i + o, m = (d % 2 == 0 ? d : d + 1) / 2; for (h[1 + m] = e, v[1 + m] = t + 1, a = 0; a <= m; ++a) { for (u = -a; u <= a; u += 2) { for (s = u + m, u === -a || u !== a && h[s - 1] < h[s + 1] ? h[s] = h[s + 1] : h[s] = h[s - 1] + 1, l = (c = h[s]) - e + n - u; c < t && l < r && p[c] === g[l];)h[s] = ++c, ++l; if (f % 2 != 0 && f - a <= u && u <= f + a && v[s - f] <= h[s]) return y(v[s - f], u + e - n, t, r) } for (u = f - a; u <= f + a; u += 2) { for (s = u + m - f, u === f - a || u !== f + a && v[s + 1] <= v[s - 1] ? v[s] = v[s + 1] - 1 : v[s] = v[s - 1], l = (c = v[s] - 1) - e + n - u; e <= c && n <= l && p[c] === g[l];)v[s] = c-- , l--; if (f % 2 == 0 && -a <= u && u <= a && v[s] <= h[s + f]) return y(v[s], u + e - n, t, r) } } }, t = []; return c(0, p.length, 0, g.length, t), t }, $g = function (e) { return Ao.isElement(e) ? e.outerHTML : Ao.isText(e) ? Vo.encodeRaw(e.data, !1) : Ao.isComment(e) ? "\x3c!--" + e.data + "--\x3e" : "" }, Wg = function (e, t, n) { var r = function (e) { var t, n, r; for (r = document.createElement("div"), t = document.createDocumentFragment(), e && (r.innerHTML = e); n = r.firstChild;)t.appendChild(n); return t }(t); if (e.hasChildNodes() && n < e.childNodes.length) { var o = e.childNodes[n]; o.parentNode.insertBefore(r, o) } else e.appendChild(r) }, Kg = function (e) { return Bt.filter(Bt.map(e.childNodes, $g), function (e) { return 0 < e.length }) }, Xg = function (e, t) { var n, r, o, i = Bt.map(t.childNodes, $g); return n = jg(i, e), r = t, o = 0, Bt.each(n, function (e) { e[0] === qg ? o++ : e[0] === Hg ? (Wg(r, e[1], o), o++) : e[0] === Vg && function (e, t) { if (e.hasChildNodes() && t < e.childNodes.length) { var n = e.childNodes[t]; n.parentNode.removeChild(n) } }(r, o) }), t }, Yg = function (e, t) { var n = (t || document).createElement("div"); return n.innerHTML = e, qr.children(qn.fromDom(n)) }, Gg = function (e) { return e.dom().innerHTML }, Jg = Gg, Qg = function (e, t) { var n = qr.owner(e).dom(), r = qn.fromDom(n.createDocumentFragment()), o = Yg(t, n); Pc(r, o), Ic.empty(e), Fu.append(e, r) }, Zg = function (e) { return { type: "fragmented", fragments: e, content: "", bookmark: null, beforeBookmark: null } }, eh = function (e) { return { type: "complete", fragments: null, content: e, bookmark: null, beforeBookmark: null } }, th = function (e) { return "fragmented" === e.type ? e.fragments.join("") : e.content }, nh = function (e) { var t = qn.fromTag("body"); return Qg(t, th(e)), H.each(fu(t, "*[data-mce-bogus]"), Ic.unwrap), Jg(t) }, rh = { createFragmentedLevel: Zg, createCompleteLevel: eh, createFromEditor: function (n) { var e, t, r; return e = Kg(n.getBody()), -1 !== (t = (r = H.bind(e, function (e) { var t = Ug.trimInternal(n.serializer, e); return 0 < t.length ? [t] : [] })).join("")).indexOf("</iframe>") ? Zg(r) : eh(t) }, applyToEditor: function (e, t, n) { "fragmented" === t.type ? Xg(t.fragments, e.getBody()) : e.setContent(t.content, { format: "raw" }), e.selection.moveToBookmark(n ? t.beforeBookmark : t.bookmark) }, isEq: function (e, t) { return !(!e || !t) && (r = t, th(e) === th(r) || (n = t, nh(e) === nh(n))); var n, r } }; function oh(u) { var s, r, o = this, c = 0, l = [], t = 0, f = function () { return 0 === t }, i = function (e) { f() && (o.typing = e) }, d = function (e) { u.setDirty(e) }, a = function (e) { i(!1), o.add({}, e) }, n = function () { o.typing && (i(!1), o.add()) }; return u.on("init", function () { o.add() }), u.on("BeforeExecCommand", function (e) { var t = e.command; "Undo" !== t && "Redo" !== t && "mceRepaint" !== t && (n(), o.beforeChange()) }), u.on("ExecCommand", function (e) { var t = e.command; "Undo" !== t && "Redo" !== t && "mceRepaint" !== t && a(e) }), u.on("ObjectResizeStart Cut", function () { o.beforeChange() }), u.on("SaveContent ObjectResized blur", a), u.on("DragEnd", a), u.on("KeyUp", function (e) { var t = e.keyCode; e.isDefaultPrevented() || ((33 <= t && t <= 36 || 37 <= t && t <= 40 || 45 === t || e.ctrlKey) && (a(), u.nodeChanged()), 46 !== t && 8 !== t || u.nodeChanged(), r && o.typing && !1 === rh.isEq(rh.createFromEditor(u), l[0]) && (!1 === u.isDirty() && (d(!0), u.fire("change", { level: l[0], lastLevel: null })), u.fire("TypingUndo"), r = !1, u.nodeChanged())) }), u.on("KeyDown", function (e) { var t = e.keyCode; if (!e.isDefaultPrevented()) if (33 <= t && t <= 36 || 37 <= t && t <= 40 || 45 === t) o.typing && a(e); else { var n = e.ctrlKey && !e.altKey || e.metaKey; !(t < 16 || 20 < t) || 224 === t || 91 === t || o.typing || n || (o.beforeChange(), i(!0), o.add({}, e), r = !0) } }), u.on("MouseDown", function (e) { o.typing && a(e) }), u.on("input", function (e) { var t; e.inputType && ("insertReplacementText" === e.inputType || "insertText" === (t = e).inputType && null === t.data) && a(e) }), u.addShortcut("meta+z", "", "Undo"), u.addShortcut("meta+y,meta+shift+z", "", "Redo"), u.on("AddUndo Undo Redo ClearUndos", function (e) { e.isDefaultPrevented() || u.nodeChanged() }), o = { data: l, typing: !1, beforeChange: function () { f() && (s = bc.getUndoBookmark(u.selection)) }, add: function (e, t) { var n, r, o, i = u.settings; if (o = rh.createFromEditor(u), e = e || {}, e = Lt.extend(e, o), !1 === f() || u.removed) return null; if (r = l[c], u.fire("BeforeAddUndo", { level: e, lastLevel: r, originalEvent: t }).isDefaultPrevented()) return null; if (r && rh.isEq(r, e)) return null; if (l[c] && (l[c].beforeBookmark = s), i.custom_undo_redo_levels && l.length > i.custom_undo_redo_levels) { for (n = 0; n < l.length - 1; n++)l[n] = l[n + 1]; l.length-- , c = l.length } e.bookmark = bc.getUndoBookmark(u.selection), c < l.length - 1 && (l.length = c + 1), l.push(e), c = l.length - 1; var a = { level: e, lastLevel: r, originalEvent: t }; return u.fire("AddUndo", a), 0 < c && (d(!0), u.fire("change", a)), e }, undo: function () { var e; return o.typing && (o.add(), o.typing = !1, i(!1)), 0 < c && (e = l[--c], rh.applyToEditor(u, e, !0), d(!0), u.fire("undo", { level: e })), e }, redo: function () { var e; return c < l.length - 1 && (e = l[++c], rh.applyToEditor(u, e, !1), d(!0), u.fire("redo", { level: e })), e }, clear: function () { l = [], c = 0, o.typing = !1, o.data = l, u.fire("ClearUndos") }, hasUndo: function () { return 0 < c || o.typing && l[0] && !rh.isEq(rh.createFromEditor(u), l[0]) }, hasRedo: function () { return c < l.length - 1 && !o.typing }, transact: function (e) { return n(), o.beforeChange(), o.ignore(e), o.add() }, ignore: function (e) { try { t++ , e() } finally { t-- } }, extra: function (e, t) { var n, r; o.transact(e) && (r = l[c].bookmark, n = l[c - 1], rh.applyToEditor(u, n, !0), o.transact(t) && (l[c - 1].beforeBookmark = r)) } } } var ih, ah, uh = function (e) { return e && /^(IMG)$/.test(e.nodeName) }, sh = function (e) { return e && 3 === e.nodeType && /^([\t \r\n]+|)$/.test(e.nodeValue) }, ch = function (e, t, n) { return "color" !== n && "backgroundColor" !== n || (t = e.toHex(t)), "fontWeight" === n && 700 === t && (t = "bold"), "fontFamily" === n && (t = t.replace(/[\'\"]/g, "").replace(/,\s+/g, ",")), "" + t }, lh = { isInlineBlock: uh, moveStart: function (e, t, n) { var r, o, i, a = n.startOffset, u = n.startContainer; if ((n.startContainer !== n.endContainer || !uh(n.startContainer.childNodes[n.startOffset])) && 1 === u.nodeType) for (a < (i = u.childNodes).length ? r = new no(u = i[a], e.getParent(u, e.isBlock)) : (r = new no(u = i[i.length - 1], e.getParent(u, e.isBlock))).next(!0), o = r.current(); o; o = r.next())if (3 === o.nodeType && !sh(o)) return n.setStart(o, 0), void t.setRng(n) }, getNonWhiteSpaceSibling: function (e, t, n) { if (e) for (t = t ? "nextSibling" : "previousSibling", e = n ? e : e[t]; e; e = e[t])if (1 === e.nodeType || !sh(e)) return e }, isTextBlock: function (e, t) { return t.nodeType && (t = t.nodeName), !!e.schema.getTextBlockElements()[t.toLowerCase()] }, isValid: function (e, t, n) { return e.schema.isValidChild(t, n) }, isWhiteSpaceNode: sh, replaceVars: function (e, n) { return "string" != typeof e ? e = e(n) : n && (e = e.replace(/%(\w+)/g, function (e, t) { return n[t] || e })), e }, isEq: function (e, t) { return t = t || "", e = "" + ((e = e || "").nodeName || e), t = "" + (t.nodeName || t), e.toLowerCase() === t.toLowerCase() }, normalizeStyleValue: ch, getStyle: function (e, t, n) { return ch(e, e.getStyle(t, n), n) }, getTextDecoration: function (t, e) { var n; return t.getParent(e, function (e) { return (n = t.getStyle(e, "text-decoration")) && "none" !== n }), n }, getParents: function (e, t, n) { return e.getParents(t, n, e.getRoot()) } }, fh = Bc.isBookmarkNode, dh = lh.getParents, mh = lh.isWhiteSpaceNode, ph = lh.isTextBlock, gh = function (e, t) { for (void 0 === t && (t = 3 === e.nodeType ? e.length : e.childNodes.length); e && e.hasChildNodes();)(e = e.childNodes[t]) && (t = 3 === e.nodeType ? e.length : e.childNodes.length); return { node: e, offset: t } }, hh = function (e, t) { for (var n = t; n;) { if (1 === n.nodeType && e.getContentEditable(n)) return "false" === e.getContentEditable(n) ? n : t; n = n.parentNode } return t }, vh = function (e, t, n, r) { var o, i, a = n.nodeValue; return void 0 === r && (r = e ? a.length : 0), e ? (o = a.lastIndexOf(" ", r), -1 === (o = (i = a.lastIndexOf("\xa0", r)) < o ? o : i) || t || o++) : (o = a.indexOf(" ", r), i = a.indexOf("\xa0", r), o = -1 !== o && (-1 === i || o < i) ? o : i), o }, yh = function (e, t, n, r, o, i) { var a, u, s, c; if (3 === n.nodeType) { if (-1 !== (s = vh(o, i, n, r))) return { container: n, offset: s }; c = n } for (a = new no(n, e.getParent(n, e.isBlock) || t); u = a[o ? "prev" : "next"]();)if (3 === u.nodeType) { if (-1 !== (s = vh(o, i, c = u))) return { container: u, offset: s } } else if (e.isBlock(u)) break; if (c) return { container: c, offset: r = o ? 0 : c.length } }, bh = function (e, t, n, r, o) { var i, a, u, s; for (3 === r.nodeType && 0 === r.nodeValue.length && r[o] && (r = r[o]), i = dh(e, r), a = 0; a < i.length; a++)for (u = 0; u < t.length; u++)if (!("collapsed" in (s = t[u]) && s.collapsed !== n.collapsed) && e.is(i[a], s.selector)) return i[a]; return r }, Ch = function (t, e, n, r) { var o, i = t.dom, a = i.getRoot(); if (e[0].wrapper || (o = i.getParent(n, e[0].block, a)), !o) { var u = i.getParent(n, "LI,TD,TH"); o = i.getParent(3 === n.nodeType ? n.parentNode : n, function (e) { return e !== a && ph(t, e) }, u) } if (o && e[0].wrapper && (o = dh(i, o, "ul,ol").reverse()[0] || o), !o) for (o = n; o[r] && !i.isBlock(o[r]) && (o = o[r], !lh.isEq(o, "br"));); return o || n }, xh = function (e, t, n, r, o, i, a) { var u, s, c, l, f, d; if (u = s = a ? n : o, l = a ? "previousSibling" : "nextSibling", f = e.getRoot(), 3 === u.nodeType && !mh(u) && (a ? 0 < r : i < u.nodeValue.length)) return u; for (; ;) { if (!t[0].block_expand && e.isBlock(s)) return s; for (c = s[l]; c; c = c[l])if (!fh(c) && !mh(c) && ("BR" !== (d = c).nodeName || !d.getAttribute("data-mce-bogus") || d.nextSibling)) return s; if (s === f || s.parentNode === f) { u = s; break } s = s.parentNode } return u }, wh = function (e, t, n, r) { var o, i = t.startContainer, a = t.startOffset, u = t.endContainer, s = t.endOffset, c = e.dom; return 1 === i.nodeType && i.hasChildNodes() && 3 === (i = na(i, a)).nodeType && (a = 0), 1 === u.nodeType && u.hasChildNodes() && 3 === (u = na(u, t.collapsed ? s : s - 1)).nodeType && (s = u.nodeValue.length), i = hh(c, i), u = hh(c, u), (fh(i.parentNode) || fh(i)) && 3 === (i = (i = fh(i) ? i : i.parentNode).nextSibling || i).nodeType && (a = 0), (fh(u.parentNode) || fh(u)) && 3 === (u = (u = fh(u) ? u : u.parentNode).previousSibling || u).nodeType && (s = u.length), n[0].inline && (t.collapsed && ((o = yh(c, e.getBody(), i, a, !0, r)) && (i = o.container, a = o.offset), (o = yh(c, e.getBody(), u, s, !1, r)) && (u = o.container, s = o.offset)), u = r ? u : function (e, t) { var n = gh(e, t); if (n.node) { for (; n.node && 0 === n.offset && n.node.previousSibling;)n = gh(n.node.previousSibling); n.node && 0 < n.offset && 3 === n.node.nodeType && " " === n.node.nodeValue.charAt(n.offset - 1) && 1 < n.offset && (e = n.node).splitText(n.offset - 1) } return e }(u, s)), (n[0].inline || n[0].block_expand) && (n[0].inline && 3 === i.nodeType && 0 !== a || (i = xh(c, n, i, a, u, s, !0)), n[0].inline && 3 === u.nodeType && s !== u.nodeValue.length || (u = xh(c, n, i, a, u, s, !1))), n[0].selector && !1 !== n[0].expand && !n[0].inline && (i = bh(c, n, t, i, "previousSibling"), u = bh(c, n, t, u, "nextSibling")), (n[0].block || n[0].selector) && (i = Ch(e, n, i, "previousSibling"), u = Ch(e, n, u, "nextSibling"), n[0].block && (c.isBlock(i) || (i = xh(c, n, i, a, u, s, !0)), c.isBlock(u) || (u = xh(c, n, i, a, u, s, !1)))), 1 === i.nodeType && (a = c.nodeIndex(i), i = i.parentNode), 1 === u.nodeType && (s = c.nodeIndex(u) + 1, u = u.parentNode), { startContainer: i, startOffset: a, endContainer: u, endOffset: s } }, Nh = lh.isEq, Eh = function (e, t, n) { var r = e.formatter.get(n); if (r) for (var o = 0; o < r.length; o++)if (!1 === r[o].inherit && e.dom.is(t, r[o].selector)) return !0; return !1 }, Sh = function (t, e, n, r) { var o = t.dom.getRoot(); return e !== o && (e = t.dom.getParent(e, function (e) { return !!Eh(t, e, n) || e.parentNode === o || !!Ah(t, e, n, r, !0) }), Ah(t, e, n, r)) }, kh = function (e, t, n) { return !!Nh(t, n.inline) || !!Nh(t, n.block) || (n.selector ? 1 === t.nodeType && e.is(t, n.selector) : void 0) }, Th = function (e, t, n, r, o, i) { var a, u, s, c = n[r]; if (n.onmatch) return n.onmatch(t, n, r); if (c) if ("undefined" == typeof c.length) { for (a in c) if (c.hasOwnProperty(a)) { if (u = "attributes" === r ? e.getAttrib(t, a) : lh.getStyle(e, t, a), o && !u && !n.exact) return; if ((!o || n.exact) && !Nh(u, lh.normalizeStyleValue(e, lh.replaceVars(c[a], i), a))) return } } else for (s = 0; s < c.length; s++)if ("attributes" === r ? e.getAttrib(t, c[s]) : lh.getStyle(e, t, c[s])) return n; return n }, Ah = function (e, t, n, r, o) { var i, a, u, s, c = e.formatter.get(n), l = e.dom; if (c && t) for (a = 0; a < c.length; a++)if (i = c[a], kh(e.dom, t, i) && Th(l, t, i, "attributes", o, r) && Th(l, t, i, "styles", o, r)) { if (s = i.classes) for (u = 0; u < s.length; u++)if (!e.dom.hasClass(t, s[u])) return; return i } }, Rh = { matchNode: Ah, matchName: kh, match: function (e, t, n, r) { var o; return r ? Sh(e, r, t, n) : (r = e.selection.getNode(), !!Sh(e, r, t, n) || !((o = e.selection.getStart()) === r || !Sh(e, o, t, n))) }, matchAll: function (r, o, i) { var e, a = [], u = {}; return e = r.selection.getStart(), r.dom.getParent(e, function (e) { var t, n; for (t = 0; t < o.length; t++)n = o[t], !u[n] && Ah(r, e, n, i) && (u[n] = !0, a.push(n)) }, r.dom.getRoot()), a }, canApply: function (e, t) { var n, r, o, i, a, u = e.formatter.get(t), s = e.dom; if (u) for (n = e.selection.getStart(), r = lh.getParents(s, n), i = u.length - 1; 0 <= i; i--) { if (!(a = u[i].selector) || u[i].defaultBlock) return !0; for (o = r.length - 1; 0 <= o; o--)if (s.is(r[o], a)) return !0 } return !1 }, matchesUnInheritedFormatSelector: Eh }, Bh = function (e, t) { return e.splitText(t) }, _h = { split: function (e) { var t = e.startContainer, n = e.startOffset, r = e.endContainer, o = e.endOffset; return t === r && Ao.isText(t) ? 0 < n && n < t.nodeValue.length && (t = (r = Bh(t, n)).previousSibling, n < o ? (t = r = Bh(r, o -= n).previousSibling, o = r.nodeValue.length, n = 0) : o = 0) : (Ao.isText(t) && 0 < n && n < t.nodeValue.length && (t = Bh(t, n), n = 0), Ao.isText(r) && 0 < o && o < r.nodeValue.length && (o = (r = Bh(r, o).previousSibling).nodeValue.length)), { startContainer: t, startOffset: n, endContainer: r, endOffset: o } } }, Dh = Ei, Oh = "_mce_caret", Ph = function (e) { return 0 < function (e) { for (var t = []; e;) { if (3 === e.nodeType && e.nodeValue !== Dh || 1 < e.childNodes.length) return []; 1 === e.nodeType && t.push(e), e = e.firstChild } return t }(e).length }, Lh = function (e) { var t; if (e) for (e = (t = new no(e, e)).current(); e; e = t.next())if (3 === e.nodeType) return e; return null }, Ih = function (e) { var t = qn.fromTag("span"); return cr.setAll(t, { id: Oh, "data-mce-bogus": "1", "data-mce-type": "format-caret" }), e && Fu.append(t, qn.fromText(Dh)), t }, Mh = function (e, t, n, r) { var o, i, a, u; o = t.getRng(!0), i = e.getParent(n, e.isBlock), Ph(n) ? (!1 !== r && (o.setStartBefore(n), o.setEndBefore(n)), e.remove(n)) : ((u = Lh(n)) && u.nodeValue.charAt(0) === Dh && u.deleteData(0, 1), a = u, o.startContainer === a && 0 < o.startOffset && o.setStart(a, o.startOffset - 1), o.endContainer === a && 0 < o.endOffset && o.setEnd(a, o.endOffset - 1), e.remove(n, !0)), i && e.isEmpty(i) && Uc(qn.fromDom(i)), t.setRng(o) }, Fh = function (e, t, n, r, o) { if (r) Mh(t, n, r, o); else if (!(r = wc(e, n.getStart()))) for (; r = t.get(Oh);)Mh(t, n, r, !1) }, zh = function (e, t, n) { var r = e.dom, o = r.getParent(n, ua.curry(lh.isTextBlock, e)); o && r.isEmpty(o) ? n.parentNode.replaceChild(t, n) : (zc(qn.fromDom(n)), r.isEmpty(n) ? n.parentNode.replaceChild(t, n) : r.insertAfter(t, n)) }, Uh = function (e, t) { return e.appendChild(t), t }, qh = function (e, t) { var n = H.foldr(e, function (e, t) { return Uh(e, t.cloneNode(!1)) }, t); return Uh(n, n.ownerDocument.createTextNode(Dh)) }, Vh = function (e) { var i = e.dom, a = e.selection, u = e.getBody(); e.on("mouseup keydown", function (e) { var t, n, r, o; t = u, n = i, r = a, o = e.keyCode, Fh(t, n, r, null, !1), 8 === o && r.isCollapsed() && r.getStart().innerHTML === Dh && Fh(t, n, r, wc(t, r.getStart())), 37 !== o && 39 !== o || Fh(t, n, r, wc(t, r.getStart())) }) }, Hh = function (e, t) { return e.schema.getTextInlineElements().hasOwnProperty(Qn.name(t)) && !xc(t.dom()) && !Ao.isBogus(t.dom()) }, jh = {}, $h = Bt.filter, Wh = Bt.each; ah = function (e) { var t, n, r = e.selection.getRng(); t = Ao.matchNodeNames("pre"), r.collapsed || (n = e.selection.getSelectedBlocks(), Wh($h($h(n, t), function (e) { return t(e.previousSibling) && -1 !== Bt.indexOf(n, e.previousSibling) }), function (e) { var t, n; t = e.previousSibling, en(n = e).remove(), en(t).append("<br><br>").append(n.childNodes) })) }, jh[ih = "pre"] || (jh[ih] = []), jh[ih].push(ah); var Kh = function (e, t) { Wh(jh[e], function (e) { e(t) }) }, Xh = Lt.each, Yh = { walk: function (e, t, o) { var n, r, i, a, u, s, c, l = t.startContainer, f = t.startOffset, d = t.endContainer, m = t.endOffset; if (0 < (c = e.select("td[data-mce-selected],th[data-mce-selected]")).length) Xh(c, function (e) { o([e]) }); else { var p, g, h, v = function (e) { var t; return 3 === (t = e[0]).nodeType && t === l && f >= t.nodeValue.length && e.splice(0, 1), t = e[e.length - 1], 0 === m && 0 < e.length && t === d && 3 === t.nodeType && e.splice(e.length - 1, 1), e }, y = function (e, t, n) { for (var r = []; e && e !== n; e = e[t])r.push(e); return r }, b = function (e, t) { do { if (e.parentNode === t) return e; e = e.parentNode } while (e) }, C = function (e, t, n) { var r = n ? "nextSibling" : "previousSibling"; for (u = (a = e).parentNode; a && a !== t; a = u)u = a.parentNode, (s = y(a === e ? a : a[r], r)).length && (n || s.reverse(), o(v(s))) }; if (1 === l.nodeType && l.hasChildNodes() && (l = l.childNodes[f]), 1 === d.nodeType && d.hasChildNodes() && (g = m, h = (p = d).childNodes, --g > h.length - 1 ? g = h.length - 1 : g < 0 && (g = 0), d = h[g] || p), l === d) return o(v([l])); for (n = e.findCommonAncestor(l, d), a = l; a; a = a.parentNode) { if (a === d) return C(l, n, !0); if (a === n) break } for (a = d; a; a = a.parentNode) { if (a === l) return C(d, n); if (a === n) break } r = b(l, n) || l, i = b(d, n) || d, C(l, r, !0), (s = y(r === l ? r : r.nextSibling, "nextSibling", i === d ? i.nextSibling : i)).length && o(v(s)), C(d, i) } } }, Gh = /^(src|href|style)$/, Jh = Lt.each, Qh = lh.isEq, Zh = function (e) { return /^(TH|TD)$/.test(e.nodeName) }, ev = function (e, t, n) { var r, o, i; return r = t[n ? "startContainer" : "endContainer"], o = t[n ? "startOffset" : "endOffset"], Ao.isElement(r) && (i = r.childNodes.length - 1, !n && o && o-- , r = r.childNodes[i < o ? i : o]), Ao.isText(r) && n && o >= r.nodeValue.length && (r = new no(r, e.getBody()).next() || r), Ao.isText(r) && !n && 0 === o && (r = new no(r, e.getBody()).prev() || r), r }, tv = function (e, t, n, r) { var o = e.create(n, r); return t.parentNode.insertBefore(o, t), o.appendChild(t), o }, nv = function (e, t, n, r) { return !(t = lh.getNonWhiteSpaceSibling(t, n, r)) || "BR" === t.nodeName || e.isBlock(t) }, rv = function (e, n, r, o, i) { var t, a, u, s, c, l, f, d, m, p, g, h, v, y, b = e.dom; if (c = b, !(Qh(l = o, (f = n).inline) || Qh(l, f.block) || (f.selector ? Ao.isElement(l) && c.is(l, f.selector) : void 0) || (s = o, n.links && "A" === s.tagName))) return !1; if ("all" !== n.remove) for (Jh(n.styles, function (e, t) { e = lh.normalizeStyleValue(b, lh.replaceVars(e, r), t), "number" == typeof t && (t = e, i = 0), (n.remove_similar || !i || Qh(lh.getStyle(b, i, t), e)) && b.setStyle(o, t, ""), u = 1 }), u && "" === b.getAttrib(o, "style") && (o.removeAttribute("style"), o.removeAttribute("data-mce-style")), Jh(n.attributes, function (e, t) { var n; if (e = lh.replaceVars(e, r), "number" == typeof t && (t = e, i = 0), !i || Qh(b.getAttrib(i, t), e)) { if ("class" === t && (e = b.getAttrib(o, t)) && (n = "", Jh(e.split(/\s+/), function (e) { /mce\-\w+/.test(e) && (n += (n ? " " : "") + e) }), n)) return void b.setAttrib(o, t, n); "class" === t && o.removeAttribute("className"), Gh.test(t) && o.removeAttribute("data-mce-" + t), o.removeAttribute(t) } }), Jh(n.classes, function (e) { e = lh.replaceVars(e, r), i && !b.hasClass(i, e) || b.removeClass(o, e) }), a = b.getAttribs(o), t = 0; t < a.length; t++) { var C = a[t].nodeName; if (0 !== C.indexOf("_") && 0 !== C.indexOf("data-")) return !1 } return "none" !== n.remove ? (d = e, p = n, h = (m = o).parentNode, v = d.dom, y = d.settings.forced_root_block, p.block && (y ? h === v.getRoot() && (p.list_block && Qh(m, p.list_block) || Jh(Lt.grep(m.childNodes), function (e) { lh.isValid(d, y, e.nodeName.toLowerCase()) ? g ? g.appendChild(e) : (g = tv(v, e, y), v.setAttribs(g, d.settings.forced_root_block_attrs)) : g = 0 })) : v.isBlock(m) && !v.isBlock(h) && (nv(v, m, !1) || nv(v, m.firstChild, !0, 1) || m.insertBefore(v.create("br"), m.firstChild), nv(v, m, !0) || nv(v, m.lastChild, !1, 1) || m.appendChild(v.create("br")))), p.selector && p.inline && !Qh(p.inline, m) || v.remove(m, 1), !0) : void 0 }, ov = { removeFormat: rv, remove: function (s, c, l, e, f) { var t, n, d = s.formatter.get(c), m = d[0], a = !0, u = s.dom, r = s.selection, o = function (e) { var n, t, r, o, i, a, u = (n = s, t = e, r = c, o = l, i = f, Jh(lh.getParents(n.dom, t.parentNode).reverse(), function (e) { var t; a || "_start" === e.id || "_end" === e.id || (t = Rh.matchNode(n, e, r, o, i)) && !1 !== t.split && (a = e) }), a); return function (e, t, n, r, o, i, a, u) { var s, c, l, f, d, m, p = e.dom; if (n) { for (m = n.parentNode, s = r.parentNode; s && s !== m; s = s.parentNode) { for (c = p.clone(s, !1), d = 0; d < t.length; d++)if (rv(e, t[d], u, c, c)) { c = 0; break } c && (l && c.appendChild(l), f || (f = c), l = c) } !i || a.mixed && p.isBlock(n) || (r = p.split(n, r)), l && (o.parentNode.insertBefore(l, o), f.appendChild(o)) } return r }(s, d, u, e, e, !0, m, l) }, p = function (e) { var t, n, r, o, i; if (Ao.isElement(e) && u.getContentEditable(e) && (o = a, a = "true" === u.getContentEditable(e), i = !0), t = Lt.grep(e.childNodes), a && !i) for (n = 0, r = d.length; n < r && !rv(s, d[n], l, e, e); n++); if (m.deep && t.length) { for (n = 0, r = t.length; n < r; n++)p(t[n]); i && (a = o) } }, i = function (e) { var t = u.get(e ? "_start" : "_end"), n = t[e ? "firstChild" : "lastChild"]; return Bc.isBookmarkNode(n) && (n = n[e ? "firstChild" : "lastChild"]), Ao.isText(n) && 0 === n.data.length && (n = e ? t.previousSibling || t.nextSibling : t.nextSibling || t.previousSibling), u.remove(t, !0), n }, g = function (e) { var t, n, r = e.commonAncestorContainer; if (e = wh(s, e, d, !0), m.split) { if ((t = ev(s, e, !0)) !== (n = ev(s, e))) { if (/^(TR|TH|TD)$/.test(t.nodeName) && t.firstChild && (t = "TR" === t.nodeName ? t.firstChild.firstChild || t : t.firstChild || t), r && /^T(HEAD|BODY|FOOT|R)$/.test(r.nodeName) && Zh(n) && n.firstChild && (n = n.firstChild || n), u.isChildOf(t, n) && t !== n && !u.isBlock(n) && !Zh(t) && !Zh(n)) return t = tv(u, t, "span", { id: "_start", "data-mce-type": "bookmark" }), o(t), void (t = i(!0)); t = tv(u, t, "span", { id: "_start", "data-mce-type": "bookmark" }), n = tv(u, n, "span", { id: "_end", "data-mce-type": "bookmark" }), o(t), o(n), t = i(!0), n = i() } else t = n = o(t); e.startContainer = t.parentNode ? t.parentNode : t, e.startOffset = u.nodeIndex(t), e.endContainer = n.parentNode ? n.parentNode : n, e.endOffset = u.nodeIndex(n) + 1 } Yh.walk(u, e, function (e) { Jh(e, function (e) { p(e), Ao.isElement(e) && "underline" === s.dom.getStyle(e, "text-decoration") && e.parentNode && "underline" === lh.getTextDecoration(u, e.parentNode) && rv(s, { deep: !1, exact: !0, inline: "span", styles: { textDecoration: "underline" } }, null, e) }) }) }; if (e) e.nodeType ? ((n = u.createRng()).setStartBefore(e), n.setEndAfter(e), g(n)) : g(e); else if ("false" !== u.getContentEditable(r.getNode())) r.isCollapsed() && m.inline && !u.select("td[data-mce-selected],th[data-mce-selected]").length ? function (e, t, n, r) { var o, i, a, u, s, c, l, f = e.dom, d = e.selection, m = [], p = d.getRng(); for (o = p.startContainer, i = p.startOffset, 3 === (s = o).nodeType && (i !== o.nodeValue.length && (u = !0), s = s.parentNode); s;) { if (Rh.matchNode(e, s, t, n, r)) { c = s; break } s.nextSibling && (u = !0), m.push(s), s = s.parentNode } if (c) if (u) { a = d.getBookmark(), p.collapse(!0); var g = wh(e, p, e.formatter.get(t), !0); g = _h.split(g), e.formatter.remove(t, n, g), d.moveToBookmark(a) } else { l = wc(e.getBody(), c); var h = Ih(!1).dom(), v = qh(m, h); zh(e, h, l || c), Mh(f, d, l, !1), d.setCursorLocation(v, 1), f.isEmpty(c) && f.remove(c) } }(s, c, l, f) : (t = bc.getPersistentBookmark(s.selection, !0), g(r.getRng()), r.moveToBookmark(t), m.inline && Rh.match(s, c, l, r.getStart()) && lh.moveStart(u, r, r.getRng()), s.nodeChanged()); else { e = r.getNode(); for (var h = 0, v = d.length; h < v && (!d[h].ceFalseOverride || !rv(s, d[h], l, e, e)); h++); } } }, iv = Lt.each, av = function (e) { return e && 1 === e.nodeType && !Bc.isBookmarkNode(e) && !xc(e) && !Ao.isBogus(e) }, uv = function (e, t) { var n; for (n = e; n; n = n[t]) { if (3 === n.nodeType && 0 !== n.nodeValue.length) return e; if (1 === n.nodeType && !Bc.isBookmarkNode(n)) return n } return e }, sv = function (e, t, n) { var r, o, i = new Dc(e); if (t && n && (t = uv(t, "previousSibling"), n = uv(n, "nextSibling"), i.compare(t, n))) { for (r = t.nextSibling; r && r !== n;)r = (o = r).nextSibling, t.appendChild(o); return e.remove(n), Lt.each(Lt.grep(n.childNodes), function (e) { t.appendChild(e) }), t } return n }, cv = function (e, t, n) { iv(e.childNodes, function (e) { av(e) && (t(e) && n(e), e.hasChildNodes() && cv(e, t, n)) }) }, lv = function (n, e) { return V.curry(function (e, t) { return !(!t || !lh.getStyle(n, t, e)) }, e) }, fv = function (r, e, t) { return V.curry(function (e, t, n) { r.setStyle(n, e, t), "" === n.getAttribute("style") && n.removeAttribute("style"), dv(r, n) }, e, t) }, dv = function (e, t) { "SPAN" === t.nodeName && 0 === e.getAttribs(t).length && e.remove(t, !0) }, mv = function (e, t) { var n; 1 === t.nodeType && t.parentNode && 1 === t.parentNode.nodeType && (n = lh.getTextDecoration(e, t.parentNode), e.getStyle(t, "color") && n ? e.setStyle(t, "text-decoration", n) : e.getStyle(t, "text-decoration") === n && e.setStyle(t, "text-decoration", null)) }, pv = function (n, e, r, o) { iv(e, function (t) { iv(n.dom.select(t.inline, o), function (e) { av(e) && ov.removeFormat(n, t, r, e, t.exact ? e : null) }), function (r, e, t) { if (e.clear_child_styles) { var n = e.links ? "*:not(a)" : "*"; iv(r.select(n, t), function (n) { av(n) && iv(e.styles, function (e, t) { r.setStyle(n, t, "") }) }) } }(n.dom, t, o) }) }, gv = function (e, t, n, r) { (t.styles.color || t.styles.textDecoration) && (Lt.walk(r, V.curry(mv, e), "childNodes"), mv(e, r)) }, hv = function (e, t, n, r) { t.styles && t.styles.backgroundColor && cv(r, lv(e, "fontSize"), fv(e, "backgroundColor", lh.replaceVars(t.styles.backgroundColor, n))) }, vv = function (e, t, n, r) { "sub" !== t.inline && "sup" !== t.inline || (cv(r, lv(e, "fontSize"), fv(e, "fontSize", "")), e.remove(e.select("sup" === t.inline ? "sub" : "sup", r), !0)) }, yv = function (e, t, n, r) { r && !1 !== t.merge_siblings && (r = sv(e, lh.getNonWhiteSpaceSibling(r), r), r = sv(e, r, lh.getNonWhiteSpaceSibling(r, !0))) }, bv = function (t, n, r, o, i) { Rh.matchNode(t, i.parentNode, r, o) && ov.removeFormat(t, n, o, i) || n.merge_with_parents && t.dom.getParent(i.parentNode, function (e) { if (Rh.matchNode(t, e, r, o)) return ov.removeFormat(t, n, o, i), !0 }) }, Cv = Lt.each, xv = function (p, g, h, r) { var e, t, v = p.formatter.get(g), y = v[0], o = !r && p.selection.isCollapsed(), i = p.dom, n = p.selection, b = function (n, e) { if (e = e || y, n) { if (e.onformat && e.onformat(n, e, h, r), Cv(e.styles, function (e, t) { i.setStyle(n, t, lh.replaceVars(e, h)) }), e.styles) { var t = i.getAttrib(n, "style"); t && n.setAttribute("data-mce-style", t) } Cv(e.attributes, function (e, t) { i.setAttrib(n, t, lh.replaceVars(e, h)) }), Cv(e.classes, function (e) { e = lh.replaceVars(e, h), i.hasClass(n, e) || i.addClass(n, e) }) } }, C = function (e, t) { var n = !1; return !!y.selector && (Cv(e, function (e) { if (!("collapsed" in e && e.collapsed !== o)) return i.is(t, e.selector) && !xc(t) ? (b(t, e), !(n = !0)) : void 0 }), n) }, a = function (s, e, t, c) { var l, f, d = [], m = !0; l = y.inline || y.block, f = s.create(l), b(f), Yh.walk(s, e, function (e) { var a, u = function (e) { var t, n, r, o; if (o = m, t = e.nodeName.toLowerCase(), n = e.parentNode.nodeName.toLowerCase(), 1 === e.nodeType && s.getContentEditable(e) && (o = m, m = "true" === s.getContentEditable(e), r = !0), lh.isEq(t, "br")) return a = 0, void (y.block && s.remove(e)); if (y.wrapper && Rh.matchNode(p, e, g, h)) a = 0; else { if (m && !r && y.block && !y.wrapper && lh.isTextBlock(p, t) && lh.isValid(p, n, l)) return e = s.rename(e, l), b(e), d.push(e), void (a = 0); if (y.selector) { var i = C(v, e); if (!y.inline || i) return void (a = 0) } !m || r || !lh.isValid(p, l, t) || !lh.isValid(p, n, l) || !c && 3 === e.nodeType && 1 === e.nodeValue.length && 65279 === e.nodeValue.charCodeAt(0) || xc(e) || y.inline && s.isBlock(e) ? (a = 0, Cv(Lt.grep(e.childNodes), u), r && (m = o), a = 0) : (a || (a = s.clone(f, !1), e.parentNode.insertBefore(a, e), d.push(a)), a.appendChild(e)) } }; Cv(e, u) }), !0 === y.links && Cv(d, function (e) { var t = function (e) { "A" === e.nodeName && b(e, y), Cv(Lt.grep(e.childNodes), t) }; t(e) }), Cv(d, function (e) { var t, n, r, o, i, a = function (e) { var n = !1; return Cv(e.childNodes, function (e) { if ((t = e) && 1 === t.nodeType && !Bc.isBookmarkNode(t) && !xc(t) && !Ao.isBogus(t)) return n = e, !1; var t }), n }; n = 0, Cv(e.childNodes, function (e) { lh.isWhiteSpaceNode(e) || Bc.isBookmarkNode(e) || n++ }), t = n, !(1 < d.length) && s.isBlock(e) || 0 !== t ? (y.inline || y.wrapper) && (y.exact || 1 !== t || ((o = a(r = e)) && !Bc.isBookmarkNode(o) && Rh.matchName(s, o, y) && (i = s.clone(o, !1), b(i), s.replace(i, r, !0), s.remove(o, 1)), e = i || r), pv(p, v, h, e), bv(p, y, g, h, e), hv(s, y, h, e), vv(s, y, h, e), yv(s, y, h, e)) : s.remove(e, 1) }) }; if ("false" !== i.getContentEditable(n.getNode())) { if (y) { if (r) r.nodeType ? C(v, r) || ((t = i.createRng()).setStartBefore(r), t.setEndAfter(r), a(i, wh(p, t, v), 0, !0)) : a(i, r, 0, !0); else if (o && y.inline && !i.select("td[data-mce-selected],th[data-mce-selected]").length) !function (e, t, n) { var r, o, i, a, u, s, c = e.selection; a = (r = c.getRng(!0)).startOffset, s = r.startContainer.nodeValue, (o = wc(e.getBody(), c.getStart())) && (i = Lh(o)); var l, f, d = /[^\s\u00a0\u00ad\u200b\ufeff]/; s && 0 < a && a < s.length && d.test(s.charAt(a)) && d.test(s.charAt(a - 1)) ? (u = c.getBookmark(), r.collapse(!0), r = wh(e, r, e.formatter.get(t)), r = _h.split(r), e.formatter.apply(t, n, r), c.moveToBookmark(u)) : (o && i.nodeValue === Dh || (l = e.getDoc(), f = Ih(!0).dom(), i = (o = l.importNode(f, !0)).firstChild, r.insertNode(o), a = 1), e.formatter.apply(t, n, o), c.setCursorLocation(i, a)) }(p, g, h); else { var u = p.selection.getNode(); p.settings.forced_root_block || !v[0].defaultBlock || i.getParent(u, i.isBlock) || xv(p, v[0].defaultBlock), p.selection.setRng(Wc(p.selection.getRng())), e = bc.getPersistentBookmark(p.selection, !0), a(i, wh(p, n.getRng(), v)), y.styles && gv(i, y, h, u), n.moveToBookmark(e), lh.moveStart(i, n, n.getRng()), p.nodeChanged() } Kh(g, p) } } else { r = n.getNode(); for (var s = 0, c = v.length; s < c; s++)if (v[s].ceFalseOverride && i.is(r, v[s].selector)) return void b(r, v[s]) } }, wv = { applyFormat: xv }, Nv = Lt.each, Ev = { formatChanged: function (e, t, n, r, o) { var i, a, u, s, c, l, f, d; null === t.get() && (a = e, u = {}, (i = t).set({}), a.on("NodeChange", function (n) { var r = lh.getParents(a.dom, n.element), o = {}; r = Lt.grep(r, function (e) { return 1 === e.nodeType && !e.getAttribute("data-mce-bogus") }), Nv(i.get(), function (e, n) { Nv(r, function (t) { return a.formatter.matchNode(t, n, {}, e.similar) ? (u[n] || (Nv(e, function (e) { e(!0, { node: t, format: n, parents: r }) }), u[n] = e), o[n] = e, !1) : !Rh.matchesUnInheritedFormatSelector(a, t, n) && void 0 }) }), Nv(u, function (e, t) { o[t] || (delete u[t], Nv(e, function (e) { e(!1, { node: n.element, format: t, parents: r }) })) }) })), c = n, l = r, f = o, d = (s = t).get(), Nv(c.split(","), function (e) { d[e] || (d[e] = [], d[e].similar = f), d[e].push(l) }), s.set(d) } }, Sv = { get: function (r) { var t = { valigntop: [{ selector: "td,th", styles: { verticalAlign: "top" } }], valignmiddle: [{ selector: "td,th", styles: { verticalAlign: "middle" } }], valignbottom: [{ selector: "td,th", styles: { verticalAlign: "bottom" } }], alignleft: [{ selector: "figure.image", collapsed: !1, classes: "align-left", ceFalseOverride: !0, preview: "font-family font-size" }, { selector: "figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li", styles: { textAlign: "left" }, inherit: !1, preview: !1, defaultBlock: "div" }, { selector: "img,table", collapsed: !1, styles: { "float": "left" }, preview: "font-family font-size" }], aligncenter: [{ selector: "figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li", styles: { textAlign: "center" }, inherit: !1, preview: "font-family font-size", defaultBlock: "div" }, { selector: "figure.image", collapsed: !1, classes: "align-center", ceFalseOverride: !0, preview: "font-family font-size" }, { selector: "img", collapsed: !1, styles: { display: "block", marginLeft: "auto", marginRight: "auto" }, preview: !1 }, { selector: "table", collapsed: !1, styles: { marginLeft: "auto", marginRight: "auto" }, preview: "font-family font-size" }], alignright: [{ selector: "figure.image", collapsed: !1, classes: "align-right", ceFalseOverride: !0, preview: "font-family font-size" }, { selector: "figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li", styles: { textAlign: "right" }, inherit: !1, preview: "font-family font-size", defaultBlock: "div" }, { selector: "img,table", collapsed: !1, styles: { "float": "right" }, preview: "font-family font-size" }], alignjustify: [{ selector: "figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li", styles: { textAlign: "justify" }, inherit: !1, defaultBlock: "div", preview: "font-family font-size" }], bold: [{ inline: "strong", remove: "all" }, { inline: "span", styles: { fontWeight: "bold" } }, { inline: "b", remove: "all" }], italic: [{ inline: "em", remove: "all" }, { inline: "span", styles: { fontStyle: "italic" } }, { inline: "i", remove: "all" }], underline: [{ inline: "span", styles: { textDecoration: "underline" }, exact: !0 }, { inline: "u", remove: "all" }], strikethrough: [{ inline: "span", styles: { textDecoration: "line-through" }, exact: !0 }, { inline: "strike", remove: "all" }], forecolor: { inline: "span", styles: { color: "%value" }, links: !0, remove_similar: !0, clear_child_styles: !0 }, hilitecolor: { inline: "span", styles: { backgroundColor: "%value" }, links: !0, remove_similar: !0, clear_child_styles: !0 }, fontname: { inline: "span", toggle: !1, styles: { fontFamily: "%value" }, clear_child_styles: !0 }, fontsize: { inline: "span", toggle: !1, styles: { fontSize: "%value" }, clear_child_styles: !0 }, fontsize_class: { inline: "span", attributes: { "class": "%value" } }, blockquote: { block: "blockquote", wrapper: 1, remove: "all" }, subscript: { inline: "sub" }, superscript: { inline: "sup" }, code: { inline: "code" }, link: { inline: "a", selector: "a", remove: "all", split: !0, deep: !0, onmatch: function () { return !0 }, onformat: function (n, e, t) { Lt.each(t, function (e, t) { r.setAttrib(n, t, e) }) } }, removeformat: [{ selector: "b,strong,em,i,font,u,strike,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins", remove: "all", split: !0, expand: !1, block_expand: !0, deep: !0 }, { selector: "span", attributes: ["style", "class"], remove: "empty", split: !0, expand: !1, deep: !0 }, { selector: "*", attributes: ["style", "class"], split: !1, expand: !1, deep: !0 }] }; return Lt.each("p h1 h2 h3 h4 h5 h6 div address pre div dt dd samp".split(/\s/), function (e) { t[e] = { block: e, remove: "all" } }), t } }, kv = Lt.each, Tv = di.DOM, Av = function (e, t) { var n, o, r, m = t && t.schema || Zo({}), p = function (e) { var t, n, r; return o = "string" == typeof e ? { name: e, classes: [], attrs: {} } : e, t = Tv.create(o.name), n = t, (r = o).classes.length && Tv.addClass(n, r.classes.join(" ")), Tv.setAttribs(n, r.attrs), t }, g = function (n, e, t) { var r, o, i, a, u, s, c, l, f = 0 < e.length && e[0], d = f && f.name; if (u = d, s = "string" != typeof (a = n) ? a.nodeName.toLowerCase() : a, c = m.getElementRule(s), i = !(!(l = c && c.parentsRequired) || !l.length) && (u && -1 !== Lt.inArray(l, u) ? u : l[0])) d === i ? (o = e[0], e = e.slice(1)) : o = i; else if (f) o = e[0], e = e.slice(1); else if (!t) return n; return o && (r = p(o)).appendChild(n), t && (r || (r = Tv.create("div")).appendChild(n), Lt.each(t, function (e) { var t = p(e); r.insertBefore(t, n) })), g(r, e, o && o.siblings) }; return e && e.length ? (o = e[0], n = p(o), (r = Tv.create("div")).appendChild(g(n, e.slice(1), o.siblings)), r) : "" }, Rv = function (e) { var t, a = { classes: [], attrs: {} }; return "*" !== (e = a.selector = Lt.trim(e)) && (t = e.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g, function (e, t, n, r, o) { switch (t) { case "#": a.attrs.id = n; break; case ".": a.classes.push(n); break; case ":": -1 !== Lt.inArray("checked disabled enabled read-only required".split(" "), n) && (a.attrs[n] = n) }if ("[" === r) { var i = o.match(/([\w\-]+)(?:\=\"([^\"]+))?/); i && (a.attrs[i[1]] = i[2]) } return "" })), a.name = t || "div", a }, Bv = function (e) { return e && "string" == typeof e ? (e = (e = e.split(/\s*,\s*/)[0]).replace(/\s*(~\+|~|\+|>)\s*/g, "$1"), Lt.map(e.split(/(?:>|\s+(?![^\[\]]+\]))/), function (e) { var t = Lt.map(e.split(/(?:~\+|~|\+)/), Rv), n = t.pop(); return t.length && (n.siblings = t), n }).reverse()) : [] }, _v = { getCssText: function (n, e) { var t, r, o, i, a, u, s = ""; if (!1 === (u = n.settings.preview_styles)) return ""; "string" != typeof u && (u = "font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"); var c = function (e) { return e.replace(/%(\w+)/g, "") }; if ("string" == typeof e) { if (!(e = n.formatter.get(e))) return; e = e[0] } return "preview" in e && !1 === (u = e.preview) ? "" : (t = e.block || e.inline || "span", (i = Bv(e.selector)).length ? (i[0].name || (i[0].name = t), t = e.selector, r = Av(i, n)) : r = Av([t], n), o = Tv.select(t, r)[0] || r.firstChild, kv(e.styles, function (e, t) { (e = c(e)) && Tv.setStyle(o, t, e) }), kv(e.attributes, function (e, t) { (e = c(e)) && Tv.setAttrib(o, t, e) }), kv(e.classes, function (e) { e = c(e), Tv.hasClass(o, e) || Tv.addClass(o, e) }), n.fire("PreviewFormats"), Tv.setStyles(r, { position: "absolute", left: -65535 }), n.getBody().appendChild(r), a = Tv.getStyle(n.getBody(), "fontSize", !0), a = /px$/.test(a) ? parseInt(a, 10) : 0, kv(u.split(" "), function (e) { var t = Tv.getStyle(o, e, !0); if (!("background-color" === e && /transparent|rgba\s*\([^)]+,\s*0\)/.test(t) && (t = Tv.getStyle(n.getBody(), e, !0), "#ffffff" === Tv.toHex(t).toLowerCase()) || "color" === e && "#000000" === Tv.toHex(t).toLowerCase())) { if ("font-size" === e && /em|%$/.test(t)) { if (0 === a) return; t = parseFloat(t) / (/%$/.test(t) ? 100 : 1) * a + "px" } "border" === e && t && (s += "padding:0 2px;"), s += e + ":" + t + ";" } }), n.fire("AfterPreviewFormats"), Tv.remove(r), s) }, parseSelector: Bv, selectorToHtml: function (e, t) { return Av(Bv(e), t) } }, Dv = { toggle: function (e, t, n, r, o) { var i = t.get(n); !Rh.match(e, n, r, o) || "toggle" in i[0] && !i[0].toggle ? wv.applyFormat(e, n, r, o) : ov.remove(e, n, r, o) } }, Ov = { setup: function (e) { e.addShortcut("meta+b", "", "Bold"), e.addShortcut("meta+i", "", "Italic"), e.addShortcut("meta+u", "", "Underline"); for (var t = 1; t <= 6; t++)e.addShortcut("access+" + t, "", ["FormatBlock", !1, "h" + t]); e.addShortcut("access+7", "", ["FormatBlock", !1, "p"]), e.addShortcut("access+8", "", ["FormatBlock", !1, "div"]), e.addShortcut("access+9", "", ["FormatBlock", !1, "address"]) } }; function Pv(e) { var t, n, r, o = (t = e, n = {}, (r = function (e, t) { e && ("string" != typeof e ? Lt.each(e, function (e, t) { r(t, e) }) : (t = t.length ? t : [t], Lt.each(t, function (e) { "undefined" == typeof e.deep && (e.deep = !e.selector), "undefined" == typeof e.split && (e.split = !e.selector || e.inline), "undefined" == typeof e.remove && e.selector && !e.inline && (e.remove = "none"), e.selector && e.inline && (e.mixed = !0, e.block_expand = !0), "string" == typeof e.classes && (e.classes = e.classes.split(/\s+/)) }), n[e] = t)) })(Sv.get(t.dom)), r(t.settings.formats), { get: function (e) { return e ? n[e] : n }, register: r, unregister: function (e) { return e && n[e] && delete n[e], n } }), i = Ju(null); return Ov.setup(e), Vh(e), { get: o.get, register: o.register, unregister: o.unregister, apply: V.curry(wv.applyFormat, e), remove: V.curry(ov.remove, e), toggle: V.curry(Dv.toggle, e, o), match: V.curry(Rh.match, e), matchAll: V.curry(Rh.matchAll, e), matchNode: V.curry(Rh.matchNode, e), canApply: V.curry(Rh.canApply, e), formatChanged: V.curry(Ev.formatChanged, e, i), getCssText: V.curry(_v.getCssText, e) } } var Lv = function (a) { return function () { for (var e = new Array(arguments.length), t = 0; t < e.length; t++)e[t] = arguments[t]; if (0 === e.length) throw new Error("Can't merge zero objects"); for (var n = {}, r = 0; r < e.length; r++) { var o = e[r]; for (var i in o) o.hasOwnProperty(i) && (n[i] = a(n[i], o[i])) } return n } }, Iv = Lv(function (e, t) { return E.isObject(e) && E.isObject(t) ? Iv(e, t) : t }), Mv = Lv(function (e, t) { return t }), Fv = { deepMerge: Iv, merge: Mv }, zv = function (e, t) { return e.fire("PreProcess", t) }, Uv = function (e, t) { return e.fire("PostProcess", t) }, qv = function (e) { return e.fire("remove") }, Vv = { register: function (t, s, c) { t.addAttributeFilter("data-mce-tabindex", function (e, t) { for (var n, r = e.length; r--;)(n = e[r]).attr("tabindex", n.attributes.map["data-mce-tabindex"]), n.attr(t, null) }), t.addAttributeFilter("src,href,style", function (e, t) { for (var n, r, o = e.length, i = "data-mce-" + t, a = s.url_converter, u = s.url_converter_scope; o--;)(r = (n = e[o]).attributes.map[i]) !== undefined ? (n.attr(t, 0 < r.length ? r : null), n.attr(i, null)) : (r = n.attributes.map[t], "style" === t ? r = c.serializeStyle(c.parseStyle(r), n.name) : a && (r = a.call(u, r, t, n.name)), n.attr(t, 0 < r.length ? r : null)) }), t.addAttributeFilter("class", function (e) { for (var t, n, r = e.length; r--;)(n = (t = e[r]).attr("class")) && (n = t.attr("class").replace(/(?:^|\s)mce-item-\w+(?!\S)/g, ""), t.attr("class", 0 < n.length ? n : null)) }), t.addAttributeFilter("data-mce-type", function (e, t, n) { for (var r, o = e.length; o--;)"bookmark" !== (r = e[o]).attributes.map["data-mce-type"] || n.cleanup || r.remove() }), t.addNodeFilter("noscript", function (e) { for (var t, n = e.length; n--;)(t = e[n].firstChild) && (t.value = Vo.decode(t.value)) }), t.addNodeFilter("script,style", function (e, t) { for (var n, r, o, i = e.length, a = function (e) { return e.replace(/(<!--\[CDATA\[|\]\]-->)/g, "\n").replace(/^[\r\n]*|[\r\n]*$/g, "").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi, "").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g, "") }; i--;)r = (n = e[i]).firstChild ? n.firstChild.value : "", "script" === t ? ((o = n.attr("type")) && n.attr("type", "mce-no/type" === o ? null : o.replace(/^mce\-/, "")), "xhtml" === s.element_format && 0 < r.length && (n.firstChild.value = "// <![CDATA[\n" + a(r) + "\n// ]]>")) : "xhtml" === s.element_format && 0 < r.length && (n.firstChild.value = "\x3c!--\n" + a(r) + "\n--\x3e") }), t.addNodeFilter("#comment", function (e) { for (var t, n = e.length; n--;)0 === (t = e[n]).value.indexOf("[CDATA[") ? (t.name = "#cdata", t.type = 4, t.value = t.value.replace(/^\[CDATA\[|\]\]$/g, "")) : 0 === t.value.indexOf("mce:protected ") && (t.name = "#text", t.type = 3, t.raw = !0, t.value = unescape(t.value).substr(14)) }), t.addNodeFilter("xml:namespace,input", function (e, t) { for (var n, r = e.length; r--;)7 === (n = e[r]).type ? n.remove() : 1 === n.type && ("input" !== t || "type" in n.attributes.map || n.attr("type", "text")) }), t.addAttributeFilter("data-mce-type", function (e) { H.each(e, function (e) { "format-caret" === e.attr("data-mce-type") && (e.isEmpty(t.schema.getNonEmptyElements()) ? e.remove() : e.unwrap()) }) }), t.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-type,data-mce-resize", function (e, t) { for (var n = e.length; n--;)e[n].attr(t, null) }) }, trimTrailingBr: function (e) { var t, n, r = function (e) { return e && "br" === e.name }; r(t = e.lastChild) && r(n = t.prev) && (t.remove(), n.remove()) } }, Hv = { process: function (e, t, n) { return f = n, (l = e) && l.hasEventListeners("PreProcess") && !f.no_events ? (o = t, i = n, c = (r = e).dom, o = o.cloneNode(!0), (a = document.implementation).createHTMLDocument && (u = a.createHTMLDocument(""), Lt.each("BODY" === o.nodeName ? o.childNodes : [o], function (e) { u.body.appendChild(u.importNode(e, !0)) }), o = "BODY" !== o.nodeName ? u.body.firstChild : u.body, s = c.doc, c.doc = u), zv(r, Fv.merge(i, { node: o })), s && (c.doc = s), o) : t; var r, o, i, a, u, s, c, l, f } }, jv = function (e, u, s) { e.addNodeFilter("font", function (e) { H.each(e, function (e) { var t, n, r = u.parse(e.attr("style")), o = e.attr("color"), i = e.attr("face"), a = e.attr("size"); o && (r.color = o), i && (r["font-family"] = i), a && (r["font-size"] = s[parseInt(e.attr("size"), 10) - 1]), e.name = "span", e.attr("style", u.serialize(r)), t = e, n = ["color", "face", "size"], H.each(n, function (e) { t.attr(e, null) }) }) }) }, $v = function (e, t) { var n, r = ti(); t.convert_fonts_to_spans && jv(e, r, Lt.explode(t.font_size_legacy_values)), n = r, e.addNodeFilter("strike", function (e) { H.each(e, function (e) { var t = n.parse(e.attr("style")); t["text-decoration"] = "line-through", e.name = "span", e.attr("style", n.serialize(t)) }) }) }, Wv = { register: function (e, t) { t.inline_styles && $v(e, t) } }, Kv = /^[ \t\r\n]*$/, Xv = { "#text": 3, "#comment": 8, "#cdata": 4, "#pi": 7, "#doctype": 10, "#document-fragment": 11 }, Yv = function (e, t, n) { var r, o, i = n ? "lastChild" : "firstChild", a = n ? "prev" : "next"; if (e[i]) return e[i]; if (e !== t) { if (r = e[a]) return r; for (o = e.parent; o && o !== t; o = o.parent)if (r = o[a]) return r } }, Gv = function () { function a(e, t) { this.name = e, 1 === (this.type = t) && (this.attributes = [], this.attributes.map = {}) } return a.create = function (e, t) { var n, r; if (n = new a(e, Xv[e] || 1), t) for (r in t) n.attr(r, t[r]); return n }, a.prototype.replace = function (e) { return e.parent && e.remove(), this.insert(e, this), this.remove(), this }, a.prototype.attr = function (e, t) { var n, r; if ("string" != typeof e) { for (r in e) this.attr(r, e[r]); return this } if (n = this.attributes) { if (t !== undefined) { if (null === t) { if (e in n.map) for (delete n.map[e], r = n.length; r--;)if (n[r].name === e) return n = n.splice(r, 1), this; return this } if (e in n.map) { for (r = n.length; r--;)if (n[r].name === e) { n[r].value = t; break } } else n.push({ name: e, value: t }); return n.map[e] = t, this } return n.map[e] } }, a.prototype.clone = function () { var e, t, n, r, o, i = new a(this.name, this.type); if (n = this.attributes) { for ((o = []).map = {}, e = 0, t = n.length; e < t; e++)"id" !== (r = n[e]).name && (o[o.length] = { name: r.name, value: r.value }, o.map[r.name] = r.value); i.attributes = o } return i.value = this.value, i.shortEnded = this.shortEnded, i }, a.prototype.wrap = function (e) { return this.parent.insert(e, this), e.append(this), this }, a.prototype.unwrap = function () { var e, t; for (e = this.firstChild; e;)t = e.next, this.insert(e, this, !0), e = t; this.remove() }, a.prototype.remove = function () { var e = this.parent, t = this.next, n = this.prev; return e && (e.firstChild === this ? (e.firstChild = t) && (t.prev = null) : n.next = t, e.lastChild === this ? (e.lastChild = n) && (n.next = null) : t.prev = n, this.parent = this.next = this.prev = null), this }, a.prototype.append = function (e) { var t; return e.parent && e.remove(), (t = this.lastChild) ? ((t.next = e).prev = t, this.lastChild = e) : this.lastChild = this.firstChild = e, e.parent = this, e }, a.prototype.insert = function (e, t, n) { var r; return e.parent && e.remove(), r = t.parent || this, n ? (t === r.firstChild ? r.firstChild = e : t.prev.next = e, e.prev = t.prev, (e.next = t).prev = e) : (t === r.lastChild ? r.lastChild = e : t.next.prev = e, e.next = t.next, (e.prev = t).next = e), e.parent = r, e }, a.prototype.getAll = function (e) { var t, n = []; for (t = this.firstChild; t; t = Yv(t, this))t.name === e && n.push(t); return n }, a.prototype.empty = function () { var e, t, n; if (this.firstChild) { for (e = [], n = this.firstChild; n; n = Yv(n, this))e.push(n); for (t = e.length; t--;)(n = e[t]).parent = n.firstChild = n.lastChild = n.next = n.prev = null } return this.firstChild = this.lastChild = null, this }, a.prototype.isEmpty = function (e, t, n) { var r, o, i = this.firstChild; if (t = t || {}, i) do { if (1 === i.type) { if (i.attributes.map["data-mce-bogus"]) continue; if (e[i.name]) return !1; for (r = i.attributes.length; r--;)if ("name" === (o = i.attributes[r].name) || 0 === o.indexOf("data-mce-bookmark")) return !1 } if (8 === i.type) return !1; if (3 === i.type && !Kv.test(i.value)) return !1; if (3 === i.type && i.parent && t[i.parent.name] && Kv.test(i.value)) return !1; if (n && n(i)) return !1 } while (i = Yv(i, this)); return !0 }, a.prototype.walk = function (e) { return Yv(this, null, e) }, a }(), Jv = function (e, t, n, r) { (e.padd_empty_with_br || t.insert) && n[r.name] ? r.empty().append(new Gv("br", 1)).shortEnded = !0 : r.empty().append(new Gv("#text", 3)).value = "\xa0" }, Qv = function (e) { return Zv(e, "#text") && "\xa0" === e.firstChild.value }, Zv = function (e, t) { return e && e.firstChild && e.firstChild === e.lastChild && e.firstChild.name === t }, ey = function (r, e, t, n) { return n.isEmpty(e, t, function (e) { return t = e, (n = r.getElementRule(t.name)) && n.paddEmpty; var t, n }) }, ty = function (e, t) { return e && (t[e.name] || "br" === e.name) }, ny = function (e, g) { var h = e.schema; g.remove_trailing_brs && e.addNodeFilter("br", function (e, t, n) { var r, o, i, a, u, s, c, l, f = e.length, d = Lt.extend({}, h.getBlockElements()), m = h.getNonEmptyElements(), p = h.getNonEmptyElements(); for (d.body = 1, r = 0; r < f; r++)if (i = (o = e[r]).parent, d[o.parent.name] && o === i.lastChild) { for (u = o.prev; u;) { if ("span" !== (s = u.name) || "bookmark" !== u.attr("data-mce-type")) { if ("br" !== s) break; if ("br" === s) { o = null; break } } u = u.prev } o && (o.remove(), ey(h, m, p, i) && (c = h.getElementRule(i.name)) && (c.removeEmpty ? i.remove() : c.paddEmpty && Jv(g, n, d, i))) } else { for (a = o; i && i.firstChild === a && i.lastChild === a && !d[(a = i).name];)i = i.parent; a === i && !0 !== g.padd_empty_with_br && ((l = new Gv("#text", 3)).value = "\xa0", o.replace(l)) } }), e.addAttributeFilter("href", function (e) { var t, n, r, o = e.length; if (!g.allow_unsafe_link_target) for (; o--;)"a" === (t = e[o]).name && "_blank" === t.attr("target") && t.attr("rel", (n = t.attr("rel"), r = n ? Lt.trim(n) : "", /\b(noopener)\b/g.test(r) ? r : r.split(" ").filter(function (e) { return 0 < e.length }).concat(["noopener"]).sort().join(" "))) }), g.allow_html_in_named_anchor || e.addAttributeFilter("id,name", function (e) { for (var t, n, r, o, i = e.length; i--;)if ("a" === (o = e[i]).name && o.firstChild && !o.attr("href")) for (r = o.parent, t = o.lastChild; n = t.prev, r.insert(t, o), t = n;); }), g.fix_list_elements && e.addNodeFilter("ul,ol", function (e) { for (var t, n, r = e.length; r--;)if ("ul" === (n = (t = e[r]).parent).name || "ol" === n.name) if (t.prev && "li" === t.prev.name) t.prev.append(t); else { var o = new Gv("li", 1); o.attr("style", "list-style-type: none"), t.wrap(o) } }), g.validate && h.getValidClasses() && e.addAttributeFilter("class", function (e) { for (var t, n, r, o, i, a, u, s = e.length, c = h.getValidClasses(); s--;) { for (n = (t = e[s]).attr("class").split(" "), i = "", r = 0; r < n.length; r++)o = n[r], u = !1, (a = c["*"]) && a[o] && (u = !0), a = c[t.name], !u && a && a[o] && (u = !0), u && (i && (i += " "), i += o); i.length || (i = null), t.attr("class", i) } }) }, ry = Lt.makeMap, oy = Lt.each, iy = Lt.explode, ay = Lt.extend; function uy(k, T) { void 0 === T && (T = Zo()); var A = {}, R = [], B = {}, _ = {}; (k = k || {}).validate = !("validate" in k) || k.validate, k.root_name = k.root_name || "body"; var D = function (e) { var t, n, r; n in A && ((r = B[n]) ? r.push(e) : B[n] = [e]), t = R.length; for (; t--;)(n = R[t].name) in e.attributes.map && ((r = _[n]) ? r.push(e) : _[n] = [e]); return e }, e = { schema: T, addAttributeFilter: function (e, n) { oy(iy(e), function (e) { var t; for (t = 0; t < R.length; t++)if (R[t].name === e) return void R[t].callbacks.push(n); R.push({ name: e, callbacks: [n] }) }) }, getAttributeFilters: function () { return [].concat(R) }, addNodeFilter: function (e, n) { oy(iy(e), function (e) { var t = A[e]; t || (A[e] = t = []), t.push(n) }) }, getNodeFilters: function () { var e = []; for (var t in A) A.hasOwnProperty(t) && e.push({ name: t, callbacks: A[t] }); return e }, filterNode: D, parse: function (e, a) { var t, n, r, o, i, u, s, c, l, f, d, m = []; a = a || {}, B = {}, _ = {}, l = ay(ry("script,style,head,html,body,title,meta,param"), T.getBlockElements()); var p = T.getNonEmptyElements(), g = T.children, h = k.validate, v = "forced_root_block" in a ? a.forced_root_block : k.forced_root_block, y = T.getWhiteSpaceElements(), b = /^[ \t\r\n]+/, C = /[ \t\r\n]+$/, x = /[ \t\r\n]+/g, w = /^[ \t\r\n]+$/, N = function (e, t) { var n, r = new Gv(e, t); return e in A && ((n = B[e]) ? n.push(r) : B[e] = [r]), r }, E = function (e) { var t, n, r, o, i = T.getBlockElements(); for (t = e.prev; t && 3 === t.type;) { if (0 < (r = t.value.replace(C, "")).length) return void (t.value = r); if (n = t.next) { if (3 === n.type && n.value.length) { t = t.prev; continue } if (!i[n.name] && "script" !== n.name && "style" !== n.name) { t = t.prev; continue } } o = t.prev, t.remove(), t = o } }; t = Fg({ validate: h, allow_script_urls: k.allow_script_urls, allow_conditional_comments: k.allow_conditional_comments, self_closing_elements: function (e) { var t, n = {}; for (t in e) "li" !== t && "p" !== t && (n[t] = e[t]); return n }(T.getSelfClosingElements()), cdata: function (e) { d.append(N("#cdata", 4)).value = e }, text: function (e, t) { var n; f || (e = e.replace(x, " "), ty(d.lastChild, l) && (e = e.replace(b, ""))), 0 !== e.length && ((n = N("#text", 3)).raw = !!t, d.append(n).value = e) }, comment: function (e) { d.append(N("#comment", 8)).value = e }, pi: function (e, t) { d.append(N(e, 7)).value = t, E(d) }, doctype: function (e) { d.append(N("#doctype", 10)).value = e, E(d) }, start: function (e, t, n) { var r, o, i, a, u; if (i = h ? T.getElementRule(e) : {}) { for ((r = N(i.outputName || e, 1)).attributes = t, r.shortEnded = n, d.append(r), (u = g[d.name]) && g[r.name] && !u[r.name] && m.push(r), o = R.length; o--;)(a = R[o].name) in t.map && ((s = _[a]) ? s.push(r) : _[a] = [r]); l[e] && E(r), n || (d = r), !f && y[e] && (f = !0) } }, end: function (e) { var t, n, r, o, i; if (n = h ? T.getElementRule(e) : {}) { if (l[e] && !f) { if ((t = d.firstChild) && 3 === t.type) if (0 < (r = t.value.replace(b, "")).length) t.value = r, t = t.next; else for (o = t.next, t.remove(), t = o; t && 3 === t.type;)r = t.value, o = t.next, (0 === r.length || w.test(r)) && (t.remove(), t = o), t = o; if ((t = d.lastChild) && 3 === t.type) if (0 < (r = t.value.replace(C, "")).length) t.value = r, t = t.prev; else for (o = t.prev, t.remove(), t = o; t && 3 === t.type;)r = t.value, o = t.prev, (0 === r.length || w.test(r)) && (t.remove(), t = o), t = o } if (f && y[e] && (f = !1), n.removeEmpty && ey(T, p, y, d) && !d.attributes.map.name && !d.attr("id")) return i = d.parent, l[d.name] ? d.empty().remove() : d.unwrap(), void (d = i); n.paddEmpty && (Qv(d) || ey(T, p, y, d)) && Jv(k, a, l, d), d = d.parent } } }, T); var S = d = new Gv(a.context || k.root_name, 11); if (t.parse(e), h && m.length && (a.context ? a.invalid = !0 : function (e) { var t, n, r, o, i, a, u, s, c, l, f, d, m, p, g, h; for (d = ry("tr,td,th,tbody,thead,tfoot,table"), l = T.getNonEmptyElements(), f = T.getWhiteSpaceElements(), m = T.getTextBlockElements(), p = T.getSpecialElements(), t = 0; t < e.length; t++)if ((n = e[t]).parent && !n.fixed) if (m[n.name] && "li" === n.parent.name) { for (g = n.next; g && m[g.name];)g.name = "li", g.fixed = !0, n.parent.insert(g, n.parent), g = g.next; n.unwrap(n) } else { for (o = [n], r = n.parent; r && !T.isValidChild(r.name, n.name) && !d[r.name]; r = r.parent)o.push(r); if (r && 1 < o.length) { for (o.reverse(), i = a = D(o[0].clone()), c = 0; c < o.length - 1; c++) { for (T.isValidChild(a.name, o[c].name) ? (u = D(o[c].clone()), a.append(u)) : u = a, s = o[c].firstChild; s && s !== o[c + 1];)h = s.next, u.append(s), s = h; a = u } ey(T, l, f, i) ? r.insert(n, o[0], !0) : (r.insert(i, o[0], !0), r.insert(n, i)), r = o[0], (ey(T, l, f, r) || Zv(r, "br")) && r.empty().remove() } else if (n.parent) { if ("li" === n.name) { if ((g = n.prev) && ("ul" === g.name || "ul" === g.name)) { g.append(n); continue } if ((g = n.next) && ("ul" === g.name || "ul" === g.name)) { g.insert(n, g.firstChild, !0); continue } n.wrap(D(new Gv("ul", 1))); continue } T.isValidChild(n.parent.name, "div") && T.isValidChild("div", n.name) ? n.wrap(D(new Gv("div", 1))) : p[n.name] ? n.empty().remove() : n.unwrap() } } }(m)), v && ("body" === S.name || a.isRootContent) && function () { var e, t, n = S.firstChild, r = function (e) { e && ((n = e.firstChild) && 3 === n.type && (n.value = n.value.replace(b, "")), (n = e.lastChild) && 3 === n.type && (n.value = n.value.replace(C, ""))) }; if (T.isValidChild(S.name, v.toLowerCase())) { for (; n;)e = n.next, 3 === n.type || 1 === n.type && "p" !== n.name && !l[n.name] && !n.attr("data-mce-type") ? (t || ((t = N(v, 1)).attr(k.forced_root_block_attrs), S.insert(t, n)), t.append(n)) : (r(t), t = null), n = e; r(t) } }(), !a.invalid) { for (c in B) { for (s = A[c], i = (n = B[c]).length; i--;)n[i].parent || n.splice(i, 1); for (r = 0, o = s.length; r < o; r++)s[r](n, c, a) } for (r = 0, o = R.length; r < o; r++)if ((s = R[r]).name in _) { for (i = (n = _[s.name]).length; i--;)n[i].parent || n.splice(i, 1); for (i = 0, u = s.callbacks.length; i < u; i++)s.callbacks[i](n, s.name, a) } } return S } }; return ny(e, k), Wv.register(e, k), e } var sy = function (e, t, n) { -1 === Lt.inArray(t, n) && (e.addAttributeFilter(n, function (e, t) { for (var n = e.length; n--;)e[n].attr(t, null) }), t.push(n)) }, cy = function (e, t, n) { var r = Si(n.getInner ? t.innerHTML : e.getOuterHTML(t)); return n.selection ? r : Lt.trim(r) }, ly = function (e, t, n, r) { var o = r.selection ? Fv.merge({ forced_root_block: !1 }, r) : r, i = e.parse(n, o); return Vv.trimTrailingBr(i), i }, fy = function (e, t, n, r, o) { var i, a, u, s, c = (i = r, jc(t, n).serialize(i)); return a = e, s = c, !(u = o).no_events && a ? Uv(a, Fv.merge(u, { content: s })).content : s }; function dy(e, t) { var a, u, s, c, l, n, r = (a = e, n = ["data-mce-selected"], s = (u = t) && u.dom ? u.dom : di.DOM, c = u && u.schema ? u.schema : Zo(a), a.entity_encoding = a.entity_encoding || "named", a.remove_trailing_brs = !("remove_trailing_brs" in a) || a.remove_trailing_brs, l = uy(a, c), Vv.register(l, a, s), { schema: c, addNodeFilter: l.addNodeFilter, addAttributeFilter: l.addAttributeFilter, serialize: function (e, t) { var n = Fv.merge({ format: "html" }, t || {}), r = Hv.process(u, e, n), o = cy(s, r, n), i = ly(l, s, o, n); return "tree" === n.format ? i : fy(u, a, c, i, n) }, addRules: function (e) { c.addValidElements(e) }, setRules: function (e) { c.setValidElements(e) }, addTempAttr: V.curry(sy, l, n), getTempAttrs: function () { return n } }); return { schema: r.schema, addNodeFilter: r.addNodeFilter, addAttributeFilter: r.addAttributeFilter, serialize: r.serialize, addRules: r.addRules, setRules: r.setRules, addTempAttr: r.addTempAttr, getTempAttrs: r.getTempAttrs } } function my(e) { return { getBookmark: V.curry(Bc.getBookmark, e), moveToBookmark: V.curry(Bc.moveToBookmark, e) } } (my || (my = {})).isBookmarkNode = Bc.isBookmarkNode; var py = my, gy = Ao.isContentEditableFalse, hy = Ao.isContentEditableTrue, vy = function (r, a) { var u, s, c, l, f, d, m, p, g, h, v, y, i, b, C, x, w, N = a.dom, E = Lt.each, S = a.getDoc(), k = document, T = Math.abs, A = Math.round, R = a.getBody(); l = { nw: [0, 0, -1, -1], ne: [1, 0, 1, -1], se: [1, 1, 1, 1], sw: [0, 1, -1, 1] }; var e = ".mce-content-body"; a.contentStyles.push(e + " div.mce-resizehandle {position: absolute;border: 1px solid black;box-sizing: content-box;background: #FFF;width: 7px;height: 7px;z-index: 10000}" + e + " .mce-resizehandle:hover {background: #000}" + e + " img[data-mce-selected]," + e + " hr[data-mce-selected] {outline: 1px solid black;resize: none}" + e + " .mce-clonedresizable {position: absolute;" + (ge.gecko ? "" : "outline: 1px dashed black;") + "opacity: .5;filter: alpha(opacity=50);z-index: 10000}" + e + " .mce-resize-helper {background: #555;background: rgba(0,0,0,0.75);border-radius: 3px;border: 1px;color: white;display: none;font-family: sans-serif;font-size: 12px;white-space: nowrap;line-height: 14px;margin: 5px 10px;padding: 5px;position: absolute;z-index: 10001}"); var B = function (e) { return e && ("IMG" === e.nodeName || a.dom.is(e, "figure.image")) }, n = function (e) { var t, n, r = e.target; t = e, n = a.selection.getRng(), !B(t.target) || Ng(t.clientX, t.clientY, n) || e.isDefaultPrevented() || (e.preventDefault(), a.selection.select(r)) }, _ = function (e) { return a.dom.is(e, "figure.image") ? e.querySelector("img") : e }, D = function (e) { var t = a.settings.object_resizing; return !1 !== t && !ge.iOS && ("string" != typeof t && (t = "table,img,figure.image,div"), "false" !== e.getAttribute("data-mce-resize") && e !== a.getBody() && Br.is(qn.fromDom(e), t)) }, O = function (e) { var t, n, r, o; t = e.screenX - d, n = e.screenY - m, b = t * f[2] + h, C = n * f[3] + v, b = b < 5 ? 5 : b, C = C < 5 ? 5 : C, (B(u) && !1 !== a.settings.resize_img_proportional ? !kg.modifierPressed(e) : kg.modifierPressed(e) || B(u) && f[2] * f[3] != 0) && (T(t) > T(n) ? (C = A(b * y), b = A(C / y)) : (b = A(C / y), C = A(b * y))), N.setStyles(_(s), { width: b, height: C }), r = 0 < (r = f.startPos.x + t) ? r : 0, o = 0 < (o = f.startPos.y + n) ? o : 0, N.setStyles(c, { left: r, top: o, display: "block" }), c.innerHTML = b + " &times; " + C, f[2] < 0 && s.clientWidth <= b && N.setStyle(s, "left", p + (h - b)), f[3] < 0 && s.clientHeight <= C && N.setStyle(s, "top", g + (v - C)), (t = R.scrollWidth - x) + (n = R.scrollHeight - w) != 0 && N.setStyles(c, { left: r - t, top: o - n }), i || (a.fire("ObjectResizeStart", { target: u, width: h, height: v }), i = !0) }, P = function () { i = !1; var e = function (e, t) { t && (u.style[e] || !a.schema.isValid(u.nodeName.toLowerCase(), e) ? N.setStyle(_(u), e, t) : N.setAttrib(_(u), e, t)) }; e("width", b), e("height", C), N.unbind(S, "mousemove", O), N.unbind(S, "mouseup", P), k !== S && (N.unbind(k, "mousemove", O), N.unbind(k, "mouseup", P)), N.remove(s), N.remove(c), o(u), a.fire("ObjectResized", { target: u, width: b, height: C }), N.setAttrib(u, "style", N.getAttrib(u, "style")), a.nodeChanged() }, o = function (e) { var t, r, o, n, i; L(), F(), t = N.getPos(e, R), p = t.x, g = t.y, i = e.getBoundingClientRect(), r = i.width || i.right - i.left, o = i.height || i.bottom - i.top, u !== e && (u = e, b = C = 0), n = a.fire("ObjectSelected", { target: e }), D(e) && !n.isDefaultPrevented() ? E(l, function (n, e) { var t; (t = N.get("mceResizeHandle" + e)) && N.remove(t), t = N.add(R, "div", { id: "mceResizeHandle" + e, "data-mce-bogus": "all", "class": "mce-resizehandle", unselectable: !0, style: "cursor:" + e + "-resize; margin:0; padding:0" }), ge.ie && (t.contentEditable = !1), N.bind(t, "mousedown", function (e) { var t; e.stopImmediatePropagation(), e.preventDefault(), d = (t = e).screenX, m = t.screenY, h = _(u).clientWidth, v = _(u).clientHeight, y = v / h, (f = n).startPos = { x: r * n[0] + p, y: o * n[1] + g }, x = R.scrollWidth, w = R.scrollHeight, s = u.cloneNode(!0), N.addClass(s, "mce-clonedresizable"), N.setAttrib(s, "data-mce-bogus", "all"), s.contentEditable = !1, s.unSelectabe = !0, N.setStyles(s, { left: p, top: g, margin: 0 }), s.removeAttribute("data-mce-selected"), R.appendChild(s), N.bind(S, "mousemove", O), N.bind(S, "mouseup", P), k !== S && (N.bind(k, "mousemove", O), N.bind(k, "mouseup", P)), c = N.add(R, "div", { "class": "mce-resize-helper", "data-mce-bogus": "all" }, h + " &times; " + v) }), n.elm = t, N.setStyles(t, { left: r * n[0] + p - t.offsetWidth / 2, top: o * n[1] + g - t.offsetHeight / 2 }) }) : L(), u.setAttribute("data-mce-selected", "1") }, L = function () { var e, t; for (e in F(), u && u.removeAttribute("data-mce-selected"), l) (t = N.get("mceResizeHandle" + e)) && (N.unbind(t), N.remove(t)) }, I = function (e) { var t, n = function (e, t) { if (e) do { if (e === t) return !0 } while (e = e.parentNode) }; i || a.removed || (E(N.select("img[data-mce-selected],hr[data-mce-selected]"), function (e) { e.removeAttribute("data-mce-selected") }), t = "mousedown" === e.type ? e.target : r.getNode(), n(t = N.$(t).closest("table,img,figure.image,hr")[0], R) && (z(), n(r.getStart(!0), t) && n(r.getEnd(!0), t)) ? o(t) : L()) }, M = function (e) { return gy(function (e, t) { for (; t && t !== e;) { if (hy(t) || gy(t)) return t; t = t.parentNode } return null }(a.getBody(), e)) }, F = function () { for (var e in l) { var t = l[e]; t.elm && (N.unbind(t.elm), delete t.elm) } }, z = function () { try { a.getDoc().execCommand("enableObjectResizing", !1, !1) } catch (e) { } }; return a.on("init", function () { z(), ge.ie && 11 <= ge.ie && (a.on("mousedown click", function (e) { var t = e.target, n = t.nodeName; i || !/^(TABLE|IMG|HR)$/.test(n) || M(t) || (2 !== e.button && a.selection.select(t, "TABLE" === n), "mousedown" === e.type && a.nodeChanged()) }), a.dom.bind(R, "mscontrolselect", function (e) { var t = function (e) { Ce.setEditorTimeout(a, function () { a.selection.select(e) }) }; if (M(e.target)) return e.preventDefault(), void t(e.target); /^(TABLE|IMG|HR)$/.test(e.target.nodeName) && (e.preventDefault(), "IMG" === e.target.tagName && t(e.target)) })); var t = Ce.throttle(function (e) { a.composing || I(e) }); a.on("nodechange ResizeEditor ResizeWindow drop FullscreenStateChanged", t), a.on("keyup compositionend", function (e) { u && "TABLE" === u.nodeName && t(e) }), a.on("hide blur", L), a.on("contextmenu", n) }), a.on("remove", F), { isResizable: D, showResizeRect: o, hideResizeRect: L, updateResizeRect: I, destroy: function () { u = s = null } } }, yy = function (e) { return Ao.isContentEditableTrue(e) || Ao.isContentEditableFalse(e) }, by = { fromPoint: function (e, t, n) { var r, o, i, a, u, s = n; if (s.caretPositionFromPoint) (o = s.caretPositionFromPoint(e, t)) && ((r = n.createRange()).setStart(o.offsetNode, o.offset), r.collapse(!0)); else if (n.caretRangeFromPoint) r = n.caretRangeFromPoint(e, t); else if (s.body.createTextRange) { r = s.body.createTextRange(); try { r.moveToPoint(e, t), r.collapse(!0) } catch (c) { r = function (e, n, t) { var r, o, i; if (r = t.elementFromPoint(e, n), o = t.body.createTextRange(), r && "HTML" !== r.tagName || (r = t.body), o.moveToElementText(r), 0 < (i = (i = Lt.toArray(o.getClientRects())).sort(function (e, t) { return (e = Math.abs(Math.max(e.top - n, e.bottom - n))) - (t = Math.abs(Math.max(t.top - n, t.bottom - n))) })).length) { n = (i[0].bottom + i[0].top) / 2; try { return o.moveToPoint(e, n), o.collapse(!0), o } catch (a) { } } return null }(e, t, n) } return i = r, a = n.body, u = i && i.parentElement ? i.parentElement() : null, Ao.isContentEditableFalse(function (e, t, n) { for (; e && e !== t;) { if (n(e)) return e; e = e.parentNode } return null }(u, a, yy)) ? null : i } return r } }, Cy = function (n, e) { return H.map(e, function (e) { var t = n.fire("GetSelectionRange", { range: e }); return t.range !== e ? t.range : e }) }, xy = function (e, t) { return qn.fromDom(e.dom().cloneNode(t)) }, wy = function (e) { return xy(e, !0) }, Ny = function (e) { return xy(e, !1) }, Ey = wy, Sy = function (e, t) { var n = (t || document).createDocumentFragment(); return H.each(e, function (e) { n.appendChild(e.dom()) }), qn.fromDom(n) }, ky = function (t) { return qr.firstChild(t).fold(V.constant([t]), function (e) { return [t].concat(ky(e)) }) }, Ty = function (t) { return qr.lastChild(t).fold(V.constant([t]), function (e) { return "br" === Qn.name(e) ? qr.prevSibling(e).map(function (e) { return [t].concat(Ty(e)) }).getOr([]) : [t].concat(Ty(e)) }) }, Ay = function (o, e) { return sa([(i = e, a = i.startContainer, u = i.startOffset, Ao.isText(a) ? 0 === u ? A.some(qn.fromDom(a)) : A.none() : A.from(a.childNodes[u]).map(qn.fromDom)), (t = e, n = t.endContainer, r = t.endOffset, Ao.isText(n) ? r === n.data.length ? A.some(qn.fromDom(n)) : A.none() : A.from(n.childNodes[r - 1]).map(qn.fromDom))], function (e, t) { var n = H.find(ky(o), V.curry(Or.eq, e)), r = H.find(Ty(o), V.curry(Or.eq, t)); return n.isSome() && r.isSome() }).getOr(!1); var t, n, r, i, a, u }, Ry = function (e, t, n, r) { var o = n, i = new no(n, o), a = e.schema.getNonEmptyElements(); do { if (3 === n.nodeType && 0 !== Lt.trim(n.nodeValue).length) return void (r ? t.setStart(n, 0) : t.setEnd(n, n.nodeValue.length)); if (a[n.nodeName] && !/^(TD|TH)$/.test(n.nodeName)) return void (r ? t.setStartBefore(n) : "BR" === n.nodeName ? t.setEndBefore(n) : t.setEndAfter(n)); if (ge.ie && ge.ie < 11 && e.isBlock(n) && e.isEmpty(n)) return void (r ? t.setStart(n, 0) : t.setEnd(n, 0)) } while (n = r ? i.next() : i.prev()); "BODY" === o.nodeName && (r ? t.setStart(o, 0) : t.setEnd(o, o.childNodes.length)) }, By = wr.immutable("element", "width", "rows"), _y = wr.immutable("element", "cells"), Dy = wr.immutable("x", "y"), Oy = function (e, t) { var n = parseInt(cr.get(e, t), 10); return isNaN(n) ? 1 : n }, Py = function (e) { return H.foldl(e, function (e, t) { return t.cells().length > e ? t.cells().length : e }, 0) }, Ly = function (e, t) { for (var n = e.rows(), r = 0; r < n.length; r++)for (var o = n[r].cells(), i = 0; i < o.length; i++)if (Or.eq(o[i], t)) return A.some(Dy(i, r)); return A.none() }, Iy = function (e, t, n, r, o) { for (var i = [], a = e.rows(), u = n; u <= o; u++) { var s = a[u].cells(), c = t < r ? s.slice(t, r + 1) : s.slice(r, t + 1); i.push(_y(a[u].element(), c)) } return i }, My = function (e) { var o = By(Ny(e), 0, []); return H.each(fu(e, "tr"), function (n, r) { H.each(fu(n, "td,th"), function (e, t) { !function (e, t, n, r, o) { for (var i = Oy(o, "rowspan"), a = Oy(o, "colspan"), u = e.rows(), s = n; s < n + i; s++) { u[s] || (u[s] = _y(Ey(r), [])); for (var c = t; c < t + a; c++)u[s].cells()[c] = s === n && c === t ? o : Ny(o) } }(o, function (e, t, n) { for (; r = t, o = n, i = void 0, ((i = e.rows())[o] ? i[o].cells() : [])[r];)t++; var r, o, i; return t }(o, t, r), r, n, e) }) }), By(o.element(), Py(o.rows()), o.rows()) }, Fy = function (e) { return i = t = e, n = H.map(i.rows(), function (e) { var t = H.map(e.cells(), function (e) { var t = Ey(e); return cr.remove(t, "colspan"), cr.remove(t, "rowspan"), t }), n = Ny(e.element()); return Pc(n, t), n }), r = Ny(t.element()), o = qn.fromTag("tbody"), Pc(o, n), Fu.append(r, o), r; var t, n, r, o, i }, zy = function (l, e, t) { return Ly(l, e).bind(function (c) { return Ly(l, t).map(function (e) { return t = l, r = e, o = (n = c).x(), i = n.y(), a = r.x(), u = r.y(), s = i < u ? Iy(t, o, i, a, u) : Iy(t, o, u, a, i), By(t.element(), Py(s), s); var t, n, r, o, i, a, u, s }) }) }, Uy = function (n, t) { return H.find(n, function (e) { return "li" === Qn.name(e) && Ay(e, t) }).fold(V.constant([]), function (e) { return (t = n, H.find(t, function (e) { return "ul" === Qn.name(e) || "ol" === Qn.name(e) })).map(function (e) { return [qn.fromTag("li"), qn.fromTag(Qn.name(e))] }).getOr([]); var t }) }, qy = function (e, t) { var n, r = qn.fromDom(t.commonAncestorContainer), o = Ml(r, e), i = H.filter(o, function (e) { return co(e) || uo(e) }), a = Uy(o, t), u = i.concat(a.length ? a : po(n = r) ? qr.parent(n).filter(mo).fold(V.constant([]), function (e) { return [n, e] }) : mo(n) ? [n] : []); return H.map(u, Ny) }, Vy = function () { return Sy([]) }, Hy = function (e, t) { return n = qn.fromDom(t.cloneContents()), r = qy(e, t), o = H.foldl(r, function (e, t) { return Fu.append(t, e), t }, n), 0 < r.length ? Sy([o]) : o; var n, r, o }, jy = function (e, o) { return (t = e, n = o[0], bl(n, "table", V.curry(Or.eq, t))).bind(function (e) { var t = o[0], n = o[o.length - 1], r = My(e); return zy(r, t, n).map(function (e) { return Sy([Fy(e)]) }) }).getOrThunk(Vy); var t, n }, $y = function (e, t) { var n, r, o = Td(t, e); return 0 < o.length ? jy(e, o) : (n = e, 0 < (r = t).length && r[0].collapsed ? Vy() : Hy(n, r[0])) }, Wy = function (e, t) { var n, r = e.selection.getRng(), o = e.dom.create("body"), i = e.selection.getSel(), a = Cy(e, xd(i)); if ((t = t || {}).get = !0, t.format = t.format || "html", t.selection = !0, (t = e.fire("BeforeGetContent", t)).isDefaultPrevented()) return e.fire("GetContent", t), t.content; if ("text" === t.format) return e.selection.isCollapsed() ? "" : Si(r.text || (i.toString ? i.toString() : "")); r.cloneContents ? (n = t.contextual ? $y(qn.fromDom(e.getBody()), a).dom() : r.cloneContents()) && o.appendChild(n) : r.item !== undefined || r.htmlText !== undefined ? (o.innerHTML = "<br>" + (r.item ? r.item(0).outerHTML : r.htmlText), o.removeChild(o.firstChild)) : o.innerHTML = r.toString(), t.getInner = !0; var u = e.selection.serializer.serialize(o, t); return "tree" === t.format ? u : (t.content = e.selection.isCollapsed() ? "" : u, e.fire("GetContent", t), t.content) }, Ky = function (e, t, n) { var r, o, i, a = e.selection.getRng(), u = e.getDoc(); if ((n = n || { format: "html" }).set = !0, n.selection = !0, n.content = t, n.no_events || !(n = e.fire("BeforeSetContent", n)).isDefaultPrevented()) { if (t = n.content, a.insertNode) { t += '<span id="__caret">_</span>', a.startContainer === u && a.endContainer === u ? u.body.innerHTML = t : (a.deleteContents(), 0 === u.body.childNodes.length ? u.body.innerHTML = t : a.createContextualFragment ? a.insertNode(a.createContextualFragment(t)) : (o = u.createDocumentFragment(), i = u.createElement("div"), o.appendChild(i), i.outerHTML = t, a.insertNode(o))), r = e.dom.get("__caret"), (a = u.createRange()).setStartBefore(r), a.setEndBefore(r), e.selection.setRng(a), e.dom.remove("__caret"); try { e.selection.setRng(a) } catch (s) { } } else a.item && (u.execCommand("Delete", !1, null), a = e.getRng()), /^\s+/.test(t) ? (a.pasteHTML('<span id="__mce_tmp">_</span>' + t), e.dom.remove("__mce_tmp")) : a.pasteHTML(t); n.no_events || e.fire("SetContent", n) } else e.fire("SetContent", n) }, Xy = function (e, t, n, r, o) { var i = n ? t.startContainer : t.endContainer, a = n ? t.startOffset : t.endOffset; return A.from(i).map(qn.fromDom).map(function (e) { return r && t.collapsed ? e : qr.child(e, o(e, a)).getOr(e) }).bind(function (e) { return Qn.isElement(e) ? A.some(e) : qr.parent(e) }).map(function (e) { return e.dom() }).getOr(e) }, Yy = function (e, t, n) { return Xy(e, t, !0, n, function (e, t) { return Math.min(qr.childNodesCount(e), t) }) }, Gy = function (e, t, n) { return Xy(e, t, !1, n, function (e, t) { return 0 < t ? t - 1 : t }) }, Jy = function (e, t) { for (var n = e; e && Ao.isText(e) && 0 === e.length;)e = t ? e.nextSibling : e.previousSibling; return e || n }, Qy = Lt.each, Zy = function (e) { return !!e.select }, eb = function (e) { return !(!e || !e.ownerDocument) && Or.contains(qn.fromDom(e.ownerDocument), qn.fromDom(e)) }, tb = function (u, s, e, c) { var n, t, l, f, a, r = function (e, t) { return Ky(c, e, t) }, o = function (e) { var t = m(); t.collapse(!!e), i(t) }, d = function () { return s.getSelection ? s.getSelection() : s.document.selection }, m = function () { var e, t, n, r, o = function (e, t, n) { try { return t.compareBoundaryPoints(e, n) } catch (r) { return -1 } }; if (!s) return null; if (null == (r = s.document)) return null; if (c.bookmark !== undefined && !1 === dp(c)) { var i = _m.getRng(c); if (i.isSome()) return i.map(function (e) { return Cy(c, [e])[0] }).getOr(r.createRange()) } try { (e = d()) && (t = 0 < e.rangeCount ? e.getRangeAt(0) : e.createRange ? e.createRange() : r.createRange()) } catch (a) { } return (t = Cy(c, [t])[0]) || (t = r.createRange ? r.createRange() : r.body.createTextRange()), t.setStart && 9 === t.startContainer.nodeType && t.collapsed && (n = u.getRoot(), t.setStart(n, 0), t.setEnd(n, 0)), l && f && (0 === o(t.START_TO_START, t, l) && 0 === o(t.END_TO_END, t, l) ? t = f : f = l = null), t }, i = function (e, t) { var n, r; if ((o = e) && (Zy(o) || eb(o.startContainer) && eb(o.endContainer))) { var o, i = Zy(e) ? e : null; if (i) { f = null; try { i.select() } catch (a) { } } else { if (n = d(), e = c.fire("SetSelectionRange", { range: e, forward: t }).range, n) { f = e; try { n.removeAllRanges(), n.addRange(e) } catch (a) { } !1 === t && n.extend && (n.collapse(e.endContainer, e.endOffset), n.extend(e.startContainer, e.startOffset)), l = 0 < n.rangeCount ? n.getRangeAt(0) : null } e.collapsed || e.startContainer !== e.endContainer || !n.setBaseAndExtent || ge.ie || e.endOffset - e.startOffset < 2 && e.startContainer.hasChildNodes() && (r = e.startContainer.childNodes[e.startOffset]) && "IMG" === r.tagName && (n.setBaseAndExtent(e.startContainer, e.startOffset, e.endContainer, e.endOffset), n.anchorNode === e.startContainer && n.focusNode === e.endContainer || n.setBaseAndExtent(r, 0, r, 1)), c.fire("AfterSetSelectionRange", { range: e, forward: t }) } } }, p = function () { var e, t, n = d(); return !(n && n.anchorNode && n.focusNode) || ((e = u.createRng()).setStart(n.anchorNode, n.anchorOffset), e.collapse(!0), (t = u.createRng()).setStart(n.focusNode, n.focusOffset), t.collapse(!0), e.compareBoundaryPoints(e.START_TO_START, t) <= 0) }, g = { bookmarkManager: null, controlSelection: null, dom: u, win: s, serializer: e, editor: c, collapse: o, setCursorLocation: function (e, t) { var n = u.createRng(); e ? (n.setStart(e, t), n.setEnd(e, t), i(n), o(!1)) : (Ry(u, n, c.getBody(), !0), i(n)) }, getContent: function (e) { return Wy(c, e) }, setContent: r, getBookmark: function (e, t) { return n.getBookmark(e, t) }, moveToBookmark: function (e) { return n.moveToBookmark(e) }, select: function (e, t) { var r, n, o; return (r = u, n = e, o = t, A.from(n).map(function (e) { var t = r.nodeIndex(e), n = r.createRng(); return n.setStart(e.parentNode, t), n.setEnd(e.parentNode, t + 1), o && (Ry(r, n, e, !0), Ry(r, n, e, !1)), n })).each(i), e }, isCollapsed: function () { var e = m(), t = d(); return !(!e || e.item) && (e.compareEndPoints ? 0 === e.compareEndPoints("StartToEnd", e) : !t || e.collapsed) }, isForward: p, setNode: function (e) { return r(u.getOuterHTML(e)), e }, getNode: function () { return e = c.getBody(), (t = m()) ? (r = t.startContainer, o = t.endContainer, i = t.startOffset, a = t.endOffset, n = t.commonAncestorContainer, !t.collapsed && (r === o && a - i < 2 && r.hasChildNodes() && (n = r.childNodes[i]), 3 === r.nodeType && 3 === o.nodeType && (r = r.length === i ? Jy(r.nextSibling, !0) : r.parentNode, o = 0 === a ? Jy(o.previousSibling, !1) : o.parentNode, r && r === o)) ? r : n && 3 === n.nodeType ? n.parentNode : n) : e; var e, t, n, r, o, i, a }, getSel: d, setRng: i, getRng: m, getStart: function (e) { return Yy(c.getBody(), m(), e) }, getEnd: function (e) { return Gy(c.getBody(), m(), e) }, getSelectedBlocks: function (e, t) { return function (e, t, n, r) { var o, i, a = []; if (i = e.getRoot(), n = e.getParent(n || Yy(i, t, !1), e.isBlock), r = e.getParent(r || Gy(i, t, !1), e.isBlock), n && n !== i && a.push(n), n && r && n !== r) for (var u = new no(o = n, i); (o = u.next()) && o !== r;)e.isBlock(o) && a.push(o); return r && n !== r && r !== i && a.push(r), a }(u, m(), e, t) }, normalize: function () { var e = m(); if (!Nd(d())) { var t = rm.normalize(u, e); return t.each(function (e) { i(e, p()) }), t.getOr(e) } return e }, selectorChanged: function (e, t) { var i; return a || (a = {}, i = {}, c.on("NodeChange", function (e) { var n = e.element, r = u.getParents(n, null, u.getRoot()), o = {}; Qy(a, function (e, n) { Qy(r, function (t) { if (u.is(t, n)) return i[n] || (Qy(e, function (e) { e(!0, { node: t, selector: n, parents: r }) }), i[n] = e), o[n] = e, !1 }) }), Qy(i, function (e, t) { o[t] || (delete i[t], Qy(e, function (e) { e(!1, { node: n, selector: t, parents: r }) })) }) })), a[e] || (a[e] = []), a[e].push(t), g }, getScrollContainer: function () { for (var e, t = u.getRoot(); t && "BODY" !== t.nodeName;) { if (t.scrollHeight > t.clientHeight) { e = t; break } t = t.parentNode } return e }, scrollIntoView: function (e, t) { return yu(c, e, t) }, placeCaretAt: function (e, t) { return i(by.fromPoint(e, t, c.getDoc())) }, getBoundingClientRect: function () { var e = m(); return e.collapsed ? Ba.fromRangeStart(e).getClientRects()[0] : e.getBoundingClientRect() }, destroy: function () { s = l = f = null, t.destroy() } }; return n = py(g), t = vy(g, c), g.bookmarkManager = n, g.controlSelection = t, g }, nb = Ao.isContentEditableFalse, rb = ta, ob = ks, ib = Ss, ab = function (e, t) { for (; t = e(t);)if (t.isVisible()) return t; return t }, ub = function (e, t, n, r) { var o, i, a, u, s, c, l = e === eu.Forwards, f = l ? ib : ob; return !r.collapsed && (o = rb(r), nb(o)) ? Ga(e, t, o, e === eu.Backwards, !0) : (u = Ai(r.startContainer), f(i = Es(e, t.getBody(), r)) ? Ja(t, i.getNode(!l)) : (i = n(i)) ? f(i) ? Ga(e, t, i.getNode(!l), l, !0) : f(a = n(i)) && (!(c = ps(s = i, a)) && Ao.isBr(s.getNode()) || c) ? Ga(e, t, a.getNode(!l), l, !0) : u ? Za(t, i.toRange(), !0) : null : u ? r : null) }, sb = function (e, t, n, r) { var o, i, a, u, s, c, l, f, d; if (d = rb(r), o = Es(e, t.getBody(), r), i = n(t.getBody(), mg(1), o), a = Bt.filter(i, pg(1)), s = Bt.last(o.getClientRects()), (ib(o) || Ts(o)) && (d = o.getNode()), (ob(o) || As(o)) && (d = o.getNode(!0)), !s) return null; if (c = s.left, (u = Cg(a, c)) && nb(u.node)) return l = Math.abs(c - u.left), f = Math.abs(c - u.right), Ga(e, t, u.node, l < f, !0); if (d) { var m = function (e, t, n, r) { var o, i, a, u, s, c, l = js(t), f = [], d = 0, m = function (e) { return Bt.last(e.getClientRects()) }; 1 === e ? (o = l.next, i = ea, a = Zi, u = Ba.after(r)) : (o = l.prev, i = Zi, a = ea, u = Ba.before(r)), c = m(u); do { if (u.isVisible() && !a(s = m(u), c)) { if (0 < f.length && i(s, Bt.last(f)) && d++ , (s = Gi(s)).position = u, s.line = d, n(s)) return f; f.push(s) } } while (u = o(u)); return f }(e, t.getBody(), mg(1), d); if (u = Cg(Bt.filter(m, pg(1)), c)) return Za(t, u.position.toRange(), !0); if (u = Bt.last(Bt.filter(m, pg(0)))) return Za(t, u.position.toRange(), !0) } }, cb = function (e, t, n) { var r, o, i, a, u = js(e.getBody()), s = ua.curry(ab, u.next), c = ua.curry(ab, u.prev); if (n.collapsed && e.settings.forced_root_block) { if (!(r = e.dom.getParent(n.startContainer, "PRE"))) return; (1 === t ? s(Ba.fromRangeStart(n)) : c(Ba.fromRangeStart(n))) || (a = (i = e).dom.create(i.settings.forced_root_block), (!ge.ie || 11 <= ge.ie) && (a.innerHTML = '<br data-mce-bogus="1">'), o = a, 1 === t ? e.$(r).after(o) : e.$(r).before(o), e.selection.select(o, !0), e.selection.collapse()) } }, lb = function (l, f) { return function () { var e, t, n, r, o, i, a, u, s, c = (t = f, r = js((e = l).getBody()), o = ua.curry(ab, r.next), i = ua.curry(ab, r.prev), a = t ? eu.Forwards : eu.Backwards, u = t ? o : i, s = e.selection.getRng(), (n = ub(a, e, u, s)) ? n : (n = cb(e, a, s)) || null); return !!c && (l.selection.setRng(c), !0) } }, fb = function (u, s) { return function () { var e, t, n, r, o, i, a = (r = (t = s) ? 1 : -1, o = t ? dg : fg, i = (e = u).selection.getRng(), (n = sb(r, e, o, i)) ? n : (n = cb(e, r, i)) || null); return !!a && (u.selection.setRng(a), !0) } }, db = function (e, r) { return H.bind((t = e, H.map(t, function (e) { return Fv.merge({ shiftKey: !1, altKey: !1, ctrlKey: !1, metaKey: !1, keyCode: 0, action: V.noop }, e) })), function (e) { return t = e, (n = r).keyCode === t.keyCode && n.shiftKey === t.shiftKey && n.altKey === t.altKey && n.ctrlKey === t.ctrlKey && n.metaKey === t.metaKey ? [e] : []; var t, n }); var t }, mb = function (e) { for (var t = [], n = 1; n < arguments.length; n++)t[n - 1] = arguments[n]; var r = Array.prototype.slice.call(arguments, 1); return function () { return e.apply(null, r) } }, pb = function (e, t) { return H.find(db(e, t), function (e) { return e.action() }) }, gb = function (i, a) { i.on("keydown", function (e) { var t, n, r, o; !1 === e.isDefaultPrevented() && (t = i, n = a, r = e, o = zn.detect().os, pb([{ keyCode: kg.RIGHT, action: lb(t, !0) }, { keyCode: kg.LEFT, action: lb(t, !1) }, { keyCode: kg.UP, action: fb(t, !1) }, { keyCode: kg.DOWN, action: fb(t, !0) }, { keyCode: kg.RIGHT, action: Yu(t, !0) }, { keyCode: kg.LEFT, action: Yu(t, !1) }, { keyCode: kg.UP, action: Gu(t, !1) }, { keyCode: kg.DOWN, action: Gu(t, !0) }, { keyCode: kg.RIGHT, action: td.move(t, n, !0) }, { keyCode: kg.LEFT, action: td.move(t, n, !1) }, { keyCode: kg.RIGHT, ctrlKey: !o.isOSX(), altKey: o.isOSX(), action: td.moveNextWord(t, n) }, { keyCode: kg.LEFT, ctrlKey: !o.isOSX(), altKey: o.isOSX(), action: td.movePrevWord(t, n) }], r).each(function (e) { r.preventDefault() })) }) }, hb = function (e) { return 1 === qr.children(e).length }, vb = function (e, t, n, r) { var o, i, a, u, s = V.curry(Hh, t), c = H.map(H.filter(r, s), function (e) { return e.dom() }); if (0 === c.length) lf(t, e, n); else { var l = (o = n.dom(), i = c, a = Ih(!1), u = qh(i, a.dom()), Fu.before(qn.fromDom(o), a), Ic.remove(qn.fromDom(o)), Ba(u, 0)); t.selection.setRng(l.toRange()) } }, yb = function (n, r) { var t, e = qn.fromDom(n.getBody()), o = qn.fromDom(n.selection.getStart()), i = H.filter((t = Ml(o, e), H.findIndex(t, so).fold(V.constant(t), function (e) { return t.slice(0, e) })), hb); return H.last(i).map(function (e) { var t = Ba.fromRangeStart(n.selection.getRng()); return !!vl(r, t, e.dom()) && (vb(r, n, e, i), !0) }).getOr(!1) }, bb = function (e, t) { return !!e.selection.isCollapsed() && yb(e, t) }, Cb = function (o, i) { o.on("keydown", function (e) { var t, n, r; !1 === e.isDefaultPrevented() && (t = o, n = i, r = e, pb([{ keyCode: kg.BACKSPACE, action: mb(mf, t, !1) }, { keyCode: kg.DELETE, action: mb(mf, t, !0) }, { keyCode: kg.BACKSPACE, action: mb(id, t, n, !1) }, { keyCode: kg.DELETE, action: mb(id, t, n, !0) }, { keyCode: kg.BACKSPACE, action: mb(Xl, t, !1) }, { keyCode: kg.DELETE, action: mb(Xl, t, !0) }, { keyCode: kg.BACKSPACE, action: mb(jl, t, !1) }, { keyCode: kg.DELETE, action: mb(jl, t, !0) }, { keyCode: kg.BACKSPACE, action: mb(Fd, t, !1) }, { keyCode: kg.DELETE, action: mb(Fd, t, !0) }, { keyCode: kg.BACKSPACE, action: mb(bb, t, !1) }, { keyCode: kg.DELETE, action: mb(bb, t, !0) }], r).each(function (e) { r.preventDefault() })) }), o.on("keyup", function (e) { var t, n; !1 === e.isDefaultPrevented() && (t = o, n = e, pb([{ keyCode: kg.BACKSPACE, action: mb(pf, t) }, { keyCode: kg.DELETE, action: mb(pf, t) }], n)) }) }, xb = function (e) { return A.from(e.dom.getParent(e.selection.getStart(!0), e.dom.isBlock)) }, wb = function (e, t) { var n, r, o, i = t, a = e.dom, u = e.schema.getMoveCaretBeforeOnEnterElements(); if (t) { if (/^(LI|DT|DD)$/.test(t.nodeName)) { var s = function (e) { for (; e;) { if (1 === e.nodeType || 3 === e.nodeType && e.data && /[\r\n\s]/.test(e.data)) return e; e = e.nextSibling } }(t.firstChild); s && /^(UL|OL|DL)$/.test(s.nodeName) && t.insertBefore(a.doc.createTextNode("\xa0"), t.firstChild) } if (o = a.createRng(), t.normalize(), t.hasChildNodes()) { for (n = new no(t, t); r = n.current();) { if (Ao.isText(r)) { o.setStart(r, 0), o.setEnd(r, 0); break } if (u[r.nodeName.toLowerCase()]) { o.setStartBefore(r), o.setEndBefore(r); break } i = r, r = n.next() } r || (o.setStart(i, 0), o.setEnd(i, 0)) } else Ao.isBr(t) ? t.nextSibling && a.isBlock(t.nextSibling) ? (o.setStartBefore(t), o.setEndBefore(t)) : (o.setStartAfter(t), o.setEndAfter(t)) : (o.setStart(t, 0), o.setEnd(t, 0)); e.selection.setRng(o), a.remove(void 0), e.selection.scrollIntoView(t) } }, Nb = function (e, t) { var n, r, o = e.getRoot(); for (n = t; n !== o && "false" !== e.getContentEditable(n);)"true" === e.getContentEditable(n) && (r = n), n = n.parentNode; return n !== o ? r : o }, Eb = xb, Sb = function (e) { return xb(e).fold(V.constant(""), function (e) { return e.nodeName.toUpperCase() }) }, kb = function (e) { return xb(e).filter(function (e) { return po(qn.fromDom(e)) }).isSome() }, Tb = function (e, t) { return e && e.parentNode && e.parentNode.nodeName === t }, Ab = function (e) { return e && /^(OL|UL|LI)$/.test(e.nodeName) }, Rb = function (e) { var t = e.parentNode; return /^(LI|DT|DD)$/.test(t.nodeName) ? t : e }, Bb = function (e, t, n) { for (var r = e[n ? "firstChild" : "lastChild"]; r && !Ao.isElement(r);)r = r[n ? "nextSibling" : "previousSibling"]; return r === t }, _b = function (e, t, n, r, o) { var i = e.dom, a = e.selection.getRng(); if (n !== e.getBody()) { var u; Ab(u = n) && Ab(u.parentNode) && (o = "LI"); var s, c, l = o ? t(o) : i.create("BR"); if (Bb(n, r, !0) && Bb(n, r, !1)) Tb(n, "LI") ? i.insertAfter(l, Rb(n)) : i.replace(l, n); else if (Bb(n, r, !0)) Tb(n, "LI") ? (i.insertAfter(l, Rb(n)), l.appendChild(i.doc.createTextNode(" ")), l.appendChild(n)) : n.parentNode.insertBefore(l, n); else if (Bb(n, r, !1)) i.insertAfter(l, Rb(n)); else { n = Rb(n); var f = a.cloneRange(); f.setStartAfter(r), f.setEndAfter(n); var d = f.extractContents(); "LI" === o && (c = "LI", (s = d).firstChild && s.firstChild.nodeName === c) ? (l = d.firstChild, i.insertAfter(d, n)) : (i.insertAfter(d, n), i.insertAfter(l, n)) } i.remove(r), wb(e, l) } }, Db = function (e) { e.innerHTML = '<br data-mce-bogus="1">' }, Ob = function (e, t) { return e.nodeName === t || e.previousSibling && e.previousSibling.nodeName === t }, Pb = function (e, t) { return t && e.isBlock(t) && !/^(TD|TH|CAPTION|FORM)$/.test(t.nodeName) && !/^(fixed|absolute)/i.test(t.style.position) && "true" !== e.getContentEditable(t) }, Lb = function (e, t, n) { return !1 === Ao.isText(t) ? n : e ? 1 === n && t.data.charAt(n - 1) === Ei ? 0 : n : n === t.data.length - 1 && t.data.charAt(n) === Ei ? t.data.length : n }, Ib = function (e, t) { var n, r, o = e.getRoot(); for (n = t; n !== o && "false" !== e.getContentEditable(n);)"true" === e.getContentEditable(n) && (r = n), n = n.parentNode; return n !== o ? r : o }, Mb = function (e, t) { var n = Au(e); n && n.toLowerCase() === t.tagName.toLowerCase() && e.dom.setAttribs(t, Ru(e)) }, Fb = function (a, e) { var t, u, s, i, c, n, r, o, l, f, d, m, p, g, h, v, y, b, C = a.dom, x = a.schema, w = x.getNonEmptyElements(), N = a.selection.getRng(), E = function (e) { var t, n, r, o = s, i = x.getTextInlineElements(); if (e || "TABLE" === f || "HR" === f ? (t = C.create(e || m), Mb(a, t)) : t = c.cloneNode(!1), r = t, !1 === Du(a)) C.setAttrib(t, "style", null), C.setAttrib(t, "class", null); else do { if (i[o.nodeName]) { if (xc(o)) continue; n = o.cloneNode(!1), C.setAttrib(n, "id", ""), t.hasChildNodes() ? n.appendChild(t.firstChild) : r = n, t.appendChild(n) } } while ((o = o.parentNode) && o !== u); return Db(r), t }, S = function (e) { var t, n, r, o; if (o = Lb(e, s, i), Ao.isText(s) && (e ? 0 < o : o < s.nodeValue.length)) return !1; if (s.parentNode === c && p && !e) return !0; if (e && Ao.isElement(s) && s === c.firstChild) return !0; if (Ob(s, "TABLE") || Ob(s, "HR")) return p && !e || !p && e; for (t = new no(s, c), Ao.isText(s) && (e && 0 === o ? t.prev() : e || o !== s.nodeValue.length || t.next()); n = t.current();) { if (Ao.isElement(n)) { if (!n.getAttribute("data-mce-bogus") && (r = n.nodeName.toLowerCase(), w[r] && "br" !== r)) return !1 } else if (Ao.isText(n) && !/^[ \t\r\n]*$/.test(n.nodeValue)) return !1; e ? t.prev() : t.next() } return !0 }, k = function () { r = /^(H[1-6]|PRE|FIGURE)$/.test(f) && "HGROUP" !== d ? E(m) : E(), Ou(a) && Pb(C, l) && C.isEmpty(c) ? r = C.split(l, c) : C.insertAfter(r, c), wb(a, r) }; rm.normalize(C, N).each(function (e) { N.setStart(e.startContainer, e.startOffset), N.setEnd(e.endContainer, e.endOffset) }), s = N.startContainer, i = N.startOffset, m = Au(a), n = e.shiftKey, Ao.isElement(s) && s.hasChildNodes() && (p = i > s.childNodes.length - 1, s = s.childNodes[Math.min(i, s.childNodes.length - 1)] || s, i = p && Ao.isText(s) ? s.nodeValue.length : 0), (u = Ib(C, s)) && ((m && !n || !m && n) && (s = function (e, t, n, r, o) { var i, a, u, s, c, l, f, d = t || "P", m = e.dom, p = Ib(m, r); if (!(a = m.getParent(r, m.isBlock)) || !Pb(m, a)) { if (l = (a = a || p) === e.getBody() || (f = a) && /^(TD|TH|CAPTION)$/.test(f.nodeName) ? a.nodeName.toLowerCase() : a.parentNode.nodeName.toLowerCase(), !a.hasChildNodes()) return i = m.create(d), Mb(e, i), a.appendChild(i), n.setStart(i, 0), n.setEnd(i, 0), i; for (s = r; s.parentNode !== a;)s = s.parentNode; for (; s && !m.isBlock(s);)s = (u = s).previousSibling; if (u && e.schema.isValidChild(l, d.toLowerCase())) { for (i = m.create(d), Mb(e, i), u.parentNode.insertBefore(i, u), s = u; s && !m.isBlock(s);)c = s.nextSibling, i.appendChild(s), s = c; n.setStart(r, o), n.setEnd(r, o) } } return r }(a, m, N, s, i)), c = C.getParent(s, C.isBlock), l = c ? C.getParent(c.parentNode, C.isBlock) : null, f = c ? c.nodeName.toUpperCase() : "", "LI" !== (d = l ? l.nodeName.toUpperCase() : "") || e.ctrlKey || (l = (c = l).parentNode, f = d), /^(LI|DT|DD)$/.test(f) && C.isEmpty(c) ? _b(a, E, l, c, m) : m && c === a.getBody() || (m = m || "P", Ai(c) ? (r = Mi(c), C.isEmpty(c) && Db(c), wb(a, r)) : S() ? k() : S(!0) ? (r = c.parentNode.insertBefore(E(), c), wb(a, Ob(c, "HR") ? r : c)) : ((t = (y = N, b = y.cloneRange(), b.setStart(y.startContainer, Lb(!0, y.startContainer, y.startOffset)), b.setEnd(y.endContainer, Lb(!1, y.endContainer, y.endOffset)), b).cloneRange()).setEndAfter(c), function (e) { for (; Ao.isText(e) && (e.nodeValue = e.nodeValue.replace(/^[\r\n]+/, "")), e = e.firstChild;); }(o = t.extractContents()), r = o.firstChild, C.insertAfter(o, c), function (e, t, n) { var r, o = n, i = []; if (o) { for (; o = o.firstChild;) { if (e.isBlock(o)) return; Ao.isElement(o) && !t[o.nodeName.toLowerCase()] && i.push(o) } for (r = i.length; r--;)!(o = i[r]).hasChildNodes() || o.firstChild === o.lastChild && "" === o.firstChild.nodeValue ? e.remove(o) : (a = o) && "A" === a.nodeName && 0 === Lt.trim(Si(a.innerText || a.textContent)).length && e.remove(o); var a } }(C, w, r), g = C, (h = c).normalize(), (v = h.lastChild) && !/^(left|right)$/gi.test(g.getStyle(v, "float", !0)) || g.add(h, "br"), C.isEmpty(c) && Db(c), r.normalize(), C.isEmpty(r) ? (C.remove(r), k()) : wb(a, r)), C.setAttrib(r, "id", ""), a.fire("NewBlock", { newBlock: r }))) }, zb = function (e, t) { return Eb(e).filter(function (e) { return 0 < t.length && Br.is(qn.fromDom(e), t) }).isSome() }, Ub = function (e) { return zb(e, Bu(e)) }, qb = function (e) { return zb(e, _u(e)) }, Vb = Yl([{ br: [] }, { block: [] }, { none: [] }]), Hb = function (e, t) { return qb(e) }, jb = function (n) { return function (e, t) { return "" === Au(e) === n } }, $b = function (n) { return function (e, t) { return kb(e) === n } }, Wb = function (n) { return function (e, t) { return "PRE" === Sb(e) === n } }, Kb = function (n) { return function (e, t) { return Tu(e) === n } }, Xb = function (e, t) { return Ub(e) }, Yb = function (e, t) { return t }, Gb = function (e) { var t = Au(e), n = Nb(e.dom, e.selection.getStart()); return n && e.schema.isValidChild(n.nodeName, t || "P") }, Jb = function (e, t) { return function (n, r) { return H.foldl(e, function (e, t) { return e && t(n, r) }, !0) ? A.some(t) : A.none() } }, Qb = function (e, t) { return Sf([Jb([Hb], Vb.none()), Jb([Wb(!0), Kb(!1), Yb], Vb.br()), Jb([Wb(!0), Kb(!1)], Vb.block()), Jb([Wb(!0), Kb(!0), Yb], Vb.block()), Jb([Wb(!0), Kb(!0)], Vb.br()), Jb([$b(!0), Yb], Vb.br()), Jb([$b(!0)], Vb.block()), Jb([jb(!0), Yb, Gb], Vb.block()), Jb([jb(!0)], Vb.br()), Jb([Xb], Vb.br()), Jb([jb(!1), Yb], Vb.br()), Jb([Gb], Vb.block())], [e, t.shiftKey]).getOr(Vb.none()) }, Zb = function (e, t) { Qb(e, t).fold(function () { mm.insert(e, t) }, function () { Fb(e, t) }, V.noop) }, eC = function (o) { o.on("keydown", function (e) { var t, n, r; e.keyCode === kg.ENTER && (t = o, (n = e).isDefaultPrevented() || (n.preventDefault(), (r = t.undoManager).typing && (r.typing = !1, r.add()), t.undoManager.transact(function () { !1 === t.selection.isCollapsed() && t.execCommand("Delete"), Zb(t, n) }))) }) }, tC = function (e, t, n) { return u = t, !(!nC(n) || !Ao.isText(u.container()) || (r = e, i = (o = t).container(), a = o.offset(), i.insertData(a, "\xa0"), r.selection.setCursorLocation(i, a + 1), 0)); var r, o, i, a, u }, nC = function (e) { return e.fold(V.constant(!1), V.constant(!0), V.constant(!0), V.constant(!1)) }, rC = function (e) { return !!e.selection.isCollapsed() && (t = e, n = V.curry(pl.isInlineTarget, t), r = Ba.fromRangeStart(t.selection.getRng()), Hf(n, t.getBody(), r).map(V.curry(tC, t, r)).getOr(!1)); var t, n, r }, oC = function (r) { r.on("keydown", function (e) { var t, n; !1 === e.isDefaultPrevented() && (t = r, n = e, pb([{ keyCode: kg.SPACEBAR, action: mb(rC, t) }], n).each(function (e) { n.preventDefault() })) }) }, iC = function (e, t) { var n; t.hasAttribute("data-mce-caret") && (Mi(t), (n = e).selection.setRng(n.selection.getRng()), e.selection.scrollIntoView(t)) }, aC = function (e, t) { var n, r = (n = e, Cl(qn.fromDom(n.getBody()), "*[data-mce-caret]").fold(V.constant(null), function (e) { return e.dom() })); if (r) return "compositionstart" === t.type ? (t.preventDefault(), t.stopPropagation(), void iC(e, r)) : void (_i(r) && (iC(e, r), e.undoManager.add())) }, uC = function (e) { e.on("keyup compositionstart", V.curry(aC, e)) }, sC = function (e) { var t = td.setupSelectedState(e); uC(e), gb(e, t), Cb(e, t), eC(e), oC(e) }; function cC(u) { var s, n, r, o = Lt.each, c = kg.BACKSPACE, l = kg.DELETE, f = u.dom, d = u.selection, e = u.settings, t = u.parser, i = ge.gecko, a = ge.ie, m = ge.webkit, p = "data:text/mce-internal,", g = a ? "Text" : "URL", h = function (e, t) { try { u.getDoc().execCommand(e, !1, t) } catch (n) { } }, v = function (e) { return e.isDefaultPrevented() }, y = function () { u.shortcuts.add("meta+a", null, "SelectAll") }, b = function () { u.on("keydown", function (e) { if (!v(e) && e.keyCode === c && d.isCollapsed() && 0 === d.getRng().startOffset) { var t = d.getNode().previousSibling; if (t && t.nodeName && "table" === t.nodeName.toLowerCase()) return e.preventDefault(), !1 } }) }, C = function () { u.inline || (u.contentStyles.push("body {min-height: 150px}"), u.on("click", function (e) { var t; if ("HTML" === e.target.nodeName) { if (11 < ge.ie) return void u.getBody().focus(); t = u.selection.getRng(), u.getBody().focus(), u.selection.setRng(t), u.selection.normalize(), u.nodeChanged() } })) }; return u.on("keydown", function (e) { var t, n, r, o, i; if (!v(e) && e.keyCode === kg.BACKSPACE && (n = (t = d.getRng()).startContainer, r = t.startOffset, o = f.getRoot(), i = n, t.collapsed && 0 === r)) { for (; i && i.parentNode && i.parentNode.firstChild === i && i.parentNode !== o;)i = i.parentNode; "BLOCKQUOTE" === i.tagName && (u.formatter.toggle("blockquote", null, i), (t = f.createRng()).setStart(n, 0), t.setEnd(n, 0), d.setRng(t)) } }), s = function (e) { var t = f.create("body"), n = e.cloneContents(); return t.appendChild(n), d.serializer.serialize(t, { format: "html" }) }, u.on("keydown", function (e) { var t, n, r, o, i, a = e.keyCode; if (!v(e) && (a === l || a === c)) { if (t = u.selection.isCollapsed(), n = u.getBody(), t && !f.isEmpty(n)) return; if (!t && (r = u.selection.getRng(), o = s(r), (i = f.createRng()).selectNode(u.getBody()), o !== s(i))) return; e.preventDefault(), u.setContent(""), n.firstChild && f.isBlock(n.firstChild) ? u.selection.setCursorLocation(n.firstChild, 0) : u.selection.setCursorLocation(n, 0), u.nodeChanged() } }), ge.windowsPhone || u.on("keyup focusin mouseup", function (e) { kg.modifierPressed(e) || d.normalize() }, !0), m && (u.settings.content_editable || f.bind(u.getDoc(), "mousedown mouseup", function (e) { var t; if (e.target === u.getDoc().documentElement) if (t = d.getRng(), u.getBody().focus(), "mousedown" === e.type) { if (Bi(t.startContainer)) return; d.placeCaretAt(e.clientX, e.clientY) } else d.setRng(t) }), u.on("click", function (e) { var t = e.target; /^(IMG|HR)$/.test(t.nodeName) && "false" !== f.getContentEditableParent(t) && (e.preventDefault(), u.selection.select(t), u.nodeChanged()), "A" === t.nodeName && f.hasClass(t, "mce-item-anchor") && (e.preventDefault(), d.select(t)) }), e.forced_root_block && u.on("init", function () { h("DefaultParagraphSeparator", e.forced_root_block) }), u.on("init", function () { u.dom.bind(u.getBody(), "submit", function (e) { e.preventDefault() }) }), b(), t.addNodeFilter("br", function (e) { for (var t = e.length; t--;)"Apple-interchange-newline" === e[t].attr("class") && e[t].remove() }), ge.iOS ? (u.inline || u.on("keydown", function () { document.activeElement === document.body && u.getWin().focus() }), C(), u.on("click", function (e) { var t = e.target; do { if ("A" === t.tagName) return void e.preventDefault() } while (t = t.parentNode) }), u.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")) : y()), 11 <= ge.ie && (C(), b()), ge.ie && (y(), h("AutoUrlDetect", !1), u.on("dragstart", function (e) { var t, n, r; (t = e).dataTransfer && (u.selection.isCollapsed() && "IMG" === t.target.tagName && d.select(t.target), 0 < (n = u.selection.getContent()).length && (r = p + escape(u.id) + "," + escape(n), t.dataTransfer.setData(g, r))) }), u.on("drop", function (e) { if (!v(e)) { var t = (i = e).dataTransfer && (a = i.dataTransfer.getData(g)) && 0 <= a.indexOf(p) ? (a = a.substr(p.length).split(","), { id: unescape(a[0]), html: unescape(a[1]) }) : null; if (t && t.id !== u.id) { e.preventDefault(); var n = by.fromPoint(e.x, e.y, u.getDoc()); d.setRng(n), r = t.html, o = !0, u.queryCommandSupported("mceInsertClipboardContent") ? u.execCommand("mceInsertClipboardContent", !1, { content: r, internal: o }) : u.execCommand("mceInsertContent", !1, r) } } var r, o, i, a })), i && (u.on("keydown", function (e) { if (!v(e) && e.keyCode === c) { if (!u.getBody().getElementsByTagName("hr").length) return; if (d.isCollapsed() && 0 === d.getRng().startOffset) { var t = d.getNode(), n = t.previousSibling; if ("HR" === t.nodeName) return f.remove(t), void e.preventDefault(); n && n.nodeName && "hr" === n.nodeName.toLowerCase() && (f.remove(n), e.preventDefault()) } } }), Range.prototype.getClientRects || u.on("mousedown", function (e) { if (!v(e) && "HTML" === e.target.nodeName) { var t = u.getBody(); t.blur(), Ce.setEditorTimeout(u, function () { t.focus() }) } }), n = function () { var e = f.getAttribs(d.getStart().cloneNode(!1)); return function () { var t = d.getStart(); t !== u.getBody() && (f.setAttrib(t, "style", null), o(e, function (e) { t.setAttributeNode(e.cloneNode(!0)) })) } }, r = function () { return !d.isCollapsed() && f.getParent(d.getStart(), f.isBlock) !== f.getParent(d.getEnd(), f.isBlock) }, u.on("keypress", function (e) { var t; if (!v(e) && (8 === e.keyCode || 46 === e.keyCode) && r()) return t = n(), u.getDoc().execCommand("delete", !1, null), t(), e.preventDefault(), !1 }), f.bind(u.getDoc(), "cut", function (e) { var t; !v(e) && r() && (t = n(), Ce.setEditorTimeout(u, function () { t() })) }), e.readonly || u.on("BeforeExecCommand MouseDown", function () { h("StyleWithCSS", !1), h("enableInlineTableEditing", !1), e.object_resizing || h("enableObjectResizing", !1) }), u.on("SetContent ExecCommand", function (e) { "setcontent" !== e.type && "mceInsertLink" !== e.command || o(f.select("a"), function (e) { var t = e.parentNode, n = f.getRoot(); if (t.lastChild === e) { for (; t && !f.isBlock(t);) { if (t.parentNode.lastChild !== t || t === n) return; t = t.parentNode } f.add(t, "br", { "data-mce-bogus": 1 }) } }) }), u.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}"), ge.mac && u.on("keydown", function (e) { !kg.metaKeyPressed(e) || e.shiftKey || 37 !== e.keyCode && 39 !== e.keyCode || (e.preventDefault(), u.selection.getSel().modify("move", 37 === e.keyCode ? "backward" : "forward", "lineboundary")) }), b()), { refreshContentEditable: function () { }, isHidden: function () { var e; return !i || u.removed ? 0 : !(e = u.selection.getSel()) || !e.rangeCount || 0 === e.rangeCount } } } var lC = function (e) { return Ao.isElement(e) && fo(qn.fromDom(e)) }, fC = function (t) { t.on("click", function (e) { 3 === e.detail && function (e) { var t = e.selection.getRng(), n = Ta.fromRangeStart(t), r = Ta.fromRangeEnd(t); if (Ta.isElementPosition(n)) { var o = n.container(); lC(o) && Ka.firstPositionIn(o).each(function (e) { return t.setStart(e.container(), e.offset()) }) } Ta.isElementPosition(r) && (o = n.container(), lC(o) && Ka.lastPositionIn(o).each(function (e) { return t.setEnd(e.container(), e.offset()) })), e.selection.setRng(Wc(t)) }(t) }) }, dC = di.DOM, mC = function (e) { var t; e.bindPendingEventDelegates(), e.initialized = !0, e.fire("init"), e.focus(!0), e.nodeChanged({ initial: !0 }), e.execCallback("init_instance_callback", e), (t = e).settings.auto_focus && Ce.setEditorTimeout(t, function () { var e; (e = !0 === t.settings.auto_focus ? t : t.editorManager.get(t.settings.auto_focus)).destroyed || e.focus() }, 100) }, pC = function (t, e) { var n, r, u, o, i, a, s, c, l, f = t.settings, d = t.getElement(), m = t.getDoc(); f.inline || (t.getElement().style.visibility = t.orgVisibility), e || f.content_editable || (m.open(), m.write(t.iframeHTML), m.close()), f.content_editable && (t.on("remove", function () { var e = this.getBody(); dC.removeClass(e, "mce-content-body"), dC.removeClass(e, "mce-edit-focus"), dC.setAttrib(e, "contentEditable", null) }), dC.addClass(d, "mce-content-body"), t.contentDocument = m = f.content_document || document, t.contentWindow = f.content_window || window, t.bodyElement = d, f.content_document = f.content_window = null, f.root_name = d.nodeName.toLowerCase()), (n = t.getBody()).disabled = !0, t.readonly = f.readonly, t.readonly || (t.inline && "static" === dC.getStyle(n, "position", !0) && (n.style.position = "relative"), n.contentEditable = t.getParam("content_editable_state", !0)), n.disabled = !1, t.editorUpload = $p(t), t.schema = Zo(f), t.dom = di(m, { keep_values: !0, url_converter: t.convertURL, url_converter_scope: t, hex_colors: f.force_hex_style_colors, class_filter: f.class_filter, update_styles: !0, root_element: t.inline ? t.getBody() : null, collect: f.content_editable, schema: t.schema, onSetAttrib: function (e) { t.fire("SetAttrib", e) } }), t.parser = ((o = uy((u = t).settings, u.schema)).addAttributeFilter("src,href,style,tabindex", function (e, t) { for (var n, r, o, i = e.length, a = u.dom; i--;)if (r = (n = e[i]).attr(t), o = "data-mce-" + t, !n.attributes.map[o]) { if (0 === r.indexOf("data:") || 0 === r.indexOf("blob:")) continue; "style" === t ? ((r = a.serializeStyle(a.parseStyle(r), n.name)).length || (r = null), n.attr(o, r), n.attr(t, r)) : "tabindex" === t ? (n.attr(o, r), n.attr(t, null)) : n.attr(o, u.convertURL(r, t, n.name)) } }), o.addNodeFilter("script", function (e) { for (var t, n, r = e.length; r--;)0 !== (n = (t = e[r]).attr("type") || "no/type").indexOf("mce-") && t.attr("type", "mce-" + n) }), o.addNodeFilter("#cdata", function (e) { for (var t, n = e.length; n--;)(t = e[n]).type = 8, t.name = "#comment", t.value = "[CDATA[" + t.value + "]]" }), o.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div", function (e) { for (var t, n = e.length, r = u.schema.getNonEmptyElements(); n--;)(t = e[n]).isEmpty(r) && 0 === t.getAll("br").length && (t.append(new Gv("br", 1)).shortEnded = !0) }), o), t.serializer = dy(f, t), t.selection = tb(t.dom, t.getWin(), t.serializer, t), t.formatter = Pv(t), t.undoManager = oh(t), t._nodeChangeDispatcher = new Gp(t), t._selectionOverrides = Dg(t), fC(t), sC(t), Yp(t), t.fire("PreInit"), f.browser_spellcheck || f.gecko_spellcheck || (m.body.spellcheck = !1, dC.setAttrib(n, "spellcheck", "false")), t.quirks = cC(t), t.fire("PostRender"), f.directionality && (n.dir = f.directionality), f.nowrap && (n.style.whiteSpace = "nowrap"), f.protect && t.on("BeforeSetContent", function (t) { Lt.each(f.protect, function (e) { t.content = t.content.replace(e, function (e) { return "\x3c!--mce:protected " + escape(e) + "--\x3e" }) }) }), t.on("SetContent", function () { t.addVisual(t.getBody()) }), t.load({ initial: !0, format: "html" }), t.startContent = t.getContent({ format: "raw" }), t.on("compositionstart compositionend", function (e) { t.composing = "compositionstart" === e.type }), 0 < t.contentStyles.length && (r = "", Lt.each(t.contentStyles, function (e) { r += e + "\r\n" }), t.dom.addStyle(r)), (i = t, i.inline ? dC.styleSheetLoader : i.dom.styleSheetLoader).loadAll(t.contentCSS, function (e) { mC(t) }, function (e) { mC(t) }), f.content_style && (a = t, s = f.content_style, c = qn.fromDom(a.getDoc().head), l = qn.fromTag("style"), cr.set(l, "type", "text/css"), Fu.append(l, qn.fromText(s)), Fu.append(c, l)) }, gC = di.DOM, hC = function (e, t) { var n, r, o, i, a, u, s, c = e.editorManager.translate("Rich Text Area. Press ALT-F9 for menu. Press ALT-F10 for toolbar. Press ALT-0 for help"), l = (n = e.id, r = c, o = t.height, i = xu(e), s = qn.fromTag("iframe"), cr.setAll(s, i), cr.setAll(s, { id: n + "_ifr", frameBorder: "0", allowTransparency: "true", title: r }), vr(s, { width: "100%", height: (a = o, u = "number" == typeof a ? a + "px" : a, u || ""), display: "block" }), s).dom(); l.onload = function () { l.onload = null, e.fire("load") }; var f, d, m, p, g = function (e, t) { if (document.domain !== window.location.hostname && ge.ie && ge.ie < 12) { var n = jp.uuid("mce"); e[n] = function () { pC(e) }; var r = 'javascript:(function(){document.open();document.domain="' + document.domain + '";var ed = window.parent.tinymce.get("' + e.id + '");document.write(ed.iframeHTML);document.close();ed.' + n + "(true);})()"; return gC.setAttrib(t, "src", r), !0 } return !1 }(e, l); return e.contentAreaContainer = t.iframeContainer, e.iframeElement = l, e.iframeHTML = (p = wu(f = e) + "<html><head>", Nu(f) !== f.documentBaseUrl && (p += '<base href="' + f.documentBaseURI.getURI() + '" />'), p += '<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />', d = Eu(f), m = Su(f), ku(f) && (p += '<meta http-equiv="Content-Security-Policy" content="' + ku(f) + '" />'), p += '</head><body id="' + d + '" class="mce-content-body ' + m + '" data-id="' + f.id + '"><br></body></html>'), gC.add(t.iframeContainer, l), g }, vC = function (e, t) { var n = hC(e, t); t.editorContainer && (gC.get(t.editorContainer).style.display = e.orgDisplay, e.hidden = gC.isHidden(t.editorContainer)), e.getElement().style.display = "none", gC.setAttrib(e.id, "aria-hidden", "true"), n || pC(e) }, yC = di.DOM, bC = function (t, n, e) { var r, o, i = Tp.get(e); if (r = Tp.urls[e] || t.documentBaseUrl.replace(/\/$/, ""), e = Lt.trim(e), i && -1 === Lt.inArray(n, e)) { if (Lt.each(Tp.dependencies(e), function (e) { bC(t, n, e) }), t.plugins[e]) return; o = new i(t, r, t.$), (t.plugins[e] = o).init && (o.init(t, r), n.push(e)) } }, CC = function (e) { return e.replace(/^\-/, "") }, xC = function (e) { return { editorContainer: e, iframeContainer: e } }, wC = function (e) { var t, n, r = e.getElement(); return e.inline ? xC(null) : (t = r, n = yC.create("div"), yC.insertAfter(n, t), xC(n)) }, NC = function (e) { var t, n, r, o, i, a, u, s, c, l, f, d = e.settings, m = e.getElement(); return e.orgDisplay = m.style.display, E.isString(d.theme) ? (l = (o = e).settings, f = o.getElement(), i = l.width || yC.getStyle(f, "width") || "100%", a = l.height || yC.getStyle(f, "height") || f.offsetHeight, u = l.min_height || 100, (s = /^[0-9\.]+(|px)$/i).test("" + i) && (i = Math.max(parseInt(i, 10), 100)), s.test("" + a) && (a = Math.max(parseInt(a, 10), u)), c = o.theme.renderUI({ targetNode: f, width: i, height: a, deltaWidth: l.delta_width, deltaHeight: l.delta_height }), l.content_editable || (a = (c.iframeHeight || a) + ("number" == typeof a ? c.deltaHeight || 0 : "")) < u && (a = u), c.height = a, c) : E.isFunction(d.theme) ? (r = (t = e).getElement(), (n = t.settings.theme(t, r)).editorContainer.nodeType && (n.editorContainer.id = n.editorContainer.id || t.id + "_parent"), n.iframeContainer && n.iframeContainer.nodeType && (n.iframeContainer.id = n.iframeContainer.id || t.id + "_iframecontainer"), n.height = n.iframeHeight ? n.iframeHeight : r.offsetHeight, n) : wC(e) }, EC = function (t) { var e, n, r, o, i, a, u = t.settings, s = t.getElement(); return t.rtl = u.rtl_ui || t.editorManager.i18n.rtl, t.editorManager.i18n.setCode(u.language), u.aria_label = u.aria_label || yC.getAttrib(s, "aria-label", t.getLang("aria.rich_text_area")), t.fire("ScriptsLoaded"), o = (n = t).settings.theme, E.isString(o) ? (n.settings.theme = CC(o), r = Ap.get(o), n.theme = new r(n, Ap.urls[o]), n.theme.init && n.theme.init(n, Ap.urls[o] || n.documentBaseUrl.replace(/\/$/, ""), n.$)) : n.theme = {}, i = t, a = [], Lt.each(i.settings.plugins.split(/[ ,]/), function (e) { bC(i, a, CC(e)) }), e = NC(t), t.editorContainer = e.editorContainer ? e.editorContainer : null, u.content_css && Lt.each(Lt.explode(u.content_css), function (e) { t.contentCSS.push(t.documentBaseURI.toAbsolute(e)) }), u.content_editable ? pC(t) : vC(t, e) }, SC = di.DOM, kC = function (e) { return "-" === e.charAt(0) }, TC = function (i, a) { var u = vi.ScriptLoader; !function (e, t, n, r) { var o = t.settings, i = o.theme; if (E.isString(i)) { if (!kC(i) && !Ap.urls.hasOwnProperty(i)) { var a = o.theme_url; a ? Ap.load(i, t.documentBaseURI.toAbsolute(a)) : Ap.load(i, "themes/" + i + "/theme" + n + ".js") } e.loadQueue(function () { Ap.waitFor(i, r) }) } else r() }(u, i, a, function () { var e, t, n, r, o; e = u, (n = (t = i).settings).language && "en" !== n.language && !n.language_url && (n.language_url = t.editorManager.baseURL + "/langs/" + n.language + ".js"), n.language_url && !t.editorManager.i18n.data[n.language] && e.add(n.language_url), r = i.settings, o = a, Lt.isArray(r.plugins) && (r.plugins = r.plugins.join(" ")), Lt.each(r.external_plugins, function (e, t) { Tp.load(t, e), r.plugins += " " + t }), Lt.each(r.plugins.split(/[ ,]/), function (e) { if ((e = Lt.trim(e)) && !Tp.urls[e]) if (kC(e)) { e = e.substr(1, e.length); var t = Tp.dependencies(e); Lt.each(t, function (e) { var t = { prefix: "plugins/", resource: e, suffix: "/plugin" + o + ".js" }; e = Tp.createUrl(t, e), Tp.load(e.resource, e) }) } else Tp.load(e, { prefix: "plugins/", resource: e, suffix: "/plugin" + o + ".js" }) }), u.loadQueue(function () { i.removed || EC(i) }, i, function (e) { kp.pluginLoadError(i, e[0]), i.removed || EC(i) }) }) }, AC = function (t) { var e = t.settings, n = t.id, r = function () { SC.unbind(window, "ready", r), t.render() }; if (Re.Event.domLoaded) { if (t.getElement() && ge.contentEditable) { e.inline ? t.inline = !0 : (t.orgVisibility = t.getElement().style.visibility, t.getElement().style.visibility = "hidden"); var o = t.getElement().form || SC.getParent(n, "form"); o && (t.formElement = o, e.hidden_input && !/TEXTAREA|INPUT/i.test(t.getElement().nodeName) && (SC.insertAfter(SC.create("input", { type: "hidden", name: n }), n), t.hasHiddenInput = !0), t.formEventDelegate = function (e) { t.fire(e.type, e) }, SC.bind(o, "submit reset", t.formEventDelegate), t.on("reset", function () { t.setContent(t.startContent, { format: "raw" }) }), !e.submit_patch || o.submit.nodeType || o.submit.length || o._mceOldSubmit || (o._mceOldSubmit = o.submit, o.submit = function () { return t.editorManager.triggerSave(), t.setDirty(!1), o._mceOldSubmit(o) })), t.windowManager = xp(t), t.notificationManager = Cp(t), "xml" === e.encoding && t.on("GetContent", function (e) { e.save && (e.content = SC.encode(e.content)) }), e.add_form_submit_trigger && t.on("submit", function () { t.initialized && t.save() }), e.add_unload_trigger && (t._beforeUnload = function () { !t.initialized || t.destroyed || t.isHidden() || t.save({ format: "raw", no_events: !0, set_dirty: !1 }) }, t.editorManager.on("BeforeUnload", t._beforeUnload)), t.editorManager.add(t), TC(t, t.suffix) } } else SC.bind(window, "ready", r) }, RC = function (e, t, n) { var r = e.sidebars ? e.sidebars : []; r.push({ name: t, settings: n }), e.sidebars = r }, BC = Lt.each, _C = Lt.trim, DC = "source protocol authority userInfo user password host port relative path directory file query anchor".split(" "), OC = { ftp: 21, http: 80, https: 443, mailto: 25 }, PC = function (r, e) { var t, n, o = this; if (r = _C(r), t = (e = o.settings = e || {}).base_uri, /^([\w\-]+):([^\/]{2})/i.test(r) || /^\s*#/.test(r)) o.source = r; else { var i = 0 === r.indexOf("//"); 0 !== r.indexOf("/") || i || (r = (t && t.protocol || "http") + "://mce_host" + r), /^[\w\-]*:?\/\//.test(r) || (n = e.base_uri ? e.base_uri.path : new PC(document.location.href).directory, "" == e.base_uri.protocol ? r = "//mce_host" + o.toAbsPath(n, r) : (r = /([^#?]*)([#?]?.*)/.exec(r), r = (t && t.protocol || "http") + "://mce_host" + o.toAbsPath(n, r[1]) + r[2])), r = r.replace(/@@/g, "(mce_at)"), r = /^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(r), BC(DC, function (e, t) { var n = r[t]; n && (n = n.replace(/\(mce_at\)/g, "@@")), o[e] = n }), t && (o.protocol || (o.protocol = t.protocol), o.userInfo || (o.userInfo = t.userInfo), o.port || "mce_host" !== o.host || (o.port = t.port), o.host && "mce_host" !== o.host || (o.host = t.host), o.source = ""), i && (o.protocol = "") } }; PC.prototype = { setPath: function (e) { e = /^(.*?)\/?(\w+)?$/.exec(e), this.path = e[0], this.directory = e[1], this.file = e[2], this.source = "", this.getURI() }, toRelative: function (e) { var t; if ("./" === e) return e; if ("mce_host" !== (e = new PC(e, { base_uri: this })).host && this.host !== e.host && e.host || this.port !== e.port || this.protocol !== e.protocol && "" !== e.protocol) return e.getURI(); var n = this.getURI(), r = e.getURI(); return n === r || "/" === n.charAt(n.length - 1) && n.substr(0, n.length - 1) === r ? n : (t = this.toRelPath(this.path, e.path), e.query && (t += "?" + e.query), e.anchor && (t += "#" + e.anchor), t) }, toAbsolute: function (e, t) { return (e = new PC(e, { base_uri: this })).getURI(t && this.isSameOrigin(e)) }, isSameOrigin: function (e) { if (this.host == e.host && this.protocol == e.protocol) { if (this.port == e.port) return !0; var t = OC[this.protocol]; if (t && (this.port || t) == (e.port || t)) return !0 } return !1 }, toRelPath: function (e, t) { var n, r, o, i = 0, a = ""; if (e = (e = e.substring(0, e.lastIndexOf("/"))).split("/"), n = t.split("/"), e.length >= n.length) for (r = 0, o = e.length; r < o; r++)if (r >= n.length || e[r] !== n[r]) { i = r + 1; break } if (e.length < n.length) for (r = 0, o = n.length; r < o; r++)if (r >= e.length || e[r] !== n[r]) { i = r + 1; break } if (1 === i) return t; for (r = 0, o = e.length - (i - 1); r < o; r++)a += "../"; for (r = i - 1, o = n.length; r < o; r++)a += r !== i - 1 ? "/" + n[r] : n[r]; return a }, toAbsPath: function (e, t) { var n, r, o, i = 0, a = []; for (r = /\/$/.test(t) ? "/" : "", e = e.split("/"), t = t.split("/"), BC(e, function (e) { e && a.push(e) }), e = a, n = t.length - 1, a = []; 0 <= n; n--)0 !== t[n].length && "." !== t[n] && (".." !== t[n] ? 0 < i ? i-- : a.push(t[n]) : i++); return 0 !== (o = (n = e.length - i) <= 0 ? a.reverse().join("/") : e.slice(0, n).join("/") + "/" + a.reverse().join("/")).indexOf("/") && (o = "/" + o), r && o.lastIndexOf("/") !== o.length - 1 && (o += r), o }, getURI: function (e) { var t, n = this; return n.source && !e || (t = "", e || (n.protocol ? t += n.protocol + "://" : t += "//", n.userInfo && (t += n.userInfo + "@"), n.host && (t += n.host), n.port && (t += ":" + n.port)), n.path && (t += n.path), n.query && (t += "?" + n.query), n.anchor && (t += "#" + n.anchor), n.source = t), n.source } }, PC.parseDataUri = function (e) { var t, n; return e = decodeURIComponent(e).split(","), (n = /data:([^;]+)/.exec(e[0])) && (t = n[1]), { type: t, data: e[1] } }, PC.getDocumentBaseUrl = function (e) { var t; return t = 0 !== e.protocol.indexOf("http") && "file:" !== e.protocol ? e.href : e.protocol + "//" + e.host + e.pathname, /^[^:]+:\/\/\/?[^\/]+\//.test(t) && (t = t.replace(/[\?#].*$/, "").replace(/[\/\\][^\/]+$/, ""), /[\/\\]$/.test(t) || (t += "/")), t }; var LC = function (e, t) { t(e), e.firstChild && LC(e.firstChild, t), e.next && LC(e.next, t) }, IC = function (e, t, n) { var r = function (e, n, t) { var r = {}, o = {}, i = []; for (var a in t.firstChild && LC(t.firstChild, function (t) { H.each(e, function (e) { e.name === t.name && (r[e.name] ? r[e.name].nodes.push(t) : r[e.name] = { filter: e, nodes: [t] }) }), H.each(n, function (e) { "string" == typeof t.attr(e.name) && (o[e.name] ? o[e.name].nodes.push(t) : o[e.name] = { filter: e, nodes: [t] }) }) }), r) r.hasOwnProperty(a) && i.push(r[a]); for (var u in o) o.hasOwnProperty(u) && i.push(o[u]); return i }(e, t, n); H.each(r, function (t) { H.each(t.filter.callbacks, function (e) { e(t.nodes, t.filter.name, {}) }) }) }, MC = function (e) { return e instanceof Gv }, FC = function (e, t, n) { var r, o, i, a, u; if (t.format = t.format ? t.format : "html", t.get = !0, t.getInner = !0, t.no_events || e.fire("BeforeGetContent", t), "raw" === t.format) r = Lt.trim(Ug.trimExternal(e.serializer, n.innerHTML)); else if ("text" === t.format) r = Si(n.innerText || n.textContent); else { if ("tree" === t.format) return e.serializer.serialize(n, t); i = (o = e).serializer.serialize(n, t), a = Au(o), u = new RegExp("^(<" + a + "[^>]*>(&nbsp;|&#160;|\\s|\xa0|<br \\/>|)<\\/" + a + ">[\r\n]*|<br \\/>[\r\n]*)$"), r = i.replace(u, "") } return "text" !== t.format ? t.content = Lt.trim(r) : t.content = r, t.no_events || e.fire("GetContent", t), t.content }, zC = function (u, s, c) { return void 0 === c && (c = {}), c.format = c.format ? c.format : "html", c.set = !0, c.content = MC(s) ? "" : s, MC(s) || c.no_events || (u.fire("BeforeSetContent", c), s = c.content), A.from(u.getBody()).fold(V.constant(s), function (e) { return MC(s) ? function (e, t, n, r) { IC(e.parser.getNodeFilters(), e.parser.getAttributeFilters(), n); var o = jc({ validate: e.validate }, e.schema).serialize(n); return r.content = Lt.trim(o), e.dom.setHTML(t, r.content), r.no_events || e.fire("SetContent", r), n }(u, e, s, c) : (t = u, n = e, o = c, 0 === (r = s).length || /^\s+$/.test(r) ? (a = '<br data-mce-bogus="1">', "TABLE" === n.nodeName ? r = "<tr><td>" + a + "</td></tr>" : /^(UL|OL)$/.test(n.nodeName) && (r = "<li>" + a + "</li>"), (i = Au(t)) && t.schema.isValidChild(n.nodeName.toLowerCase(), i.toLowerCase()) ? (r = a, r = t.dom.createHTML(i, t.settings.forced_root_block_attrs, r)) : r || (r = '<br data-mce-bogus="1">'), t.dom.setHTML(n, r), t.fire("SetContent", o)) : ("raw" !== o.format && (r = jc({ validate: t.validate }, t.schema).serialize(t.parser.parse(r, { isRootContent: !0, insert: !0 }))), o.content = Lt.trim(r), t.dom.setHTML(n, o.content), o.no_events || t.fire("SetContent", o)), o.content); var t, n, r, o, i, a }) }, UC = di.DOM, qC = function (e) { return A.from(e).each(function (e) { return e.destroy() }) }, VC = function (e) { if (!e.removed) { var t = e._selectionOverrides, n = e.editorUpload, r = e.getBody(), o = e.getElement(); r && e.save(), e.removed = !0, e.unbindAllNativeEvents(), e.hasHiddenInput && o && UC.remove(o.nextSibling), !e.inline && r && (i = e, UC.setStyle(i.id, "display", i.orgDisplay)), qv(e), e.editorManager.remove(e), UC.remove(e.getContainer()), qC(t), qC(n), e.destroy() } var i }, HC = function (e, t) { var n, r, o, i = e.selection, a = e.dom; e.destroyed || (t || e.removed ? (t || (e.editorManager.off("beforeunload", e._beforeUnload), e.theme && e.theme.destroy && e.theme.destroy(), qC(i), qC(a)), (r = (n = e).formElement) && (r._mceOldSubmit && (r.submit = r._mceOldSubmit, r._mceOldSubmit = null), UC.unbind(r, "submit reset", n.formEventDelegate)), (o = e).contentAreaContainer = o.formElement = o.container = o.editorContainer = null, o.bodyElement = o.contentDocument = o.contentWindow = null, o.iframeElement = o.targetElm = null, o.selection && (o.selection = o.selection.win = o.selection.dom = o.selection.dom.doc = null), e.destroyed = !0) : e.remove()) }, jC = di.DOM, $C = Lt.extend, WC = Lt.each, KC = Lt.resolve, XC = ge.ie, YC = function (e, t, n) { var r, o, i, a, u, s, c, l = this, f = l.documentBaseUrl = n.documentBaseURL, d = n.baseURI; r = l, o = e, i = f, a = n.defaultSettings, u = t, c = { id: o, theme: "modern", delta_width: 0, delta_height: 0, popup_css: "", plugins: "", document_base_url: i, add_form_submit_trigger: !0, submit_patch: !0, add_unload_trigger: !0, convert_urls: !0, relative_urls: !0, remove_script_host: !0, object_resizing: !0, doctype: "<!DOCTYPE html>", visual: !0, font_size_style_values: "xx-small,x-small,small,medium,large,x-large,xx-large", font_size_legacy_values: "xx-small,small,medium,large,x-large,xx-large,300%", forced_root_block: "p", hidden_input: !0, render_ui: !0, indentation: "30px", inline_styles: !0, convert_fonts_to_spans: !0, indent: "simple", indent_before: "p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,figcaption,option,optgroup,datalist", indent_after: "p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,figcaption,option,optgroup,datalist", entity_encoding: "named", url_converter: (s = r).convertURL, url_converter_scope: s, ie7_compat: !0 }, t = sl(nl, c, a, u), l.settings = t, Ci.language = t.language || "en", Ci.languageLoad = t.language_load, Ci.baseURL = n.baseURL, l.id = e, l.setDirty(!1), l.plugins = {}, l.documentBaseURI = new PC(t.document_base_url, { base_uri: d }), l.baseURI = d, l.contentCSS = [], l.contentStyles = [], l.shortcuts = new tp(l), l.loadedCSS = {}, l.editorCommands = new Mm(l), l.suffix = n.suffix, l.editorManager = n, l.inline = t.inline, l.buttons = {}, l.menuItems = {}, t.cache_suffix && (ge.cacheSuffix = t.cache_suffix.replace(/^[\?\&]+/, "")), !1 === t.override_viewport && (ge.overrideViewPort = !1), n.fire("SetupEditor", { editor: l }), l.execCallback("setup", l), l.$ = en.overrideDefaults(function () { return { context: l.inline ? l.getBody() : l.getDoc(), element: l.getBody() } }) }; $C(YC.prototype = { render: function () { AC(this) }, focus: function (e) { fp(this, e) }, hasFocus: function () { return dp(this) }, execCallback: function (e) { for (var t = [], n = 1; n < arguments.length; n++)t[n - 1] = arguments[n]; var r, o = this.settings[e]; if (o) return this.callbackLookup && (r = this.callbackLookup[e]) && (o = r.func, r = r.scope), "string" == typeof o && (r = (r = o.replace(/\.\w+$/, "")) ? KC(r) : 0, o = KC(o), this.callbackLookup = this.callbackLookup || {}, this.callbackLookup[e] = { func: o, scope: r }), o.apply(r || this, Array.prototype.slice.call(arguments, 1)) }, translate: function (e) { if (e && Lt.is(e, "string")) { var n = this.settings.language || "en", r = this.editorManager.i18n; e = r.data[n + "." + e] || e.replace(/\{\#([^\}]+)\}/g, function (e, t) { return r.data[n + "." + t] || "{#" + t + "}" }) } return this.editorManager.translate(e) }, getLang: function (e, t) { return this.editorManager.i18n.data[(this.settings.language || "en") + "." + e] || (t !== undefined ? t : "{#" + e + "}") }, getParam: function (e, t, n) { return fl(this, e, t, n) }, nodeChanged: function (e) { this._nodeChangeDispatcher.nodeChanged(e) }, addButton: function (e, t) { var n = this; t.cmd && (t.onclick = function () { n.execCommand(t.cmd) }), t.stateSelector && "undefined" == typeof t.active && (t.active = !1), t.text || t.icon || (t.icon = e), n.buttons = n.buttons, t.tooltip = t.tooltip || t.title, n.buttons[e] = t }, addSidebar: function (e, t) { return RC(this, e, t) }, addMenuItem: function (e, t) { var n = this; t.cmd && (t.onclick = function () { n.execCommand(t.cmd) }), n.menuItems = n.menuItems, n.menuItems[e] = t }, addContextToolbar: function (e, t) { var n, r = this; r.contextToolbars = r.contextToolbars || [], "string" == typeof e && (n = e, e = function (e) { return r.dom.is(e, n) }), r.contextToolbars.push({ id: jp.uuid("mcet"), predicate: e, items: t }) }, addCommand: function (e, t, n) { this.editorCommands.addCommand(e, t, n) }, addQueryStateHandler: function (e, t, n) { this.editorCommands.addQueryStateHandler(e, t, n) }, addQueryValueHandler: function (e, t, n) { this.editorCommands.addQueryValueHandler(e, t, n) }, addShortcut: function (e, t, n, r) { this.shortcuts.add(e, t, n, r) }, execCommand: function (e, t, n, r) { return this.editorCommands.execCommand(e, t, n, r) }, queryCommandState: function (e) { return this.editorCommands.queryCommandState(e) }, queryCommandValue: function (e) { return this.editorCommands.queryCommandValue(e) }, queryCommandSupported: function (e) { return this.editorCommands.queryCommandSupported(e) }, show: function () { this.hidden && (this.hidden = !1, this.inline ? this.getBody().contentEditable = !0 : (jC.show(this.getContainer()), jC.hide(this.id)), this.load(), this.fire("show")) }, hide: function () { var e = this, t = e.getDoc(); e.hidden || (XC && t && !e.inline && t.execCommand("SelectAll"), e.save(), e.inline ? (e.getBody().contentEditable = !1, e === e.editorManager.focusedEditor && (e.editorManager.focusedEditor = null)) : (jC.hide(e.getContainer()), jC.setStyle(e.id, "display", e.orgDisplay)), e.hidden = !0, e.fire("hide")) }, isHidden: function () { return !!this.hidden }, setProgressState: function (e, t) { this.fire("ProgressState", { state: e, time: t }) }, load: function (e) { var t, n = this.getElement(); return this.removed ? "" : n ? ((e = e || {}).load = !0, t = this.setContent(n.value !== undefined ? n.value : n.innerHTML, e), e.element = n, e.no_events || this.fire("LoadContent", e), e.element = n = null, t) : void 0 }, save: function (e) { var t, n, r = this, o = r.getElement(); if (o && r.initialized && !r.removed) return (e = e || {}).save = !0, e.element = o, e.content = r.getContent(e), e.no_events || r.fire("SaveContent", e), "raw" === e.format && r.fire("RawSaveContent", e), t = e.content, /TEXTAREA|INPUT/i.test(o.nodeName) ? o.value = t : (r.inline || (o.innerHTML = t), (n = jC.getParent(r.id, "form")) && WC(n.elements, function (e) { if (e.name === r.id) return e.value = t, !1 })), e.element = o = null, !1 !== e.set_dirty && r.setDirty(!1), t }, setContent: function (e, t) { return zC(this, e, t) }, getContent: function (e) { return t = this, void 0 === (n = e) && (n = {}), A.from(t.getBody()).fold(V.constant("tree" === n.format ? new Gv("body", 11) : ""), function (e) { return FC(t, n, e) }); var t, n }, insertContent: function (e, t) { t && (e = $C({ content: e }, t)), this.execCommand("mceInsertContent", !1, e) }, isDirty: function () { return !this.isNotDirty }, setDirty: function (e) { var t = !this.isNotDirty; this.isNotDirty = !e, e && e !== t && this.fire("dirty") }, setMode: function (e) { Gm(this, e) }, getContainer: function () { return this.container || (this.container = jC.get(this.editorContainer || this.id + "_parent")), this.container }, getContentAreaContainer: function () { return this.contentAreaContainer }, getElement: function () { return this.targetElm || (this.targetElm = jC.get(this.id)), this.targetElm }, getWin: function () { var e; return this.contentWindow || (e = this.iframeElement) && (this.contentWindow = e.contentWindow), this.contentWindow }, getDoc: function () { var e; return this.contentDocument || (e = this.getWin()) && (this.contentDocument = e.document), this.contentDocument }, getBody: function () { var e = this.getDoc(); return this.bodyElement || (e ? e.body : null) }, convertURL: function (e, t, n) { var r = this.settings; return r.urlconverter_callback ? this.execCallback("urlconverter_callback", e, n, !0, t) : !r.convert_urls || n && "LINK" === n.nodeName || 0 === e.indexOf("file:") || 0 === e.length ? e : r.relative_urls ? this.documentBaseURI.toRelative(e) : e = this.documentBaseURI.toAbsolute(e, r.remove_script_host) }, addVisual: function (e) { var n, r = this, o = r.settings, i = r.dom; e = e || r.getBody(), r.hasVisual === undefined && (r.hasVisual = o.visual), WC(i.select("table,a", e), function (e) { var t; switch (e.nodeName) { case "TABLE": return n = o.visual_table_class || "mce-item-table", void ((t = i.getAttrib(e, "border")) && "0" !== t || !r.hasVisual ? i.removeClass(e, n) : i.addClass(e, n)); case "A": return void (i.getAttrib(e, "href") || (t = i.getAttrib(e, "name") || e.id, n = o.visual_anchor_class || "mce-item-anchor", t && r.hasVisual ? i.addClass(e, n) : i.removeClass(e, n))) } }), r.fire("VisualAid", { element: e, hasVisual: r.hasVisual }) }, remove: function () { VC(this) }, destroy: function (e) { HC(this, e) }, uploadImages: function (e) { return this.editorUpload.uploadImages(e) }, _scanForImages: function () { return this.editorUpload.scanForImages() } }, Km); var GC, JC, QC, ZC = { isEditorUIElement: function (e) { return -1 !== e.className.toString().indexOf("mce-") } }, ex = function (n, e) { var t, r, o = zn.detect().browser; o.isIE() || o.isEdge() ? (r = n).on("focusout", function () { _m.store(r) }) : (t = e, n.on("mouseup touchend", function (e) { t.throttle() })), n.on("keyup nodechange", function (e) { var t; "nodechange" === (t = e).type && t.selectionChange || _m.store(n) }) }, tx = function (e) { var t, n, r, o = Eg(function () { _m.store(e) }, 0); e.inline && (t = e, n = o, r = function () { n.throttle() }, di.DOM.bind(document, "mouseup", r), t.on("remove", function () { di.DOM.unbind(document, "mouseup", r) })), e.on("init", function () { ex(e, o) }), e.on("remove", function () { o.cancel() }) }, nx = di.DOM, rx = function (e) { return ZC.isEditorUIElement(e) }, ox = function (t, e) { var n = t ? t.settings.custom_ui_selector : ""; return null !== nx.getParent(e, function (e) { return rx(e) || !!n && t.dom.is(e, n) }) }, ix = function (r, e) { var t = e.editor; tx(t), t.on("focusin", function () { var e = r.focusedEditor; e !== this && (e && e.fire("blur", { focusedEditor: this }), r.setActive(this), (r.focusedEditor = this).fire("focus", { blurredEditor: e }), this.focus(!0)) }), t.on("focusout", function () { var t = this; Ce.setEditorTimeout(t, function () { var e = r.focusedEditor; ox(t, function () { try { return document.activeElement } catch (e) { return document.body } }()) || e !== t || (t.fire("blur", { focusedEditor: null }), r.focusedEditor = null) }) }), GC || (GC = function (e) { var t, n = r.activeEditor; t = e.target, n && t.ownerDocument === document && (t === document.body || ox(n, t) || r.focusedEditor !== n || (n.fire("blur", { focusedEditor: null }), r.focusedEditor = null)) }, nx.bind(document, "focusin", GC)) }, ax = function (e, t) { e.focusedEditor === t.editor && (e.focusedEditor = null), e.activeEditor || (nx.unbind(document, "focusin", GC), GC = null) }, ux = function (e) { e.on("AddEditor", V.curry(ix, e)), e.on("RemoveEditor", V.curry(ax, e)) }, sx = {}, cx = "en", lx = { setCode: function (e) { e && (cx = e, this.rtl = !!this.data[e] && "rtl" === this.data[e]._dir) }, getCode: function () { return cx }, rtl: !1, add: function (e, t) { var n = sx[e]; for (var r in n || (sx[e] = n = {}), t) n[r] = t[r]; this.setCode(e) }, translate: function (e) { var t = sx[cx] || {}, n = function (e) { return Lt.is(e, "function") ? Object.prototype.toString.call(e) : r(e) ? "" : "" + e }, r = function (e) { return "" === e || null === e || Lt.is(e, "undefined") }, o = function (e) { return e = n(e), Lt.hasOwn(t, e) ? n(t[e]) : e }; if (r(e)) return ""; if (Lt.is(e, "object") && Lt.hasOwn(e, "raw")) return n(e.raw); if (Lt.is(e, "array")) { var i = e.slice(1); e = o(e[0]).replace(/\{([0-9]+)\}/g, function (e, t) { return Lt.hasOwn(i, t) ? n(i[t]) : e }) } return o(e).replace(/{context:\w+}$/, "") }, data: sx }, fx = di.DOM, dx = Lt.explode, mx = Lt.each, px = Lt.extend, gx = 0, hx = !1, vx = [], yx = [], bx = function (t) { mx(QC.get(), function (e) { "scroll" === t.type ? e.fire("ScrollWindow", t) : e.fire("ResizeWindow", t) }) }, Cx = function (e) { e !== hx && (e ? en(window).on("resize scroll", bx) : en(window).off("resize scroll", bx), hx = e) }, xx = function (t) { var e = yx; delete vx[t.id]; for (var n = 0; n < vx.length; n++)if (vx[n] === t) { vx.splice(n, 1); break } return yx = H.filter(yx, function (e) { return t !== e }), QC.activeEditor === t && (QC.activeEditor = 0 < yx.length ? yx[0] : null), QC.focusedEditor === t && (QC.focusedEditor = null), e.length !== yx.length }; px(QC = { defaultSettings: {}, $: en, majorVersion: "4", minorVersion: "7.11", releaseDate: "2018-04-11", editors: vx, i18n: lx, activeEditor: null, settings: {}, setup: function () { var e, t, n, r, o = ""; if (t = PC.getDocumentBaseUrl(document.location), /^[^:]+:\/\/\/?[^\/]+\//.test(t) && (t = t.replace(/[\?#].*$/, "").replace(/[\/\\][^\/]+$/, ""), /[\/\\]$/.test(t) || (t += "/")), n = window.tinymce || window.tinyMCEPreInit) e = n.base || n.baseURL, o = n.suffix; else { for (var i = document.getElementsByTagName("script"), a = 0; a < i.length; a++) { var u = (r = i[a].src).substring(r.lastIndexOf("/")); if (/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(r)) { -1 !== u.indexOf(".min") && (o = ".min"), e = r.substring(0, r.lastIndexOf("/")); break } } !e && document.currentScript && (-1 !== (r = document.currentScript.src).indexOf(".min") && (o = ".min"), e = r.substring(0, r.lastIndexOf("/"))) } this.baseURL = new PC(t).toAbsolute(e), this.documentBaseURL = t, this.baseURI = new PC(this.baseURL), this.suffix = o, ux(this) }, overrideDefaults: function (e) { var t, n; (t = e.base_url) && (this.baseURL = new PC(this.documentBaseURL).toAbsolute(t.replace(/\/+$/, "")), this.baseURI = new PC(this.baseURL)), n = e.suffix, e.suffix && (this.suffix = n); var r = (this.defaultSettings = e).plugin_base_urls; for (var o in r) Ci.PluginManager.urls[o] = r[o] }, init: function (r) { var n, u, s = this; u = Lt.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option tbody tfoot thead tr script noscript style textarea video audio iframe object menu", " "); var c = function (e) { var t = e.id; return t || (t = (t = e.name) && !fx.get(t) ? e.name : fx.uniqueId(), e.setAttribute("id", t)), t }, l = function (e, t) { return t.constructor === RegExp ? t.test(e.className) : fx.hasClass(e, t) }, f = function (e) { n = e }, e = function () { var o, i = 0, a = [], n = function (e, t, n) { var r = new YC(e, t, s); a.push(r), r.on("init", function () { ++i === o.length && f(a) }), r.targetElm = r.targetElm || n, r.render() }; fx.unbind(window, "ready", e), function (e) { var t = r[e]; t && t.apply(s, Array.prototype.slice.call(arguments, 2)) }("onpageload"), o = en.unique(function (t) { var e, n = []; if (ge.ie && ge.ie < 11) return kp.initError("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/"), []; if (t.types) return mx(t.types, function (e) { n = n.concat(fx.select(e.selector)) }), n; if (t.selector) return fx.select(t.selector); if (t.target) return [t.target]; switch (t.mode) { case "exact": 0 < (e = t.elements || "").length && mx(dx(e), function (t) { var e; (e = fx.get(t)) ? n.push(e) : mx(document.forms, function (e) { mx(e.elements, function (e) { e.name === t && (t = "mce_editor_" + gx++ , fx.setAttrib(e, "id", t), n.push(e)) }) }) }); break; case "textareas": case "specific_textareas": mx(fx.select("textarea"), function (e) { t.editor_deselector && l(e, t.editor_deselector) || t.editor_selector && !l(e, t.editor_selector) || n.push(e) }) }return n }(r)), r.types ? mx(r.types, function (t) { Lt.each(o, function (e) { return !fx.is(e, t.selector) || (n(c(e), px({}, r, t), e), !1) }) }) : (Lt.each(o, function (e) { var t; (t = s.get(e.id)) && t.initialized && !(t.getContainer() || t.getBody()).parentNode && (xx(t), t.unbindAllNativeEvents(), t.destroy(!0), t.removed = !0, t = null) }), 0 === (o = Lt.grep(o, function (e) { return !s.get(e.id) })).length ? f([]) : mx(o, function (e) { var t; t = e, r.inline && t.tagName.toLowerCase() in u ? kp.initError("Could not initialize inline editor on invalid inline target element", e) : n(c(e), r, e) })) }; return s.settings = r, fx.bind(window, "ready", e), new he(function (t) { n ? t(n) : f = function (e) { t(e) } }) }, get: function (t) { return 0 === arguments.length ? yx.slice(0) : E.isString(t) ? H.find(yx, function (e) { return e.id === t }).getOr(null) : E.isNumber(t) && yx[t] ? yx[t] : null }, add: function (e) { var t = this; return vx[e.id] === e || (null === t.get(e.id) && ("length" !== e.id && (vx[e.id] = e), vx.push(e), yx.push(e)), Cx(!0), t.activeEditor = e, t.fire("AddEditor", { editor: e }), JC || (JC = function () { t.fire("BeforeUnload") }, fx.bind(window, "beforeunload", JC))), e }, createEditor: function (e, t) { return this.add(new YC(e, t, this)) }, remove: function (e) { var t, n, r = this; if (e) return E.isString(e) ? (e = e.selector || e, void mx(fx.select(e), function (e) { (n = r.get(e.id)) && r.remove(n) })) : (n = e, E.isNull(r.get(n.id)) ? null : (xx(n) && r.fire("RemoveEditor", { editor: n }), 0 === yx.length && fx.unbind(window, "beforeunload", JC), n.remove(), Cx(0 < yx.length), n)); for (t = yx.length - 1; 0 <= t; t--)r.remove(yx[t]) }, execCommand: function (e, t, n) { var r = this.get(n); switch (e) { case "mceAddEditor": return this.get(n) || new YC(n, this.settings, this).render(), !0; case "mceRemoveEditor": return r && r.remove(), !0; case "mceToggleEditor": return r ? r.isHidden() ? r.show() : r.hide() : this.execCommand("mceAddEditor", 0, n), !0 }return !!this.activeEditor && this.activeEditor.execCommand(e, t, n) }, triggerSave: function () { mx(yx, function (e) { e.save() }) }, addI18n: function (e, t) { lx.add(e, t) }, translate: function (e) { return lx.translate(e) }, setActive: function (e) { var t = this.activeEditor; this.activeEditor !== e && (t && t.fire("deactivate", { relatedTarget: e }), e.fire("activate", { relatedTarget: t })), this.activeEditor = e } }, Vm), QC.setup(); var wx, Nx = QC; function Ex(n) { return { walk: function (e, t) { return Yh.walk(n, e, t) }, split: _h.split, normalize: function (t) { return rm.normalize(n, t).fold(V.constant(!1), function (e) { return t.setStart(e.startContainer, e.startOffset), t.setEnd(e.endContainer, e.endOffset), !0 }) } } } (wx = Ex || (Ex = {})).compareRanges = Gd.isEq, wx.getCaretRangeFromPoint = by.fromPoint, wx.getSelectedNode = ta, wx.getNode = na; var Sx, kx, Tx = Ex, Ax = Math.min, Rx = Math.max, Bx = Math.round, _x = function (e, t, n) { var r, o, i, a, u, s; return r = t.x, o = t.y, i = e.w, a = e.h, u = t.w, s = t.h, "b" === (n = (n || "").split(""))[0] && (o += s), "r" === n[1] && (r += u), "c" === n[0] && (o += Bx(s / 2)), "c" === n[1] && (r += Bx(u / 2)), "b" === n[3] && (o -= a), "r" === n[4] && (r -= i), "c" === n[3] && (o -= Bx(a / 2)), "c" === n[4] && (r -= Bx(i / 2)), Dx(r, o, i, a) }, Dx = function (e, t, n, r) { return { x: e, y: t, w: n, h: r } }, Ox = { inflate: function (e, t, n) { return Dx(e.x - t, e.y - n, e.w + 2 * t, e.h + 2 * n) }, relativePosition: _x, findBestRelativePosition: function (e, t, n, r) { var o, i; for (i = 0; i < r.length; i++)if ((o = _x(e, t, r[i])).x >= n.x && o.x + o.w <= n.w + n.x && o.y >= n.y && o.y + o.h <= n.h + n.y) return r[i]; return null }, intersect: function (e, t) { var n, r, o, i; return n = Rx(e.x, t.x), r = Rx(e.y, t.y), o = Ax(e.x + e.w, t.x + t.w), i = Ax(e.y + e.h, t.y + t.h), o - n < 0 || i - r < 0 ? null : Dx(n, r, o - n, i - r) }, clamp: function (e, t, n) { var r, o, i, a, u, s, c, l, f, d; return u = e.x, s = e.y, c = e.x + e.w, l = e.y + e.h, f = t.x + t.w, d = t.y + t.h, r = Rx(0, t.x - u), o = Rx(0, t.y - s), i = Rx(0, c - f), a = Rx(0, l - d), u += r, s += o, n && (c += r, l += o, u -= i, s -= a), Dx(u, s, (c -= i) - u, (l -= a) - s) }, create: Dx, fromClientRect: function (e) { return Dx(e.left, e.top, e.width, e.height) } }, Px = {}, Lx = { add: function (e, t) { Px[e.toLowerCase()] = t }, has: function (e) { return !!Px[e.toLowerCase()] }, get: function (e) { var t = e.toLowerCase(), n = Px.hasOwnProperty(t) ? Px[t] : null; if (null === n) throw new Error("Could not find module for type: " + e); return n }, create: function (e, t) { var n; if ("string" == typeof e ? (t = t || {}).type = e : e = (t = e).type, e = e.toLowerCase(), !(n = Px[e])) throw new Error("Could not find control by type: " + e); return (n = new n(t)).type = e, n } }, Ix = Lt.each, Mx = Lt.extend, Fx = function () { }; Fx.extend = Sx = function (n) { var e, t, r, o = this.prototype, i = function () { var e, t, n; if (!kx && (this.init && this.init.apply(this, arguments), t = this.Mixins)) for (e = t.length; e--;)(n = t[e]).init && n.init.apply(this, arguments) }, a = function () { return this }, u = function (n, r) { return function () { var e, t = this._super; return this._super = o[n], e = r.apply(this, arguments), this._super = t, e } }; for (t in kx = !0, e = new this, kx = !1, n.Mixins && (Ix(n.Mixins, function (e) { for (var t in e) "init" !== t && (n[t] = e[t]) }), o.Mixins && (n.Mixins = o.Mixins.concat(n.Mixins))), n.Methods && Ix(n.Methods.split(","), function (e) { n[e] = a }), n.Properties && Ix(n.Properties.split(","), function (e) { var t = "_" + e; n[e] = function (e) { return e !== undefined ? (this[t] = e, this) : this[t] } }), n.Statics && Ix(n.Statics, function (e, t) { i[t] = e }), n.Defaults && o.Defaults && (n.Defaults = Mx({}, o.Defaults, n.Defaults)), n) "function" == typeof (r = n[t]) && o[t] ? e[t] = u(t, r) : e[t] = r; return i.prototype = e, (i.constructor = i).extend = Sx, i }; var zx = Math.min, Ux = Math.max, qx = Math.round, Vx = function (e, n) { var r, o, t, i; if (n = n || '"', null === e) return "null"; if ("string" == (t = typeof e)) return o = "\bb\tt\nn\ff\rr\"\"''\\\\", n + e.replace(/([\u0080-\uFFFF\x00-\x1f\"\'\\])/g, function (e, t) { return '"' === n && "'" === e ? e : (r = o.indexOf(t)) + 1 ? "\\" + o.charAt(r + 1) : (e = t.charCodeAt().toString(16), "\\u" + "0000".substring(e.length) + e) }) + n; if ("object" === t) { if (e.hasOwnProperty && "[object Array]" === Object.prototype.toString.call(e)) { for (r = 0, o = "["; r < e.length; r++)o += (0 < r ? "," : "") + Vx(e[r], n); return o + "]" } for (i in o = "{", e) e.hasOwnProperty(i) && (o += "function" != typeof e[i] ? (1 < o.length ? "," + n : n) + i + n + ":" + Vx(e[i], n) : ""); return o + "}" } return "" + e }, Hx = { serialize: Vx, parse: function (e) { try { return JSON.parse(e) } catch (t) { } } }, jx = { callbacks: {}, count: 0, send: function (t) { var n = this, r = di.DOM, o = t.count !== undefined ? t.count : n.count, i = "tinymce_jsonp_" + o; n.callbacks[o] = function (e) { r.remove(i), delete n.callbacks[o], t.callback(e) }, r.add(r.doc.body, "script", { id: i, src: t.url, type: "text/javascript" }), n.count++ } }, $x = { send: function (e) { var t, n = 0, r = function () { !e.async || 4 === t.readyState || 1e4 < n++ ? (e.success && n < 1e4 && 200 === t.status ? e.success.call(e.success_scope, "" + t.responseText, t, e) : e.error && e.error.call(e.error_scope, 1e4 < n ? "TIMED_OUT" : "GENERAL", t, e), t = null) : setTimeout(r, 10) }; if (e.scope = e.scope || this, e.success_scope = e.success_scope || e.scope, e.error_scope = e.error_scope || e.scope, e.async = !1 !== e.async, e.data = e.data || "", $x.fire("beforeInitialize", { settings: e }), t = new Rp) { if (t.overrideMimeType && t.overrideMimeType(e.content_type), t.open(e.type || (e.data ? "POST" : "GET"), e.url, e.async), e.crossDomain && (t.withCredentials = !0), e.content_type && t.setRequestHeader("Content-Type", e.content_type), e.requestheaders && Lt.each(e.requestheaders, function (e) { t.setRequestHeader(e.key, e.value) }), t.setRequestHeader("X-Requested-With", "XMLHttpRequest"), (t = $x.fire("beforeSend", { xhr: t, settings: e }).xhr).send(e.data), !e.async) return r(); setTimeout(r, 10) } } }; Lt.extend($x, Vm); var Wx = Lt.extend, Kx = function (e) { this.settings = Wx({}, e), this.count = 0 }; Kx.sendRPC = function (e) { return (new Kx).send(e) }, Kx.prototype = { send: function (n) { var r = n.error, o = n.success; (n = Wx(this.settings, n)).success = function (e, t) { void 0 === (e = Hx.parse(e)) && (e = { error: "JSON Parse error." }), e.error ? r.call(n.error_scope || n.scope, e.error, t) : o.call(n.success_scope || n.scope, e.result) }, n.error = function (e, t) { r && r.call(n.error_scope || n.scope, e, t) }, n.data = Hx.serialize({ id: n.id || "c" + this.count++, method: n.method, params: n.params }), n.content_type = "application/json", $x.send(n) } }; var Xx, Yx = window.localStorage, Gx = Nx, Jx = { geom: { Rect: Ox }, util: { Promise: he, Delay: Ce, Tools: Lt, VK: kg, URI: PC, Class: Fx, EventDispatcher: zm, Observable: Vm, I18n: lx, XHR: $x, JSON: Hx, JSONRequest: Kx, JSONP: jx, LocalStorage: Yx, Color: function (e) { var n = {}, u = 0, s = 0, c = 0, t = function (e) { var t; return "object" == typeof e ? "r" in e ? (u = e.r, s = e.g, c = e.b) : "v" in e && function (e, t, n) { var r, o, i, a; if (e = (parseInt(e, 10) || 0) % 360, t = parseInt(t, 10) / 100, n = parseInt(n, 10) / 100, t = Ux(0, zx(t, 1)), n = Ux(0, zx(n, 1)), 0 !== t) { switch (r = e / 60, i = (o = n * t) * (1 - Math.abs(r % 2 - 1)), a = n - o, Math.floor(r)) { case 0: u = o, s = i, c = 0; break; case 1: u = i, s = o, c = 0; break; case 2: u = 0, s = o, c = i; break; case 3: u = 0, s = i, c = o; break; case 4: u = i, s = 0, c = o; break; case 5: u = o, s = 0, c = i; break; default: u = s = c = 0 }u = qx(255 * (u + a)), s = qx(255 * (s + a)), c = qx(255 * (c + a)) } else u = s = c = qx(255 * n) }(e.h, e.s, e.v) : (t = /rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)[^\)]*\)/gi.exec(e)) ? (u = parseInt(t[1], 10), s = parseInt(t[2], 10), c = parseInt(t[3], 10)) : (t = /#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(e)) ? (u = parseInt(t[1], 16), s = parseInt(t[2], 16), c = parseInt(t[3], 16)) : (t = /#([0-F])([0-F])([0-F])/gi.exec(e)) && (u = parseInt(t[1] + t[1], 16), s = parseInt(t[2] + t[2], 16), c = parseInt(t[3] + t[3], 16)), u = u < 0 ? 0 : 255 < u ? 255 : u, s = s < 0 ? 0 : 255 < s ? 255 : s, c = c < 0 ? 0 : 255 < c ? 255 : c, n }; return e && t(e), n.toRgb = function () { return { r: u, g: s, b: c } }, n.toHsv = function () { return e = u, t = s, n = c, o = 0, (i = zx(e /= 255, zx(t /= 255, n /= 255))) === (a = Ux(e, Ux(t, n))) ? { h: 0, s: 0, v: 100 * (o = i) } : (r = (a - i) / a, { h: qx(60 * ((e === i ? 3 : n === i ? 1 : 5) - (e === i ? t - n : n === i ? e - t : n - e) / ((o = a) - i))), s: qx(100 * r), v: qx(100 * o) }); var e, t, n, r, o, i, a }, n.toHex = function () { var e = function (e) { return 1 < (e = parseInt(e, 10).toString(16)).length ? e : "0" + e }; return "#" + e(u) + e(s) + e(c) }, n.parse = t, n } }, dom: { EventUtils: Re, Sizzle: dt, DomQuery: en, TreeWalker: no, DOMUtils: di, ScriptLoader: vi, RangeUtils: Tx, Serializer: dy, ControlSelection: vy, BookmarkManager: py, Selection: tb, Event: Re.Event }, html: { Styles: ti, Entities: Vo, Node: Gv, Schema: Zo, SaxParser: Fg, DomParser: uy, Writer: Hc, Serializer: jc }, ui: { Factory: Lx }, Env: ge, AddOnManager: Ci, Formatter: Pv, UndoManager: oh, EditorCommands: Mm, WindowManager: xp, NotificationManager: Cp, EditorObservable: Km, Shortcuts: tp, Editor: YC, FocusManager: ZC, EditorManager: Nx, DOM: di.DOM, ScriptLoader: vi.ScriptLoader, PluginManager: Ci.PluginManager, ThemeManager: Ci.ThemeManager, trim: Lt.trim, isArray: Lt.isArray, is: Lt.is, toArray: Lt.toArray, makeMap: Lt.makeMap, each: Lt.each, map: Lt.map, grep: Lt.grep, inArray: Lt.inArray, extend: Lt.extend, create: Lt.create, walk: Lt.walk, createNS: Lt.createNS, resolve: Lt.resolve, explode: Lt.explode, _addCacheSuffix: Lt._addCacheSuffix, isOpera: ge.opera, isWebKit: ge.webkit, isIE: ge.ie, isGecko: ge.gecko, isMac: ge.mac }, Qx = Gx = Lt.extend(Gx, Jx); Xx = Qx, window.tinymce = Xx, window.tinyMCE = Xx, function (e) { if ("object" == typeof module) try { module.exports = e } catch (t) { } }(Qx) }();
!function () { "use strict"; var u, t, e, n, i, r, o = tinymce.util.Tools.resolve("tinymce.ThemeManager"), h = tinymce.util.Tools.resolve("tinymce.Env"), v = tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"), c = tinymce.util.Tools.resolve("tinymce.util.Delay"), s = function (t) { return t.reduce(function (t, e) { return Array.isArray(e) ? t.concat(s(e)) : t.concat(e) }, []) }, a = { flatten: s }, l = function (t, e) { for (var n = 0; n < e.length; n++) { var i = (0, e[n])(t); if (i) return i } return null }, d = function (t, e) { return { id: t, rect: e } }, f = function (t) { return { x: t.left, y: t.top, w: t.width, h: t.height } }, m = function (t) { return { left: t.x, top: t.y, width: t.w, height: t.h, right: t.x + t.w, bottom: t.y + t.h } }, g = function (t) { var e = v.DOM.getViewPort(); return { x: t.x + e.x, y: t.y + e.y, w: t.w, h: t.h } }, p = function (t) { var e = t.getBoundingClientRect(); return g({ x: e.left, y: e.top, w: Math.max(t.clientWidth, t.offsetWidth), h: Math.max(t.clientHeight, t.offsetHeight) }) }, y = function (t, e) { return p(e) }, b = function (t) { return p(t.getContentAreaContainer() || t.getBody()) }, x = function (t) { var e = t.selection.getBoundingClientRect(); return e ? g(f(e)) : null }, w = function (n, i) { return function (t) { for (var e = 0; e < i.length; e++)if (i[e].predicate(n)) return d(i[e].id, y(t, n)); return null } }, _ = function (i, r) { return function (t) { for (var e = 0; e < i.length; e++)for (var n = 0; n < r.length; n++)if (r[n].predicate(i[e])) return d(r[n].id, y(t, i[e])); return null } }, R = tinymce.util.Tools.resolve("tinymce.util.Tools"), C = function (t, e) { return { id: t, predicate: e } }, k = function (t) { return R.map(t, function (t) { return C(t.id, t.predicate) }) }, E = function (e) { return function (t) { return t.selection.isCollapsed() ? null : d(e, x(t)) } }, H = function (i, r) { return function (t) { var e, n = t.schema.getTextBlockElements(); for (e = 0; e < i.length; e++)if ("TABLE" === i[e].nodeName) return null; for (e = 0; e < i.length; e++)if (i[e].nodeName in n) return t.dom.isEmpty(i[e]) ? d(r, x(t)) : null; return null } }, S = function (t) { t.fire("SkinLoaded") }, M = function (t) { return t.fire("BeforeRenderUI") }, T = tinymce.util.Tools.resolve("tinymce.EditorManager"), W = function (e) { return function (t) { return typeof t === e } }, P = function (t) { return Array.isArray(t) }, N = function (t) { return W("string")(t) }, O = function (t) { return W("number")(t) }, D = function (t) { return W("boolean")(t) }, A = function (t) { return W("function")(t) }, B = (W("object"), P), L = function (t, e) { if (e(t)) return !0; throw new Error("Default value doesn't match requested type.") }, I = function (r) { return function (t, e, n) { var i = t.settings; return L(n, r), e in i && r(i[e]) ? i[e] : n } }, z = { getStringOr: I(N), getBoolOr: I(D), getNumberOr: I(O), getHandlerOr: I(A), getToolbarItemsOr: (u = B, function (t, e, n) { var i, r, o, s, a, l = e in t.settings ? t.settings[e] : n; return L(n, u), r = n, B(i = l) ? i : N(i) ? "string" == typeof (s = i) ? (a = /[ ,]/, s.split(a).filter(function (t) { return 0 < t.length })) : s : D(i) ? (o = r, !1 === i ? [] : o) : r }) }, F = tinymce.util.Tools.resolve("tinymce.geom.Rect"), V = function (t, e) { return { rect: t, position: e } }, q = function (t, e) { return { x: e.x, y: e.y, w: t.w, h: t.h } }, U = function (t, e, n, i, r) { var o, s, a, l = { x: i.x, y: i.y, w: i.w + (i.w < r.w + n.w ? r.w : 0), h: i.h + (i.h < r.h + n.h ? r.h : 0) }; return o = F.findBestRelativePosition(r, n, l, t), n = F.clamp(n, l), o ? (s = F.relativePosition(r, n, o), a = q(r, s), V(a, o)) : (n = F.intersect(l, n)) ? ((o = F.findBestRelativePosition(r, n, l, e)) ? (s = F.relativePosition(r, n, o), a = q(r, s)) : a = q(r, n), V(a, o)) : null }, j = function (t, e, n) { return U(["cr-cl", "cl-cr"], ["bc-tc", "bl-tl", "br-tr"], t, e, n) }, $ = function (t, e, n) { return U(["tc-bc", "bc-tc", "tl-bl", "bl-tl", "tr-br", "br-tr", "cr-cl", "cl-cr"], ["bc-tc", "bl-tl", "br-tr", "cr-cl"], t, e, n) }, Y = function (t, e, n, i) { var r; return "function" == typeof t ? (r = t({ elementRect: m(e), contentAreaRect: m(n), panelRect: m(i) }), f(r)) : i }, X = function (t) { return t.panelRect }, J = function (t) { return z.getToolbarItemsOr(t, "selection_toolbar", ["bold", "italic", "|", "quicklink", "h2", "h3", "blockquote"]) }, G = function (t) { return z.getToolbarItemsOr(t, "insert_toolbar", ["quickimage", "quicktable"]) }, K = function (t) { return z.getHandlerOr(t, "inline_toolbar_position_handler", X) }, Z = function (t) { var e, n, i, r, o = t.settings; return o.skin_url ? (i = t, r = o.skin_url, i.documentBaseURI.toAbsolute(r)) : (e = o.skin, n = T.baseURL + "/skins/", e ? n + e : n + "lightgray") }, Q = function (t) { return !1 === t.settings.skin }, tt = function (i, r) { var t = Z(i), e = function () { var t, e, n; e = r, n = function () { t._skinLoaded = !0, S(t), e() }, (t = i).initialized ? n() : t.on("init", n) }; Q(i) ? e() : (v.DOM.styleSheetLoader.load(t + "/skin.min.css", e), i.contentCSS.push(t + "/content.inline.min.css")) }, et = function (t) { var e, n, i, r, o = t.contextToolbars; return a.flatten([o || [], (e = t, n = "img", i = "image", r = "alignleft aligncenter alignright", { predicate: function (t) { return e.dom.is(t, n) }, id: i, items: r })]) }, nt = function (t, e) { var n, i, r, o, s; return s = (o = t).selection.getNode(), i = o.dom.getParents(s, "*"), r = k(e), (n = l(t, [w(i[0], r), E("text"), H(i, "insert"), _(i, r)])) && n.rect ? n : null }, it = function (i, r) { return function () { var t, e, n; i.removed || (n = i, document.activeElement !== n.getBody()) || (t = et(i), (e = nt(i, t)) ? r.show(i, e.id, e.rect, t) : r.hide()) } }, rt = function (t, e) { var n, i, r, o, s, a = c.throttle(it(t, e), 0), l = c.throttle((r = it(n = t, i = e), function () { n.removed || i.inForm() || r() }), 0), u = (o = t, s = e, function () { var t = et(o), e = nt(o, t); e && s.reposition(o, e.id, e.rect) }); t.on("blur hide ObjectResizeStart", e.hide), t.on("click", a), t.on("nodeChange mouseup", l), t.on("ResizeEditor keyup", a), t.on("ResizeWindow", u), v.DOM.bind(h.container, "scroll", u), t.on("remove", function () { v.DOM.unbind(h.container, "scroll", u), e.remove() }), t.shortcuts.add("Alt+F10,F10", "", e.focus) }, ot = function (t, e) { return tt(t, function () { var n, i; rt(t, e), i = e, (n = t).shortcuts.remove("meta+k"), n.shortcuts.add("meta+k", "", function () { var t = et(n), e = l(n, [E("quicklink")]); e && i.show(n, e.id, e.rect, t) }) }), {} }, st = function (t, e) { return t.inline ? ot(t, e) : function (t) { throw new Error(t) }("inlite theme only supports inline mode.") }, at = function (t) { return function () { return t } }, lt = { noop: function () { for (var t = [], e = 0; e < arguments.length; e++)t[e] = arguments[e] }, noarg: function (n) { return function () { for (var t = [], e = 0; e < arguments.length; e++)t[e] = arguments[e]; return n() } }, compose: function (n, i) { return function () { for (var t = [], e = 0; e < arguments.length; e++)t[e] = arguments[e]; return n(i.apply(null, arguments)) } }, constant: at, identity: function (t) { return t }, tripleEquals: function (t, e) { return t === e }, curry: function (o) { for (var t = [], e = 1; e < arguments.length; e++)t[e - 1] = arguments[e]; for (var s = new Array(arguments.length - 1), n = 1; n < arguments.length; n++)s[n - 1] = arguments[n]; return function () { for (var t = [], e = 0; e < arguments.length; e++)t[e] = arguments[e]; for (var n = new Array(arguments.length), i = 0; i < n.length; i++)n[i] = arguments[i]; var r = s.concat(n); return o.apply(null, r) } }, not: function (n) { return function () { for (var t = [], e = 0; e < arguments.length; e++)t[e] = arguments[e]; return !n.apply(null, arguments) } }, die: function (t) { return function () { throw new Error(t) } }, apply: function (t) { return t() }, call: function (t) { t() }, never: at(!1), always: at(!0) }, ut = lt.never, ct = lt.always, dt = function () { return ft }, ft = (i = { fold: function (t, e) { return t() }, is: ut, isSome: ut, isNone: ct, getOr: n = function (t) { return t }, getOrThunk: e = function (t) { return t() }, getOrDie: function (t) { throw new Error(t || "error: getOrDie called on none.") }, or: n, orThunk: e, map: dt, ap: dt, each: function () { }, bind: dt, flatten: dt, exists: ut, forall: ct, filter: dt, equals: t = function (t) { return t.isNone() }, equals_: t, toArray: function () { return [] }, toString: lt.constant("none()") }, Object.freeze && Object.freeze(i), i), ht = function (n) { var t = function () { return n }, e = function () { return r }, i = function (t) { return t(n) }, r = { fold: function (t, e) { return e(n) }, is: function (t) { return n === t }, isSome: ct, isNone: ut, getOr: t, getOrThunk: t, getOrDie: t, or: e, orThunk: e, map: function (t) { return ht(t(n)) }, ap: function (t) { return t.fold(dt, function (t) { return ht(t(n)) }) }, each: function (t) { t(n) }, bind: i, flatten: t, exists: i, forall: i, filter: function (t) { return t(n) ? r : ft }, equals: function (t) { return t.is(n) }, equals_: function (t, e) { return t.fold(ut, function (t) { return e(n, t) }) }, toArray: function () { return [n] }, toString: function () { return "some(" + n + ")" } }; return r }, mt = { some: ht, none: dt, from: function (t) { return null === t || t === undefined ? ft : ht(t) } }, gt = function (e) { return function (t) { return function (t) { if (null === t) return "null"; var e = typeof t; return "object" === e && Array.prototype.isPrototypeOf(t) ? "array" : "object" === e && String.prototype.isPrototypeOf(t) ? "string" : e }(t) === e } }, pt = { isString: gt("string"), isObject: gt("object"), isArray: gt("array"), isNull: gt("null"), isBoolean: gt("boolean"), isUndefined: gt("undefined"), isFunction: gt("function"), isNumber: gt("number") }, vt = (r = Array.prototype.indexOf) === undefined ? function (t, e) { return Ct(t, e) } : function (t, e) { return r.call(t, e) }, yt = function (t, e) { return -1 < vt(t, e) }, bt = function (t, e) { for (var n = t.length, i = new Array(n), r = 0; r < n; r++) { var o = t[r]; i[r] = e(o, r, t) } return i }, xt = function (t, e) { for (var n = 0, i = t.length; n < i; n++)e(t[n], n, t) }, wt = function (t, e) { for (var n = t.length - 1; 0 <= n; n--)e(t[n], n, t) }, _t = function (t, e) { for (var n = [], i = 0, r = t.length; i < r; i++) { var o = t[i]; e(o, i, t) && n.push(o) } return n }, Rt = function (t, e) { for (var n = 0, i = t.length; n < i; n++)if (e(t[n], n, t)) return mt.some(n); return mt.none() }, Ct = function (t, e) { for (var n = 0, i = t.length; n < i; ++n)if (t[n] === e) return n; return -1 }, kt = Array.prototype.push, Et = function (t) { for (var e = [], n = 0, i = t.length; n < i; ++n) { if (!Array.prototype.isPrototypeOf(t[n])) throw new Error("Arr.flatten item " + n + " was not an array, input: " + t); kt.apply(e, t[n]) } return e }, Ht = function (t, e) { for (var n = 0, i = t.length; n < i; ++n)if (!0 !== e(t[n], n, t)) return !1; return !0 }, St = Array.prototype.slice, Mt = pt.isFunction(Array.from) ? Array.from : function (t) { return St.call(t) }, Tt = { map: bt, each: xt, eachr: wt, partition: function (t, e) { for (var n = [], i = [], r = 0, o = t.length; r < o; r++) { var s = t[r]; (e(s, r, t) ? n : i).push(s) } return { pass: n, fail: i } }, filter: _t, groupBy: function (t, e) { if (0 === t.length) return []; for (var n = e(t[0]), i = [], r = [], o = 0, s = t.length; o < s; o++) { var a = t[o], l = e(a); l !== n && (i.push(r), r = []), n = l, r.push(a) } return 0 !== r.length && i.push(r), i }, indexOf: function (t, e) { var n = vt(t, e); return -1 === n ? mt.none() : mt.some(n) }, foldr: function (t, e, n) { return wt(t, function (t) { n = e(n, t) }), n }, foldl: function (t, e, n) { return xt(t, function (t) { n = e(n, t) }), n }, find: function (t, e) { for (var n = 0, i = t.length; n < i; n++) { var r = t[n]; if (e(r, n, t)) return mt.some(r) } return mt.none() }, findIndex: Rt, flatten: Et, bind: function (t, e) { var n = bt(t, e); return Et(n) }, forall: Ht, exists: function (t, e) { return Rt(t, e).isSome() }, contains: yt, equal: function (t, n) { return t.length === n.length && Ht(t, function (t, e) { return t === n[e] }) }, reverse: function (t) { var e = St.call(t, 0); return e.reverse(), e }, chunk: function (t, e) { for (var n = [], i = 0; i < t.length; i += e) { var r = t.slice(i, i + e); n.push(r) } return n }, difference: function (t, e) { return _t(t, function (t) { return !yt(e, t) }) }, mapToObject: function (t, e) { for (var n = {}, i = 0, r = t.length; i < r; i++) { var o = t[i]; n[String(o)] = e(o, i) } return n }, pure: function (t) { return [t] }, sort: function (t, e) { var n = St.call(t, 0); return n.sort(e), n }, range: function (t, e) { for (var n = [], i = 0; i < t; i++)n.push(e(i)); return n }, head: function (t) { return 0 === t.length ? mt.none() : mt.some(t[0]) }, last: function (t) { return 0 === t.length ? mt.none() : mt.some(t[t.length - 1]) }, from: Mt }, Wt = 0, Pt = { id: function () { return "mceu_" + Wt++ }, create: function (t, e, n) { var i = document.createElement(t); return v.DOM.setAttribs(i, e), "string" == typeof n ? i.innerHTML = n : R.each(n, function (t) { t.nodeType && i.appendChild(t) }), i }, createFragment: function (t) { return v.DOM.createFragment(t) }, getWindowSize: function () { return v.DOM.getViewPort() }, getSize: function (t) { var e, n; if (t.getBoundingClientRect) { var i = t.getBoundingClientRect(); e = Math.max(i.width || i.right - i.left, t.offsetWidth), n = Math.max(i.height || i.bottom - i.bottom, t.offsetHeight) } else e = t.offsetWidth, n = t.offsetHeight; return { width: e, height: n } }, getPos: function (t, e) { return v.DOM.getPos(t, e || Pt.getContainer()) }, getContainer: function () { return h.container ? h.container : document.body }, getViewPort: function (t) { return v.DOM.getViewPort(t) }, get: function (t) { return document.getElementById(t) }, addClass: function (t, e) { return v.DOM.addClass(t, e) }, removeClass: function (t, e) { return v.DOM.removeClass(t, e) }, hasClass: function (t, e) { return v.DOM.hasClass(t, e) }, toggleClass: function (t, e, n) { return v.DOM.toggleClass(t, e, n) }, css: function (t, e, n) { return v.DOM.setStyle(t, e, n) }, getRuntimeStyle: function (t, e) { return v.DOM.getStyle(t, e, !0) }, on: function (t, e, n, i) { return v.DOM.bind(t, e, n, i) }, off: function (t, e, n) { return v.DOM.unbind(t, e, n) }, fire: function (t, e, n) { return v.DOM.fire(t, e, n) }, innerHtml: function (t, e) { v.DOM.setHTML(t, e) } }, Nt = tinymce.util.Tools.resolve("tinymce.dom.DomQuery"), Ot = tinymce.util.Tools.resolve("tinymce.util.Class"), Dt = tinymce.util.Tools.resolve("tinymce.util.EventDispatcher"), At = function (t) { var e; if (t) return "number" == typeof t ? { top: t = t || 0, left: t, bottom: t, right: t } : (1 === (e = (t = t.split(" ")).length) ? t[1] = t[2] = t[3] = t[0] : 2 === e ? (t[2] = t[0], t[3] = t[1]) : 3 === e && (t[3] = t[1]), { top: parseInt(t[0], 10) || 0, right: parseInt(t[1], 10) || 0, bottom: parseInt(t[2], 10) || 0, left: parseInt(t[3], 10) || 0 }) }, Bt = function (i, t) { function e(t) { var e = parseFloat(function (t) { var e = i.ownerDocument.defaultView; if (e) { var n = e.getComputedStyle(i, null); return n ? (t = t.replace(/[A-Z]/g, function (t) { return "-" + t }), n.getPropertyValue(t)) : null } return i.currentStyle[t] }(t)); return isNaN(e) ? 0 : e } return { top: e(t + "TopWidth"), right: e(t + "RightWidth"), bottom: e(t + "BottomWidth"), left: e(t + "LeftWidth") } }; function Lt() { } function It(t) { this.cls = [], this.cls._map = {}, this.onchange = t || Lt, this.prefix = "" } R.extend(It.prototype, { add: function (t) { return t && !this.contains(t) && (this.cls._map[t] = !0, this.cls.push(t), this._change()), this }, remove: function (t) { if (this.contains(t)) { var e = void 0; for (e = 0; e < this.cls.length && this.cls[e] !== t; e++); this.cls.splice(e, 1), delete this.cls._map[t], this._change() } return this }, toggle: function (t, e) { var n = this.contains(t); return n !== e && (n ? this.remove(t) : this.add(t), this._change()), this }, contains: function (t) { return !!this.cls._map[t] }, _change: function () { delete this.clsValue, this.onchange.call(this) } }), It.prototype.toString = function () { var t; if (this.clsValue) return this.clsValue; t = ""; for (var e = 0; e < this.cls.length; e++)0 < e && (t += " "), t += this.prefix + this.cls[e]; return t }; var zt, Ft, Vt, qt = /^([\w\\*]+)?(?:#([\w\-\\]+))?(?:\.([\w\\\.]+))?(?:\[\@?([\w\\]+)([\^\$\*!~]?=)([\w\\]+)\])?(?:\:(.+))?/i, Ut = /((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g, jt = /^\s*|\s*$/g, $t = Ot.extend({ init: function (t) { var o = this.match; function s(t, e, n) { var i; function r(t) { t && e.push(t) } return r(function (e) { if (e) return e = e.toLowerCase(), function (t) { return "*" === e || t.type === e } }((i = qt.exec(t.replace(jt, "")))[1])), r(function (e) { if (e) return function (t) { return t._name === e } }(i[2])), r(function (n) { if (n) return n = n.split("."), function (t) { for (var e = n.length; e--;)if (!t.classes.contains(n[e])) return !1; return !0 } }(i[3])), r(function (n, i, r) { if (n) return function (t) { var e = t[n] ? t[n]() : ""; return i ? "=" === i ? e === r : "*=" === i ? 0 <= e.indexOf(r) : "~=" === i ? 0 <= (" " + e + " ").indexOf(" " + r + " ") : "!=" === i ? e !== r : "^=" === i ? 0 === e.indexOf(r) : "$=" === i && e.substr(e.length - r.length) === r : !!r } }(i[4], i[5], i[6])), r(function (i) { var e; if (i) return (i = /(?:not\((.+)\))|(.+)/i.exec(i))[1] ? (e = a(i[1], []), function (t) { return !o(t, e) }) : (i = i[2], function (t, e, n) { return "first" === i ? 0 === e : "last" === i ? e === n - 1 : "even" === i ? e % 2 == 0 : "odd" === i ? e % 2 == 1 : !!t[i] && t[i]() }) }(i[7])), e.pseudo = !!i[7], e.direct = n, e } function a(t, e) { var n, i, r, o = []; do { if (Ut.exec(""), (i = Ut.exec(t)) && (t = i[3], o.push(i[1]), i[2])) { n = i[3]; break } } while (i); for (n && a(n, e), t = [], r = 0; r < o.length; r++)">" !== o[r] && t.push(s(o[r], [], ">" === o[r - 1])); return e.push(t), e } this._selectors = a(t, []) }, match: function (t, e) { var n, i, r, o, s, a, l, u, c, d, f, h, m; for (n = 0, i = (e = e || this._selectors).length; n < i; n++) { for (m = t, h = 0, r = (o = (s = e[n]).length) - 1; 0 <= r; r--)for (u = s[r]; m;) { if (u.pseudo) for (c = d = (f = m.parent().items()).length; c-- && f[c] !== m;); for (a = 0, l = u.length; a < l; a++)if (!u[a](m, c, d)) { a = l + 1; break } if (a === l) { h++; break } if (r === o - 1) break; m = m.parent() } if (h === o) return !0 } return !1 }, find: function (t) { var e, n, u = [], i = this._selectors; function c(t, e, n) { var i, r, o, s, a, l = e[n]; for (i = 0, r = t.length; i < r; i++) { for (a = t[i], o = 0, s = l.length; o < s; o++)if (!l[o](a, i, r)) { o = s + 1; break } if (o === s) n === e.length - 1 ? u.push(a) : a.items && c(a.items(), e, n + 1); else if (l.direct) return; a.items && c(a.items(), e, n) } } if (t.items) { for (e = 0, n = i.length; e < n; e++)c(t.items(), i[e], 0); 1 < n && (u = function (t) { for (var e, n = [], i = t.length; i--;)(e = t[i]).__checked || (n.push(e), e.__checked = 1); for (i = n.length; i--;)delete n[i].__checked; return n }(u)) } return zt || (zt = $t.Collection), new zt(u) } }), Yt = Array.prototype.push, Xt = Array.prototype.slice; Vt = { length: 0, init: function (t) { t && this.add(t) }, add: function (t) { return R.isArray(t) ? Yt.apply(this, t) : t instanceof Ft ? this.add(t.toArray()) : Yt.call(this, t), this }, set: function (t) { var e, n = this, i = n.length; for (n.length = 0, n.add(t), e = n.length; e < i; e++)delete n[e]; return n }, filter: function (e) { var t, n, i, r, o = []; for ("string" == typeof e ? (e = new $t(e), r = function (t) { return e.match(t) }) : r = e, t = 0, n = this.length; t < n; t++)r(i = this[t]) && o.push(i); return new Ft(o) }, slice: function () { return new Ft(Xt.apply(this, arguments)) }, eq: function (t) { return -1 === t ? this.slice(t) : this.slice(t, +t + 1) }, each: function (t) { return R.each(this, t), this }, toArray: function () { return R.toArray(this) }, indexOf: function (t) { for (var e = this.length; e-- && this[e] !== t;); return e }, reverse: function () { return new Ft(R.toArray(this).reverse()) }, hasClass: function (t) { return !!this[0] && this[0].classes.contains(t) }, prop: function (e, n) { var t; return n !== undefined ? (this.each(function (t) { t[e] && t[e](n) }), this) : (t = this[0]) && t[e] ? t[e]() : void 0 }, exec: function (e) { var n = R.toArray(arguments).slice(1); return this.each(function (t) { t[e] && t[e].apply(t, n) }), this }, remove: function () { for (var t = this.length; t--;)this[t].remove(); return this }, addClass: function (e) { return this.each(function (t) { t.classes.add(e) }) }, removeClass: function (e) { return this.each(function (t) { t.classes.remove(e) }) } }, R.each("fire on off show hide append prepend before after reflow".split(" "), function (n) { Vt[n] = function () { var e = R.toArray(arguments); return this.each(function (t) { n in t && t[n].apply(t, e) }), this } }), R.each("text name disabled active selected checked visible parent value data".split(" "), function (e) { Vt[e] = function (t) { return this.prop(e, t) } }), Ft = Ot.extend(Vt); var Jt = $t.Collection = Ft, Gt = function (t) { this.create = t.create }; Gt.create = function (r, o) { return new Gt({ create: function (e, n) { var i, t = function (t) { e.set(n, t.value) }; return e.on("change:" + n, function (t) { r.set(o, t.value) }), r.on("change:" + o, t), (i = e._bindings) || (i = e._bindings = [], e.on("destroy", function () { for (var t = i.length; t--;)i[t]() })), i.push(function () { r.off("change:" + o, t) }), r.get(o) } }) }; var Kt = tinymce.util.Tools.resolve("tinymce.util.Observable"); function Zt(t) { return 0 < t.nodeType } var Qt, te, ee = Ot.extend({ Mixins: [Kt], init: function (t) { var e, n; for (e in t = t || {}) (n = t[e]) instanceof Gt && (t[e] = n.create(this, e)); this.data = t }, set: function (e, n) { var i, r, o = this.data[e]; if (n instanceof Gt && (n = n.create(this, e)), "object" == typeof e) { for (i in e) this.set(i, e[i]); return this } return function t(e, n) { var i, r; if (e === n) return !0; if (null === e || null === n) return e === n; if ("object" != typeof e || "object" != typeof n) return e === n; if (R.isArray(n)) { if (e.length !== n.length) return !1; for (i = e.length; i--;)if (!t(e[i], n[i])) return !1 } if (Zt(e) || Zt(n)) return e === n; for (i in r = {}, n) { if (!t(e[i], n[i])) return !1; r[i] = !0 } for (i in e) if (!r[i] && !t(e[i], n[i])) return !1; return !0 }(o, n) || (this.data[e] = n, r = { target: this, name: e, value: n, oldValue: o }, this.fire("change:" + e, r), this.fire("change", r)), this }, get: function (t) { return this.data[t] }, has: function (t) { return t in this.data }, bind: function (t) { return Gt.create(this, t) }, destroy: function () { this.fire("destroy") } }), ne = {}, ie = { add: function (t) { var e = t.parent(); if (e) { if (!e._layout || e._layout.isNative()) return; ne[e._id] || (ne[e._id] = e), Qt || (Qt = !0, c.requestAnimationFrame(function () { var t, e; for (t in Qt = !1, ne) (e = ne[t]).state.get("rendered") && e.reflow(); ne = {} }, document.body)) } }, remove: function (t) { ne[t._id] && delete ne[t._id] } }, re = function (t) { return t ? t.getRoot().uiContainer : null }, oe = { getUiContainerDelta: function (t) { var e = re(t); if (e && "static" !== v.DOM.getStyle(e, "position", !0)) { var n = v.DOM.getPos(e), i = e.scrollLeft - n.x, r = e.scrollTop - n.y; return mt.some({ x: i, y: r }) } return mt.none() }, setUiContainer: function (t, e) { var n = v.DOM.select(t.settings.ui_container)[0]; e.getRoot().uiContainer = n }, getUiContainer: re, inheritUiContainer: function (t, e) { return e.uiContainer = re(t) } }, se = "onmousewheel" in document, ae = !1, le = 0, ue = { Statics: { classPrefix: "mce-" }, isRtl: function () { return te.rtl }, classPrefix: "mce-", init: function (e) { var t, n, i = this; function r(t) { var e; for (t = t.split(" "), e = 0; e < t.length; e++)i.classes.add(t[e]) } i.settings = e = R.extend({}, i.Defaults, e), i._id = e.id || "mceu_" + le++ , i._aria = { role: e.role }, i._elmCache = {}, i.$ = Nt, i.state = new ee({ visible: !0, active: !1, disabled: !1, value: "" }), i.data = new ee(e.data), i.classes = new It(function () { i.state.get("rendered") && (i.getEl().className = this.toString()) }), i.classes.prefix = i.classPrefix, (t = e.classes) && (i.Defaults && (n = i.Defaults.classes) && t !== n && r(n), r(t)), R.each("title text name visible disabled active value".split(" "), function (t) { t in e && i[t](e[t]) }), i.on("click", function () { if (i.disabled()) return !1 }), i.settings = e, i.borderBox = At(e.border), i.paddingBox = At(e.padding), i.marginBox = At(e.margin), e.hidden && i.hide() }, Properties: "parent,name", getContainerElm: function () { var t = oe.getUiContainer(this); return t || Pt.getContainer() }, getParentCtrl: function (t) { for (var e, n = this.getRoot().controlIdLookup; t && n && !(e = n[t.id]);)t = t.parentNode; return e }, initLayoutRect: function () { var t, e, n, i, r, o, s, a, l, u, c = this, d = c.settings, f = c.getEl(); t = c.borderBox = c.borderBox || Bt(f, "border"), c.paddingBox = c.paddingBox || Bt(f, "padding"), c.marginBox = c.marginBox || Bt(f, "margin"), u = Pt.getSize(f), a = d.minWidth, l = d.minHeight, r = a || u.width, o = l || u.height, n = d.width, i = d.height, s = void 0 !== (s = d.autoResize) ? s : !n && !i, n = n || r, i = i || o; var h = t.left + t.right, m = t.top + t.bottom, g = d.maxWidth || 65535, p = d.maxHeight || 65535; return c._layoutRect = e = { x: d.x || 0, y: d.y || 0, w: n, h: i, deltaW: h, deltaH: m, contentW: n - h, contentH: i - m, innerW: n - h, innerH: i - m, startMinWidth: a || 0, startMinHeight: l || 0, minW: Math.min(r, g), minH: Math.min(o, p), maxW: g, maxH: p, autoResize: s, scrollW: 0 }, c._lastLayoutRect = {}, e }, layoutRect: function (t) { var e, n, i, r, o, s = this, a = s._layoutRect; return a || (a = s.initLayoutRect()), t ? (i = a.deltaW, r = a.deltaH, t.x !== undefined && (a.x = t.x), t.y !== undefined && (a.y = t.y), t.minW !== undefined && (a.minW = t.minW), t.minH !== undefined && (a.minH = t.minH), (n = t.w) !== undefined && (n = (n = n < a.minW ? a.minW : n) > a.maxW ? a.maxW : n, a.w = n, a.innerW = n - i), (n = t.h) !== undefined && (n = (n = n < a.minH ? a.minH : n) > a.maxH ? a.maxH : n, a.h = n, a.innerH = n - r), (n = t.innerW) !== undefined && (n = (n = n < a.minW - i ? a.minW - i : n) > a.maxW - i ? a.maxW - i : n, a.innerW = n, a.w = n + i), (n = t.innerH) !== undefined && (n = (n = n < a.minH - r ? a.minH - r : n) > a.maxH - r ? a.maxH - r : n, a.innerH = n, a.h = n + r), t.contentW !== undefined && (a.contentW = t.contentW), t.contentH !== undefined && (a.contentH = t.contentH), (e = s._lastLayoutRect).x === a.x && e.y === a.y && e.w === a.w && e.h === a.h || ((o = te.repaintControls) && o.map && !o.map[s._id] && (o.push(s), o.map[s._id] = !0), e.x = a.x, e.y = a.y, e.w = a.w, e.h = a.h), s) : a }, repaint: function () { var t, e, n, i, r, o, s, a, l, u, c = this; l = document.createRange ? function (t) { return t } : Math.round, t = c.getEl().style, i = c._layoutRect, a = c._lastRepaintRect || {}, o = (r = c.borderBox).left + r.right, s = r.top + r.bottom, i.x !== a.x && (t.left = l(i.x) + "px", a.x = i.x), i.y !== a.y && (t.top = l(i.y) + "px", a.y = i.y), i.w !== a.w && (u = l(i.w - o), t.width = (0 <= u ? u : 0) + "px", a.w = i.w), i.h !== a.h && (u = l(i.h - s), t.height = (0 <= u ? u : 0) + "px", a.h = i.h), c._hasBody && i.innerW !== a.innerW && (u = l(i.innerW), (n = c.getEl("body")) && ((e = n.style).width = (0 <= u ? u : 0) + "px"), a.innerW = i.innerW), c._hasBody && i.innerH !== a.innerH && (u = l(i.innerH), (n = n || c.getEl("body")) && ((e = e || n.style).height = (0 <= u ? u : 0) + "px"), a.innerH = i.innerH), c._lastRepaintRect = a, c.fire("repaint", {}, !1) }, updateLayoutRect: function () { var t = this; t.parent()._lastRect = null, Pt.css(t.getEl(), { width: "", height: "" }), t._layoutRect = t._lastRepaintRect = t._lastLayoutRect = null, t.initLayoutRect() }, on: function (t, e) { var n, i, r, o = this; return ce(o).on(t, "string" != typeof (n = e) ? n : function (t) { return i || o.parentsAndSelf().each(function (t) { var e = t.settings.callbacks; if (e && (i = e[n])) return r = t, !1 }), i ? i.call(r, t) : (t.action = n, void this.fire("execute", t)) }), o }, off: function (t, e) { return ce(this).off(t, e), this }, fire: function (t, e, n) { if ((e = e || {}).control || (e.control = this), e = ce(this).fire(t, e), !1 !== n && this.parent) for (var i = this.parent(); i && !e.isPropagationStopped();)i.fire(t, e, !1), i = i.parent(); return e }, hasEventListeners: function (t) { return ce(this).has(t) }, parents: function (t) { var e, n = new Jt; for (e = this.parent(); e; e = e.parent())n.add(e); return t && (n = n.filter(t)), n }, parentsAndSelf: function (t) { return new Jt(this).add(this.parents(t)) }, next: function () { var t = this.parent().items(); return t[t.indexOf(this) + 1] }, prev: function () { var t = this.parent().items(); return t[t.indexOf(this) - 1] }, innerHtml: function (t) { return this.$el.html(t), this }, getEl: function (t) { var e = t ? this._id + "-" + t : this._id; return this._elmCache[e] || (this._elmCache[e] = Nt("#" + e)[0]), this._elmCache[e] }, show: function () { return this.visible(!0) }, hide: function () { return this.visible(!1) }, focus: function () { try { this.getEl().focus() } catch (t) { } return this }, blur: function () { return this.getEl().blur(), this }, aria: function (t, e) { var n = this, i = n.getEl(n.ariaTarget); return void 0 === e ? n._aria[t] : (n._aria[t] = e, n.state.get("rendered") && i.setAttribute("role" === t ? t : "aria-" + t, e), n) }, encode: function (t, e) { return !1 !== e && (t = this.translate(t)), (t || "").replace(/[&<>"]/g, function (t) { return "&#" + t.charCodeAt(0) + ";" }) }, translate: function (t) { return te.translate ? te.translate(t) : t }, before: function (t) { var e = this.parent(); return e && e.insert(t, e.items().indexOf(this), !0), this }, after: function (t) { var e = this.parent(); return e && e.insert(t, e.items().indexOf(this)), this }, remove: function () { var e, t, n = this, i = n.getEl(), r = n.parent(); if (n.items) { var o = n.items().toArray(); for (t = o.length; t--;)o[t].remove() } r && r.items && (e = [], r.items().each(function (t) { t !== n && e.push(t) }), r.items().set(e), r._lastRect = null), n._eventsRoot && n._eventsRoot === n && Nt(i).off(); var s = n.getRoot().controlIdLookup; return s && delete s[n._id], i && i.parentNode && i.parentNode.removeChild(i), n.state.set("rendered", !1), n.state.destroy(), n.fire("remove"), n }, renderBefore: function (t) { return Nt(t).before(this.renderHtml()), this.postRender(), this }, renderTo: function (t) { return Nt(t || this.getContainerElm()).append(this.renderHtml()), this.postRender(), this }, preRender: function () { }, render: function () { }, renderHtml: function () { return '<div id="' + this._id + '" class="' + this.classes + '"></div>' }, postRender: function () { var t, e, n, i, r, o = this, s = o.settings; for (i in o.$el = Nt(o.getEl()), o.state.set("rendered", !0), s) 0 === i.indexOf("on") && o.on(i.substr(2), s[i]); if (o._eventsRoot) { for (n = o.parent(); !r && n; n = n.parent())r = n._eventsRoot; if (r) for (i in r._nativeEvents) o._nativeEvents[i] = !0 } de(o), s.style && (t = o.getEl()) && (t.setAttribute("style", s.style), t.style.cssText = s.style), o.settings.border && (e = o.borderBox, o.$el.css({ "border-top-width": e.top, "border-right-width": e.right, "border-bottom-width": e.bottom, "border-left-width": e.left })); var a = o.getRoot(); for (var l in a.controlIdLookup || (a.controlIdLookup = {}), (a.controlIdLookup[o._id] = o)._aria) o.aria(l, o._aria[l]); !1 === o.state.get("visible") && (o.getEl().style.display = "none"), o.bindStates(), o.state.on("change:visible", function (t) { var e, n = t.value; o.state.get("rendered") && (o.getEl().style.display = !1 === n ? "none" : "", o.getEl().getBoundingClientRect()), (e = o.parent()) && (e._lastRect = null), o.fire(n ? "show" : "hide"), ie.add(o) }), o.fire("postrender", {}, !1) }, bindStates: function () { }, scrollIntoView: function (t) { var e, n, i, r, o, s, a = this.getEl(), l = a.parentNode, u = function (t, e) { var n, i, r = t; for (n = i = 0; r && r !== e && r.nodeType;)n += r.offsetLeft || 0, i += r.offsetTop || 0, r = r.offsetParent; return { x: n, y: i } }(a, l); return e = u.x, n = u.y, i = a.offsetWidth, r = a.offsetHeight, o = l.clientWidth, s = l.clientHeight, "end" === t ? (e -= o - i, n -= s - r) : "center" === t && (e -= o / 2 - i / 2, n -= s / 2 - r / 2), l.scrollLeft = e, l.scrollTop = n, this }, getRoot: function () { for (var t, e = this, n = []; e;) { if (e.rootControl) { t = e.rootControl; break } n.push(e), e = (t = e).parent() } t || (t = this); for (var i = n.length; i--;)n[i].rootControl = t; return t }, reflow: function () { ie.remove(this); var t = this.parent(); return t && t._layout && !t._layout.isNative() && t.reflow(), this } }; function ce(n) { return n._eventDispatcher || (n._eventDispatcher = new Dt({ scope: n, toggleEvent: function (t, e) { e && Dt.isNative(t) && (n._nativeEvents || (n._nativeEvents = {}), n._nativeEvents[t] = !0, n.state.get("rendered") && de(n)) } })), n._eventDispatcher } function de(a) { var t, e, n, l, i, r; function o(t) { var e = a.getParentCtrl(t.target); e && e.fire(t.type, t) } function s() { var t = l._lastHoverCtrl; t && (t.fire("mouseleave", { target: t.getEl() }), t.parents().each(function (t) { t.fire("mouseleave", { target: t.getEl() }) }), l._lastHoverCtrl = null) } function u(t) { var e, n, i, r = a.getParentCtrl(t.target), o = l._lastHoverCtrl, s = 0; if (r !== o) { if ((n = (l._lastHoverCtrl = r).parents().toArray().reverse()).push(r), o) { for ((i = o.parents().toArray().reverse()).push(o), s = 0; s < i.length && n[s] === i[s]; s++); for (e = i.length - 1; s <= e; e--)(o = i[e]).fire("mouseleave", { target: o.getEl() }) } for (e = s; e < n.length; e++)(r = n[e]).fire("mouseenter", { target: r.getEl() }) } } function c(t) { t.preventDefault(), "mousewheel" === t.type ? (t.deltaY = -.025 * t.wheelDelta, t.wheelDeltaX && (t.deltaX = -.025 * t.wheelDeltaX)) : (t.deltaX = 0, t.deltaY = t.detail), t = a.fire("wheel", t) } if (i = a._nativeEvents) { for ((n = a.parents().toArray()).unshift(a), t = 0, e = n.length; !l && t < e; t++)l = n[t]._eventsRoot; for (l || (l = n[n.length - 1] || a), a._eventsRoot = l, e = t, t = 0; t < e; t++)n[t]._eventsRoot = l; var d = l._delegates; for (r in d || (d = l._delegates = {}), i) { if (!i) return !1; "wheel" !== r || ae ? ("mouseenter" === r || "mouseleave" === r ? l._hasMouseEnter || (Nt(l.getEl()).on("mouseleave", s).on("mouseover", u), l._hasMouseEnter = 1) : d[r] || (Nt(l.getEl()).on(r, o), d[r] = !0), i[r] = !1) : se ? Nt(a.getEl()).on("mousewheel", c) : Nt(a.getEl()).on("DOMMouseScroll", c) } } } R.each("text title visible disabled active value".split(" "), function (e) { ue[e] = function (t) { return 0 === arguments.length ? this.state.get(e) : (void 0 !== t && this.state.set(e, t), this) } }); var fe = te = Ot.extend(ue), he = function (t) { return "static" === Pt.getRuntimeStyle(t, "position") }, me = function (t) { return t.state.get("fixed") }; function ge(t, e, n) { var i, r, o, s, a, l, u, c, d, f; return d = pe(), o = (r = Pt.getPos(e, oe.getUiContainer(t))).x, s = r.y, me(t) && he(document.body) && (o -= d.x, s -= d.y), i = t.getEl(), a = (f = Pt.getSize(i)).width, l = f.height, u = (f = Pt.getSize(e)).width, c = f.height, "b" === (n = (n || "").split(""))[0] && (s += c), "r" === n[1] && (o += u), "c" === n[0] && (s += Math.round(c / 2)), "c" === n[1] && (o += Math.round(u / 2)), "b" === n[3] && (s -= l), "r" === n[4] && (o -= a), "c" === n[3] && (s -= Math.round(l / 2)), "c" === n[4] && (o -= Math.round(a / 2)), { x: o, y: s, w: a, h: l } } var pe = function () { var t = window, e = Math.max(t.pageXOffset, document.body.scrollLeft, document.documentElement.scrollLeft), n = Math.max(t.pageYOffset, document.body.scrollTop, document.documentElement.scrollTop); return { x: e, y: n, w: e + (t.innerWidth || document.documentElement.clientWidth), h: n + (t.innerHeight || document.documentElement.clientHeight) } }, ve = function (t) { var e, n = oe.getUiContainer(t); return n && !me(t) ? { x: 0, y: 0, w: (e = n).scrollWidth - 1, h: e.scrollHeight - 1 } : pe() }, ye = { testMoveRel: function (t, e) { for (var n = ve(this), i = 0; i < e.length; i++) { var r = ge(this, t, e[i]); if (me(this)) { if (0 < r.x && r.x + r.w < n.w && 0 < r.y && r.y + r.h < n.h) return e[i] } else if (r.x > n.x && r.x + r.w < n.w && r.y > n.y && r.y + r.h < n.h) return e[i] } return e[0] }, moveRel: function (t, e) { "string" != typeof e && (e = this.testMoveRel(t, e)); var n = ge(this, t, e); return this.moveTo(n.x, n.y) }, moveBy: function (t, e) { var n = this.layoutRect(); return this.moveTo(n.x + t, n.y + e), this }, moveTo: function (t, e) { var n = this; function i(t, e, n) { return t < 0 ? 0 : e < t + n && (t = e - n) < 0 ? 0 : t } if (n.settings.constrainToViewport) { var r = ve(this), o = n.layoutRect(); t = i(t, r.w, o.w), e = i(e, r.h, o.h) } var s = oe.getUiContainer(n); return s && he(s) && !me(n) && (t -= s.scrollLeft, e -= s.scrollTop), s && (t += 1, e += 1), n.state.get("rendered") ? n.layoutRect({ x: t, y: e }).repaint() : (n.settings.x = t, n.settings.y = e), n.fire("move", { x: t, y: e }), n } }, be = fe.extend({ Mixins: [ye], Defaults: { classes: "widget tooltip tooltip-n" }, renderHtml: function () { var t = this, e = t.classPrefix; return '<div id="' + t._id + '" class="' + t.classes + '" role="presentation"><div class="' + e + 'tooltip-arrow"></div><div class="' + e + 'tooltip-inner">' + t.encode(t.state.get("text")) + "</div></div>" }, bindStates: function () { var e = this; return e.state.on("change:text", function (t) { e.getEl().lastChild.innerHTML = e.encode(t.value) }), e._super() }, repaint: function () { var t, e; t = this.getEl().style, e = this._layoutRect, t.left = e.x + "px", t.top = e.y + "px", t.zIndex = 131070 } }), xe = fe.extend({ init: function (i) { var r = this; r._super(i), i = r.settings, r.canFocus = !0, i.tooltip && !1 !== xe.tooltips && (r.on("mouseenter", function (t) { var e = r.tooltip().moveTo(-65535); if (t.control === r) { var n = e.text(i.tooltip).show().testMoveRel(r.getEl(), ["bc-tc", "bc-tl", "bc-tr"]); e.classes.toggle("tooltip-n", "bc-tc" === n), e.classes.toggle("tooltip-nw", "bc-tl" === n), e.classes.toggle("tooltip-ne", "bc-tr" === n), e.moveRel(r.getEl(), n) } else e.hide() }), r.on("mouseleave mousedown click", function () { r.tooltip().remove(), r._tooltip = null })), r.aria("label", i.ariaLabel || i.tooltip) }, tooltip: function () { return this._tooltip || (this._tooltip = new be({ type: "tooltip" }), oe.inheritUiContainer(this, this._tooltip), this._tooltip.renderTo()), this._tooltip }, postRender: function () { var t = this, e = t.settings; t._super(), t.parent() || !e.width && !e.height || (t.initLayoutRect(), t.repaint()), e.autofocus && t.focus() }, bindStates: function () { var e = this; function n(t) { e.aria("disabled", t), e.classes.toggle("disabled", t) } function i(t) { e.aria("pressed", t), e.classes.toggle("active", t) } return e.state.on("change:disabled", function (t) { n(t.value) }), e.state.on("change:active", function (t) { i(t.value) }), e.state.get("disabled") && n(!0), e.state.get("active") && i(!0), e._super() }, remove: function () { this._super(), this._tooltip && (this._tooltip.remove(), this._tooltip = null) } }), we = xe.extend({ Defaults: { value: 0 }, init: function (t) { this._super(t), this.classes.add("progress"), this.settings.filter || (this.settings.filter = function (t) { return Math.round(t) }) }, renderHtml: function () { var t = this._id, e = this.classPrefix; return '<div id="' + t + '" class="' + this.classes + '"><div class="' + e + 'bar-container"><div class="' + e + 'bar"></div></div><div class="' + e + 'text">0%</div></div>' }, postRender: function () { return this._super(), this.value(this.settings.value), this }, bindStates: function () { var e = this; function n(t) { t = e.settings.filter(t), e.getEl().lastChild.innerHTML = t + "%", e.getEl().firstChild.firstChild.style.width = t + "%" } return e.state.on("change:value", function (t) { n(t.value) }), n(e.state.get("value")), e._super() } }), _e = function (t, e) { t.getEl().lastChild.textContent = e + (t.progressBar ? " " + t.progressBar.value() + "%" : "") }, Re = fe.extend({ Mixins: [ye], Defaults: { classes: "widget notification" }, init: function (t) { var e = this; e._super(t), e.maxWidth = t.maxWidth, t.text && e.text(t.text), t.icon && (e.icon = t.icon), t.color && (e.color = t.color), t.type && e.classes.add("notification-" + t.type), t.timeout && (t.timeout < 0 || 0 < t.timeout) && !t.closeButton ? e.closeButton = !1 : (e.classes.add("has-close"), e.closeButton = !0), t.progressBar && (e.progressBar = new we), e.on("click", function (t) { -1 !== t.target.className.indexOf(e.classPrefix + "close") && e.close() }) }, renderHtml: function () { var t, e = this, n = e.classPrefix, i = "", r = "", o = ""; return e.icon && (i = '<i class="' + n + "ico " + n + "i-" + e.icon + '"></i>'), t = ' style="max-width: ' + e.maxWidth + "px;" + (e.color ? "background-color: " + e.color + ';"' : '"'), e.closeButton && (r = '<button type="button" class="' + n + 'close" aria-hidden="true">\xd7</button>'), e.progressBar && (o = e.progressBar.renderHtml()), '<div id="' + e._id + '" class="' + e.classes + '"' + t + ' role="presentation">' + i + '<div class="' + n + 'notification-inner">' + e.state.get("text") + "</div>" + o + r + '<div style="clip: rect(1px, 1px, 1px, 1px);height: 1px;overflow: hidden;position: absolute;width: 1px;" aria-live="assertive" aria-relevant="additions" aria-atomic="true"></div></div>' }, postRender: function () { var t = this; return c.setTimeout(function () { t.$el.addClass(t.classPrefix + "in"), _e(t, t.state.get("text")) }, 100), t._super() }, bindStates: function () { var e = this; return e.state.on("change:text", function (t) { e.getEl().firstChild.innerHTML = t.value, _e(e, t.value) }), e.progressBar && (e.progressBar.bindStates(), e.progressBar.state.on("change:value", function (t) { _e(e, e.state.get("text")) })), e._super() }, close: function () { return this.fire("close").isDefaultPrevented() || this.remove(), this }, repaint: function () { var t, e; t = this.getEl().style, e = this._layoutRect, t.left = e.x + "px", t.top = e.y + "px", t.zIndex = 65534 } }); function Ce(o) { var s = function (t) { return t.inline ? t.getElement() : t.getContentAreaContainer() }; return { open: function (t, e) { var n, i = R.extend(t, { maxWidth: (n = s(o), Pt.getSize(n).width) }), r = new Re(i); return 0 < (r.args = i).timeout && (r.timer = setTimeout(function () { r.close(), e() }, i.timeout)), r.on("close", function () { e() }), r.renderTo(), r }, close: function (t) { t.close() }, reposition: function (t) { var e; e = t, Tt.each(e, function (t) { t.moveTo(0, 0) }), function (n) { if (0 < n.length) { var t = n.slice(0, 1)[0], e = s(o); t.moveRel(e, "tc-tc"), Tt.each(n, function (t, e) { 0 < e && t.moveRel(n[e - 1].getEl(), "bc-tc") }) } }(t) }, getArgs: function (t) { return t.args } } } function ke(t) { var e, n; if (t.changedTouches) for (e = "screenX screenY pageX pageY clientX clientY".split(" "), n = 0; n < e.length; n++)t[e[n]] = t.changedTouches[0][e[n]] } function Ee(t, h) { var m, g, e, p, v, y, b, x = h.document || document; h = h || {}; var w = x.getElementById(h.handle || t); e = function (t) { var e, n, i, r, o, s, a, l, u, c, d, f = (e = x, u = Math.max, n = e.documentElement, i = e.body, r = u(n.scrollWidth, i.scrollWidth), o = u(n.clientWidth, i.clientWidth), s = u(n.offsetWidth, i.offsetWidth), a = u(n.scrollHeight, i.scrollHeight), l = u(n.clientHeight, i.clientHeight), { width: r < s ? o : r, height: a < u(n.offsetHeight, i.offsetHeight) ? l : a }); ke(t), t.preventDefault(), g = t.button, c = w, y = t.screenX, b = t.screenY, d = window.getComputedStyle ? window.getComputedStyle(c, null).getPropertyValue("cursor") : c.runtimeStyle.cursor, m = Nt("<div></div>").css({ position: "absolute", top: 0, left: 0, width: f.width, height: f.height, zIndex: 2147483647, opacity: 1e-4, cursor: d }).appendTo(x.body), Nt(x).on("mousemove touchmove", v).on("mouseup touchend", p), h.start(t) }, v = function (t) { if (ke(t), t.button !== g) return p(t); t.deltaX = t.screenX - y, t.deltaY = t.screenY - b, t.preventDefault(), h.drag(t) }, p = function (t) { ke(t), Nt(x).off("mousemove touchmove", v).off("mouseup touchend", p), m.remove(), h.stop && h.stop(t) }, this.destroy = function () { Nt(w).off() }, Nt(w).on("mousedown touchstart", e) } var He = tinymce.util.Tools.resolve("tinymce.ui.Factory"), Se = function (t) { return !!t.getAttribute("data-mce-tabstop") }; function Me(t) { var o, r, n = t.root; function i(t) { return t && 1 === t.nodeType } try { o = document.activeElement } catch (e) { o = document.body } function s(t) { return i(t = t || o) ? t.getAttribute("role") : null } function a(t) { for (var e, n = t || o; n = n.parentNode;)if (e = s(n)) return e } function l(t) { var e = o; if (i(e)) return e.getAttribute("aria-" + t) } function u(t) { var e = t.tagName.toUpperCase(); return "INPUT" === e || "TEXTAREA" === e || "SELECT" === e } function c(e) { var r = []; return function t(e) { if (1 === e.nodeType && "none" !== e.style.display && !e.disabled) { var n; (u(n = e) && !n.hidden || Se(n) || /^(button|menuitem|checkbox|tab|menuitemcheckbox|option|gridcell|slider)$/.test(s(n))) && r.push(e); for (var i = 0; i < e.childNodes.length; i++)t(e.childNodes[i]) } }(e || n.getEl()), r } function d(t) { var e, n; (n = (t = t || r).parents().toArray()).unshift(t); for (var i = 0; i < n.length && !(e = n[i]).settings.ariaRoot; i++); return e } function f(t, e) { return t < 0 ? t = e.length - 1 : t >= e.length && (t = 0), e[t] && e[t].focus(), t } function h(t, e) { var n = -1, i = d(); e = e || c(i.getEl()); for (var r = 0; r < e.length; r++)e[r] === o && (n = r); n += t, i.lastAriaIndex = f(n, e) } function m() { "tablist" === a() ? h(-1, c(o.parentNode)) : r.parent().submenu ? y() : h(-1) } function g() { var t = s(), e = a(); "tablist" === e ? h(1, c(o.parentNode)) : "menuitem" === t && "menu" === e && l("haspopup") ? b() : h(1) } function p() { h(-1) } function v() { var t = s(), e = a(); "menuitem" === t && "menubar" === e ? b() : "button" === t && l("haspopup") ? b({ key: "down" }) : h(1) } function y() { r.fire("cancel") } function b(t) { t = t || {}, r.fire("click", { target: o, aria: t }) } return r = n.getParentCtrl(o), n.on("keydown", function (t) { function e(t, e) { u(o) || Se(o) || "slider" !== s(o) && !1 !== e(t) && t.preventDefault() } if (!t.isDefaultPrevented()) switch (t.keyCode) { case 37: e(t, m); break; case 39: e(t, g); break; case 38: e(t, p); break; case 40: e(t, v); break; case 27: y(); break; case 14: case 13: case 32: e(t, b); break; case 9: !function (t) { if ("tablist" === a()) { var e = c(r.getEl("body"))[0]; e && e.focus() } else h(t.shiftKey ? -1 : 1) }(t), t.preventDefault() } }), n.on("focusin", function (t) { o = t.target, r = t.control }), { focusFirst: function (t) { var e = d(t), n = c(e.getEl()); e.settings.ariaRemember && "lastAriaIndex" in e ? f(e.lastAriaIndex, n) : f(0, n) } } } var Te, We, Pe, Ne, Oe = {}, De = fe.extend({ init: function (t) { var e = this; e._super(t), (t = e.settings).fixed && e.state.set("fixed", !0), e._items = new Jt, e.isRtl() && e.classes.add("rtl"), e.bodyClasses = new It(function () { e.state.get("rendered") && (e.getEl("body").className = this.toString()) }), e.bodyClasses.prefix = e.classPrefix, e.classes.add("container"), e.bodyClasses.add("container-body"), t.containerCls && e.classes.add(t.containerCls), e._layout = He.create((t.layout || "") + "layout"), e.settings.items ? e.add(e.settings.items) : e.add(e.render()), e._hasBody = !0 }, items: function () { return this._items }, find: function (t) { return (t = Oe[t] = Oe[t] || new $t(t)).find(this) }, add: function (t) { return this.items().add(this.create(t)).parent(this), this }, focus: function (t) { var e, n, i, r = this; if (!t || !(n = r.keyboardNav || r.parents().eq(-1)[0].keyboardNav)) return i = r.find("*"), r.statusbar && i.add(r.statusbar.items()), i.each(function (t) { if (t.settings.autofocus) return e = null, !1; t.canFocus && (e = e || t) }), e && e.focus(), r; n.focusFirst(r) }, replace: function (t, e) { for (var n, i = this.items(), r = i.length; r--;)if (i[r] === t) { i[r] = e; break } 0 <= r && ((n = e.getEl()) && n.parentNode.removeChild(n), (n = t.getEl()) && n.parentNode.removeChild(n)), e.parent(this) }, create: function (t) { var e, n = this, i = []; return R.isArray(t) || (t = [t]), R.each(t, function (t) { t && (t instanceof fe || ("string" == typeof t && (t = { type: t }), e = R.extend({}, n.settings.defaults, t), t.type = e.type = e.type || t.type || n.settings.defaultType || (e.defaults ? e.defaults.type : null), t = He.create(e)), i.push(t)) }), i }, renderNew: function () { var i = this; return i.items().each(function (t, e) { var n; t.parent(i), t.state.get("rendered") || ((n = i.getEl("body")).hasChildNodes() && e <= n.childNodes.length - 1 ? Nt(n.childNodes[e]).before(t.renderHtml()) : Nt(n).append(t.renderHtml()), t.postRender(), ie.add(t)) }), i._layout.applyClasses(i.items().filter(":visible")), i._lastRect = null, i }, append: function (t) { return this.add(t).renderNew() }, prepend: function (t) { return this.items().set(this.create(t).concat(this.items().toArray())), this.renderNew() }, insert: function (t, e, n) { var i, r, o; return t = this.create(t), i = this.items(), !n && e < i.length - 1 && (e += 1), 0 <= e && e < i.length && (r = i.slice(0, e).toArray(), o = i.slice(e).toArray(), i.set(r.concat(t, o))), this.renderNew() }, fromJSON: function (t) { for (var e in t) this.find("#" + e).value(t[e]); return this }, toJSON: function () { var i = {}; return this.find("*").each(function (t) { var e = t.name(), n = t.value(); e && void 0 !== n && (i[e] = n) }), i }, renderHtml: function () { var t = this, e = t._layout, n = this.settings.role; return t.preRender(), e.preRender(t), '<div id="' + t._id + '" class="' + t.classes + '"' + (n ? ' role="' + this.settings.role + '"' : "") + '><div id="' + t._id + '-body" class="' + t.bodyClasses + '">' + (t.settings.html || "") + e.renderHtml(t) + "</div></div>" }, postRender: function () { var t, e = this; return e.items().exec("postRender"), e._super(), e._layout.postRender(e), e.state.set("rendered", !0), e.settings.style && e.$el.css(e.settings.style), e.settings.border && (t = e.borderBox, e.$el.css({ "border-top-width": t.top, "border-right-width": t.right, "border-bottom-width": t.bottom, "border-left-width": t.left })), e.parent() || (e.keyboardNav = Me({ root: e })), e }, initLayoutRect: function () { var t = this._super(); return this._layout.recalc(this), t }, recalc: function () { var t = this, e = t._layoutRect, n = t._lastRect; if (!n || n.w !== e.w || n.h !== e.h) return t._layout.recalc(t), e = t.layoutRect(), t._lastRect = { x: e.x, y: e.y, w: e.w, h: e.h }, !0 }, reflow: function () { var t; if (ie.remove(this), this.visible()) { for (fe.repaintControls = [], fe.repaintControls.map = {}, this.recalc(), t = fe.repaintControls.length; t--;)fe.repaintControls[t].repaint(); "flow" !== this.settings.layout && "stack" !== this.settings.layout && this.repaint(), fe.repaintControls = [] } return this } }), Ae = { init: function () { this.on("repaint", this.renderScroll) }, renderScroll: function () { var p = this, v = 2; function n() { var m, g, t; function e(t, e, n, i, r, o) { var s, a, l, u, c, d, f, h; if (a = p.getEl("scroll" + t)) { if (f = e.toLowerCase(), h = n.toLowerCase(), Nt(p.getEl("absend")).css(f, p.layoutRect()[i] - 1), !r) return void Nt(a).css("display", "none"); Nt(a).css("display", "block"), s = p.getEl("body"), l = p.getEl("scroll" + t + "t"), u = s["client" + n] - 2 * v, c = (u -= m && g ? a["client" + o] : 0) / s["scroll" + n], (d = {})[f] = s["offset" + e] + v, d[h] = u, Nt(a).css(d), (d = {})[f] = s["scroll" + e] * c, d[h] = u * c, Nt(l).css(d) } } t = p.getEl("body"), m = t.scrollWidth > t.clientWidth, g = t.scrollHeight > t.clientHeight, e("h", "Left", "Width", "contentW", m, "Height"), e("v", "Top", "Height", "contentH", g, "Width") } p.settings.autoScroll && (p._hasScroll || (p._hasScroll = !0, function () { function t(s, a, l, u, c) { var d, t = p._id + "-scroll" + s, e = p.classPrefix; Nt(p.getEl()).append('<div id="' + t + '" class="' + e + "scrollbar " + e + "scrollbar-" + s + '"><div id="' + t + 't" class="' + e + 'scrollbar-thumb"></div></div>'), p.draghelper = new Ee(t + "t", { start: function () { d = p.getEl("body")["scroll" + a], Nt("#" + t).addClass(e + "active") }, drag: function (t) { var e, n, i, r, o = p.layoutRect(); n = o.contentW > o.innerW, i = o.contentH > o.innerH, r = p.getEl("body")["client" + l] - 2 * v, e = (r -= n && i ? p.getEl("scroll" + s)["client" + c] : 0) / p.getEl("body")["scroll" + l], p.getEl("body")["scroll" + a] = d + t["delta" + u] / e }, stop: function () { Nt("#" + t).removeClass(e + "active") } }) } p.classes.add("scroll"), t("v", "Top", "Height", "Y", "Width"), t("h", "Left", "Width", "X", "Height") }(), p.on("wheel", function (t) { var e = p.getEl("body"); e.scrollLeft += 10 * (t.deltaX || 0), e.scrollTop += 10 * t.deltaY, n() }), Nt(p.getEl("body")).on("scroll", n)), n()) } }, Be = De.extend({ Defaults: { layout: "fit", containerCls: "panel" }, Mixins: [Ae], renderHtml: function () { var t = this, e = t._layout, n = t.settings.html; return t.preRender(), e.preRender(t), void 0 === n ? n = '<div id="' + t._id + '-body" class="' + t.bodyClasses + '">' + e.renderHtml(t) + "</div>" : ("function" == typeof n && (n = n.call(t)), t._hasBody = !1), '<div id="' + t._id + '" class="' + t.classes + '" hidefocus="1" tabindex="-1" role="group">' + (t._preBodyHtml || "") + n + "</div>" } }), Le = { resizeToContent: function () { this._layoutRect.autoResize = !0, this._lastRect = null, this.reflow() }, resizeTo: function (t, e) { if (t <= 1 || e <= 1) { var n = Pt.getWindowSize(); t = t <= 1 ? t * n.w : t, e = e <= 1 ? e * n.h : e } return this._layoutRect.autoResize = !1, this.layoutRect({ minW: t, minH: e, w: t, h: e }).reflow() }, resizeBy: function (t, e) { var n = this.layoutRect(); return this.resizeTo(n.w + t, n.h + e) } }, Ie = [], ze = []; function Fe(t, e) { for (; t;) { if (t === e) return !0; t = t.parent() } } function Ve() { Te || (Te = function (t) { 2 !== t.button && function (t) { for (var e = Ie.length; e--;) { var n = Ie[e], i = n.getParentCtrl(t.target); if (n.settings.autohide) { if (i && (Fe(i, n) || n.parent() === i)) continue; (t = n.fire("autohide", { target: t.target })).isDefaultPrevented() || n.hide() } } }(t) }, Nt(document).on("click touchstart", Te)) } function qe(r) { var t = Pt.getViewPort().y; function e(t, e) { for (var n, i = 0; i < Ie.length; i++)if (Ie[i] !== r) for (n = Ie[i].parent(); n && (n = n.parent());)n === r && Ie[i].fixed(t).moveBy(0, e).repaint() } r.settings.autofix && (r.state.get("fixed") ? r._autoFixY > t && (r.fixed(!1).layoutRect({ y: r._autoFixY }).repaint(), e(!1, r._autoFixY - t)) : (r._autoFixY = r.layoutRect().y, r._autoFixY < t && (r.fixed(!0).layoutRect({ y: 0 }).repaint(), e(!0, t - r._autoFixY)))) } function Ue(t, e) { var n, i, r = je.zIndex || 65535; if (t) ze.push(e); else for (n = ze.length; n--;)ze[n] === e && ze.splice(n, 1); if (ze.length) for (n = 0; n < ze.length; n++)ze[n].modal && (r++ , i = ze[n]), ze[n].getEl().style.zIndex = r, ze[n].zIndex = r, r++; var o = Nt("#" + e.classPrefix + "modal-block", e.getContainerElm())[0]; i ? Nt(o).css("z-index", i.zIndex - 1) : o && (o.parentNode.removeChild(o), Ne = !1), je.currentZIndex = r } var je = Be.extend({ Mixins: [ye, Le], init: function (t) { var i = this; i._super(t), (i._eventsRoot = i).classes.add("floatpanel"), t.autohide && (Ve(), function () { if (!Pe) { var t = document.documentElement, e = t.clientWidth, n = t.clientHeight; Pe = function () { document.all && e === t.clientWidth && n === t.clientHeight || (e = t.clientWidth, n = t.clientHeight, je.hideAll()) }, Nt(window).on("resize", Pe) } }(), Ie.push(i)), t.autofix && (We || (We = function () { var t; for (t = Ie.length; t--;)qe(Ie[t]) }, Nt(window).on("scroll", We)), i.on("move", function () { qe(this) })), i.on("postrender show", function (t) { if (t.control === i) { var e, n = i.classPrefix; i.modal && !Ne && ((e = Nt("#" + n + "modal-block", i.getContainerElm()))[0] || (e = Nt('<div id="' + n + 'modal-block" class="' + n + "reset " + n + 'fade"></div>').appendTo(i.getContainerElm())), c.setTimeout(function () { e.addClass(n + "in"), Nt(i.getEl()).addClass(n + "in") }), Ne = !0), Ue(!0, i) } }), i.on("show", function () { i.parents().each(function (t) { if (t.state.get("fixed")) return i.fixed(!0), !1 }) }), t.popover && (i._preBodyHtml = '<div class="' + i.classPrefix + 'arrow"></div>', i.classes.add("popover").add("bottom").add(i.isRtl() ? "end" : "start")), i.aria("label", t.ariaLabel), i.aria("labelledby", i._id), i.aria("describedby", i.describedBy || i._id + "-none") }, fixed: function (t) { var e = this; if (e.state.get("fixed") !== t) { if (e.state.get("rendered")) { var n = Pt.getViewPort(); t ? e.layoutRect().y -= n.y : e.layoutRect().y += n.y } e.classes.toggle("fixed", t), e.state.set("fixed", t) } return e }, show: function () { var t, e = this._super(); for (t = Ie.length; t-- && Ie[t] !== this;); return -1 === t && Ie.push(this), e }, hide: function () { return $e(this), Ue(!1, this), this._super() }, hideAll: function () { je.hideAll() }, close: function () { return this.fire("close").isDefaultPrevented() || (this.remove(), Ue(!1, this)), this }, remove: function () { $e(this), this._super() }, postRender: function () { return this.settings.bodyRole && this.getEl("body").setAttribute("role", this.settings.bodyRole), this._super() } }); function $e(t) { var e; for (e = Ie.length; e--;)Ie[e] === t && Ie.splice(e, 1); for (e = ze.length; e--;)ze[e] === t && ze.splice(e, 1) } je.hideAll = function () { for (var t = Ie.length; t--;) { var e = Ie[t]; e && e.settings.autohide && (e.hide(), Ie.splice(t, 1)) } }; var Ye = [], Xe = ""; function Je(t) { var e, n = Nt("meta[name=viewport]")[0]; !1 !== h.overrideViewPort && (n || ((n = document.createElement("meta")).setAttribute("name", "viewport"), document.getElementsByTagName("head")[0].appendChild(n)), (e = n.getAttribute("content")) && void 0 !== Xe && (Xe = e), n.setAttribute("content", t ? "width=device-width,initial-scale=1.0,user-scalable=0,minimum-scale=1.0,maximum-scale=1.0" : Xe)) } function Ge(t, e) { (function () { for (var t = 0; t < Ye.length; t++)if (Ye[t]._fullscreen) return !0; return !1 })() && !1 === e && Nt([document.documentElement, document.body]).removeClass(t + "fullscreen") } var Ke = je.extend({ modal: !0, Defaults: { border: 1, layout: "flex", containerCls: "panel", role: "dialog", callbacks: { submit: function () { this.fire("submit", { data: this.toJSON() }) }, close: function () { this.close() } } }, init: function (t) { var n = this; n._super(t), n.isRtl() && n.classes.add("rtl"), n.classes.add("window"), n.bodyClasses.add("window-body"), n.state.set("fixed", !0), t.buttons && (n.statusbar = new Be({ layout: "flex", border: "1 0 0 0", spacing: 3, padding: 10, align: "center", pack: n.isRtl() ? "start" : "end", defaults: { type: "button" }, items: t.buttons }), n.statusbar.classes.add("foot"), n.statusbar.parent(n)), n.on("click", function (t) { var e = n.classPrefix + "close"; (Pt.hasClass(t.target, e) || Pt.hasClass(t.target.parentNode, e)) && n.close() }), n.on("cancel", function () { n.close() }), n.on("move", function (t) { t.control === n && je.hideAll() }), n.aria("describedby", n.describedBy || n._id + "-none"), n.aria("label", t.title), n._fullscreen = !1 }, recalc: function () { var t, e, n, i, r = this, o = r.statusbar; r._fullscreen && (r.layoutRect(Pt.getWindowSize()), r.layoutRect().contentH = r.layoutRect().innerH), r._super(), t = r.layoutRect(), r.settings.title && !r._fullscreen && (e = t.headerW) > t.w && (n = t.x - Math.max(0, e / 2), r.layoutRect({ w: e, x: n }), i = !0), o && (o.layoutRect({ w: r.layoutRect().innerW }).recalc(), (e = o.layoutRect().minW + t.deltaW) > t.w && (n = t.x - Math.max(0, e - t.w), r.layoutRect({ w: e, x: n }), i = !0)), i && r.recalc() }, initLayoutRect: function () { var t, e = this, n = e._super(), i = 0; if (e.settings.title && !e._fullscreen) { t = e.getEl("head"); var r = Pt.getSize(t); n.headerW = r.width, n.headerH = r.height, i += n.headerH } e.statusbar && (i += e.statusbar.layoutRect().h), n.deltaH += i, n.minH += i, n.h += i; var o = Pt.getWindowSize(); return n.x = e.settings.x || Math.max(0, o.w / 2 - n.w / 2), n.y = e.settings.y || Math.max(0, o.h / 2 - n.h / 2), n }, renderHtml: function () { var t = this, e = t._layout, n = t._id, i = t.classPrefix, r = t.settings, o = "", s = "", a = r.html; return t.preRender(), e.preRender(t), r.title && (o = '<div id="' + n + '-head" class="' + i + 'window-head"><div id="' + n + '-title" class="' + i + 'title">' + t.encode(r.title) + '</div><div id="' + n + '-dragh" class="' + i + 'dragh"></div><button type="button" class="' + i + 'close" aria-hidden="true"><i class="mce-ico mce-i-remove"></i></button></div>'), r.url && (a = '<iframe src="' + r.url + '" tabindex="-1"></iframe>'), void 0 === a && (a = e.renderHtml(t)), t.statusbar && (s = t.statusbar.renderHtml()), '<div id="' + n + '" class="' + t.classes + '" hidefocus="1"><div class="' + t.classPrefix + 'reset" role="application">' + o + '<div id="' + n + '-body" class="' + t.bodyClasses + '">' + a + "</div>" + s + "</div></div>" }, fullscreen: function (t) { var n, e, i = this, r = document.documentElement, o = i.classPrefix; if (t !== i._fullscreen) if (Nt(window).on("resize", function () { var t; if (i._fullscreen) if (n) i._timer || (i._timer = c.setTimeout(function () { var t = Pt.getWindowSize(); i.moveTo(0, 0).resizeTo(t.w, t.h), i._timer = 0 }, 50)); else { t = (new Date).getTime(); var e = Pt.getWindowSize(); i.moveTo(0, 0).resizeTo(e.w, e.h), 50 < (new Date).getTime() - t && (n = !0) } }), e = i.layoutRect(), i._fullscreen = t) { i._initial = { x: e.x, y: e.y, w: e.w, h: e.h }, i.borderBox = At("0"), i.getEl("head").style.display = "none", e.deltaH -= e.headerH + 2, Nt([r, document.body]).addClass(o + "fullscreen"), i.classes.add("fullscreen"); var s = Pt.getWindowSize(); i.moveTo(0, 0).resizeTo(s.w, s.h) } else i.borderBox = At(i.settings.border), i.getEl("head").style.display = "", e.deltaH += e.headerH, Nt([r, document.body]).removeClass(o + "fullscreen"), i.classes.remove("fullscreen"), i.moveTo(i._initial.x, i._initial.y).resizeTo(i._initial.w, i._initial.h); return i.reflow() }, postRender: function () { var e, n = this; setTimeout(function () { n.classes.add("in"), n.fire("open") }, 0), n._super(), n.statusbar && n.statusbar.postRender(), n.focus(), this.dragHelper = new Ee(n._id + "-dragh", { start: function () { e = { x: n.layoutRect().x, y: n.layoutRect().y } }, drag: function (t) { n.moveTo(e.x + t.deltaX, e.y + t.deltaY) } }), n.on("submit", function (t) { t.isDefaultPrevented() || n.close() }), Ye.push(n), Je(!0) }, submit: function () { return this.fire("submit", { data: this.toJSON() }) }, remove: function () { var t, e = this; for (e.dragHelper.destroy(), e._super(), e.statusbar && this.statusbar.remove(), Ge(e.classPrefix, !1), t = Ye.length; t--;)Ye[t] === e && Ye.splice(t, 1); Je(0 < Ye.length) }, getContentWindow: function () { var t = this.getEl().getElementsByTagName("iframe")[0]; return t ? t.contentWindow : null } }); !function () { if (!h.desktop) { var n = { w: window.innerWidth, h: window.innerHeight }; c.setInterval(function () { var t = window.innerWidth, e = window.innerHeight; n.w === t && n.h === e || (n = { w: t, h: e }, Nt(window).trigger("resize")) }, 100) } Nt(window).on("resize", function () { var t, e, n = Pt.getWindowSize(); for (t = 0; t < Ye.length; t++)e = Ye[t].layoutRect(), Ye[t].moveTo(Ye[t].settings.x || Math.max(0, n.w / 2 - e.w / 2), Ye[t].settings.y || Math.max(0, n.h / 2 - e.h / 2)) }) }(); var Ze = Ke.extend({ init: function (t) { t = { border: 1, padding: 20, layout: "flex", pack: "center", align: "center", containerCls: "panel", autoScroll: !0, buttons: { type: "button", text: "Ok", action: "ok" }, items: { type: "label", multiline: !0, maxWidth: 500, maxHeight: 200 } }, this._super(t) }, Statics: { OK: 1, OK_CANCEL: 2, YES_NO: 3, YES_NO_CANCEL: 4, msgBox: function (t) { var e, i = t.callback || function () { }; function n(t, e, n) { return { type: "button", text: t, subtype: n ? "primary" : "", onClick: function (t) { t.control.parents()[1].close(), i(e) } } } switch (t.buttons) { case Ze.OK_CANCEL: e = [n("Ok", !0, !0), n("Cancel", !1)]; break; case Ze.YES_NO: case Ze.YES_NO_CANCEL: e = [n("Yes", 1, !0), n("No", 0)], t.buttons === Ze.YES_NO_CANCEL && e.push(n("Cancel", -1)); break; default: e = [n("Ok", !0, !0)] }return new Ke({ padding: 20, x: t.x, y: t.y, minWidth: 300, minHeight: 100, layout: "flex", pack: "center", align: "center", buttons: e, title: t.title, role: "alertdialog", items: { type: "label", multiline: !0, maxWidth: 500, maxHeight: 200, text: t.text }, onPostRender: function () { this.aria("describedby", this.items()[0]._id) }, onClose: t.onClose, onCancel: function () { i(!1) } }).renderTo(document.body).reflow() }, alert: function (t, e) { return "string" == typeof t && (t = { text: t }), t.callback = e, Ze.msgBox(t) }, confirm: function (t, e) { return "string" == typeof t && (t = { text: t }), t.callback = e, t.buttons = Ze.OK_CANCEL, Ze.msgBox(t) } } }), Qe = function (t, e) { return { renderUI: function () { return st(t, e) }, getNotificationManagerImpl: function () { return Ce(t) }, getWindowManagerImpl: function () { return { open: function (n, t, e) { var i; return n.title = n.title || " ", n.url = n.url || n.file, n.url && (n.width = parseInt(n.width || 320, 10), n.height = parseInt(n.height || 240, 10)), n.body && (n.items = { defaults: n.defaults, type: n.bodyType || "form", items: n.body, data: n.data, callbacks: n.commands }), n.url || n.buttons || (n.buttons = [{ text: "Ok", subtype: "primary", onclick: function () { i.find("form")[0].submit() } }, { text: "Cancel", onclick: function () { i.close() } }]), (i = new Ke(n)).on("close", function () { e(i) }), n.data && i.on("postRender", function () { this.find("*").each(function (t) { var e = t.name(); e in n.data && t.value(n.data[e]) }) }), i.features = n || {}, i.params = t || {}, i = i.renderTo(document.body).reflow() }, alert: function (t, e, n) { var i; return (i = Ze.alert(t, function () { e() })).on("close", function () { n(i) }), i }, confirm: function (t, e, n) { var i; return (i = Ze.confirm(t, function (t) { e(t) })).on("close", function () { n(i) }), i }, close: function (t) { t.close() }, getParams: function (t) { return t.params }, setParams: function (t, e) { t.params = e } } } } }, tn = "undefined" != typeof window ? window : Function("return this;")(), en = function (t, e) { for (var n = e !== undefined && null !== e ? e : tn, i = 0; i < t.length && n !== undefined && null !== n; ++i)n = n[t[i]]; return n }, nn = function (t, e) { var n = t.split("."); return en(n, e) }, rn = { getOrDie: function (t, e) { var n = nn(t, e); if (n === undefined || null === n) throw t + " not available on this browser"; return n } }; function on() { return new (rn.getOrDie("FileReader")) } var sn, an = tinymce.util.Tools.resolve("tinymce.util.Promise"), ln = function (n) { return new an(function (t) { var e = new on; e.onloadend = function () { t(e.result.split(",")[1]) }, e.readAsDataURL(n) }) }, un = function () { return new an(function (e) { var t; (t = document.createElement("input")).type = "file", t.style.position = "fixed", t.style.left = 0, t.style.top = 0, t.style.opacity = .001, document.body.appendChild(t), t.onchange = function (t) { e(Array.prototype.slice.call(t.target.files)) }, t.click(), t.parentNode.removeChild(t) }) }, cn = 0, dn = function (t) { return t + cn++ + (e = function () { return Math.round(4294967295 * Math.random()).toString(36) }, "s" + Date.now().toString(36) + e() + e() + e()); var e }, fn = function (r, o) { var s = {}; function t(t) { var e, n, i; n = o[t ? "startContainer" : "endContainer"], i = o[t ? "startOffset" : "endOffset"], 1 === n.nodeType && (e = r.create("span", { "data-mce-type": "bookmark" }), n.hasChildNodes() ? (i = Math.min(i, n.childNodes.length - 1), t ? n.insertBefore(e, n.childNodes[i]) : r.insertAfter(e, n.childNodes[i])) : n.appendChild(e), n = e, i = 0), s[t ? "startContainer" : "endContainer"] = n, s[t ? "startOffset" : "endOffset"] = i } return t(!0), o.collapsed || t(), s }, hn = function (r, o) { function t(t) { var e, n, i; e = i = o[t ? "startContainer" : "endContainer"], n = o[t ? "startOffset" : "endOffset"], e && (1 === e.nodeType && (n = function (t) { for (var e = t.parentNode.firstChild, n = 0; e;) { if (e === t) return n; 1 === e.nodeType && "bookmark" === e.getAttribute("data-mce-type") || n++ , e = e.nextSibling } return -1 }(e), e = e.parentNode, r.remove(i)), o[t ? "startContainer" : "endContainer"] = e, o[t ? "startOffset" : "endOffset"] = n) } t(!0), t(); var e = r.createRng(); return e.setStart(o.startContainer, o.startOffset), o.endContainer && e.setEnd(o.endContainer, o.endOffset), e }, mn = tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"), gn = tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"), pn = function (t) { return "A" === t.nodeName && t.hasAttribute("href") }, vn = function (t) { var e, n, i, r, o, s, a, l; return r = t.selection, o = t.dom, s = r.getRng(), a = o, l = gn.getNode(s.startContainer, s.startOffset), e = a.getParent(l, pn) || l, n = gn.getNode(s.endContainer, s.endOffset), i = t.getBody(), R.grep(function (t, e, n) { var i, r, o = []; for (i = new mn(e, t), r = e; r && (1 === r.nodeType && o.push(r), r !== n); r = i.next()); return o }(i, e, n), pn) }, yn = function (t) { var e, n, i, r, o; n = vn(e = t), r = e.dom, o = e.selection, i = fn(r, o.getRng()), R.each(n, function (t) { e.dom.remove(t, !0) }), o.setRng(hn(r, i)) }, bn = function (t) { t.selection.collapse(!1) }, xn = function (t) { t.focus(), yn(t), bn(t) }, wn = function (t, e) { var n, i, r, o, s, a = t.dom.getParent(t.selection.getStart(), "a[href]"); a ? (o = a, s = e, (r = t).focus(), r.dom.setAttrib(o, "href", s), bn(r)) : (i = e, (n = t).execCommand("mceInsertLink", !1, { href: i }), bn(n)) }, _n = function (t, e, n) { var i, r, o; t.plugins.table ? t.plugins.table.insertTable(e, n) : (r = e, o = n, (i = t).undoManager.transact(function () { var t, e; i.insertContent(function (t, e) { var n, i, r; for (r = '<table data-mce-id="mce" style="width: 100%">', r += "<tbody>", i = 0; i < e; i++) { for (r += "<tr>", n = 0; n < t; n++)r += "<td><br></td>"; r += "</tr>" } return r += "</tbody>", r += "</table>" }(r, o)), (t = i.dom.select("*[data-mce-id]")[0]).removeAttribute("data-mce-id"), e = i.dom.select("td,th", t), i.selection.setCursorLocation(e[0], 0) })) }, Rn = function (t, e) { t.execCommand("FormatBlock", !1, e) }, Cn = function (t, e, n) { var i, r; r = (i = t.editorUpload.blobCache).create(dn("mceu"), n, e), i.add(r), t.insertContent(t.dom.createHTML("img", { src: r.blobUri() })) }, kn = function (t, e) { 0 === e.trim().length ? xn(t) : wn(t, e) }, En = xn, Hn = function (n, t) { n.addButton("quicklink", { icon: "link", tooltip: "Insert/Edit link", stateSelector: "a[href]", onclick: function () { t.showForm(n, "quicklink") } }), n.addButton("quickimage", { icon: "image", tooltip: "Insert image", onclick: function () { un().then(function (t) { var e = t[0]; ln(e).then(function (t) { Cn(n, t, e) }) }) } }), n.addButton("quicktable", { icon: "table", tooltip: "Insert table", onclick: function () { t.hide(), _n(n, 2, 2) } }), function (e) { for (var t = function (t) { return function () { Rn(e, t) } }, n = 1; n < 6; n++) { var i = "h" + n; e.addButton(i, { text: i.toUpperCase(), tooltip: "Heading " + n, stateSelector: i, onclick: t(i), onPostRender: function () { this.getEl().firstChild.firstChild.style.fontWeight = "bold" } }) } }(n) }, Sn = function () { var t = h.container; if (t && "static" !== v.DOM.getStyle(t, "position", !0)) { var e = v.DOM.getPos(t), n = e.x - t.scrollLeft, i = e.y - t.scrollTop; return mt.some({ x: n, y: i }) } return mt.none() }, Mn = function (t) { return /^www\.|\.(com|org|edu|gov|uk|net|ca|de|jp|fr|au|us|ru|ch|it|nl|se|no|es|mil)$/i.test(t.trim()) }, Tn = function (t) { return /^https?:\/\//.test(t.trim()) }, Wn = function (t, e) { return !Tn(e) && Mn(e) ? (n = t, i = e, new an(function (e) { n.windowManager.confirm("The URL you entered seems to be an external link. Do you want to add the required http:// prefix?", function (t) { e(!0 === t ? "http://" + i : i) }) })) : an.resolve(e); var n, i }, Pn = function (r, e) { var t, n, i, o = {}; return t = "quicklink", n = { items: [{ type: "button", name: "unlink", icon: "unlink", onclick: function () { r.focus(), En(r), e() }, tooltip: "Remove link" }, { type: "filepicker", name: "linkurl", placeholder: "Paste or type a link", filetype: "file", onchange: function (t) { var e = t.meta; e && e.attach && (o = { href: this.value(), attach: e.attach }) } }, { type: "button", icon: "checkmark", subtype: "primary", tooltip: "Ok", onclick: "submit" }], onshow: function (t) { if (t.control === this) { var e, n = ""; (e = r.dom.getParent(r.selection.getStart(), "a[href]")) && (n = r.dom.getAttrib(e, "href")), this.fromJSON({ linkurl: n }), i = this.find("#unlink"), e ? i.show() : i.hide(), this.find("#linkurl")[0].focus() } var i }, onsubmit: function (t) { Wn(r, t.data.linkurl).then(function (t) { r.undoManager.transact(function () { t === o.href && (o.attach(), o = {}), kn(r, t) }), e() }) } }, (i = He.create(R.extend({ type: "form", layout: "flex", direction: "row", padding: 5, name: t, spacing: 3 }, n))).on("show", function () { i.find("textbox").eq(0).each(function (t) { t.focus() }) }), i }, Nn = function (n, t, e) { var o, i, s = []; if (e) return R.each(B(i = e) ? i : N(i) ? i.split(/[ ,]/) : [], function (t) { if ("|" === t) o = null; else if (n.buttons[t]) { o || (o = { type: "buttongroup", items: [] }, s.push(o)); var e = n.buttons[t]; A(e) && (e = e()), e.type = e.type || "button", (e = He.create(e)).on("postRender", (i = n, r = e, function () { var e, t, n = (t = function (t, e) { return { selector: t, handler: e } }, (e = r).settings.stateSelector ? t(e.settings.stateSelector, function (t) { e.active(t) }) : e.settings.disabledStateSelector ? t(e.settings.disabledStateSelector, function (t) { e.disabled(t) }) : null); null !== n && i.selection.selectorChanged(n.selector, n.handler) })), o.items.push(e) } var i, r }), He.create({ type: "toolbar", layout: "flow", name: t, items: s }) }, On = function () { var l, c, o = function (t) { return 0 < t.items().length }, u = function (t, e) { var n, i, r = (n = t, i = e, R.map(i, function (t) { return Nn(n, t.id, t.items) })).concat([Nn(t, "text", J(t)), Nn(t, "insert", G(t)), Pn(t, p)]); return He.create({ type: "floatpanel", role: "dialog", classes: "tinymce tinymce-inline arrow", ariaLabel: "Inline toolbar", layout: "flex", direction: "column", align: "stretch", autohide: !1, autofix: !0, fixed: !0, border: 1, items: R.grep(r, o), oncancel: function () { t.focus() } }) }, d = function (t) { t && t.show() }, f = function (t, e) { t.moveTo(e.x, e.y) }, h = function (n, i) { i = i ? i.substr(0, 2) : "", R.each({ t: "down", b: "up", c: "center" }, function (t, e) { n.classes.toggle("arrow-" + t, e === i.substr(0, 1)) }), "cr" === i ? (n.classes.toggle("arrow-left", !0), n.classes.toggle("arrow-right", !1)) : "cl" === i ? (n.classes.toggle("arrow-left", !0), n.classes.toggle("arrow-right", !0)) : R.each({ l: "left", r: "right" }, function (t, e) { n.classes.toggle("arrow-" + t, e === i.substr(1, 1)) }) }, m = function (t, e) { var n = t.items().filter("#" + e); return 0 < n.length && (n[0].show(), t.reflow(), !0) }, g = function (t, e, n, i) { var r, o, s, a; if (a = K(n), r = b(n), o = v.DOM.getRect(t.getEl()), s = "insert" === e ? j(i, r, o) : $(i, r, o)) { var l = Sn().getOr({ x: 0, y: 0 }), u = { x: s.rect.x - l.x, y: s.rect.y - l.y, w: s.rect.w, h: s.rect.h }; return f(t, Y(a, c = i, r, u)), h(t, s.position), !0 } return !1 }, p = function () { l && l.hide() }; return { show: function (t, e, n, i) { var r, o, s, a; l || (M(t), (l = u(t, i)).renderTo().reflow().moveTo(n.x, n.y), t.nodeChanged()), o = e, s = t, a = n, d(r = l), r.items().hide(), m(r, o) ? !1 === g(r, o, s, a) && p() : p() }, showForm: function (t, e) { if (l) { if (l.items().hide(), !m(l, e)) return void p(); var n, i, r, o = void 0; d(l), l.items().hide(), m(l, e), r = K(t), n = b(t), o = v.DOM.getRect(l.getEl()), (i = $(c, n, o)) && (o = i.rect, f(l, Y(r, c, n, o)), h(l, i.position)) } }, reposition: function (t, e, n) { l && g(l, e, t, n) }, inForm: function () { return l && l.visible() && 0 < l.items().filter("form:visible").length }, hide: p, focus: function () { l && l.find("toolbar:visible").eq(0).each(function (t) { t.focus(!0) }) }, remove: function () { l && (l.remove(), l = null) } } }, Dn = Ot.extend({ Defaults: { firstControlClass: "first", lastControlClass: "last" }, init: function (t) { this.settings = R.extend({}, this.Defaults, t) }, preRender: function (t) { t.bodyClasses.add(this.settings.containerClass) }, applyClasses: function (t) { var e, n, i, r, o = this.settings; e = o.firstControlClass, n = o.lastControlClass, t.each(function (t) { t.classes.remove(e).remove(n).add(o.controlClass), t.visible() && (i || (i = t), r = t) }), i && i.classes.add(e), r && r.classes.add(n) }, renderHtml: function (t) { var e = ""; return this.applyClasses(t.items()), t.items().each(function (t) { e += t.renderHtml() }), e }, recalc: function () { }, postRender: function () { }, isNative: function () { return !1 } }), An = Dn.extend({ Defaults: { containerClass: "abs-layout", controlClass: "abs-layout-item" }, recalc: function (t) { t.items().filter(":visible").each(function (t) { var e = t.settings; t.layoutRect({ x: e.x, y: e.y, w: e.w, h: e.h }), t.recalc && t.recalc() }) }, renderHtml: function (t) { return '<div id="' + t._id + '-absend" class="' + t.classPrefix + 'abs-end"></div>' + this._super(t) } }), Bn = xe.extend({ Defaults: { classes: "widget btn", role: "button" }, init: function (t) { var e, n = this; n._super(t), t = n.settings, e = n.settings.size, n.on("click mousedown", function (t) { t.preventDefault() }), n.on("touchstart", function (t) { n.fire("click", t), t.preventDefault() }), t.subtype && n.classes.add(t.subtype), e && n.classes.add("btn-" + e), t.icon && n.icon(t.icon) }, icon: function (t) { return arguments.length ? (this.state.set("icon", t), this) : this.state.get("icon") }, repaint: function () { var t, e = this.getEl().firstChild; e && ((t = e.style).width = t.height = "100%"), this._super() }, renderHtml: function () { var t, e, n = this, i = n._id, r = n.classPrefix, o = n.state.get("icon"), s = n.state.get("text"), a = "", l = n.settings; return (t = l.image) ? (o = "none", "string" != typeof t && (t = window.getSelection ? t[0] : t[1]), t = " style=\"background-image: url('" + t + "')\"") : t = "", s && (n.classes.add("btn-has-text"), a = '<span class="' + r + 'txt">' + n.encode(s) + "</span>"), o = o ? r + "ico " + r + "i-" + o : "", e = "boolean" == typeof l.active ? ' aria-pressed="' + l.active + '"' : "", '<div id="' + i + '" class="' + n.classes + '" tabindex="-1"' + e + '><button id="' + i + '-button" role="presentation" type="button" tabindex="-1">' + (o ? '<i class="' + o + '"' + t + "></i>" : "") + a + "</button></div>" }, bindStates: function () { var o = this, n = o.$, i = o.classPrefix + "txt"; function s(t) { var e = n("span." + i, o.getEl()); t ? (e[0] || (n("button:first", o.getEl()).append('<span class="' + i + '"></span>'), e = n("span." + i, o.getEl())), e.html(o.encode(t))) : e.remove(), o.classes.toggle("btn-has-text", !!t) } return o.state.on("change:text", function (t) { s(t.value) }), o.state.on("change:icon", function (t) { var e = t.value, n = o.classPrefix; e = (o.settings.icon = e) ? n + "ico " + n + "i-" + o.settings.icon : ""; var i = o.getEl().firstChild, r = i.getElementsByTagName("i")[0]; e ? (r && r === i.firstChild || (r = document.createElement("i"), i.insertBefore(r, i.firstChild)), r.className = e) : r && i.removeChild(r), s(o.state.get("text")) }), o._super() } }), Ln = Bn.extend({ init: function (t) { t = R.extend({ text: "Browse...", multiple: !1, accept: null }, t), this._super(t), this.classes.add("browsebutton"), t.multiple && this.classes.add("multiple") }, postRender: function () { var n = this, e = Pt.create("input", { type: "file", id: n._id + "-browse", accept: n.settings.accept }); n._super(), Nt(e).on("change", function (t) { var e = t.target.files; n.value = function () { return e.length ? n.settings.multiple ? e : e[0] : null }, t.preventDefault(), e.length && n.fire("change", t) }), Nt(e).on("click", function (t) { t.stopPropagation() }), Nt(n.getEl("button")).on("click", function (t) { t.stopPropagation(), e.click() }), n.getEl().appendChild(e) }, remove: function () { Nt(this.getEl("button")).off(), Nt(this.getEl("input")).off(), this._super() } }), In = De.extend({ Defaults: { defaultType: "button", role: "group" }, renderHtml: function () { var t = this, e = t._layout; return t.classes.add("btn-group"), t.preRender(), e.preRender(t), '<div id="' + t._id + '" class="' + t.classes + '"><div id="' + t._id + '-body">' + (t.settings.html || "") + e.renderHtml(t) + "</div></div>" } }), zn = xe.extend({ Defaults: { classes: "checkbox", role: "checkbox", checked: !1 }, init: function (t) { var e = this; e._super(t), e.on("click mousedown", function (t) { t.preventDefault() }), e.on("click", function (t) { t.preventDefault(), e.disabled() || e.checked(!e.checked()) }), e.checked(e.settings.checked) }, checked: function (t) { return arguments.length ? (this.state.set("checked", t), this) : this.state.get("checked") }, value: function (t) { return arguments.length ? this.checked(t) : this.checked() }, renderHtml: function () { var t = this, e = t._id, n = t.classPrefix; return '<div id="' + e + '" class="' + t.classes + '" unselectable="on" aria-labelledby="' + e + '-al" tabindex="-1"><i class="' + n + "ico " + n + 'i-checkbox"></i><span id="' + e + '-al" class="' + n + 'label">' + t.encode(t.state.get("text")) + "</span></div>" }, bindStates: function () { var o = this; function e(t) { o.classes.toggle("checked", t), o.aria("checked", t) } return o.state.on("change:text", function (t) { o.getEl("al").firstChild.data = o.translate(t.value) }), o.state.on("change:checked change:value", function (t) { o.fire("change"), e(t.value) }), o.state.on("change:icon", function (t) { var e = t.value, n = o.classPrefix; if (void 0 === e) return o.settings.icon; e = (o.settings.icon = e) ? n + "ico " + n + "i-" + o.settings.icon : ""; var i = o.getEl().firstChild, r = i.getElementsByTagName("i")[0]; e ? (r && r === i.firstChild || (r = document.createElement("i"), i.insertBefore(r, i.firstChild)), r.className = e) : r && i.removeChild(r) }), o.state.get("checked") && e(!0), o._super() } }), Fn = tinymce.util.Tools.resolve("tinymce.util.VK"), Vn = xe.extend({ init: function (i) { var r = this; r._super(i), i = r.settings, r.classes.add("combobox"), r.subinput = !0, r.ariaTarget = "inp", i.menu = i.menu || i.values, i.menu && (i.icon = "caret"), r.on("click", function (t) { var e = t.target, n = r.getEl(); if (Nt.contains(n, e) || e === n) for (; e && e !== n;)e.id && -1 !== e.id.indexOf("-open") && (r.fire("action"), i.menu && (r.showMenu(), t.aria && r.menu.items()[0].focus())), e = e.parentNode }), r.on("keydown", function (t) { var e; 13 === t.keyCode && "INPUT" === t.target.nodeName && (t.preventDefault(), r.parents().reverse().each(function (t) { if (t.toJSON) return e = t, !1 }), r.fire("submit", { data: e.toJSON() })) }), r.on("keyup", function (t) { if ("INPUT" === t.target.nodeName) { var e = r.state.get("value"), n = t.target.value; n !== e && (r.state.set("value", n), r.fire("autocomplete", t)) } }), r.on("mouseover", function (t) { var e = r.tooltip().moveTo(-65535); if (r.statusLevel() && -1 !== t.target.className.indexOf(r.classPrefix + "status")) { var n = r.statusMessage() || "Ok", i = e.text(n).show().testMoveRel(t.target, ["bc-tc", "bc-tl", "bc-tr"]); e.classes.toggle("tooltip-n", "bc-tc" === i), e.classes.toggle("tooltip-nw", "bc-tl" === i), e.classes.toggle("tooltip-ne", "bc-tr" === i), e.moveRel(t.target, i) } }) }, statusLevel: function (t) { return 0 < arguments.length && this.state.set("statusLevel", t), this.state.get("statusLevel") }, statusMessage: function (t) { return 0 < arguments.length && this.state.set("statusMessage", t), this.state.get("statusMessage") }, showMenu: function () { var t, e = this, n = e.settings; e.menu || ((t = n.menu || []).length ? t = { type: "menu", items: t } : t.type = t.type || "menu", e.menu = He.create(t).parent(e).renderTo(e.getContainerElm()), e.fire("createmenu"), e.menu.reflow(), e.menu.on("cancel", function (t) { t.control === e.menu && e.focus() }), e.menu.on("show hide", function (t) { t.control.items().each(function (t) { t.active(t.value() === e.value()) }) }).fire("show"), e.menu.on("select", function (t) { e.value(t.control.value()) }), e.on("focusin", function (t) { "INPUT" === t.target.tagName.toUpperCase() && e.menu.hide() }), e.aria("expanded", !0)), e.menu.show(), e.menu.layoutRect({ w: e.layoutRect().w }), e.menu.moveRel(e.getEl(), e.isRtl() ? ["br-tr", "tr-br"] : ["bl-tl", "tl-bl"]) }, focus: function () { this.getEl("inp").focus() }, repaint: function () { var t, e, n = this, i = n.getEl(), r = n.getEl("open"), o = n.layoutRect(), s = 0, a = i.firstChild; n.statusLevel() && "none" !== n.statusLevel() && (s = parseInt(Pt.getRuntimeStyle(a, "padding-right"), 10) - parseInt(Pt.getRuntimeStyle(a, "padding-left"), 10)), t = r ? o.w - Pt.getSize(r).width - 10 : o.w - 10; var l = document; return l.all && (!l.documentMode || l.documentMode <= 8) && (e = n.layoutRect().h - 2 + "px"), Nt(a).css({ width: t - s, lineHeight: e }), n._super(), n }, postRender: function () { var e = this; return Nt(this.getEl("inp")).on("change", function (t) { e.state.set("value", t.target.value), e.fire("change", t) }), e._super() }, renderHtml: function () { var t, e, n, i = this, r = i._id, o = i.settings, s = i.classPrefix, a = i.state.get("value") || "", l = "", u = ""; return "spellcheck" in o && (u += ' spellcheck="' + o.spellcheck + '"'), o.maxLength && (u += ' maxlength="' + o.maxLength + '"'), o.size && (u += ' size="' + o.size + '"'), o.subtype && (u += ' type="' + o.subtype + '"'), n = '<i id="' + r + '-status" class="mce-status mce-ico" style="display: none"></i>', i.disabled() && (u += ' disabled="disabled"'), (t = o.icon) && "caret" !== t && (t = s + "ico " + s + "i-" + o.icon), e = i.state.get("text"), (t || e) && (l = '<div id="' + r + '-open" class="' + s + "btn " + s + 'open" tabIndex="-1" role="button"><button id="' + r + '-action" type="button" hidefocus="1" tabindex="-1">' + ("caret" !== t ? '<i class="' + t + '"></i>' : '<i class="' + s + 'caret"></i>') + (e ? (t ? " " : "") + e : "") + "</button></div>", i.classes.add("has-open")), '<div id="' + r + '" class="' + i.classes + '"><input id="' + r + '-inp" class="' + s + 'textbox" value="' + i.encode(a, !1) + '" hidefocus="1"' + u + ' placeholder="' + i.encode(o.placeholder) + '" />' + n + l + "</div>" }, value: function (t) { return arguments.length ? (this.state.set("value", t), this) : (this.state.get("rendered") && this.state.set("value", this.getEl("inp").value), this.state.get("value")) }, showAutoComplete: function (t, i) { var r = this; if (0 !== t.length) { r.menu ? r.menu.items().remove() : r.menu = He.create({ type: "menu", classes: "combobox-menu", layout: "flow" }).parent(r).renderTo(), R.each(t, function (t) { var e, n; r.menu.add({ text: t.title, url: t.previewUrl, match: i, classes: "menu-item-ellipsis", onclick: (e = t.value, n = t.title, function () { r.fire("selectitem", { title: n, value: e }) }) }) }), r.menu.renderNew(), r.hideMenu(), r.menu.on("cancel", function (t) { t.control.parent() === r.menu && (t.stopPropagation(), r.focus(), r.hideMenu()) }), r.menu.on("select", function () { r.focus() }); var e = r.layoutRect().w; r.menu.layoutRect({ w: e, minW: 0, maxW: e }), r.menu.repaint(), r.menu.reflow(), r.menu.show(), r.menu.moveRel(r.getEl(), r.isRtl() ? ["br-tr", "tr-br"] : ["bl-tl", "tl-bl"]) } else r.hideMenu() }, hideMenu: function () { this.menu && this.menu.hide() }, bindStates: function () { var r = this; r.state.on("change:value", function (t) { r.getEl("inp").value !== t.value && (r.getEl("inp").value = t.value) }), r.state.on("change:disabled", function (t) { r.getEl("inp").disabled = t.value }), r.state.on("change:statusLevel", function (t) { var e = r.getEl("status"), n = r.classPrefix, i = t.value; Pt.css(e, "display", "none" === i ? "none" : ""), Pt.toggleClass(e, n + "i-checkmark", "ok" === i), Pt.toggleClass(e, n + "i-warning", "warn" === i), Pt.toggleClass(e, n + "i-error", "error" === i), r.classes.toggle("has-status", "none" !== i), r.repaint() }), Pt.on(r.getEl("status"), "mouseleave", function () { r.tooltip().hide() }), r.on("cancel", function (t) { r.menu && r.menu.visible() && (t.stopPropagation(), r.hideMenu()) }); var n = function (t, e) { e && 0 < e.items().length && e.items().eq(t)[0].focus() }; return r.on("keydown", function (t) { var e = t.keyCode; "INPUT" === t.target.nodeName && (e === Fn.DOWN ? (t.preventDefault(), r.fire("autocomplete"), n(0, r.menu)) : e === Fn.UP && (t.preventDefault(), n(-1, r.menu))) }), r._super() }, remove: function () { Nt(this.getEl("inp")).off(), this.menu && this.menu.remove(), this._super() } }), qn = Vn.extend({ init: function (t) { var e = this; t.spellcheck = !1, t.onaction && (t.icon = "none"), e._super(t), e.classes.add("colorbox"), e.on("change keyup postrender", function () { e.repaintColor(e.value()) }) }, repaintColor: function (t) { var e = this.getEl("open"), n = e ? e.getElementsByTagName("i")[0] : null; if (n) try { n.style.background = t } catch (i) { } }, bindStates: function () { var e = this; return e.state.on("change:value", function (t) { e.state.get("rendered") && e.repaintColor(t.value) }), e._super() } }), Un = Bn.extend({ showPanel: function () { var e = this, t = e.settings; if (e.classes.add("opened"), e.panel) e.panel.show(); else { var n = t.panel; n.type && (n = { layout: "grid", items: n }), n.role = n.role || "dialog", n.popover = !0, n.autohide = !0, n.ariaRoot = !0, e.panel = new je(n).on("hide", function () { e.classes.remove("opened") }).on("cancel", function (t) { t.stopPropagation(), e.focus(), e.hidePanel() }).parent(e).renderTo(e.getContainerElm()), e.panel.fire("show"), e.panel.reflow() } var i = e.panel.testMoveRel(e.getEl(), t.popoverAlign || (e.isRtl() ? ["bc-tc", "bc-tl", "bc-tr"] : ["bc-tc", "bc-tr", "bc-tl", "tc-bc", "tc-br", "tc-bl"])); e.panel.classes.toggle("start", "l" === i.substr(-1)), e.panel.classes.toggle("end", "r" === i.substr(-1)); var r = "t" === i.substr(0, 1); e.panel.classes.toggle("bottom", !r), e.panel.classes.toggle("top", r), e.panel.moveRel(e.getEl(), i) }, hidePanel: function () { this.panel && this.panel.hide() }, postRender: function () { var e = this; return e.aria("haspopup", !0), e.on("click", function (t) { t.control === e && (e.panel && e.panel.visible() ? e.hidePanel() : (e.showPanel(), e.panel.focus(!!t.aria))) }), e._super() }, remove: function () { return this.panel && (this.panel.remove(), this.panel = null), this._super() } }), jn = v.DOM, $n = Un.extend({ init: function (t) { this._super(t), this.classes.add("splitbtn"), this.classes.add("colorbutton") }, color: function (t) { return t ? (this._color = t, this.getEl("preview").style.backgroundColor = t, this) : this._color }, resetColor: function () { return this._color = null, this.getEl("preview").style.backgroundColor = null, this }, renderHtml: function () { var t = this, e = t._id, n = t.classPrefix, i = t.state.get("text"), r = t.settings.icon ? n + "ico " + n + "i-" + t.settings.icon : "", o = t.settings.image ? " style=\"background-image: url('" + t.settings.image + "')\"" : "", s = ""; return i && (t.classes.add("btn-has-text"), s = '<span class="' + n + 'txt">' + t.encode(i) + "</span>"), '<div id="' + e + '" class="' + t.classes + '" role="button" tabindex="-1" aria-haspopup="true"><button role="presentation" hidefocus="1" type="button" tabindex="-1">' + (r ? '<i class="' + r + '"' + o + "></i>" : "") + '<span id="' + e + '-preview" class="' + n + 'preview"></span>' + s + '</button><button type="button" class="' + n + 'open" hidefocus="1" tabindex="-1"> <i class="' + n + 'caret"></i></button></div>' }, postRender: function () { var e = this, n = e.settings.onclick; return e.on("click", function (t) { t.aria && "down" === t.aria.key || t.control !== e || jn.getParent(t.target, "." + e.classPrefix + "open") || (t.stopImmediatePropagation(), n.call(e, t)) }), delete e.settings.onclick, e._super() } }), Yn = tinymce.util.Tools.resolve("tinymce.util.Color"), Xn = xe.extend({ Defaults: { classes: "widget colorpicker" }, init: function (t) { this._super(t) }, postRender: function () { var n, i, r, o, s, a = this, l = a.color(); function u(t, e) { var n, i, r = Pt.getPos(t); return n = e.pageX - r.x, i = e.pageY - r.y, { x: n = Math.max(0, Math.min(n / t.clientWidth, 1)), y: i = Math.max(0, Math.min(i / t.clientHeight, 1)) } } function c(t, e) { var n = (360 - t.h) / 360; Pt.css(r, { top: 100 * n + "%" }), e || Pt.css(s, { left: t.s + "%", top: 100 - t.v + "%" }), o.style.background = Yn({ s: 100, v: 100, h: t.h }).toHex(), a.color().parse({ s: t.s, v: t.v, h: t.h }) } function t(t) { var e; e = u(o, t), n.s = 100 * e.x, n.v = 100 * (1 - e.y), c(n), a.fire("change") } function e(t) { var e; e = u(i, t), (n = l.toHsv()).h = 360 * (1 - e.y), c(n, !0), a.fire("change") } i = a.getEl("h"), r = a.getEl("hp"), o = a.getEl("sv"), s = a.getEl("svp"), a._repaint = function () { c(n = l.toHsv()) }, a._super(), a._svdraghelper = new Ee(a._id + "-sv", { start: t, drag: t }), a._hdraghelper = new Ee(a._id + "-h", { start: e, drag: e }), a._repaint() }, rgb: function () { return this.color().toRgb() }, value: function (t) { if (!arguments.length) return this.color().toHex(); this.color().parse(t), this._rendered && this._repaint() }, color: function () { return this._color || (this._color = Yn()), this._color }, renderHtml: function () { var t, e = this._id, o = this.classPrefix, s = "#ff0000,#ff0080,#ff00ff,#8000ff,#0000ff,#0080ff,#00ffff,#00ff80,#00ff00,#80ff00,#ffff00,#ff8000,#ff0000"; return t = '<div id="' + e + '-h" class="' + o + 'colorpicker-h" style="background: -ms-linear-gradient(top,' + s + ");background: linear-gradient(to bottom," + s + ');">' + function () { var t, e, n, i, r = ""; for (n = "filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=", t = 0, e = (i = s.split(",")).length - 1; t < e; t++)r += '<div class="' + o + 'colorpicker-h-chunk" style="height:' + 100 / e + "%;" + n + i[t] + ",endColorstr=" + i[t + 1] + ");-ms-" + n + i[t] + ",endColorstr=" + i[t + 1] + ')"></div>'; return r }() + '<div id="' + e + '-hp" class="' + o + 'colorpicker-h-marker"></div></div>', '<div id="' + e + '" class="' + this.classes + '"><div id="' + e + '-sv" class="' + o + 'colorpicker-sv"><div class="' + o + 'colorpicker-overlay1"><div class="' + o + 'colorpicker-overlay2"><div id="' + e + '-svp" class="' + o + 'colorpicker-selector1"><div class="' + o + 'colorpicker-selector2"></div></div></div></div></div>' + t + "</div>" } }), Jn = xe.extend({ init: function (t) { t = R.extend({ height: 100, text: "Drop an image here", multiple: !1, accept: null }, t), this._super(t), this.classes.add("dropzone"), t.multiple && this.classes.add("multiple") }, renderHtml: function () { var t, e, n = this.settings; return t = { id: this._id, hidefocus: "1" }, e = Pt.create("div", t, "<span>" + this.translate(n.text) + "</span>"), n.height && Pt.css(e, "height", n.height + "px"), n.width && Pt.css(e, "width", n.width + "px"), e.className = this.classes, e.outerHTML }, postRender: function () { var i = this, t = function (t) { t.preventDefault(), i.classes.toggle("dragenter"), i.getEl().className = i.classes }; i._super(), i.$el.on("dragover", function (t) { t.preventDefault() }), i.$el.on("dragenter", t), i.$el.on("dragleave", t), i.$el.on("drop", function (t) { if (t.preventDefault(), !i.state.get("disabled")) { var e = function (t) { var e = i.settings.accept; if ("string" != typeof e) return t; var n = new RegExp("(" + e.split(/\s*,\s*/).join("|") + ")$", "i"); return R.grep(t, function (t) { return n.test(t.name) }) }(t.dataTransfer.files); i.value = function () { return e.length ? i.settings.multiple ? e : e[0] : null }, e.length && i.fire("change", t) } }) }, remove: function () { this.$el.off(), this._super() } }), Gn = xe.extend({ init: function (t) { var n = this; t.delimiter || (t.delimiter = "\xbb"), n._super(t), n.classes.add("path"), n.canFocus = !0, n.on("click", function (t) { var e; (e = t.target.getAttribute("data-index")) && n.fire("select", { value: n.row()[e], index: e }) }), n.row(n.settings.row) }, focus: function () { return this.getEl().firstChild.focus(), this }, row: function (t) { return arguments.length ? (this.state.set("row", t), this) : this.state.get("row") }, renderHtml: function () { return '<div id="' + this._id + '" class="' + this.classes + '">' + this._getDataPathHtml(this.state.get("row")) + "</div>" }, bindStates: function () { var e = this; return e.state.on("change:row", function (t) { e.innerHtml(e._getDataPathHtml(t.value)) }), e._super() }, _getDataPathHtml: function (t) { var e, n, i = t || [], r = "", o = this.classPrefix; for (e = 0, n = i.length; e < n; e++)r += (0 < e ? '<div class="' + o + 'divider" aria-hidden="true"> ' + this.settings.delimiter + " </div>" : "") + '<div role="button" class="' + o + "path-item" + (e === n - 1 ? " " + o + "last" : "") + '" data-index="' + e + '" tabindex="-1" id="' + this._id + "-" + e + '" aria-level="' + (e + 1) + '">' + i[e].name + "</div>"; return r || (r = '<div class="' + o + 'path-item">\xa0</div>'), r } }), Kn = Gn.extend({ postRender: function () { var o = this, s = o.settings.editor; function a(t) { if (1 === t.nodeType) { if ("BR" === t.nodeName || t.getAttribute("data-mce-bogus")) return !0; if ("bookmark" === t.getAttribute("data-mce-type")) return !0 } return !1 } return !1 !== s.settings.elementpath && (o.on("select", function (t) { s.focus(), s.selection.select(this.row()[t.index].element), s.nodeChanged() }), s.on("nodeChange", function (t) { for (var e = [], n = t.parents, i = n.length; i--;)if (1 === n[i].nodeType && !a(n[i])) { var r = s.fire("ResolveName", { name: n[i].nodeName.toLowerCase(), target: n[i] }); if (r.isDefaultPrevented() || e.push({ name: r.name, element: n[i] }), r.isPropagationStopped()) break } o.row(e) })), o._super() } }), Zn = De.extend({ Defaults: { layout: "flex", align: "center", defaults: { flex: 1 } }, renderHtml: function () { var t = this, e = t._layout, n = t.classPrefix; return t.classes.add("formitem"), e.preRender(t), '<div id="' + t._id + '" class="' + t.classes + '" hidefocus="1" tabindex="-1">' + (t.settings.title ? '<div id="' + t._id + '-title" class="' + n + 'title">' + t.settings.title + "</div>" : "") + '<div id="' + t._id + '-body" class="' + t.bodyClasses + '">' + (t.settings.html || "") + e.renderHtml(t) + "</div></div>" } }), Qn = De.extend({ Defaults: { containerCls: "form", layout: "flex", direction: "column", align: "stretch", flex: 1, padding: 15, labelGap: 30, spacing: 10, callbacks: { submit: function () { this.submit() } } }, preRender: function () { var i = this, t = i.items(); i.settings.formItemDefaults || (i.settings.formItemDefaults = { layout: "flex", autoResize: "overflow", defaults: { flex: 1 } }), t.each(function (t) { var e, n = t.settings.label; n && ((e = new Zn(R.extend({ items: { type: "label", id: t._id + "-l", text: n, flex: 0, forId: t._id, disabled: t.disabled() } }, i.settings.formItemDefaults))).type = "formitem", t.aria("labelledby", t._id + "-l"), "undefined" == typeof t.settings.flex && (t.settings.flex = 1), i.replace(t, e), e.add(t)) }) }, submit: function () { return this.fire("submit", { data: this.toJSON() }) }, postRender: function () { this._super(), this.fromJSON(this.settings.data) }, bindStates: function () { var n = this; function t() { var t, e, i = 0, r = []; if (!1 !== n.settings.labelGapCalc) for (("children" === n.settings.labelGapCalc ? n.find("formitem") : n.items()).filter("formitem").each(function (t) { var e = t.items()[0], n = e.getEl().clientWidth; i = i < n ? n : i, r.push(e) }), e = n.settings.labelGap || 0, t = r.length; t--;)r[t].settings.minWidth = i + e } n._super(), n.on("show", t), t() } }), ti = Qn.extend({ Defaults: { containerCls: "fieldset", layout: "flex", direction: "column", align: "stretch", flex: 1, padding: "25 15 5 15", labelGap: 30, spacing: 10, border: 1 }, renderHtml: function () { var t = this, e = t._layout, n = t.classPrefix; return t.preRender(), e.preRender(t), '<fieldset id="' + t._id + '" class="' + t.classes + '" hidefocus="1" tabindex="-1">' + (t.settings.title ? '<legend id="' + t._id + '-title" class="' + n + 'fieldset-title">' + t.settings.title + "</legend>" : "") + '<div id="' + t._id + '-body" class="' + t.bodyClasses + '">' + (t.settings.html || "") + e.renderHtml(t) + "</div></fieldset>" } }), ei = 0, ni = function (t) { var e = (new Date).getTime(); return t + "_" + Math.floor(1e9 * Math.random()) + ++ei + String(e) }, ii = function (t) { if (null === t || t === undefined) throw new Error("Node cannot be null or undefined"); return { dom: lt.constant(t) } }, ri = { fromHtml: function (t, e) { var n = (e || document).createElement("div"); if (n.innerHTML = t, !n.hasChildNodes() || 1 < n.childNodes.length) throw console.error("HTML does not have a single root node", t), "HTML must have a single root node"; return ii(n.childNodes[0]) }, fromTag: function (t, e) { var n = (e || document).createElement(t); return ii(n) }, fromText: function (t, e) { var n = (e || document).createTextNode(t); return ii(n) }, fromDom: ii, fromPoint: function (t, e, n) { return mt.from(t.dom().elementFromPoint(e, n)).map(ii) } }, oi = function (t) { var e, n = !1; return function () { return n || (n = !0, e = t.apply(null, arguments)), e } }, si = 9, ai = 1, li = 3, ui = function (t) { return t.dom().nodeType }, ci = function (e) { return function (t) { return ui(t) === e } }, di = (ci(ai), ci(li), ci(si), oi(function () { return di(ri.fromDom(document)) }), function (t) { var e = t.dom().body; if (null === e || e === undefined) throw "Body is not available yet"; return ri.fromDom(e) }), fi = (sn = Object.keys) === undefined ? function (t) { var e = []; for (var n in t) t.hasOwnProperty(n) && e.push(n); return e } : sn, hi = function (t, e) { for (var n = fi(t), i = 0, r = n.length; i < r; i++) { var o = n[i]; e(t[o], o, t) } }, mi = function (i, r) { var o = {}; return hi(i, function (t, e) { var n = r(t, e, i); o[n.k] = n.v }), o }, gi = function (t, n) { var i = []; return hi(t, function (t, e) { i.push(n(t, e)) }), i }, pi = function (t) { return gi(t, function (t) { return t }) }, vi = { bifilter: function (t, n) { var i = {}, r = {}; return hi(t, function (t, e) { (n(t, e) ? i : r)[e] = t }), { t: i, f: r } }, each: hi, map: function (t, i) { return mi(t, function (t, e, n) { return { k: e, v: i(t, e, n) } }) }, mapToArray: gi, tupleMap: mi, find: function (t, e) { for (var n = fi(t), i = 0, r = n.length; i < r; i++) { var o = n[i], s = t[o]; if (e(s, o, t)) return mt.some(s) } return mt.none() }, keys: fi, values: pi, size: function (t) { return pi(t).length } }, yi = function (t) { return t.slice(0).sort() }, bi = { sort: yi, reqMessage: function (t, e) { throw new Error("All required keys (" + yi(t).join(", ") + ") were not specified. Specified keys were: " + yi(e).join(", ") + ".") }, unsuppMessage: function (t) { throw new Error("Unsupported keys for object: " + yi(t).join(", ")) }, validateStrArr: function (e, t) { if (!pt.isArray(t)) throw new Error("The " + e + " fields must be an array. Was: " + t + "."); Tt.each(t, function (t) { if (!pt.isString(t)) throw new Error("The value " + t + " in the " + e + " fields was not a string.") }) }, invalidTypeMessage: function (t, e) { throw new Error("All values need to be of type: " + e + ". Keys (" + yi(t).join(", ") + ") were not.") }, checkDupes: function (t) { var n = yi(t); Tt.find(n, function (t, e) { return e < n.length - 1 && t === n[e + 1] }).each(function (t) { throw new Error("The field: " + t + " occurs more than once in the combined fields: [" + n.join(", ") + "].") }) } }, xi = { immutable: function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; return function () { for (var n = [], t = 0; t < arguments.length; t++)n[t] = arguments[t]; if (e.length !== n.length) throw new Error('Wrong number of arguments to struct. Expected "[' + e.length + ']", got ' + n.length + " arguments"); var i = {}; return Tt.each(e, function (t, e) { i[t] = lt.constant(n[e]) }), i } }, immutableBag: function (r, o) { var s = r.concat(o); if (0 === s.length) throw new Error("You must specify at least one required or optional field."); return bi.validateStrArr("required", r), bi.validateStrArr("optional", o), bi.checkDupes(s), function (e) { var n = vi.keys(e); Tt.forall(r, function (t) { return Tt.contains(n, t) }) || bi.reqMessage(r, n); var t = Tt.filter(n, function (t) { return !Tt.contains(s, t) }); 0 < t.length && bi.unsuppMessage(t); var i = {}; return Tt.each(r, function (t) { i[t] = lt.constant(e[t]) }), Tt.each(o, function (t) { i[t] = lt.constant(Object.prototype.hasOwnProperty.call(e, t) ? mt.some(e[t]) : mt.none()) }), i } } }, wi = function (t, e) { var n = function (t, e) { for (var n = 0; n < t.length; n++) { var i = t[n]; if (i.test(e)) return i } return undefined }(t, e); if (!n) return { major: 0, minor: 0 }; var i = function (t) { return Number(e.replace(n, "$" + t)) }; return Ri(i(1), i(2)) }, _i = function () { return Ri(0, 0) }, Ri = function (t, e) { return { major: t, minor: e } }, Ci = { nu: Ri, detect: function (t, e) { var n = String(e).toLowerCase(); return 0 === t.length ? _i() : wi(t, n) }, unknown: _i }, ki = "Firefox", Ei = function (t, e) { return function () { return e === t } }, Hi = function (t) { var e = t.current; return { current: e, version: t.version, isEdge: Ei("Edge", e), isChrome: Ei("Chrome", e), isIE: Ei("IE", e), isOpera: Ei("Opera", e), isFirefox: Ei(ki, e), isSafari: Ei("Safari", e) } }, Si = { unknown: function () { return Hi({ current: undefined, version: Ci.unknown() }) }, nu: Hi, edge: lt.constant("Edge"), chrome: lt.constant("Chrome"), ie: lt.constant("IE"), opera: lt.constant("Opera"), firefox: lt.constant(ki), safari: lt.constant("Safari") }, Mi = "Windows", Ti = "Android", Wi = "Solaris", Pi = "FreeBSD", Ni = function (t, e) { return function () { return e === t } }, Oi = function (t) { var e = t.current; return { current: e, version: t.version, isWindows: Ni(Mi, e), isiOS: Ni("iOS", e), isAndroid: Ni(Ti, e), isOSX: Ni("OSX", e), isLinux: Ni("Linux", e), isSolaris: Ni(Wi, e), isFreeBSD: Ni(Pi, e) } }, Di = { unknown: function () { return Oi({ current: undefined, version: Ci.unknown() }) }, nu: Oi, windows: lt.constant(Mi), ios: lt.constant("iOS"), android: lt.constant(Ti), linux: lt.constant("Linux"), osx: lt.constant("OSX"), solaris: lt.constant(Wi), freebsd: lt.constant(Pi) }, Ai = function (t, e) { var n = String(e).toLowerCase(); return Tt.find(t, function (t) { return t.search(n) }) }, Bi = function (t, n) { return Ai(t, n).map(function (t) { var e = Ci.detect(t.versionRegexes, n); return { current: t.name, version: e } }) }, Li = function (t, n) { return Ai(t, n).map(function (t) { var e = Ci.detect(t.versionRegexes, n); return { current: t.name, version: e } }) }, Ii = function (t, e) { return -1 !== t.indexOf(e) }, zi = /.*?version\/\ ?([0-9]+)\.([0-9]+).*/, Fi = function (e) { return function (t) { return Ii(t, e) } }, Vi = [{ name: "Edge", versionRegexes: [/.*?edge\/ ?([0-9]+)\.([0-9]+)$/], search: function (t) { return Ii(t, "edge/") && Ii(t, "chrome") && Ii(t, "safari") && Ii(t, "applewebkit") } }, { name: "Chrome", versionRegexes: [/.*?chrome\/([0-9]+)\.([0-9]+).*/, zi], search: function (t) { return Ii(t, "chrome") && !Ii(t, "chromeframe") } }, { name: "IE", versionRegexes: [/.*?msie\ ?([0-9]+)\.([0-9]+).*/, /.*?rv:([0-9]+)\.([0-9]+).*/], search: function (t) { return Ii(t, "msie") || Ii(t, "trident") } }, { name: "Opera", versionRegexes: [zi, /.*?opera\/([0-9]+)\.([0-9]+).*/], search: Fi("opera") }, { name: "Firefox", versionRegexes: [/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/], search: Fi("firefox") }, { name: "Safari", versionRegexes: [zi, /.*?cpu os ([0-9]+)_([0-9]+).*/], search: function (t) { return (Ii(t, "safari") || Ii(t, "mobile/")) && Ii(t, "applewebkit") } }], qi = [{ name: "Windows", search: Fi("win"), versionRegexes: [/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/] }, { name: "iOS", search: function (t) { return Ii(t, "iphone") || Ii(t, "ipad") }, versionRegexes: [/.*?version\/\ ?([0-9]+)\.([0-9]+).*/, /.*cpu os ([0-9]+)_([0-9]+).*/, /.*cpu iphone os ([0-9]+)_([0-9]+).*/] }, { name: "Android", search: Fi("android"), versionRegexes: [/.*?android\ ?([0-9]+)\.([0-9]+).*/] }, { name: "OSX", search: Fi("os x"), versionRegexes: [/.*?os\ x\ ?([0-9]+)_([0-9]+).*/] }, { name: "Linux", search: Fi("linux"), versionRegexes: [] }, { name: "Solaris", search: Fi("sunos"), versionRegexes: [] }, { name: "FreeBSD", search: Fi("freebsd"), versionRegexes: [] }], Ui = { browsers: lt.constant(Vi), oses: lt.constant(qi) }, ji = function (t) { var e, n, i, r, o, s, a, l, u, c, d, f = Ui.browsers(), h = Ui.oses(), m = Bi(f, t).fold(Si.unknown, Si.nu), g = Li(h, t).fold(Di.unknown, Di.nu); return { browser: m, os: g, deviceType: (n = m, i = t, r = (e = g).isiOS() && !0 === /ipad/i.test(i), o = e.isiOS() && !r, s = e.isAndroid() && 3 === e.version.major, a = e.isAndroid() && 4 === e.version.major, l = r || s || a && !0 === /mobile/i.test(i), u = e.isiOS() || e.isAndroid(), c = u && !l, d = n.isSafari() && e.isiOS() && !1 === /safari/i.test(i), { isiPad: lt.constant(r), isiPhone: lt.constant(o), isTablet: lt.constant(l), isPhone: lt.constant(c), isTouch: lt.constant(u), isAndroid: e.isAndroid, isiOS: e.isiOS, isWebView: lt.constant(d) }) } }, $i = oi(function () { var t = navigator.userAgent; return ji(t) }), Yi = ai, Xi = si, Ji = function (t) { return t.nodeType !== Yi && t.nodeType !== Xi || 0 === t.childElementCount }, Gi = { all: function (t, e) { var n = e === undefined ? document : e.dom(); return Ji(n) ? [] : Tt.map(n.querySelectorAll(t), ri.fromDom) }, is: function (t, e) { var n = t.dom(); if (n.nodeType !== Yi) return !1; if (n.matches !== undefined) return n.matches(e); if (n.msMatchesSelector !== undefined) return n.msMatchesSelector(e); if (n.webkitMatchesSelector !== undefined) return n.webkitMatchesSelector(e); if (n.mozMatchesSelector !== undefined) return n.mozMatchesSelector(e); throw new Error("Browser lacks native selectors") }, one: function (t, e) { var n = e === undefined ? document : e.dom(); return Ji(n) ? mt.none() : mt.from(n.querySelector(t)).map(ri.fromDom) } }, Ki = ($i().browser.isIE(), xi.immutable("element", "offset"), function (t, e) { return Gi.all(e, t) }), Zi = R.trim, Qi = function (e) { return function (t) { if (t && 1 === t.nodeType) { if (t.contentEditable === e) return !0; if (t.getAttribute("data-mce-contenteditable") === e) return !0 } return !1 } }, tr = Qi("true"), er = Qi("false"), nr = function (t, e, n, i, r) { return { type: t, title: e, url: n, level: i, attach: r } }, ir = function (t) { return t.innerText || t.textContent }, rr = function (t) { return (e = t) && "A" === e.nodeName && (e.id || e.name) && sr(t); var e }, or = function (t) { return t && /^(H[1-6])$/.test(t.nodeName) }, sr = function (t) { return function (t) { for (; t = t.parentNode;) { var e = t.contentEditable; if (e && "inherit" !== e) return tr(t) } return !1 }(t) && !er(t) }, ar = function (t) { return or(t) && sr(t) }, lr = function (t) { var e, n, i = (e = t).id ? e.id : ni("h"); return nr("header", ir(t), "#" + i, or(n = t) ? parseInt(n.nodeName.substr(1), 10) : 0, function () { t.id = i }) }, ur = function (t) { var e = t.id || t.name, n = ir(t); return nr("anchor", n || "#" + e, "#" + e, 0, lt.noop) }, cr = function (t) { var e, n; return e = "h1,h2,h3,h4,h5,h6,a:not([href])", n = t, Tt.map(Ki(ri.fromDom(n), e), function (t) { return t.dom() }) }, dr = function (t) { return 0 < Zi(t.title).length }, fr = function (t) { var e, n, i = cr(t); return Tt.filter((n = i, Tt.map(Tt.filter(n, ar), lr)).concat((e = i, Tt.map(Tt.filter(e, rr), ur))), dr) }, hr = {}, mr = function (t) { return { title: t.title, value: { title: { raw: t.title }, url: t.url, attach: t.attach } } }, gr = function (t, e) { return { title: t, value: { title: t, url: e, attach: lt.noop } } }, pr = function (t, e, n) { var i = e in t ? t[e] : n; return !1 === i ? null : i }, vr = function (t, i, r, e) { var n, o, s, a, l = { title: "-" }, u = function (t) { var e = t.hasOwnProperty(r) ? t[r] : [], n = Tt.filter(e, function (t) { return e = t, n = i, !Tt.exists(n, function (t) { return t.url === e }); var e, n }); return R.map(n, function (t) { return { title: t, value: { title: t, url: t, attach: lt.noop } } }) }, c = function (e) { var t, n = Tt.filter(i, function (t) { return t.type === e }); return t = n, R.map(t, mr) }; return !1 === e.typeahead_urls ? [] : "file" === r ? (n = [yr(t, u(hr)), yr(t, c("header")), yr(t, (o = c("anchor"), s = pr(e, "anchor_top", "#top"), a = pr(e, "anchor_bottom", "#bottom"), null !== s && o.unshift(gr("<top>", s)), null !== a && o.push(gr("<bottom>", a)), o))], Tt.foldl(n, function (t, e) { return 0 === t.length || 0 === e.length ? t.concat(e) : t.concat(l, e) }, [])) : yr(t, u(hr)) }, yr = function (t, e) { var n = t.toLowerCase(), i = R.grep(e, function (t) { return -1 !== t.title.toLowerCase().indexOf(n) }); return 1 === i.length && i[0].title === t ? [] : i }, br = function (r, i, o, s) { var e = function (t) { var e = fr(o), n = vr(t, e, s, i); r.showAutoComplete(n, t) }; r.on("autocomplete", function () { e(r.value()) }), r.on("selectitem", function (t) { var e = t.value; r.value(e.url); var n, i = (n = e.title).raw ? n.raw : n; "image" === s ? r.fire("change", { meta: { alt: i, attach: e.attach } }) : r.fire("change", { meta: { text: i, attach: e.attach } }), r.focus() }), r.on("click", function (t) { 0 === r.value().length && "INPUT" === t.target.nodeName && e("") }), r.on("PostRender", function () { r.getRoot().on("submit", function (t) { var e, n, i; t.isDefaultPrevented() || (e = r.value(), i = hr[n = s], /^https?/.test(e) && (i ? Tt.indexOf(i, e).isNone() && (hr[n] = i.slice(0, 5).concat(e)) : hr[n] = [e])) }) }) }, xr = function (o, t, n) { var i = t.filepicker_validator_handler; i && o.state.on("change:value", function (t) { var e; 0 !== (e = t.value).length ? i({ url: e, type: n }, function (t) { var e, n, i, r = (n = (e = t).status, i = e.message, "valid" === n ? { status: "ok", message: i } : "unknown" === n ? { status: "warn", message: i } : "invalid" === n ? { status: "warn", message: i } : { status: "none", message: "" }); o.statusMessage(r.message), o.statusLevel(r.status) }) : o.statusLevel("none") }) }, wr = Vn.extend({ Statics: { clearHistory: function () { hr = {} } }, init: function (t) { var e, n, i, r = this, o = window.tinymce ? window.tinymce.activeEditor : T.activeEditor, s = o.settings, a = t.filetype; t.spellcheck = !1, (i = s.file_picker_types || s.file_browser_callback_types) && (i = R.makeMap(i, /[, ]/)), i && !i[a] || (!(n = s.file_picker_callback) || i && !i[a] ? !(n = s.file_browser_callback) || i && !i[a] || (e = function () { n(r.getEl("inp").id, r.value(), a, window) }) : e = function () { var t = r.fire("beforecall").meta; t = R.extend({ filetype: a }, t), n.call(o, function (t, e) { r.value(t).fire("change", { meta: e }) }, r.value(), t) }), e && (t.icon = "browse", t.onaction = e), r._super(t), r.classes.add("filepicker"), br(r, s, o.getBody(), a), xr(r, s, a) } }), _r = An.extend({ recalc: function (t) { var e = t.layoutRect(), n = t.paddingBox; t.items().filter(":visible").each(function (t) { t.layoutRect({ x: n.left, y: n.top, w: e.innerW - n.right - n.left, h: e.innerH - n.top - n.bottom }), t.recalc && t.recalc() }) } }), Rr = An.extend({ recalc: function (t) { var e, n, i, r, o, s, a, l, u, c, d, f, h, m, g, p, v, y, b, x, w, _, R, C, k, E, H, S, M, T, W, P, N, O, D, A, B, L = [], I = Math.max, z = Math.min; for (i = t.items().filter(":visible"), r = t.layoutRect(), o = t.paddingBox, s = t.settings, f = t.isRtl() ? s.direction || "row-reversed" : s.direction, a = s.align, l = t.isRtl() ? s.pack || "end" : s.pack, u = s.spacing || 0, "row-reversed" !== f && "column-reverse" !== f || (i = i.set(i.toArray().reverse()), f = f.split("-")[0]), "column" === f ? (C = "y", _ = "h", R = "minH", k = "maxH", H = "innerH", E = "top", S = "deltaH", M = "contentH", O = "left", P = "w", T = "x", W = "innerW", N = "minW", D = "right", A = "deltaW", B = "contentW") : (C = "x", _ = "w", R = "minW", k = "maxW", H = "innerW", E = "left", S = "deltaW", M = "contentW", O = "top", P = "h", T = "y", W = "innerH", N = "minH", D = "bottom", A = "deltaH", B = "contentH"), d = r[H] - o[E] - o[E], w = c = 0, e = 0, n = i.length; e < n; e++)m = (h = i[e]).layoutRect(), d -= e < n - 1 ? u : 0, 0 < (g = h.settings.flex) && (c += g, m[k] && L.push(h), m.flex = g), d -= m[R], w < (p = o[O] + m[N] + o[D]) && (w = p); if ((b = {})[R] = d < 0 ? r[R] - d + r[S] : r[H] - d + r[S], b[N] = w + r[A], b[M] = r[H] - d, b[B] = w, b.minW = z(b.minW, r.maxW), b.minH = z(b.minH, r.maxH), b.minW = I(b.minW, r.startMinWidth), b.minH = I(b.minH, r.startMinHeight), !r.autoResize || b.minW === r.minW && b.minH === r.minH) { for (y = d / c, e = 0, n = L.length; e < n; e++)(v = (m = (h = L[e]).layoutRect())[k]) < (p = m[R] + m.flex * y) ? (d -= m[k] - m[R], c -= m.flex, m.flex = 0, m.maxFlexSize = v) : m.maxFlexSize = 0; for (y = d / c, x = o[E], b = {}, 0 === c && ("end" === l ? x = d + o[E] : "center" === l ? (x = Math.round(r[H] / 2 - (r[H] - d) / 2) + o[E]) < 0 && (x = o[E]) : "justify" === l && (x = o[E], u = Math.floor(d / (i.length - 1)))), b[T] = o[O], e = 0, n = i.length; e < n; e++)p = (m = (h = i[e]).layoutRect()).maxFlexSize || m[R], "center" === a ? b[T] = Math.round(r[W] / 2 - m[P] / 2) : "stretch" === a ? (b[P] = I(m[N] || 0, r[W] - o[O] - o[D]), b[T] = o[O]) : "end" === a && (b[T] = r[W] - m[P] - o.top), 0 < m.flex && (p += m.flex * y), b[_] = p, b[C] = x, h.layoutRect(b), h.recalc && h.recalc(), x += p + u } else if (b.w = b.minW, b.h = b.minH, t.layoutRect(b), this.recalc(t), null === t._lastRect) { var F = t.parent(); F && (F._lastRect = null, F.recalc()) } } }), Cr = Dn.extend({ Defaults: { containerClass: "flow-layout", controlClass: "flow-layout-item", endClass: "break" }, recalc: function (t) { t.items().filter(":visible").each(function (t) { t.recalc && t.recalc() }) }, isNative: function () { return !0 } }), kr = function (t, e) { return Gi.one(e, t) }, Er = function (t, e) { return function () { t.execCommand("mceToggleFormat", !1, e) } }, Hr = function (t, n) { return function () { var e = this; t.formatter ? t.formatter.formatChanged(n, function (t) { e.active(t) }) : t.on("init", function () { t.formatter.formatChanged(n, function (t) { e.active(t) }) }) } }, Sr = function (n) { n.addMenuItem("align", { text: "Align", menu: [{ text: "Left", icon: "alignleft", onclick: Er(n, "alignleft") }, { text: "Center", icon: "aligncenter", onclick: Er(n, "aligncenter") }, { text: "Right", icon: "alignright", onclick: Er(n, "alignright") }, { text: "Justify", icon: "alignjustify", onclick: Er(n, "alignjustify") }] }), R.each({ alignleft: ["Align left", "JustifyLeft"], aligncenter: ["Align center", "JustifyCenter"], alignright: ["Align right", "JustifyRight"], alignjustify: ["Justify", "JustifyFull"], alignnone: ["No alignment", "JustifyNone"] }, function (t, e) { n.addButton(e, { active: !1, tooltip: t[0], cmd: t[1], onPostRender: Hr(n, e) }) }) }, Mr = function (t) { return t ? t.split(",")[0] : "" }, Tr = function (a, l) { return function () { var s = this; a.on("init nodeChange", function (t) { var e, n, i, r = a.queryCommandValue("FontName"), o = (e = l, n = r, R.each(e, function (t) { t.value.toLowerCase() === n.toLowerCase() && (i = t.value) }), R.each(e, function (t) { i || Mr(t.value).toLowerCase() !== Mr(n).toLowerCase() || (i = t.value) }), i); s.value(o || null), !o && r && s.text(Mr(r)) }) } }, Wr = function (n) { n.addButton("fontselect", function () { var t, e = (t = function (t) { for (var e = (t = t.replace(/;$/, "").split(";")).length; e--;)t[e] = t[e].split("="); return t }(n.settings.font_formats || "Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats"), R.map(t, function (t) { return { text: { raw: t[0] }, value: t[1], textStyle: -1 === t[1].indexOf("dings") ? "font-family:" + t[1] : "" } })); return { type: "listbox", text: "Font Family", tooltip: "Font Family", values: e, fixedWidth: !0, onPostRender: Tr(n, e), onselect: function (t) { t.control.settings.value && n.execCommand("FontName", !1, t.control.settings.value) } } }) }, Pr = function (t) { Wr(t) }, Nr = function (t, e) { return /[0-9.]+px$/.test(t) ? (n = 72 * parseInt(t, 10) / 96, i = e || 0, r = Math.pow(10, i), Math.round(n * r) / r + "pt") : t; var n, i, r }, Or = function (t, e, n) { var i; return R.each(t, function (t) { t.value === n ? i = n : t.value === e && (i = e) }), i }, Dr = function (n) { n.addButton("fontsizeselect", function () { var t, s, a, e = (t = n.settings.fontsize_formats || "8pt 10pt 12pt 14pt 18pt 24pt 36pt", R.map(t.split(" "), function (t) { var e = t, n = t, i = t.split("="); return 1 < i.length && (e = i[0], n = i[1]), { text: e, value: n } })); return { type: "listbox", text: "Font Sizes", tooltip: "Font Sizes", values: e, fixedWidth: !0, onPostRender: (s = n, a = e, function () { var o = this; s.on("init nodeChange", function (t) { var e, n, i, r; if (e = s.queryCommandValue("FontSize")) for (i = 3; !r && 0 <= i; i--)n = Nr(e, i), r = Or(a, n, e); o.value(r || null), r || o.text(n) }) }), onclick: function (t) { t.control.settings.value && n.execCommand("FontSize", !1, t.control.settings.value) } } }) }, Ar = function (t) { Dr(t) }, Br = function (n, t) { var i = t.length; return R.each(t, function (t) { t.menu && (t.hidden = 0 === Br(n, t.menu)); var e = t.format; e && (t.hidden = !n.formatter.canApply(e)), t.hidden && i-- }), i }, Lr = function (n, t) { var i = t.items().length; return t.items().each(function (t) { t.menu && t.visible(0 < Lr(n, t.menu)), !t.menu && t.settings.menu && t.visible(0 < Br(n, t.settings.menu)); var e = t.settings.format; e && t.visible(n.formatter.canApply(e)), t.visible() || i-- }), i }, Ir = function (t) { var i, r, o, e, s, n, a, l, u = (r = 0, o = [], e = [{ title: "Headings", items: [{ title: "Heading 1", format: "h1" }, { title: "Heading 2", format: "h2" }, { title: "Heading 3", format: "h3" }, { title: "Heading 4", format: "h4" }, { title: "Heading 5", format: "h5" }, { title: "Heading 6", format: "h6" }] }, { title: "Inline", items: [{ title: "Bold", icon: "bold", format: "bold" }, { title: "Italic", icon: "italic", format: "italic" }, { title: "Underline", icon: "underline", format: "underline" }, { title: "Strikethrough", icon: "strikethrough", format: "strikethrough" }, { title: "Superscript", icon: "superscript", format: "superscript" }, { title: "Subscript", icon: "subscript", format: "subscript" }, { title: "Code", icon: "code", format: "code" }] }, { title: "Blocks", items: [{ title: "Paragraph", format: "p" }, { title: "Blockquote", format: "blockquote" }, { title: "Div", format: "div" }, { title: "Pre", format: "pre" }] }, { title: "Alignment", items: [{ title: "Left", icon: "alignleft", format: "alignleft" }, { title: "Center", icon: "aligncenter", format: "aligncenter" }, { title: "Right", icon: "alignright", format: "alignright" }, { title: "Justify", icon: "alignjustify", format: "alignjustify" }] }], s = function (t) { var i = []; if (t) return R.each(t, function (t) { var e = { text: t.title, icon: t.icon }; if (t.items) e.menu = s(t.items); else { var n = t.format || "custom" + r++; t.format || (t.name = n, o.push(t)), e.format = n, e.cmd = t.cmd } i.push(e) }), i }, (i = t).on("init", function () { R.each(o, function (t) { i.formatter.register(t.name, t) }) }), { type: "menu", items: i.settings.style_formats_merge ? i.settings.style_formats ? s(e.concat(i.settings.style_formats)) : s(e) : s(i.settings.style_formats || e), onPostRender: function (t) { i.fire("renderFormatsMenu", { control: t.control }) }, itemDefaults: { preview: !0, textStyle: function () { if (this.settings.format) return i.formatter.getCssText(this.settings.format) }, onPostRender: function () { var n = this; n.parent().on("show", function () { var t, e; (t = n.settings.format) && (n.disabled(!i.formatter.canApply(t)), n.active(i.formatter.match(t))), (e = n.settings.cmd) && n.active(i.queryCommandState(e)) }) }, onclick: function () { this.settings.format && Er(i, this.settings.format)(), this.settings.cmd && i.execCommand(this.settings.cmd) } } }); n = u, t.addMenuItem("formats", { text: "Formats", menu: n }), l = u, (a = t).addButton("styleselect", { type: "menubutton", text: "Formats", menu: l, onShowMenu: function () { a.settings.style_formats_autohide && Lr(a, this.menu) } }) }, zr = function (n, t) { return function () { var r, o, s, e = []; return R.each(t, function (t) { e.push({ text: t[0], value: t[1], textStyle: function () { return n.formatter.getCssText(t[1]) } }) }), { type: "listbox", text: t[0][0], values: e, fixedWidth: !0, onselect: function (t) { if (t.control) { var e = t.control.value(); Er(n, e)() } }, onPostRender: (r = n, o = e, function () { var e = this; r.on("nodeChange", function (t) { var n = r.formatter, i = null; R.each(t.parents, function (e) { if (R.each(o, function (t) { if (s ? n.matchNode(e, s, { value: t.value }) && (i = t.value) : n.matchNode(e, t.value) && (i = t.value), i) return !1 }), i) return !1 }), e.value(i) }) }) } } }, Fr = function (t) { var e, n, i = function (t) { for (var e = (t = t.replace(/;$/, "").split(";")).length; e--;)t[e] = t[e].split("="); return t }(t.settings.block_formats || "Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre"); t.addMenuItem("blockformats", { text: "Blocks", menu: (e = t, n = i, R.map(n, function (t) { return { text: t[0], onclick: Er(e, t[1]), textStyle: function () { return e.formatter.getCssText(t[1]) } } })) }), t.addButton("formatselect", zr(t, i)) }, Vr = function (e, t) { var n, i; if ("string" == typeof t) i = t.split(" "); else if (R.isArray(t)) return Tt.flatten(R.map(t, function (t) { return Vr(e, t) })); return n = R.grep(i, function (t) { return "|" === t || t in e.menuItems }), R.map(n, function (t) { return "|" === t ? { text: "-" } : e.menuItems[t] }) }, qr = function (t) { return t && "-" === t.text }, Ur = function (t) { var e = Tt.filter(t, function (t, e, n) { return !qr(t) || !qr(n[e - 1]) }); return Tt.filter(e, function (t, e, n) { return !qr(t) || 0 < e && e < n.length - 1 }) }, jr = function (t) { var e, n, i, r, o = t.settings.insert_button_items; return Ur(o ? Vr(t, o) : (e = t, n = "insert", i = [{ text: "-" }], r = R.grep(e.menuItems, function (t) { return t.context === n }), R.each(r, function (t) { "before" === t.separator && i.push({ text: "|" }), t.prependToContext ? i.unshift(t) : i.push(t), "after" === t.separator && i.push({ text: "|" }) }), i)) }, $r = function (t) { var e; (e = t).addButton("insert", { type: "menubutton", icon: "insert", menu: [], oncreatemenu: function () { this.menu.add(jr(e)), this.menu.renderNew() } }) }, Yr = function (t) { var n, i, r; n = t, R.each({ bold: "Bold", italic: "Italic", underline: "Underline", strikethrough: "Strikethrough", subscript: "Subscript", superscript: "Superscript" }, function (t, e) { n.addButton(e, { active: !1, tooltip: t, onPostRender: Hr(n, e), onclick: Er(n, e) }) }), i = t, R.each({ outdent: ["Decrease indent", "Outdent"], indent: ["Increase indent", "Indent"], cut: ["Cut", "Cut"], copy: ["Copy", "Copy"], paste: ["Paste", "Paste"], help: ["Help", "mceHelp"], selectall: ["Select all", "SelectAll"], visualaid: ["Visual aids", "mceToggleVisualAid"], newdocument: ["New document", "mceNewDocument"], removeformat: ["Clear formatting", "RemoveFormat"], remove: ["Remove", "Delete"] }, function (t, e) { i.addButton(e, { tooltip: t[0], cmd: t[1] }) }), r = t, R.each({ blockquote: ["Blockquote", "mceBlockQuote"], subscript: ["Subscript", "Subscript"], superscript: ["Superscript", "Superscript"] }, function (t, e) { r.addButton(e, { active: !1, tooltip: t[0], cmd: t[1], onPostRender: Hr(r, e) }) }) }, Xr = function (t) { var n; Yr(t), n = t, R.each({ bold: ["Bold", "Bold", "Meta+B"], italic: ["Italic", "Italic", "Meta+I"], underline: ["Underline", "Underline", "Meta+U"], strikethrough: ["Strikethrough", "Strikethrough"], subscript: ["Subscript", "Subscript"], superscript: ["Superscript", "Superscript"], removeformat: ["Clear formatting", "RemoveFormat"], newdocument: ["New document", "mceNewDocument"], cut: ["Cut", "Cut", "Meta+X"], copy: ["Copy", "Copy", "Meta+C"], paste: ["Paste", "Paste", "Meta+V"], selectall: ["Select all", "SelectAll", "Meta+A"] }, function (t, e) { n.addMenuItem(e, { text: t[0], icon: e, shortcut: t[2], cmd: t[1] }) }), n.addMenuItem("codeformat", { text: "Code", icon: "code", onclick: Er(n, "code") }) }, Jr = function (n, i) { return function () { var t = this, e = function () { var t = "redo" === i ? "hasRedo" : "hasUndo"; return !!n.undoManager && n.undoManager[t]() }; t.disabled(!e()), n.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode", function () { t.disabled(n.readonly || !e()) }) } }, Gr = function (t) { var e, n; (e = t).addMenuItem("undo", { text: "Undo", icon: "undo", shortcut: "Meta+Z", onPostRender: Jr(e, "undo"), cmd: "undo" }), e.addMenuItem("redo", { text: "Redo", icon: "redo", shortcut: "Meta+Y", onPostRender: Jr(e, "redo"), cmd: "redo" }), (n = t).addButton("undo", { tooltip: "Undo", onPostRender: Jr(n, "undo"), cmd: "undo" }), n.addButton("redo", { tooltip: "Redo", onPostRender: Jr(n, "redo"), cmd: "redo" }) }, Kr = function (t) { var e, n; (e = t).addMenuItem("visualaid", { text: "Visual aids", selectable: !0, onPostRender: (n = e, function () { var e = this; n.on("VisualAid", function (t) { e.active(t.hasVisual) }), e.active(n.hasVisual) }), cmd: "mceToggleVisualAid" }) }, Zr = { setup: function (t) { var e; t.rtl && (fe.rtl = !0), t.on("mousedown", function () { je.hideAll() }), (e = t).settings.ui_container && (h.container = kr(ri.fromDom(document.body), e.settings.ui_container).fold(lt.constant(null), function (t) { return t.dom() })), xe.tooltips = !h.iOS, fe.translate = function (t) { return T.translate(t) }, Fr(t), Sr(t), Xr(t), Gr(t), Ar(t), Pr(t), Ir(t), Kr(t), $r(t) } }, Qr = An.extend({ recalc: function (t) { var e, n, i, r, o, s, a, l, u, c, d, f, h, m, g, p, v, y, b, x, w, _, R, C, k, E, H, S, M = [], T = []; e = t.settings, r = t.items().filter(":visible"), o = t.layoutRect(), i = e.columns || Math.ceil(Math.sqrt(r.length)), n = Math.ceil(r.length / i), y = e.spacingH || e.spacing || 0, b = e.spacingV || e.spacing || 0, x = e.alignH || e.align, w = e.alignV || e.align, p = t.paddingBox, S = "reverseRows" in e ? e.reverseRows : t.isRtl(), x && "string" == typeof x && (x = [x]), w && "string" == typeof w && (w = [w]); for (d = 0; d < i; d++)M.push(0); for (f = 0; f < n; f++)T.push(0); for (f = 0; f < n; f++)for (d = 0; d < i && (c = r[f * i + d]); d++)C = (u = c.layoutRect()).minW, k = u.minH, M[d] = C > M[d] ? C : M[d], T[f] = k > T[f] ? k : T[f]; for (E = o.innerW - p.left - p.right, d = _ = 0; d < i; d++)_ += M[d] + (0 < d ? y : 0), E -= (0 < d ? y : 0) + M[d]; for (H = o.innerH - p.top - p.bottom, f = R = 0; f < n; f++)R += T[f] + (0 < f ? b : 0), H -= (0 < f ? b : 0) + T[f]; if (_ += p.left + p.right, R += p.top + p.bottom, (l = {}).minW = _ + (o.w - o.innerW), l.minH = R + (o.h - o.innerH), l.contentW = l.minW - o.deltaW, l.contentH = l.minH - o.deltaH, l.minW = Math.min(l.minW, o.maxW), l.minH = Math.min(l.minH, o.maxH), l.minW = Math.max(l.minW, o.startMinWidth), l.minH = Math.max(l.minH, o.startMinHeight), !o.autoResize || l.minW === o.minW && l.minH === o.minH) { var W; o.autoResize && ((l = t.layoutRect(l)).contentW = l.minW - o.deltaW, l.contentH = l.minH - o.deltaH), W = "start" === e.packV ? 0 : 0 < H ? Math.floor(H / n) : 0; var P = 0, N = e.flexWidths; if (N) for (d = 0; d < N.length; d++)P += N[d]; else P = i; var O = E / P; for (d = 0; d < i; d++)M[d] += N ? N[d] * O : O; for (m = p.top, f = 0; f < n; f++) { for (h = p.left, a = T[f] + W, d = 0; d < i && (c = r[S ? f * i + i - 1 - d : f * i + d]); d++)g = c.settings, u = c.layoutRect(), s = Math.max(M[d], u.startMinWidth), u.x = h, u.y = m, "center" === (v = g.alignH || (x ? x[d] || x[0] : null)) ? u.x = h + s / 2 - u.w / 2 : "right" === v ? u.x = h + s - u.w : "stretch" === v && (u.w = s), "center" === (v = g.alignV || (w ? w[d] || w[0] : null)) ? u.y = m + a / 2 - u.h / 2 : "bottom" === v ? u.y = m + a - u.h : "stretch" === v && (u.h = a), c.layoutRect(u), h += s + y, c.recalc && c.recalc(); m += a + b } } else if (l.w = l.minW, l.h = l.minH, t.layoutRect(l), this.recalc(t), null === t._lastRect) { var D = t.parent(); D && (D._lastRect = null, D.recalc()) } } }), to = xe.extend({ renderHtml: function () { var t = this; return t.classes.add("iframe"), t.canFocus = !1, '<iframe id="' + t._id + '" class="' + t.classes + '" tabindex="-1" src="' + (t.settings.url || "javascript:''") + '" frameborder="0"></iframe>' }, src: function (t) { this.getEl().src = t }, html: function (t, e) { var n = this, i = this.getEl().contentWindow.document.body; return i ? (i.innerHTML = t, e && e()) : c.setTimeout(function () { n.html(t) }), this } }), eo = xe.extend({ init: function (t) { this._super(t), this.classes.add("widget").add("infobox"), this.canFocus = !1 }, severity: function (t) { this.classes.remove("error"), this.classes.remove("warning"), this.classes.remove("success"), this.classes.add(t) }, help: function (t) { this.state.set("help", t) }, renderHtml: function () { var t = this, e = t.classPrefix; return '<div id="' + t._id + '" class="' + t.classes + '"><div id="' + t._id + '-body">' + t.encode(t.state.get("text")) + '<button role="button" tabindex="-1"><i class="' + e + "ico " + e + 'i-help"></i></button></div></div>' }, bindStates: function () { var e = this; return e.state.on("change:text", function (t) { e.getEl("body").firstChild.data = e.encode(t.value), e.state.get("rendered") && e.updateLayoutRect() }), e.state.on("change:help", function (t) { e.classes.toggle("has-help", t.value), e.state.get("rendered") && e.updateLayoutRect() }), e._super() } }), no = xe.extend({ init: function (t) { var e = this; e._super(t), e.classes.add("widget").add("label"), e.canFocus = !1, t.multiline && e.classes.add("autoscroll"), t.strong && e.classes.add("strong") }, initLayoutRect: function () { var t = this, e = t._super(); return t.settings.multiline && (Pt.getSize(t.getEl()).width > e.maxW && (e.minW = e.maxW, t.classes.add("multiline")), t.getEl().style.width = e.minW + "px", e.startMinH = e.h = e.minH = Math.min(e.maxH, Pt.getSize(t.getEl()).height)), e }, repaint: function () { return this.settings.multiline || (this.getEl().style.lineHeight = this.layoutRect().h + "px"), this._super() }, severity: function (t) { this.classes.remove("error"), this.classes.remove("warning"), this.classes.remove("success"), this.classes.add(t) }, renderHtml: function () { var t, e, n = this, i = n.settings.forId, r = n.settings.html ? n.settings.html : n.encode(n.state.get("text")); return !i && (e = n.settings.forName) && (t = n.getRoot().find("#" + e)[0]) && (i = t._id), i ? '<label id="' + n._id + '" class="' + n.classes + '"' + (i ? ' for="' + i + '"' : "") + ">" + r + "</label>" : '<span id="' + n._id + '" class="' + n.classes + '">' + r + "</span>" }, bindStates: function () { var e = this; return e.state.on("change:text", function (t) { e.innerHtml(e.encode(t.value)), e.state.get("rendered") && e.updateLayoutRect() }), e._super() } }), io = De.extend({ Defaults: { role: "toolbar", layout: "flow" }, init: function (t) { this._super(t), this.classes.add("toolbar") }, postRender: function () { return this.items().each(function (t) { t.classes.add("toolbar-item") }), this._super() } }), ro = io.extend({ Defaults: { role: "menubar", containerCls: "menubar", ariaRoot: !0, defaults: { type: "menubutton" } } }), oo = Bn.extend({ init: function (t) { var e = this; e._renderOpen = !0, e._super(t), t = e.settings, e.classes.add("menubtn"), t.fixedWidth && e.classes.add("fixed-width"), e.aria("haspopup", !0), e.state.set("menu", t.menu || e.render()) }, showMenu: function (t) { var e, n = this; if (n.menu && n.menu.visible() && !1 !== t) return n.hideMenu(); n.menu || (e = n.state.get("menu") || [], n.classes.add("opened"), e.length ? e = { type: "menu", animate: !0, items: e } : (e.type = e.type || "menu", e.animate = !0), e.renderTo ? n.menu = e.parent(n).show().renderTo() : n.menu = He.create(e).parent(n).renderTo(), n.fire("createmenu"), n.menu.reflow(), n.menu.on("cancel", function (t) { t.control.parent() === n.menu && (t.stopPropagation(), n.focus(), n.hideMenu()) }), n.menu.on("select", function () { n.focus() }), n.menu.on("show hide", function (t) { t.control === n.menu && (n.activeMenu("show" === t.type), n.classes.toggle("opened", "show" === t.type)), n.aria("expanded", "show" === t.type) }).fire("show")), n.menu.show(), n.menu.layoutRect({ w: n.layoutRect().w }), n.menu.repaint(), n.menu.moveRel(n.getEl(), n.isRtl() ? ["br-tr", "tr-br"] : ["bl-tl", "tl-bl"]), n.fire("showmenu") }, hideMenu: function () { this.menu && (this.menu.items().each(function (t) { t.hideMenu && t.hideMenu() }), this.menu.hide()) }, activeMenu: function (t) { this.classes.toggle("active", t) }, renderHtml: function () { var t, e = this, n = e._id, i = e.classPrefix, r = e.settings.icon, o = e.state.get("text"), s = ""; return (t = e.settings.image) ? (r = "none", "string" != typeof t && (t = window.getSelection ? t[0] : t[1]), t = " style=\"background-image: url('" + t + "')\"") : t = "", o && (e.classes.add("btn-has-text"), s = '<span class="' + i + 'txt">' + e.encode(o) + "</span>"), r = e.settings.icon ? i + "ico " + i + "i-" + r : "", e.aria("role", e.parent() instanceof ro ? "menuitem" : "button"), '<div id="' + n + '" class="' + e.classes + '" tabindex="-1" aria-labelledby="' + n + '"><button id="' + n + '-open" role="presentation" type="button" tabindex="-1">' + (r ? '<i class="' + r + '"' + t + "></i>" : "") + s + ' <i class="' + i + 'caret"></i></button></div>' }, postRender: function () { var r = this; return r.on("click", function (t) { t.control === r && function (t, e) { for (; t;) { if (e === t) return !0; t = t.parentNode } return !1 }(t.target, r.getEl()) && (r.focus(), r.showMenu(!t.aria), t.aria && r.menu.items().filter(":visible")[0].focus()) }), r.on("mouseenter", function (t) { var e, n = t.control, i = r.parent(); n && i && n instanceof oo && n.parent() === i && (i.items().filter("MenuButton").each(function (t) { t.hideMenu && t !== n && (t.menu && t.menu.visible() && (e = !0), t.hideMenu()) }), e && (n.focus(), n.showMenu())) }), r._super() }, bindStates: function () { var t = this; return t.state.on("change:menu", function () { t.menu && t.menu.remove(), t.menu = null }), t._super() }, remove: function () { this._super(), this.menu && this.menu.remove() } }); function so(i, r) { var o, s, a = this, l = fe.classPrefix; a.show = function (t, e) { function n() { o && (Nt(i).append('<div class="' + l + "throbber" + (r ? " " + l + "throbber-inline" : "") + '"></div>'), e && e()) } return a.hide(), o = !0, t ? s = c.setTimeout(n, t) : n(), a }, a.hide = function () { var t = i.lastChild; return c.clearTimeout(s), t && -1 !== t.className.indexOf("throbber") && t.parentNode.removeChild(t), o = !1, a } } var ao = je.extend({ Defaults: { defaultType: "menuitem", border: 1, layout: "stack", role: "application", bodyRole: "menu", ariaRoot: !0 }, init: function (t) { if (t.autohide = !0, t.constrainToViewport = !0, "function" == typeof t.items && (t.itemsFactory = t.items, t.items = []), t.itemDefaults) for (var e = t.items, n = e.length; n--;)e[n] = R.extend({}, t.itemDefaults, e[n]); this._super(t), this.classes.add("menu"), t.animate && 11 !== h.ie && this.classes.add("animate") }, repaint: function () { return this.classes.toggle("menu-align", !0), this._super(), this.getEl().style.height = "", this.getEl("body").style.height = "", this }, cancel: function () { this.hideAll(), this.fire("select") }, load: function () { var e, n = this; function i() { n.throbber && (n.throbber.hide(), n.throbber = null) } n.settings.itemsFactory && (n.throbber || (n.throbber = new so(n.getEl("body"), !0), 0 === n.items().length ? (n.throbber.show(), n.fire("loading")) : n.throbber.show(100, function () { n.items().remove(), n.fire("loading") }), n.on("hide close", i)), n.requestTime = e = (new Date).getTime(), n.settings.itemsFactory(function (t) { 0 !== t.length ? n.requestTime === e && (n.getEl().style.width = "", n.getEl("body").style.width = "", i(), n.items().remove(), n.getEl("body").innerHTML = "", n.add(t), n.renderNew(), n.fire("loaded")) : n.hide() })) }, hideAll: function () { return this.find("menuitem").exec("hideMenu"), this._super() }, preRender: function () { var n = this; return n.items().each(function (t) { var e = t.settings; if (e.icon || e.image || e.selectable) return !(n._hasIcons = !0) }), n.settings.itemsFactory && n.on("postrender", function () { n.settings.itemsFactory && n.load() }), n.on("show hide", function (t) { t.control === n && ("show" === t.type ? c.setTimeout(function () { n.classes.add("in") }, 0) : n.classes.remove("in")) }), n._super() } }), lo = oo.extend({ init: function (i) { var e, r, o, n, s = this; s._super(i), i = s.settings, s._values = e = i.values, e && ("undefined" != typeof i.value && function t(e) { for (var n = 0; n < e.length; n++) { if (r = e[n].selected || i.value === e[n].value) return o = o || e[n].text, s.state.set("value", e[n].value), !0; if (e[n].menu && t(e[n].menu)) return !0 } }(e), !r && 0 < e.length && (o = e[0].text, s.state.set("value", e[0].value)), s.state.set("menu", e)), s.state.set("text", i.text || o), s.classes.add("listbox"), s.on("select", function (t) { var e = t.control; n && (t.lastControl = n), i.multiple ? e.active(!e.active()) : s.value(t.control.value()), n = e }) }, value: function (e) { return 0 === arguments.length ? this.state.get("value") : (void 0 === e || (this.settings.values ? 0 < R.grep(this.settings.values, function (t) { return t.value === e }).length ? this.state.set("value", e) : null === e && this.state.set("value", null) : this.state.set("value", e)), this) }, bindStates: function () { var i = this; return i.on("show", function (t) { var e, n; e = t.control, n = i.value(), e instanceof ao && e.items().each(function (t) { t.hasMenus() || t.active(t.value() === n) }) }), i.state.on("change:value", function (e) { var n = function t(e, n) { var i; if (e) for (var r = 0; r < e.length; r++) { if (e[r].value === n) return e[r]; if (e[r].menu && (i = t(e[r].menu, n))) return i } }(i.state.get("menu"), e.value); n ? i.text(n.text) : i.text(i.settings.text) }), i._super() } }), uo = xe.extend({ Defaults: { border: 0, role: "menuitem" }, init: function (t) { var e, n = this; n._super(t), t = n.settings, n.classes.add("menu-item"), t.menu && n.classes.add("menu-item-expand"), t.preview && n.classes.add("menu-item-preview"), "-" !== (e = n.state.get("text")) && "|" !== e || (n.classes.add("menu-item-sep"), n.aria("role", "separator"), n.state.set("text", "-")), t.selectable && (n.aria("role", "menuitemcheckbox"), n.classes.add("menu-item-checkbox"), t.icon = "selected"), t.preview || t.selectable || n.classes.add("menu-item-normal"), n.on("mousedown", function (t) { t.preventDefault() }), t.menu && !t.ariaHideMenu && n.aria("haspopup", !0) }, hasMenus: function () { return !!this.settings.menu }, showMenu: function () { var e, n = this, t = n.settings, i = n.parent(); if (i.items().each(function (t) { t !== n && t.hideMenu() }), t.menu) { (e = n.menu) ? e.show() : ((e = t.menu).length ? e = { type: "menu", items: e } : e.type = e.type || "menu", i.settings.itemDefaults && (e.itemDefaults = i.settings.itemDefaults), (e = n.menu = He.create(e).parent(n).renderTo()).reflow(), e.on("cancel", function (t) { t.stopPropagation(), n.focus(), e.hide() }), e.on("show hide", function (t) { t.control.items && t.control.items().each(function (t) { t.active(t.settings.selected) }) }).fire("show"), e.on("hide", function (t) { t.control === e && n.classes.remove("selected") }), e.submenu = !0), e._parentMenu = i, e.classes.add("menu-sub"); var r = e.testMoveRel(n.getEl(), n.isRtl() ? ["tl-tr", "bl-br", "tr-tl", "br-bl"] : ["tr-tl", "br-bl", "tl-tr", "bl-br"]); e.moveRel(n.getEl(), r), r = "menu-sub-" + (e.rel = r), e.classes.remove(e._lastRel).add(r), e._lastRel = r, n.classes.add("selected"), n.aria("expanded", !0) } }, hideMenu: function () { var t = this; return t.menu && (t.menu.items().each(function (t) { t.hideMenu && t.hideMenu() }), t.menu.hide(), t.aria("expanded", !1)), t }, renderHtml: function () { var t, e = this, n = e._id, i = e.settings, r = e.classPrefix, o = e.state.get("text"), s = e.settings.icon, a = "", l = i.shortcut, u = e.encode(i.url); function c(t) { return t.replace(/[.*+?^${}()|[\]\\]/g, "\\$&") } function d(t) { var e = i.match || ""; return e ? t.replace(new RegExp(c(e), "gi"), function (t) { return "!mce~match[" + t + "]mce~match!" }) : t } function f(t) { return t.replace(new RegExp(c("!mce~match["), "g"), "<b>").replace(new RegExp(c("]mce~match!"), "g"), "</b>") } return s && e.parent().classes.add("menu-has-icons"), i.image && (a = " style=\"background-image: url('" + i.image + "')\""), l && (l = function (t) { var e, n, i = {}; for (i = h.mac ? { alt: "&#x2325;", ctrl: "&#x2318;", shift: "&#x21E7;", meta: "&#x2318;" } : { meta: "Ctrl" }, t = t.split("+"), e = 0; e < t.length; e++)(n = i[t[e].toLowerCase()]) && (t[e] = n); return t.join("+") }(l)), s = r + "ico " + r + "i-" + (e.settings.icon || "none"), t = "-" !== o ? '<i class="' + s + '"' + a + "></i>\xa0" : "", o = f(e.encode(d(o))), u = f(e.encode(d(u))), '<div id="' + n + '" class="' + e.classes + '" tabindex="-1">' + t + ("-" !== o ? '<span id="' + n + '-text" class="' + r + 'text">' + o + "</span>" : "") + (l ? '<div id="' + n + '-shortcut" class="' + r + 'menu-shortcut">' + l + "</div>" : "") + (i.menu ? '<div class="' + r + 'caret"></div>' : "") + (u ? '<div class="' + r + 'menu-item-link">' + u + "</div>" : "") + "</div>" }, postRender: function () { var e = this, n = e.settings, t = n.textStyle; if ("function" == typeof t && (t = t.call(this)), t) { var i = e.getEl("text"); i && (i.setAttribute("style", t), e._textStyle = t) } return e.on("mouseenter click", function (t) { t.control === e && (n.menu || "click" !== t.type ? (e.showMenu(), t.aria && e.menu.focus(!0)) : (e.fire("select"), c.requestAnimationFrame(function () { e.parent().hideAll() }))) }), e._super(), e }, hover: function () { return this.parent().items().each(function (t) { t.classes.remove("selected") }), this.classes.toggle("selected", !0), this }, active: function (t) { return function (t, e) { var n = t._textStyle; if (n) { var i = t.getEl("text"); i.setAttribute("style", n), e && (i.style.color = "", i.style.backgroundColor = "") } }(this, t), void 0 !== t && this.aria("checked", t), this._super(t) }, remove: function () { this._super(), this.menu && this.menu.remove() } }), co = zn.extend({ Defaults: { classes: "radio", role: "radio" } }), fo = xe.extend({ renderHtml: function () { var t = this, e = t.classPrefix; return t.classes.add("resizehandle"), "both" === t.settings.direction && t.classes.add("resizehandle-both"), t.canFocus = !1, '<div id="' + t._id + '" class="' + t.classes + '"><i class="' + e + "ico " + e + 'i-resize"></i></div>' }, postRender: function () { var e = this; e._super(), e.resizeDragHelper = new Ee(this._id, { start: function () { e.fire("ResizeStart") }, drag: function (t) { "both" !== e.settings.direction && (t.deltaX = 0), e.fire("Resize", t) }, stop: function () { e.fire("ResizeEnd") } }) }, remove: function () { return this.resizeDragHelper && this.resizeDragHelper.destroy(), this._super() } }); function ho(t) { var e = ""; if (t) for (var n = 0; n < t.length; n++)e += '<option value="' + t[n] + '">' + t[n] + "</option>"; return e } var mo = xe.extend({ Defaults: { classes: "selectbox", role: "selectbox", options: [] }, init: function (t) { var n = this; n._super(t), n.settings.size && (n.size = n.settings.size), n.settings.options && (n._options = n.settings.options), n.on("keydown", function (t) { var e; 13 === t.keyCode && (t.preventDefault(), n.parents().reverse().each(function (t) { if (t.toJSON) return e = t, !1 }), n.fire("submit", { data: e.toJSON() })) }) }, options: function (t) { return arguments.length ? (this.state.set("options", t), this) : this.state.get("options") }, renderHtml: function () { var t, e = this, n = ""; return t = ho(e._options), e.size && (n = ' size = "' + e.size + '"'), '<select id="' + e._id + '" class="' + e.classes + '"' + n + ">" + t + "</select>" }, bindStates: function () { var e = this; return e.state.on("change:options", function (t) { e.getEl().innerHTML = ho(t.value) }), e._super() } }); function go(t, e, n) { return t < e && (t = e), n < t && (t = n), t } function po(t, e, n) { t.setAttribute("aria-" + e, n) } function vo(t, e) { var n, i, r, o, s; "v" === t.settings.orientation ? (r = "top", i = "height", n = "h") : (r = "left", i = "width", n = "w"), s = t.getEl("handle"), o = ((t.layoutRect()[n] || 100) - Pt.getSize(s)[i]) * ((e - t._minValue) / (t._maxValue - t._minValue)) + "px", s.style[r] = o, s.style.height = t.layoutRect().h + "px", po(s, "valuenow", e), po(s, "valuetext", "" + t.settings.previewFilter(e)), po(s, "valuemin", t._minValue), po(s, "valuemax", t._maxValue) } var yo = xe.extend({ init: function (t) { var e = this; t.previewFilter || (t.previewFilter = function (t) { return Math.round(100 * t) / 100 }), e._super(t), e.classes.add("slider"), "v" === t.orientation && e.classes.add("vertical"), e._minValue = pt.isNumber(t.minValue) ? t.minValue : 0, e._maxValue = pt.isNumber(t.maxValue) ? t.maxValue : 100, e._initValue = e.state.get("value") }, renderHtml: function () { var t = this._id, e = this.classPrefix; return '<div id="' + t + '" class="' + this.classes + '"><div id="' + t + '-handle" class="' + e + 'slider-handle" role="slider" tabindex="-1"></div></div>' }, reset: function () { this.value(this._initValue).repaint() }, postRender: function () { var t, e, n, i, r, o, s, a, l, u, c, d, f, h, m = this; t = m._minValue, e = m._maxValue, "v" === m.settings.orientation ? (n = "screenY", i = "top", r = "height", o = "h") : (n = "screenX", i = "left", r = "width", o = "w"), m._super(), function (o, s) { function e(t) { var e, n, i, r; e = go(e = (((e = m.value()) + (r = n = o)) / ((i = s) - r) + .05 * t) * (i - n) - n, o, s), m.value(e), m.fire("dragstart", { value: e }), m.fire("drag", { value: e }), m.fire("dragend", { value: e }) } m.on("keydown", function (t) { switch (t.keyCode) { case 37: case 38: e(-1); break; case 39: case 40: e(1) } }) }(t, e), s = t, a = e, l = m.getEl("handle"), m._dragHelper = new Ee(m._id, { handle: m._id + "-handle", start: function (t) { u = t[n], c = parseInt(m.getEl("handle").style[i], 10), d = (m.layoutRect()[o] || 100) - Pt.getSize(l)[r], m.fire("dragstart", { value: h }) }, drag: function (t) { var e = t[n] - u; f = go(c + e, 0, d), l.style[i] = f + "px", h = s + f / d * (a - s), m.value(h), m.tooltip().text("" + m.settings.previewFilter(h)).show().moveRel(l, "bc tc"), m.fire("drag", { value: h }) }, stop: function () { m.tooltip().hide(), m.fire("dragend", { value: h }) } }) }, repaint: function () { this._super(), vo(this, this.value()) }, bindStates: function () { var e = this; return e.state.on("change:value", function (t) { vo(e, t.value) }), e._super() } }), bo = xe.extend({ renderHtml: function () { return this.classes.add("spacer"), this.canFocus = !1, '<div id="' + this._id + '" class="' + this.classes + '"></div>' } }), xo = oo.extend({ Defaults: { classes: "widget btn splitbtn", role: "button" }, repaint: function () { var t, e, n = this.getEl(), i = this.layoutRect(); return this._super(), t = n.firstChild, e = n.lastChild, Nt(t).css({ width: i.w - Pt.getSize(e).width, height: i.h - 2 }), Nt(e).css({ height: i.h - 2 }), this }, activeMenu: function (t) { Nt(this.getEl().lastChild).toggleClass(this.classPrefix + "active", t) }, renderHtml: function () { var t, e, n = this, i = n._id, r = n.classPrefix, o = n.state.get("icon"), s = n.state.get("text"), a = n.settings, l = ""; return (t = a.image) ? (o = "none", "string" != typeof t && (t = window.getSelection ? t[0] : t[1]), t = " style=\"background-image: url('" + t + "')\"") : t = "", o = a.icon ? r + "ico " + r + "i-" + o : "", s && (n.classes.add("btn-has-text"), l = '<span class="' + r + 'txt">' + n.encode(s) + "</span>"), e = "boolean" == typeof a.active ? ' aria-pressed="' + a.active + '"' : "", '<div id="' + i + '" class="' + n.classes + '" role="button"' + e + ' tabindex="-1"><button type="button" hidefocus="1" tabindex="-1">' + (o ? '<i class="' + o + '"' + t + "></i>" : "") + l + '</button><button type="button" class="' + r + 'open" hidefocus="1" tabindex="-1">' + (n._menuBtnText ? (o ? "\xa0" : "") + n._menuBtnText : "") + ' <i class="' + r + 'caret"></i></button></div>' }, postRender: function () { var n = this.settings.onclick; return this.on("click", function (t) { var e = t.target; if (t.control === this) for (; e;) { if (t.aria && "down" !== t.aria.key || "BUTTON" === e.nodeName && -1 === e.className.indexOf("open")) return t.stopImmediatePropagation(), void (n && n.call(this, t)); e = e.parentNode } }), delete this.settings.onclick, this._super() } }), wo = Cr.extend({ Defaults: { containerClass: "stack-layout", controlClass: "stack-layout-item", endClass: "break" }, isNative: function () { return !0 } }), _o = Be.extend({ Defaults: { layout: "absolute", defaults: { type: "panel" } }, activateTab: function (n) { var t; this.activeTabId && (t = this.getEl(this.activeTabId), Nt(t).removeClass(this.classPrefix + "active"), t.setAttribute("aria-selected", "false")), this.activeTabId = "t" + n, (t = this.getEl("t" + n)).setAttribute("aria-selected", "true"), Nt(t).addClass(this.classPrefix + "active"), this.items()[n].show().fire("showtab"), this.reflow(), this.items().each(function (t, e) { n !== e && t.hide() }) }, renderHtml: function () { var i = this, t = i._layout, r = "", o = i.classPrefix; return i.preRender(), t.preRender(i), i.items().each(function (t, e) { var n = i._id + "-t" + e; t.aria("role", "tabpanel"), t.aria("labelledby", n), r += '<div id="' + n + '" class="' + o + 'tab" unselectable="on" role="tab" aria-controls="' + t._id + '" aria-selected="false" tabIndex="-1">' + i.encode(t.settings.title) + "</div>" }), '<div id="' + i._id + '" class="' + i.classes + '" hidefocus="1" tabindex="-1"><div id="' + i._id + '-head" class="' + o + 'tabs" role="tablist">' + r + '</div><div id="' + i._id + '-body" class="' + i.bodyClasses + '">' + t.renderHtml(i) + "</div></div>" }, postRender: function () { var i = this; i._super(), i.settings.activeTab = i.settings.activeTab || 0, i.activateTab(i.settings.activeTab), this.on("click", function (t) { var e = t.target.parentNode; if (e && e.id === i._id + "-head") for (var n = e.childNodes.length; n--;)e.childNodes[n] === t.target && i.activateTab(n) }) }, initLayoutRect: function () { var t, e, n, i = this; e = (e = Pt.getSize(i.getEl("head")).width) < 0 ? 0 : e, n = 0, i.items().each(function (t) { e = Math.max(e, t.layoutRect().minW), n = Math.max(n, t.layoutRect().minH) }), i.items().each(function (t) { t.settings.x = 0, t.settings.y = 0, t.settings.w = e, t.settings.h = n, t.layoutRect({ x: 0, y: 0, w: e, h: n }) }); var r = Pt.getSize(i.getEl("head")).height; return i.settings.minWidth = e, i.settings.minHeight = n + r, (t = i._super()).deltaH += r, t.innerH = t.h - t.deltaH, t } }), Ro = xe.extend({ init: function (t) { var n = this; n._super(t), n.classes.add("textbox"), t.multiline ? n.classes.add("multiline") : (n.on("keydown", function (t) { var e; 13 === t.keyCode && (t.preventDefault(), n.parents().reverse().each(function (t) { if (t.toJSON) return e = t, !1 }), n.fire("submit", { data: e.toJSON() })) }), n.on("keyup", function (t) { n.state.set("value", t.target.value) })) }, repaint: function () { var t, e, n, i, r, o = this, s = 0; t = o.getEl().style, e = o._layoutRect, r = o._lastRepaintRect || {}; var a = document; return !o.settings.multiline && a.all && (!a.documentMode || a.documentMode <= 8) && (t.lineHeight = e.h - s + "px"), i = (n = o.borderBox).left + n.right + 8, s = n.top + n.bottom + (o.settings.multiline ? 8 : 0), e.x !== r.x && (t.left = e.x + "px", r.x = e.x), e.y !== r.y && (t.top = e.y + "px", r.y = e.y), e.w !== r.w && (t.width = e.w - i + "px", r.w = e.w), e.h !== r.h && (t.height = e.h - s + "px", r.h = e.h), o._lastRepaintRect = r, o.fire("repaint", {}, !1), o }, renderHtml: function () { var e, t, n = this, i = n.settings; return e = { id: n._id, hidefocus: "1" }, R.each(["rows", "spellcheck", "maxLength", "size", "readonly", "min", "max", "step", "list", "pattern", "placeholder", "required", "multiple"], function (t) { e[t] = i[t] }), n.disabled() && (e.disabled = "disabled"), i.subtype && (e.type = i.subtype), (t = Pt.create(i.multiline ? "textarea" : "input", e)).value = n.state.get("value"), t.className = n.classes, t.outerHTML }, value: function (t) { return arguments.length ? (this.state.set("value", t), this) : (this.state.get("rendered") && this.state.set("value", this.getEl().value), this.state.get("value")) }, postRender: function () { var e = this; e.getEl().value = e.state.get("value"), e._super(), e.$el.on("change", function (t) { e.state.set("value", t.target.value), e.fire("change", t) }) }, bindStates: function () { var e = this; return e.state.on("change:value", function (t) { e.getEl().value !== t.value && (e.getEl().value = t.value) }), e.state.on("change:disabled", function (t) { e.getEl().disabled = t.value }), e._super() }, remove: function () { this.$el.off(), this._super() } }), Co = function () { return { Selector: $t, Collection: Jt, ReflowQueue: ie, Control: fe, Factory: He, KeyboardNavigation: Me, Container: De, DragHelper: Ee, Scrollable: Ae, Panel: Be, Movable: ye, Resizable: Le, FloatPanel: je, Window: Ke, MessageBox: Ze, Tooltip: be, Widget: xe, Progress: we, Notification: Re, Layout: Dn, AbsoluteLayout: An, Button: Bn, ButtonGroup: In, Checkbox: zn, ComboBox: Vn, ColorBox: qn, PanelButton: Un, ColorButton: $n, ColorPicker: Xn, Path: Gn, ElementPath: Kn, FormItem: Zn, Form: Qn, FieldSet: ti, FilePicker: wr, FitLayout: _r, FlexLayout: Rr, FlowLayout: Cr, FormatControls: Zr, GridLayout: Qr, Iframe: to, InfoBox: eo, Label: no, Toolbar: io, MenuBar: ro, MenuButton: oo, MenuItem: uo, Throbber: so, Menu: ao, ListBox: lo, Radio: co, ResizeHandle: fo, SelectBox: mo, Slider: yo, Spacer: bo, SplitButton: xo, StackLayout: wo, TabPanel: _o, TextBox: Ro, DropZone: Jn, BrowseButton: Ln } }, ko = function (n) { n.ui ? R.each(Co(), function (t, e) { n.ui[e] = t }) : n.ui = Co() }; R.each(Co(), function (t, e) { He.add(e, t) }), ko(window.tinymce ? window.tinymce : {}), o.add("inlite", function (t) { var e = On(); return Zr.setup(t), Hn(t, e), Qe(t, e) }) }();
!function () { "use strict"; var n, e, t, o, r, i, u, a = function (n) { return function () { return n } }, O = { noop: function () { for (var n = [], e = 0; e < arguments.length; e++)n[e] = arguments[e] }, noarg: function (t) { return function () { for (var n = [], e = 0; e < arguments.length; e++)n[e] = arguments[e]; return t() } }, compose: function (t, o) { return function () { for (var n = [], e = 0; e < arguments.length; e++)n[e] = arguments[e]; return t(o.apply(null, arguments)) } }, constant: a, identity: function (n) { return n }, tripleEquals: function (n, e) { return n === e }, curry: function (i) { for (var n = [], e = 1; e < arguments.length; e++)n[e - 1] = arguments[e]; for (var u = new Array(arguments.length - 1), t = 1; t < arguments.length; t++)u[t - 1] = arguments[t]; return function () { for (var n = [], e = 0; e < arguments.length; e++)n[e] = arguments[e]; for (var t = new Array(arguments.length), o = 0; o < t.length; o++)t[o] = arguments[o]; var r = u.concat(t); return i.apply(null, r) } }, not: function (t) { return function () { for (var n = [], e = 0; e < arguments.length; e++)n[e] = arguments[e]; return !t.apply(null, arguments) } }, die: function (n) { return function () { throw new Error(n) } }, apply: function (n) { return n() }, call: function (n) { n() }, never: a(!1), always: a(!0) }, c = function (e) { return function (n) { return function (n) { if (null === n) return "null"; var e = typeof n; return "object" === e && Array.prototype.isPrototypeOf(n) ? "array" : "object" === e && String.prototype.isPrototypeOf(n) ? "string" : e }(n) === e } }, E = { isString: c("string"), isObject: c("object"), isArray: c("array"), isNull: c("null"), isBoolean: c("boolean"), isUndefined: c("undefined"), isFunction: c("function"), isNumber: c("number") }, s = function (u) { return function () { for (var n = new Array(arguments.length), e = 0; e < n.length; e++)n[e] = arguments[e]; if (0 === n.length) throw new Error("Can't merge zero objects"); for (var t = {}, o = 0; o < n.length; o++) { var r = n[o]; for (var i in r) r.hasOwnProperty(i) && (t[i] = u(t[i], r[i])) } return t } }, f = s(function (n, e) { return E.isObject(n) && E.isObject(e) ? f(n, e) : e }), l = s(function (n, e) { return e }), D = { deepMerge: f, merge: l }, d = O.never, m = O.always, g = function () { return p }, p = (o = { fold: function (n, e) { return n() }, is: d, isSome: d, isNone: m, getOr: t = function (n) { return n }, getOrThunk: e = function (n) { return n() }, getOrDie: function (n) { throw new Error(n || "error: getOrDie called on none.") }, or: t, orThunk: e, map: g, ap: g, each: function () { }, bind: g, flatten: g, exists: d, forall: m, filter: g, equals: n = function (n) { return n.isNone() }, equals_: n, toArray: function () { return [] }, toString: O.constant("none()") }, Object.freeze && Object.freeze(o), o), v = function (t) { var n = function () { return t }, e = function () { return r }, o = function (n) { return n(t) }, r = { fold: function (n, e) { return e(t) }, is: function (n) { return t === n }, isSome: m, isNone: d, getOr: n, getOrThunk: n, getOrDie: n, or: e, orThunk: e, map: function (n) { return v(n(t)) }, ap: function (n) { return n.fold(g, function (n) { return v(n(t)) }) }, each: function (n) { n(t) }, bind: o, flatten: n, exists: o, forall: o, filter: function (n) { return n(t) ? r : p }, equals: function (n) { return n.is(t) }, equals_: function (n, e) { return n.fold(d, function (n) { return e(t, n) }) }, toArray: function () { return [t] }, toString: function () { return "some(" + t + ")" } }; return r }, y = { some: v, none: g, from: function (n) { return null === n || n === undefined ? p : v(n) } }, h = (r = Object.keys) === undefined ? function (n) { var e = []; for (var t in n) n.hasOwnProperty(t) && e.push(t); return e } : r, b = function (n, e) { for (var t = h(n), o = 0, r = t.length; o < r; o++) { var i = t[o]; e(n[i], i, n) } }, w = function (o, r) { var i = {}; return b(o, function (n, e) { var t = r(n, e, o); i[t.k] = t.v }), i }, x = function (n, t) { var o = []; return b(n, function (n, e) { o.push(t(n, e)) }), o }, S = function (n) { return x(n, function (n) { return n }) }, M = { bifilter: function (n, t) { var o = {}, r = {}; return b(n, function (n, e) { (t(n, e) ? o : r)[e] = n }), { t: o, f: r } }, each: b, map: function (n, o) { return w(n, function (n, e, t) { return { k: e, v: o(n, e, t) } }) }, mapToArray: x, tupleMap: w, find: function (n, e) { for (var t = h(n), o = 0, r = t.length; o < r; o++) { var i = t[o], u = n[i]; if (e(u, i, n)) return y.some(u) } return y.none() }, keys: h, values: S, size: function (n) { return S(n).length } }, T = (O.constant("contextmenu"), O.constant("touchstart")), k = O.constant("touchmove"), C = O.constant("touchend"), A = (O.constant("gesturestart"), O.constant("mousedown")), B = O.constant("mousemove"), R = (O.constant("mouseout"), O.constant("mouseup")), I = O.constant("mouseover"), F = (O.constant("focusin"), O.constant("keydown")), N = O.constant("input"), V = O.constant("change"), H = (O.constant("focus"), O.constant("click")), j = O.constant("transitionend"), z = O.constant("selectstart"), L = function (n) { var e, t = !1; return function () { return t || (t = !0, e = n.apply(null, arguments)), e } }, P = function (n, e) { var t = function (n, e) { for (var t = 0; t < n.length; t++) { var o = n[t]; if (o.test(e)) return o } return undefined }(n, e); if (!t) return { major: 0, minor: 0 }; var o = function (n) { return Number(e.replace(t, "$" + n)) }; return U(o(1), o(2)) }, W = function () { return U(0, 0) }, U = function (n, e) { return { major: n, minor: e } }, G = { nu: U, detect: function (n, e) { var t = String(e).toLowerCase(); return 0 === n.length ? W() : P(n, t) }, unknown: W }, $ = "Firefox", q = function (n, e) { return function () { return e === n } }, _ = function (n) { var e = n.current; return { current: e, version: n.version, isEdge: q("Edge", e), isChrome: q("Chrome", e), isIE: q("IE", e), isOpera: q("Opera", e), isFirefox: q($, e), isSafari: q("Safari", e) } }, K = { unknown: function () { return _({ current: undefined, version: G.unknown() }) }, nu: _, edge: O.constant("Edge"), chrome: O.constant("Chrome"), ie: O.constant("IE"), opera: O.constant("Opera"), firefox: O.constant($), safari: O.constant("Safari") }, X = "Windows", Y = "Android", J = "Solaris", Q = "FreeBSD", Z = function (n, e) { return function () { return e === n } }, nn = function (n) { var e = n.current; return { current: e, version: n.version, isWindows: Z(X, e), isiOS: Z("iOS", e), isAndroid: Z(Y, e), isOSX: Z("OSX", e), isLinux: Z("Linux", e), isSolaris: Z(J, e), isFreeBSD: Z(Q, e) } }, en = { unknown: function () { return nn({ current: undefined, version: G.unknown() }) }, nu: nn, windows: O.constant(X), ios: O.constant("iOS"), android: O.constant(Y), linux: O.constant("Linux"), osx: O.constant("OSX"), solaris: O.constant(J), freebsd: O.constant(Q) }, tn = (i = Array.prototype.indexOf) === undefined ? function (n, e) { return fn(n, e) } : function (n, e) { return i.call(n, e) }, on = function (n, e) { return -1 < tn(n, e) }, rn = function (n, e) { for (var t = n.length, o = new Array(t), r = 0; r < t; r++) { var i = n[r]; o[r] = e(i, r, n) } return o }, un = function (n, e) { for (var t = 0, o = n.length; t < o; t++)e(n[t], t, n) }, an = function (n, e) { for (var t = n.length - 1; 0 <= t; t--)e(n[t], t, n) }, cn = function (n, e) { for (var t = [], o = 0, r = n.length; o < r; o++) { var i = n[o]; e(i, o, n) && t.push(i) } return t }, sn = function (n, e) { for (var t = 0, o = n.length; t < o; t++)if (e(n[t], t, n)) return y.some(t); return y.none() }, fn = function (n, e) { for (var t = 0, o = n.length; t < o; ++t)if (n[t] === e) return t; return -1 }, ln = Array.prototype.push, dn = function (n) { for (var e = [], t = 0, o = n.length; t < o; ++t) { if (!Array.prototype.isPrototypeOf(n[t])) throw new Error("Arr.flatten item " + t + " was not an array, input: " + n); ln.apply(e, n[t]) } return e }, mn = function (n, e) { for (var t = 0, o = n.length; t < o; ++t)if (!0 !== e(n[t], t, n)) return !1; return !0 }, gn = Array.prototype.slice, pn = E.isFunction(Array.from) ? Array.from : function (n) { return gn.call(n) }, vn = { map: rn, each: un, eachr: an, partition: function (n, e) { for (var t = [], o = [], r = 0, i = n.length; r < i; r++) { var u = n[r]; (e(u, r, n) ? t : o).push(u) } return { pass: t, fail: o } }, filter: cn, groupBy: function (n, e) { if (0 === n.length) return []; for (var t = e(n[0]), o = [], r = [], i = 0, u = n.length; i < u; i++) { var a = n[i], c = e(a); c !== t && (o.push(r), r = []), t = c, r.push(a) } return 0 !== r.length && o.push(r), o }, indexOf: function (n, e) { var t = tn(n, e); return -1 === t ? y.none() : y.some(t) }, foldr: function (n, e, t) { return an(n, function (n) { t = e(t, n) }), t }, foldl: function (n, e, t) { return un(n, function (n) { t = e(t, n) }), t }, find: function (n, e) { for (var t = 0, o = n.length; t < o; t++) { var r = n[t]; if (e(r, t, n)) return y.some(r) } return y.none() }, findIndex: sn, flatten: dn, bind: function (n, e) { var t = rn(n, e); return dn(t) }, forall: mn, exists: function (n, e) { return sn(n, e).isSome() }, contains: on, equal: function (n, t) { return n.length === t.length && mn(n, function (n, e) { return n === t[e] }) }, reverse: function (n) { var e = gn.call(n, 0); return e.reverse(), e }, chunk: function (n, e) { for (var t = [], o = 0; o < n.length; o += e) { var r = n.slice(o, o + e); t.push(r) } return t }, difference: function (n, e) { return cn(n, function (n) { return !on(e, n) }) }, mapToObject: function (n, e) { for (var t = {}, o = 0, r = n.length; o < r; o++) { var i = n[o]; t[String(i)] = e(i, o) } return t }, pure: function (n) { return [n] }, sort: function (n, e) { var t = gn.call(n, 0); return t.sort(e), t }, range: function (n, e) { for (var t = [], o = 0; o < n; o++)t.push(e(o)); return t }, head: function (n) { return 0 === n.length ? y.none() : y.some(n[0]) }, last: function (n) { return 0 === n.length ? y.none() : y.some(n[n.length - 1]) }, from: pn }, hn = function (n, e) { var t = String(e).toLowerCase(); return vn.find(n, function (n) { return n.search(t) }) }, bn = function (n, t) { return hn(n, t).map(function (n) { var e = G.detect(n.versionRegexes, t); return { current: n.name, version: e } }) }, yn = function (n, t) { return hn(n, t).map(function (n) { var e = G.detect(n.versionRegexes, t); return { current: n.name, version: e } }) }, wn = function (n, r) { return n.replace(/\${([^{}]*)}/g, function (n, e) { var t, o = r[e]; return "string" == (t = typeof o) || "number" === t ? o : n }) }, xn = function (n, e) { return -1 !== n.indexOf(e) }, Sn = function (n) { return n.replace(/^\s+|\s+$/g, "") }, Tn = /.*?version\/\ ?([0-9]+)\.([0-9]+).*/, kn = function (e) { return function (n) { return xn(n, e) } }, Cn = [{ name: "Edge", versionRegexes: [/.*?edge\/ ?([0-9]+)\.([0-9]+)$/], search: function (n) { return xn(n, "edge/") && xn(n, "chrome") && xn(n, "safari") && xn(n, "applewebkit") } }, { name: "Chrome", versionRegexes: [/.*?chrome\/([0-9]+)\.([0-9]+).*/, Tn], search: function (n) { return xn(n, "chrome") && !xn(n, "chromeframe") } }, { name: "IE", versionRegexes: [/.*?msie\ ?([0-9]+)\.([0-9]+).*/, /.*?rv:([0-9]+)\.([0-9]+).*/], search: function (n) { return xn(n, "msie") || xn(n, "trident") } }, { name: "Opera", versionRegexes: [Tn, /.*?opera\/([0-9]+)\.([0-9]+).*/], search: kn("opera") }, { name: "Firefox", versionRegexes: [/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/], search: kn("firefox") }, { name: "Safari", versionRegexes: [Tn, /.*?cpu os ([0-9]+)_([0-9]+).*/], search: function (n) { return (xn(n, "safari") || xn(n, "mobile/")) && xn(n, "applewebkit") } }], On = [{ name: "Windows", search: kn("win"), versionRegexes: [/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/] }, { name: "iOS", search: function (n) { return xn(n, "iphone") || xn(n, "ipad") }, versionRegexes: [/.*?version\/\ ?([0-9]+)\.([0-9]+).*/, /.*cpu os ([0-9]+)_([0-9]+).*/, /.*cpu iphone os ([0-9]+)_([0-9]+).*/] }, { name: "Android", search: kn("android"), versionRegexes: [/.*?android\ ?([0-9]+)\.([0-9]+).*/] }, { name: "OSX", search: kn("os x"), versionRegexes: [/.*?os\ x\ ?([0-9]+)_([0-9]+).*/] }, { name: "Linux", search: kn("linux"), versionRegexes: [] }, { name: "Solaris", search: kn("sunos"), versionRegexes: [] }, { name: "FreeBSD", search: kn("freebsd"), versionRegexes: [] }], En = { browsers: O.constant(Cn), oses: O.constant(On) }, Dn = function (n) { var e, t, o, r, i, u, a, c, s, f, l, d = En.browsers(), m = En.oses(), g = bn(d, n).fold(K.unknown, K.nu), p = yn(m, n).fold(en.unknown, en.nu); return { browser: g, os: p, deviceType: (t = g, o = n, r = (e = p).isiOS() && !0 === /ipad/i.test(o), i = e.isiOS() && !r, u = e.isAndroid() && 3 === e.version.major, a = e.isAndroid() && 4 === e.version.major, c = r || u || a && !0 === /mobile/i.test(o), s = e.isiOS() || e.isAndroid(), f = s && !c, l = t.isSafari() && e.isiOS() && !1 === /safari/i.test(o), { isiPad: O.constant(r), isiPhone: O.constant(i), isTablet: O.constant(c), isPhone: O.constant(f), isTouch: O.constant(s), isAndroid: e.isAndroid, isiOS: e.isiOS, isWebView: O.constant(l) }) } }, Mn = { detect: L(function () { var n = navigator.userAgent; return Dn(n) }) }, An = { tap: O.constant("alloy.tap") }, Bn = O.constant("alloy.focus"), Rn = O.constant("alloy.blur.post"), In = O.constant("alloy.receive"), Fn = O.constant("alloy.execute"), Nn = O.constant("alloy.focus.item"), Vn = An.tap, Hn = Mn.detect().deviceType.isTouch() ? An.tap : H, jn = O.constant("alloy.longpress"), zn = (O.constant("alloy.sandbox.close"), O.constant("alloy.system.init")), Ln = O.constant("alloy.system.scroll"), Pn = O.constant("alloy.system.attached"), Wn = O.constant("alloy.system.detached"), Un = (O.constant("alloy.change.tab"), O.constant("alloy.dismiss.tab"), function (n, e) { _n(n, n.element(), e, {}) }), Gn = function (n, e, t) { _n(n, n.element(), e, t) }, $n = function (n) { Un(n, Fn()) }, qn = function (n, e, t) { _n(n, e, t, {}) }, _n = function (n, e, t, o) { var r = D.deepMerge({ target: e }, o); n.getSystem().triggerEvent(t, e, M.map(r, O.constant)) }, Kn = function (n) { if (null === n || n === undefined) throw new Error("Node cannot be null or undefined"); return { dom: O.constant(n) } }, Xn = { fromHtml: function (n, e) { var t = (e || document).createElement("div"); if (t.innerHTML = n, !t.hasChildNodes() || 1 < t.childNodes.length) throw console.error("HTML does not have a single root node", n), "HTML must have a single root node"; return Kn(t.childNodes[0]) }, fromTag: function (n, e) { var t = (e || document).createElement(n); return Kn(t) }, fromText: function (n, e) { var t = (e || document).createTextNode(n); return Kn(t) }, fromDom: Kn, fromPoint: function (n, e, t) { return y.from(n.dom().elementFromPoint(e, t)).map(Kn) } }, Yn = 8, Jn = 9, Qn = 1, Zn = 3, ne = function (n) { return n.dom().nodeName.toLowerCase() }, ee = function (n) { return n.dom().nodeType }, te = function (e) { return function (n) { return ee(n) === e } }, oe = te(Qn), re = te(Zn), ie = te(Jn), ue = { name: ne, type: ee, value: function (n) { return n.dom().nodeValue }, isElement: oe, isText: re, isDocument: ie, isComment: function (n) { return ee(n) === Yn || "#comment" === ne(n) } }, ae = L(function () { return ce(Xn.fromDom(document)) }), ce = function (n) { var e = n.dom().body; if (null === e || e === undefined) throw "Body is not available yet"; return Xn.fromDom(e) }, se = { body: ae, getBody: ce, inBody: function (n) { var e = ue.isText(n) ? n.dom().parentNode : n.dom(); return e !== undefined && null !== e && e.ownerDocument.body.contains(e) } }, fe = function (n) { return n.slice(0).sort() }, le = { sort: fe, reqMessage: function (n, e) { throw new Error("All required keys (" + fe(n).join(", ") + ") were not specified. Specified keys were: " + fe(e).join(", ") + ".") }, unsuppMessage: function (n) { throw new Error("Unsupported keys for object: " + fe(n).join(", ")) }, validateStrArr: function (e, n) { if (!E.isArray(n)) throw new Error("The " + e + " fields must be an array. Was: " + n + "."); vn.each(n, function (n) { if (!E.isString(n)) throw new Error("The value " + n + " in the " + e + " fields was not a string.") }) }, invalidTypeMessage: function (n, e) { throw new Error("All values need to be of type: " + e + ". Keys (" + fe(n).join(", ") + ") were not.") }, checkDupes: function (n) { var t = fe(n); vn.find(t, function (n, e) { return e < t.length - 1 && n === t[e + 1] }).each(function (n) { throw new Error("The field: " + n + " occurs more than once in the combined fields: [" + t.join(", ") + "].") }) } }, de = { immutable: function () { for (var e = [], n = 0; n < arguments.length; n++)e[n] = arguments[n]; return function () { for (var t = [], n = 0; n < arguments.length; n++)t[n] = arguments[n]; if (e.length !== t.length) throw new Error('Wrong number of arguments to struct. Expected "[' + e.length + ']", got ' + t.length + " arguments"); var o = {}; return vn.each(e, function (n, e) { o[n] = O.constant(t[e]) }), o } }, immutableBag: function (r, i) { var u = r.concat(i); if (0 === u.length) throw new Error("You must specify at least one required or optional field."); return le.validateStrArr("required", r), le.validateStrArr("optional", i), le.checkDupes(u), function (e) { var t = M.keys(e); vn.forall(r, function (n) { return vn.contains(t, n) }) || le.reqMessage(r, t); var n = vn.filter(t, function (n) { return !vn.contains(u, n) }); 0 < n.length && le.unsuppMessage(n); var o = {}; return vn.each(r, function (n) { o[n] = O.constant(e[n]) }), vn.each(i, function (n) { o[n] = O.constant(Object.prototype.hasOwnProperty.call(e, n) ? y.some(e[n]) : y.none()) }), o } } }, me = function (n, e) { for (var t = [], o = function (n) { return t.push(n), e(n) }, r = e(n); (r = r.bind(o)).isSome();); return t }, ge = "undefined" != typeof window ? window : Function("return this;")(), pe = function (n, e) { for (var t = e !== undefined && null !== e ? e : ge, o = 0; o < n.length && t !== undefined && null !== t; ++o)t = t[n[o]]; return t }, ve = function (n, e) { var t = n.split("."); return pe(t, e) }, he = { getOrDie: function (n, e) { var t = ve(n, e); if (t === undefined || null === t) throw n + " not available on this browser"; return t } }, be = Qn, ye = Jn, we = function (n) { return n.nodeType !== be && n.nodeType !== ye || 0 === n.childElementCount }, xe = { all: function (n, e) { var t = e === undefined ? document : e.dom(); return we(t) ? [] : vn.map(t.querySelectorAll(n), Xn.fromDom) }, is: function (n, e) { var t = n.dom(); if (t.nodeType !== be) return !1; if (t.matches !== undefined) return t.matches(e); if (t.msMatchesSelector !== undefined) return t.msMatchesSelector(e); if (t.webkitMatchesSelector !== undefined) return t.webkitMatchesSelector(e); if (t.mozMatchesSelector !== undefined) return t.mozMatchesSelector(e); throw new Error("Browser lacks native selectors") }, one: function (n, e) { var t = e === undefined ? document : e.dom(); return we(t) ? y.none() : y.from(t.querySelector(n)).map(Xn.fromDom) } }, Se = function (n, e) { return n.dom() === e.dom() }, Te = (Mn.detect().browser.isIE(), Se), ke = function (n) { return Xn.fromDom(n.dom().ownerDocument) }, Ce = function (n) { var e = n.dom(); return y.from(e.parentNode).map(Xn.fromDom) }, Oe = function (n) { var e = n.dom(); return y.from(e.previousSibling).map(Xn.fromDom) }, Ee = function (n) { var e = n.dom(); return y.from(e.nextSibling).map(Xn.fromDom) }, De = function (n) { var e = n.dom(); return vn.map(e.childNodes, Xn.fromDom) }, Me = function (n, e) { var t = n.dom().childNodes; return y.from(t[e]).map(Xn.fromDom) }, Ae = de.immutable("element", "offset"), Be = { owner: ke, defaultView: function (n) { var e = n.dom().ownerDocument.defaultView; return Xn.fromDom(e) }, documentElement: function (n) { var e = ke(n); return Xn.fromDom(e.dom().documentElement) }, parent: Ce, findIndex: function (t) { return Ce(t).bind(function (n) { var e = De(n); return vn.findIndex(e, function (n) { return Te(t, n) }) }) }, parents: function (n, e) { for (var t = E.isFunction(e) ? e : O.constant(!1), o = n.dom(), r = []; null !== o.parentNode && o.parentNode !== undefined;) { var i = o.parentNode, u = Xn.fromDom(i); if (r.push(u), !0 === t(u)) break; o = i } return r }, siblings: function (e) { return Ce(e).map(De).map(function (n) { return vn.filter(n, function (n) { return !Te(e, n) }) }).getOr([]) }, prevSibling: Oe, offsetParent: function (n) { var e = n.dom(); return y.from(e.offsetParent).map(Xn.fromDom) }, prevSiblings: function (n) { return vn.reverse(me(n, Oe)) }, nextSibling: Ee, nextSiblings: function (n) { return me(n, Ee) }, children: De, child: Me, firstChild: function (n) { return Me(n, 0) }, lastChild: function (n) { return Me(n, n.dom().childNodes.length - 1) }, childNodesCount: function (n) { return n.dom().childNodes.length }, hasChildNodes: function (n) { return n.dom().hasChildNodes() }, leaf: function (n, e) { var t = De(n); return 0 < t.length && e < t.length ? Ae(t[e], 0) : Ae(n, e) } }, Re = function (e, t) { Be.parent(e).each(function (n) { n.dom().insertBefore(t.dom(), e.dom()) }) }, Ie = function (n, e) { n.dom().appendChild(e.dom()) }, Fe = { before: Re, after: function (n, e) { Be.nextSibling(n).fold(function () { Be.parent(n).each(function (n) { Ie(n, e) }) }, function (n) { Re(n, e) }) }, prepend: function (e, t) { Be.firstChild(e).fold(function () { Ie(e, t) }, function (n) { e.dom().insertBefore(t.dom(), n.dom()) }) }, append: Ie, appendAt: function (n, e, t) { Be.child(n, t).fold(function () { Ie(n, e) }, function (n) { Re(n, e) }) }, wrap: function (n, e) { Re(n, e), Ie(e, n) } }, Ne = { before: function (e, n) { vn.each(n, function (n) { Fe.before(e, n) }) }, after: function (o, r) { vn.each(r, function (n, e) { var t = 0 === e ? o : r[e - 1]; Fe.after(t, n) }) }, prepend: function (e, n) { vn.each(n.slice().reverse(), function (n) { Fe.prepend(e, n) }) }, append: function (e, n) { vn.each(n, function (n) { Fe.append(e, n) }) } }, Ve = function (n) { var e = n.dom(); null !== e.parentNode && e.parentNode.removeChild(e) }, He = { empty: function (n) { n.dom().textContent = "", vn.each(Be.children(n), function (n) { Ve(n) }) }, remove: Ve, unwrap: function (n) { var e = Be.children(n); 0 < e.length && Ne.before(n, e), Ve(n) } }, je = function (n) { Un(n, Wn()); var e = n.components(); vn.each(e, je) }, ze = function (n) { var e = n.components(); vn.each(e, ze), Un(n, Pn()) }, Le = function (n, e) { Pe(n, e, Fe.append) }, Pe = function (n, e, t) { n.getSystem().addToWorld(e), t(n.element(), e.element()), se.inBody(n.element()) && ze(e), n.syncComponents() }, We = function (n) { je(n), He.remove(n.element()), n.getSystem().removeFromWorld(n) }, Ue = function (e) { var n = Be.parent(e.element()).bind(function (n) { return e.getSystem().getByDom(n).fold(y.none, y.some) }); We(e), n.each(function (n) { n.syncComponents() }) }, Ge = function (t) { return { is: function (n) { return t === n }, isValue: O.always, isError: O.never, getOr: O.constant(t), getOrThunk: O.constant(t), getOrDie: O.constant(t), or: function (n) { return Ge(t) }, orThunk: function (n) { return Ge(t) }, fold: function (n, e) { return e(t) }, map: function (n) { return Ge(n(t)) }, each: function (n) { n(t) }, bind: function (n) { return n(t) }, exists: function (n) { return n(t) }, forall: function (n) { return n(t) }, toOption: function () { return y.some(t) } } }, $e = function (t) { return { is: O.never, isValue: O.never, isError: O.always, getOr: O.identity, getOrThunk: function (n) { return n() }, getOrDie: function () { return O.die(String(t))() }, or: function (n) { return n }, orThunk: function (n) { return n() }, fold: function (n, e) { return n(t) }, map: function (n) { return $e(t) }, each: O.noop, bind: function (n) { return $e(t) }, exists: O.never, forall: O.always, toOption: y.none } }, qe = { value: Ge, error: $e }, _e = function (u) { if (!E.isArray(u)) throw new Error("cases must be an array"); if (0 === u.length) throw new Error("there must be at least one case"); var a = [], t = {}; return vn.each(u, function (n, o) { var e = M.keys(n); if (1 !== e.length) throw new Error("one and only one name per case"); var r = e[0], i = n[r]; if (t[r] !== undefined) throw new Error("duplicate key detected:" + r); if ("cata" === r) throw new Error("cannot have a case named cata (sorry)"); if (!E.isArray(i)) throw new Error("case arguments must be an array"); a.push(r), t[r] = function () { var n = arguments.length; if (n !== i.length) throw new Error("Wrong number of arguments to case " + r + ". Expected " + i.length + " (" + i + "), got " + n); for (var t = new Array(n), e = 0; e < t.length; e++)t[e] = arguments[e]; return { fold: function () { if (arguments.length !== u.length) throw new Error("Wrong number of arguments to fold. Expected " + u.length + ", got " + arguments.length); return arguments[o].apply(null, t) }, match: function (n) { var e = M.keys(n); if (a.length !== e.length) throw new Error("Wrong number of arguments to match. Expected: " + a.join(",") + "\nActual: " + e.join(",")); if (!vn.forall(a, function (n) { return vn.contains(e, n) })) throw new Error("Not all branches were specified when using match. Specified: " + e.join(", ") + "\nRequired: " + a.join(", ")); return n[r].apply(null, t) }, log: function (n) { console.log(n, { constructors: a, constructor: r, params: t }) } } } }), t }, Ke = _e([{ strict: [] }, { defaultedThunk: ["fallbackThunk"] }, { asOption: [] }, { asDefaultedOptionThunk: ["fallbackThunk"] }, { mergeWithThunk: ["baseThunk"] }]), Xe = function (n) { return Ke.defaultedThunk(O.constant(n)) }, Ye = Ke.strict, Je = Ke.asOption, Qe = Ke.defaultedThunk, Ze = (Ke.asDefaultedOptionThunk, Ke.mergeWithThunk), nt = (_e([{ bothErrors: ["error1", "error2"] }, { firstError: ["error1", "value2"] }, { secondError: ["value1", "error2"] }, { bothValues: ["value1", "value2"] }]), function (n) { var e = [], t = []; return vn.each(n, function (n) { n.fold(function (n) { e.push(n) }, function (n) { t.push(n) }) }), { errors: e, values: t } }), et = function (n) { return O.compose(qe.error, vn.flatten)(n) }, tt = function (n, e) { var t, o, r = nt(n); return 0 < r.errors.length ? et(r.errors) : (t = r.values, o = e, qe.value(D.deepMerge.apply(undefined, [o].concat(t)))) }, ot = function (n) { var e = nt(n); return 0 < e.errors.length ? et(e.errors) : qe.value(e.values) }, rt = function (e) { return function (n) { return n.hasOwnProperty(e) ? y.from(n[e]) : y.none() } }, it = function (n, e) { return rt(e)(n) }, ut = function (n, e) { var t = {}; return t[n] = e, t }, at = function (n, e) { return t = n, o = e, r = {}, vn.each(o, function (n) { t[n] !== undefined && t.hasOwnProperty(n) && (r[n] = t[n]) }), r; var t, o, r }, ct = function (n, e) { return t = n, o = e, r = {}, M.each(t, function (n, e) { vn.contains(o, e) || (r[e] = n) }), r; var t, o, r }, st = function (n) { return rt(n) }, ft = function (n, e) { return t = n, o = e, function (n) { return rt(t)(n).getOr(o) }; var t, o }, lt = function (n, e) { return it(n, e) }, dt = function (n, e) { return ut(n, e) }, mt = function (n) { return e = n, t = {}, vn.each(e, function (n) { t[n.key] = n.value }), t; var e, t }, gt = function (n, e) { return tt(n, e) }, pt = function (n, e) { return o = e, (t = n).hasOwnProperty(o) && t[o] !== undefined && null !== t[o]; var t, o }, vt = _e([{ setOf: ["validator", "valueType"] }, { arrOf: ["valueType"] }, { objOf: ["fields"] }, { itemOf: ["validator"] }, { choiceOf: ["key", "branches"] }, { thunk: ["description"] }, { func: ["args", "outputSchema"] }]), ht = _e([{ field: ["name", "presence", "type"] }, { state: ["name"] }]), bt = function () { return he.getOrDie("JSON") }, yt = function (n, e, t) { return bt().stringify(n, e, t) }, wt = function (n) { return E.isObject(n) && 100 < M.keys(n).length ? " removed due to size" : yt(n, null, 2) }, xt = function (n, e) { return qe.error([{ path: n, getErrorInfo: e }]) }, St = _e([{ field: ["key", "okey", "presence", "prop"] }, { state: ["okey", "instantiator"] }]), Tt = function (t, o, r) { return it(o, r).fold(function () { return n = r, e = o, xt(t, function () { return 'Could not find valid *strict* value for "' + n + '" in ' + wt(e) }); var n, e }, qe.value) }, kt = function (n, e, t) { var o = it(n, e).fold(function () { return t(n) }, O.identity); return qe.value(o) }, Ct = function (r, a, n, c) { return n.fold(function (i, e, n, t) { var o = function (n) { return t.extract(r.concat([i]), c, n).map(function (n) { return ut(e, c(n)) }) }, u = function (n) { return n.fold(function () { var n = ut(e, c(y.none())); return qe.value(n) }, function (n) { return t.extract(r.concat([i]), c, n).map(function (n) { return ut(e, c(y.some(n))) }) }) }; return n.fold(function () { return Tt(r, a, i).bind(o) }, function (n) { return kt(a, i, n).bind(o) }, function () { return (n = a, e = i, qe.value(it(n, e))).bind(u); var n, e }, function (n) { return (e = a, t = i, o = n, r = it(e, t).map(function (n) { return !0 === n ? o(e) : n }), qe.value(r)).bind(u); var e, t, o, r }, function (n) { var e = n(a); return kt(a, i, O.constant({})).map(function (n) { return D.deepMerge(e, n) }).bind(o) }) }, function (n, e) { var t = e(a); return qe.value(ut(n, c(t))) }) }, Ot = function (o) { return { extract: function (t, n, e) { return o(e, n).fold(function (n) { return e = n, xt(t, function () { return e }); var e }, qe.value) }, toString: function () { return "val" }, toDsl: function () { return vt.itemOf(o) } } }, Et = function (n) { var c = Dt(n), s = vn.foldr(n, function (e, n) { return n.fold(function (n) { return D.deepMerge(e, dt(n, !0)) }, O.constant(e)) }, {}); return { extract: function (n, e, t) { var o, r, i, u = E.isBoolean(t) ? [] : (o = t, r = M.keys(o), vn.filter(r, function (n) { return pt(o, n) })), a = vn.filter(u, function (n) { return !pt(s, n) }); return 0 === a.length ? c.extract(n, e, t) : (i = a, xt(n, function () { return "There are unsupported fields: [" + i.join(", ") + "] specified" })) }, toString: c.toString, toDsl: c.toDsl } }, Dt = function (c) { return { extract: function (n, e, t) { return o = n, r = t, i = c, u = e, a = vn.map(i, function (n) { return Ct(o, r, n, u) }), tt(a, {}); var o, r, i, u, a }, toString: function () { return "obj{\n" + vn.map(c, function (n) { return n.fold(function (n, e, t, o) { return n + " -> " + o.toString() }, function (n, e) { return "state(" + n + ")" }) }).join("\n") + "}" }, toDsl: function () { return vt.objOf(vn.map(c, function (n) { return n.fold(function (n, e, t, o) { return ht.field(n, t, o) }, function (n, e) { return ht.state(n) }) })) } } }, Mt = function (r) { return { extract: function (t, o, n) { var e = vn.map(n, function (n, e) { return r.extract(t.concat(["[" + e + "]"]), o, n) }); return ot(e) }, toString: function () { return "array(" + r.toString() + ")" }, toDsl: function () { return vt.arrOf(r) } } }, At = function (u, a) { return { extract: function (t, o, r) { var n, e, i = M.keys(r); return (n = t, e = i, Mt(Ot(u)).extract(n, O.identity, e)).bind(function (n) { var e = vn.map(n, function (n) { return St.field(n, n, Ye(), a) }); return Dt(e).extract(t, o, r) }) }, toString: function () { return "setOf(" + a.toString() + ")" }, toDsl: function () { return vt.setOf(u, a) } } }, Bt = O.constant(Ot(qe.value)), Rt = (O.compose(Mt, Dt), St.state), It = St.field, Ft = function (n) { return It(n, n, Ye(), Bt()) }, Nt = function (n, e) { return It(n, n, Ye(), e) }, Vt = function (n) { return It(n, n, Ye(), Ot(function (n) { return E.isFunction(n) ? qe.value(n) : qe.error("Not a function") })) }, Ht = function (n, e) { return It(n, n, Ye(), Dt(e)) }, jt = function (n) { return It(n, n, Je(), Bt()) }, zt = function (n, e) { return It(n, n, Je(), Dt(e)) }, Lt = function (n, e) { return It(n, n, Je(), Et(e)) }, Pt = function (n, e) { return It(n, n, Xe(e), Bt()) }, Wt = function (n, e, t) { return It(n, n, Xe(e), t) }, Ut = function (n, e) { return Rt(n, e) }, Gt = function (t, e, o, r, i) { return lt(r, i).fold(function () { return n = r, e = i, xt(t, function () { return 'The chosen schema: "' + e + '" did not exist in branches: ' + wt(n) }); var n, e }, function (n) { return Dt(n).extract(t.concat(["branch: " + i]), e, o) }) }, $t = function (r, i) { return { extract: function (e, t, o) { return lt(o, r).fold(function () { return n = r, xt(e, function () { return 'Choice schema did not contain choice key: "' + n + '"' }); var n }, function (n) { return Gt(e, t, o, i, n) }) }, toString: function () { return "chooseOn(" + r + "). Possible values: " + M.keys(i) }, toDsl: function () { return vt.choiceOf(r, i) } } }, qt = Ot(qe.value), _t = function (n, e, t, o) { return e.extract([n], t, o).fold(function (n) { return qe.error({ input: o, errors: n }) }, qe.value) }, Kt = function (n, e, t) { return _t(n, e, O.constant, t) }, Xt = function (n) { return n.fold(function (n) { throw new Error(Qt(n)) }, O.identity) }, Yt = function (n, e, t) { return Xt((o = t, _t(n, e, O.identity, o))); var o }, Jt = function (n, e, t) { return Xt(Kt(n, e, t)) }, Qt = function (n) { return "Errors: \n" + (e = n.errors, t = 10 < e.length ? e.slice(0, 10).concat([{ path: [], getErrorInfo: function () { return "... (only showing first ten failures)" } }]) : e, vn.map(t, function (n) { return "Failed path: (" + n.path.join(" > ") + ")\n" + n.getErrorInfo() })) + "\n\nInput object: " + wt(n.input); var e, t }, Zt = function (n, e) { return $t(n, e) }, no = O.constant(qt), eo = function (n) { if (!pt(n, "can") && !pt(n, "abort") && !pt(n, "run")) throw new Error("EventHandler defined by: " + yt(n, null, 2) + " does not have can, abort, or run!"); return Yt("Extracting event.handler", Et([Pt("can", O.constant(!0)), Pt("abort", O.constant(!1)), Pt("run", O.noop)]), n) }, to = function (n) { var e, o, r, i, t = (e = n, o = function (n) { return n.can }, function () { var t = Array.prototype.slice.call(arguments, 0); return vn.foldl(e, function (n, e) { return n && o(e).apply(undefined, t) }, !0) }), u = (r = n, i = function (n) { return n.abort }, function () { var t = Array.prototype.slice.call(arguments, 0); return vn.foldl(r, function (n, e) { return n || i(e).apply(undefined, t) }, !1) }); return eo({ can: t, abort: u, run: function () { var e = Array.prototype.slice.call(arguments, 0); vn.each(n, function (n) { n.run.apply(undefined, e) }) } }) }, oo = mt, ro = function (n, e) { return { key: n, value: eo({ abort: e }) } }, io = function (n, e) { return { key: n, value: eo({ run: e }) } }, uo = function (n, e, t) { return { key: n, value: eo({ run: function (n) { e.apply(undefined, [n].concat(t)) } }) } }, ao = function (n) { return function (o) { return { key: n, value: eo({ run: function (n, e) { var t; t = e, Te(n.element(), t.event().target()) && o(n, e) } }) } } }, co = function (n, e, t) { var u, o, r = e.partUids()[t]; return o = r, io(u = n, function (n, i) { n.getSystem().getByUid(o).each(function (n) { var e, t, o, r; t = (e = n).element(), o = u, r = i, e.getSystem().triggerEvent(o, t, r.event()) }) }) }, so = function (n) { return io(n, function (n, e) { e.cut() }) }, fo = ao(Pn()), lo = ao(Wn()), mo = ao(zn()), go = (u = Fn(), function (n) { return io(u, n) }), po = function (n, e) { return n }, vo = de.immutableBag(["tag"], ["classes", "attributes", "styles", "value", "innerHtml", "domChildren", "defChildren"]), ho = function (n) { return { tag: n.tag(), classes: n.classes().getOr([]), attributes: n.attributes().getOr({}), styles: n.styles().getOr({}), value: n.value().getOr("<none>"), innerHtml: n.innerHtml().getOr("<none>"), defChildren: n.defChildren().getOr("<none>"), domChildren: n.domChildren().fold(function () { return "<none>" }, function (n) { return 0 === n.length ? "0 children, but still specified" : String(n.length) }) } }, bo = de.immutableBag([], ["classes", "attributes", "styles", "value", "innerHtml", "defChildren", "domChildren"]), yo = function (e, n, t) { return n.fold(function () { return t.fold(function () { return {} }, function (n) { return dt(e, n) }) }, function (n) { return t.fold(function () { return dt(e, n) }, function (n) { return dt(e, n) }) }) }, wo = function (t, o, r) { return mo(function (n, e) { r(n, t, o) }) }, xo = function (n, e, t, o, r, i) { var u, a, c = n, s = zt(e, [(u = "config", a = n, It(u, u, Je(), a))]); return To(c, s, e, t, o, r, i) }, So = function (n) { return { key: n, value: undefined } }, To = function (t, n, o, r, e, i, u) { var a = function (n) { return pt(n, o) ? n[o]() : y.none() }, c = M.map(e, function (n, e) { return r = o, i = n, u = e, function (t) { var o = arguments; return t.config({ name: O.constant(r) }).fold(function () { throw new Error("We could not find any behaviour configuration for: " + r + ". Using API: " + u) }, function (n) { var e = Array.prototype.slice.call(o, 1); return i.apply(undefined, [t, n.config, n.state].concat(e)) }) }; var r, i, u }), s = M.map(i, function (n, e) { return po(n) }), f = D.deepMerge(s, c, { revoke: O.curry(So, o), config: function (n) { var e = Jt(o + "-config", t, n); return { key: o, value: { config: e, me: f, configAsRaw: L(function () { return Yt(o + "-config", t, n) }), initialConfig: n, state: u } } }, schema: function () { return n }, exhibit: function (n, t) { return a(n).bind(function (e) { return lt(r, "exhibit").map(function (n) { return n(t, e.config, e.state) }) }).getOr(bo({})) }, name: function () { return o }, handlers: function (n) { return a(n).bind(function (e) { return lt(r, "events").map(function (n) { return n(e.config, e.state) }) }).getOr({}) } }); return f }, ko = function (n, e) { return Co(n, e, { validate: E.isFunction, label: "function" }) }, Co = function (o, r, i) { if (0 === r.length) throw new Error("You must specify at least one required field."); return le.validateStrArr("required", r), le.checkDupes(r), function (e) { var t = M.keys(e); vn.forall(r, function (n) { return vn.contains(t, n) }) || le.reqMessage(r, t), o(r, t); var n = vn.filter(r, function (n) { return !i.validate(e[n], n) }); return 0 < n.length && le.invalidTypeMessage(n, i.label), e } }, Oo = O.noop, Eo = { exactly: O.curry(ko, function (e, n) { var t = vn.filter(n, function (n) { return !vn.contains(e, n) }); 0 < t.length && le.unsuppMessage(t) }), ensure: O.curry(ko, Oo), ensureWith: O.curry(Co, Oo) }, Do = Eo.ensure(["readState"]), Mo = function () { return Do({ readState: function () { return "No State required" } }) }, Ao = Object.freeze({ init: Mo }), Bo = function (n) { return mt(n) }, Ro = Et([Ft("fields"), Ft("name"), Pt("active", {}), Pt("apis", {}), Pt("extra", {}), Pt("state", Ao)]), Io = function (n) { var e, t, o, r, i, u, a, c, s = Yt("Creating behaviour: " + n.name, Ro, n); return e = s.fields, t = s.name, o = s.active, r = s.apis, i = s.extra, u = s.state, a = Et(e), c = zt(t, [Lt("config", e)]), To(a, c, t, o, r, i, u) }, Fo = Et([Ft("branchKey"), Ft("branches"), Ft("name"), Pt("active", {}), Pt("apis", {}), Pt("extra", {}), Pt("state", Ao)]), No = (O.constant(undefined), O.constant({}), O.constant({}), O.constant({}), O.constant(Ao)); function Vo(n, e, t) { var o = t || !1, r = function () { e(), o = !0 }, i = function () { n(), o = !1 }; return { on: r, off: i, toggle: function () { (o ? i : r)() }, isOn: function () { return o } } } var Ho = function (n, e, t) { if (!(E.isString(t) || E.isBoolean(t) || E.isNumber(t))) throw console.error("Invalid call to Attr.set. Key ", e, ":: Value ", t, ":: Element ", n), new Error("Attribute value was not simple"); n.setAttribute(e, t + "") }, jo = function (n, e, t) { Ho(n.dom(), e, t) }, zo = function (n, e) { var t = n.dom().getAttribute(e); return null === t ? undefined : t }, Lo = function (n, e) { var t = n.dom(); return !(!t || !t.hasAttribute) && t.hasAttribute(e) }, Po = { clone: function (n) { return vn.foldl(n.dom().attributes, function (n, e) { return n[e.name] = e.value, n }, {}) }, set: jo, setAll: function (n, e) { var t = n.dom(); M.each(e, function (n, e) { Ho(t, e, n) }) }, get: zo, has: Lo, remove: function (n, e) { n.dom().removeAttribute(e) }, hasNone: function (n) { var e = n.dom().attributes; return e === undefined || null === e || 0 === e.length }, transfer: function (r, i, n) { ue.isElement(r) && ue.isElement(i) && vn.each(n, function (n) { var e, t, o; t = i, Lo(e = r, o = n) && !Lo(t, o) && jo(t, o, zo(e, o)) }) } }, Wo = function (n, e) { var t = Po.get(n, e); return t === undefined || "" === t ? [] : t.split(" ") }, Uo = Wo, Go = function (n, e, t) { var o = Wo(n, e).concat([t]); Po.set(n, e, o.join(" ")) }, $o = function (n, e, t) { var o = vn.filter(Wo(n, e), function (n) { return n !== t }); 0 < o.length ? Po.set(n, e, o.join(" ")) : Po.remove(n, e) }, qo = function (n) { return Uo(n, "class") }, _o = function (n, e) { return Go(n, "class", e) }, Ko = function (n, e) { return $o(n, "class", e) }, Xo = qo, Yo = _o, Jo = Ko, Qo = function (n, e) { vn.contains(qo(n), e) ? Ko(n, e) : _o(n, e) }, Zo = function (n) { return n.dom().classList !== undefined }, nr = function (n, e) { return Zo(n) && n.dom().classList.contains(e) }, er = { add: function (n, e) { Zo(n) ? n.dom().classList.add(e) : Yo(n, e) }, remove: function (n, e) { var t; Zo(n) ? n.dom().classList.remove(e) : Jo(n, e), 0 === (Zo(t = n) ? t.dom().classList : Xo(t)).length && Po.remove(t, "class") }, toggle: function (n, e) { return Zo(n) ? n.dom().classList.toggle(e) : Qo(n, e) }, toggler: function (n, e) { var t = Zo(n), o = n.dom().classList; return Vo(function () { t ? o.remove(e) : Jo(n, e) }, function () { t ? o.add(e) : Yo(n, e) }, nr(n, e)) }, has: nr }, tr = function (n, e, t) { er.remove(n, t), er.add(n, e) }, or = Object.freeze({ toAlpha: function (n, e, t) { tr(n.element(), e.alpha(), e.omega()) }, toOmega: function (n, e, t) { tr(n.element(), e.omega(), e.alpha()) }, isAlpha: function (n, e, t) { return er.has(n.element(), e.alpha()) }, isOmega: function (n, e, t) { return er.has(n.element(), e.omega()) }, clear: function (n, e, t) { er.remove(n.element(), e.alpha()), er.remove(n.element(), e.omega()) } }), rr = [Ft("alpha"), Ft("omega")], ir = Io({ fields: rr, name: "swapping", apis: or }), ur = function (n) { var e = n, t = function () { return e }; return { get: t, set: function (n) { e = n }, clone: function () { return ur(t()) } } }; function ar(n, e, t, o, r) { return n(t, o) ? y.some(t) : E.isFunction(r) && r(t) ? y.none() : e(t, o, r) } var cr = function (n, e, t) { for (var o = n.dom(), r = E.isFunction(t) ? t : O.constant(!1); o.parentNode;) { o = o.parentNode; var i = Xn.fromDom(o); if (e(i)) return y.some(i); if (r(i)) break } return y.none() }, sr = function (n, e) { return vn.find(n.dom().childNodes, O.compose(e, Xn.fromDom)).map(Xn.fromDom) }, fr = function (n, o) { var r = function (n) { for (var e = 0; e < n.childNodes.length; e++) { if (o(Xn.fromDom(n.childNodes[e]))) return y.some(Xn.fromDom(n.childNodes[e])); var t = r(n.childNodes[e]); if (t.isSome()) return t } return y.none() }; return r(n.dom()) }, lr = { first: function (n) { return fr(se.body(), n) }, ancestor: cr, closest: function (n, e, t) { return ar(function (n) { return e(n) }, cr, n, e, t) }, sibling: function (e, t) { var n = e.dom(); return n.parentNode ? sr(Xn.fromDom(n.parentNode), function (n) { return !Te(e, n) && t(n) }) : y.none() }, child: sr, descendant: fr }, dr = function (n) { n.dom().focus() }, mr = function (n) { var e = n !== undefined ? n.dom() : document; return y.from(e.activeElement).map(Xn.fromDom) }, gr = function (n) { var e = Be.owner(n).dom(); return n.dom() === e.activeElement }, pr = dr, vr = function (n) { n.dom().blur() }, hr = mr, br = function (e) { return mr(Be.owner(e)).filter(function (n) { return e.dom().contains(n.dom()) }) }, yr = tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"), wr = tinymce.util.Tools.resolve("tinymce.ThemeManager"), xr = function (n) { var e = document.createElement("a"); e.target = "_blank", e.href = n.href, e.rel = "noreferrer noopener"; var t = document.createEvent("MouseEvents"); t.initMouseEvent("click", !0, !0, window, 0, 0, 0, 0, 0, !1, !1, !1, !1, 0, null), document.body.appendChild(e), e.dispatchEvent(t), document.body.removeChild(e) }, Sr = { formatChanged: O.constant("formatChanged"), orientationChanged: O.constant("orientationChanged"), dropupDismissed: O.constant("dropupDismissed") }, Tr = function (n, e) { var t = (e || document).createElement("div"); return t.innerHTML = n, Be.children(Xn.fromDom(t)) }, kr = function (n) { return n.dom().innerHTML }, Cr = kr, Or = function (n, e) { var t = Be.owner(n).dom(), o = Xn.fromDom(t.createDocumentFragment()), r = Tr(e, t); Ne.append(o, r), He.empty(n), Fe.append(n, o) }, Er = function (n) { var e = Xn.fromTag("div"), t = Xn.fromDom(n.dom().cloneNode(!0)); return Fe.append(e, t), kr(e) }, Dr = function (n, e) { return Xn.fromDom(n.dom().cloneNode(e)) }, Mr = function (n) { return Dr(n, !1) }, Ar = function (n) { return e = Mr(n), Er(e); var e }, Br = Object.freeze({ events: function (a) { return oo([io(In(), function (r, i) { var n, e, u = a.channels(), t = M.keys(u), o = (n = t, (e = i).universal() ? n : vn.filter(n, function (n) { return vn.contains(e.channels(), n) })); vn.each(o, function (n) { var e = u[n](), t = e.schema(), o = Jt("channel[" + n + "] data\nReceiver: " + Ar(r.element()), t, i.data()); e.onReceive()(r, o) }) })]) } }), Rr = function (n) { for (var e = [], t = function (n) { e.push(n) }, o = 0; o < n.length; o++)n[o].each(t); return e }, Ir = function (n, e) { for (var t = 0; t < n.length; t++) { var o = e(n[t], t); if (o.isSome()) return o } return y.none() }, Fr = "unknown", Nr = [], Vr = ["alloy/data/Fields", "alloy/debugging/Debugging"], Hr = { logEventCut: O.noop, logEventStopped: O.noop, logNoParent: O.noop, logEventNoHandlers: O.noop, logEventResponse: O.noop, write: O.noop }, jr = function (n, e, t) { var o, r = "*" === Nr || vn.contains(Nr, n) ? (o = [], { logEventCut: function (n, e, t) { o.push({ outcome: "cut", target: e, purpose: t }) }, logEventStopped: function (n, e, t) { o.push({ outcome: "stopped", target: e, purpose: t }) }, logNoParent: function (n, e, t) { o.push({ outcome: "no-parent", target: e, purpose: t }) }, logEventNoHandlers: function (n, e) { o.push({ outcome: "no-handlers-left", target: e }) }, logEventResponse: function (n, e, t) { o.push({ outcome: "response", purpose: t, target: e }) }, write: function () { vn.contains(["mousemove", "mouseover", "mouseout", zn()], n) || console.log(n, { event: n, target: e.dom(), sequence: vn.map(o, function (n) { return vn.contains(["cut", "stopped", "response"], n.outcome) ? "{" + n.purpose + "} " + n.outcome + " at (" + Ar(n.target) + ")" : n.outcome }) }) } }) : Hr, i = t(r); return r.write(), i }, zr = (O.constant(Hr), O.constant(!0), O.constant([Ft("menu"), Ft("selectedMenu")])), Lr = O.constant([Ft("item"), Ft("selectedItem")]), Pr = (O.constant(Et(Lr().concat(zr()))), O.constant(Et(Lr()))), Wr = Ht("initSize", [Ft("numColumns"), Ft("numRows")]), Ur = function (n, e, t) { var o; return function () { var n = new Error; if (n.stack !== undefined) { var e = n.stack.split("\n"); vn.find(e, function (e) { return 0 < e.indexOf("alloy") && !vn.exists(Vr, function (n) { return -1 < e.indexOf(n) }) }).getOr(Fr) } }(), It(e, e, t, (o = function (n) { return qe.value(function () { return n.apply(undefined, arguments) }) }, Ot(function (n) { return o(n) }))) }, Gr = function (n) { return Ur(0, n, Xe(O.noop)) }, $r = function (n) { return Ur(0, n, Xe(y.none)) }, qr = function (n) { return Ur(0, n, Ye()) }, _r = function (n) { return Ur(0, n, Ye()) }, Kr = function (n, e) { return Ut(n, O.constant(e)) }, Xr = function (n) { return Ut(n, O.identity) }, Yr = O.constant(Wr), Jr = [Nt("channels", At(qe.value, Et([qr("onReceive"), Pt("schema", no())])))], Qr = Io({ fields: Jr, name: "receiving", active: Br }), Zr = function (n, e) { var t = oi(n, e), o = e.aria(); o.update()(n, o, t) }, ni = function (n, e, t) { er.toggle(n.element(), e.toggleClass()), Zr(n, e) }, ei = function (n, e, t) { er.add(n.element(), e.toggleClass()), Zr(n, e) }, ti = function (n, e, t) { er.remove(n.element(), e.toggleClass()), Zr(n, e) }, oi = function (n, e) { return er.has(n.element(), e.toggleClass()) }, ri = function (n, e, t) { (e.selected() ? ei : ti)(n, e, t) }, ii = Object.freeze({ onLoad: ri, toggle: ni, isOn: oi, on: ei, off: ti }), ui = Object.freeze({ exhibit: function (n, e, t) { return bo({}) }, events: function (n, e) { var t, o, r, i = (t = n, o = e, r = ni, go(function (n) { r(n, t, o) })), u = wo(n, e, ri); return oo(vn.flatten([n.toggleOnExecute() ? [i] : [], [u]])) } }), ai = function (n, e, t) { Po.set(n.element(), "aria-expanded", t) }, ci = [Pt("selected", !1), Ft("toggleClass"), Pt("toggleOnExecute", !0), Wt("aria", { mode: "none" }, Zt("mode", { pressed: [Pt("syncWithExpanded", !1), Kr("update", function (n, e, t) { Po.set(n.element(), "aria-pressed", t), e.syncWithExpanded() && ai(n, e, t) })], checked: [Kr("update", function (n, e, t) { Po.set(n.element(), "aria-checked", t) })], expanded: [Kr("update", ai)], selected: [Kr("update", function (n, e, t) { Po.set(n.element(), "aria-selected", t) })], none: [Kr("update", O.noop)] }))], si = Io({ fields: ci, name: "toggling", active: ui, apis: ii }), fi = function (t, o) { return Qr.config({ channels: dt(Sr.formatChanged(), { onReceive: function (n, e) { e.command === t && o(n, e.state) } }) }) }, li = function (n) { return Qr.config({ channels: dt(Sr.orientationChanged(), { onReceive: n }) }) }, di = function (n, e) { return { key: n, value: { onReceive: e } } }, mi = "tinymce-mobile", gi = { resolve: function (n) { return mi + "-" + n }, prefix: O.constant(mi) }, pi = function (n, e) { e.ignore() || (pr(n.element()), e.onFocus()(n)) }, vi = Object.freeze({ focus: pi, blur: function (n, e) { e.ignore() || vr(n.element()) }, isFocused: function (n) { return gr(n.element()) } }), hi = Object.freeze({ exhibit: function (n, e) { return e.ignore() ? bo({}) : bo({ attributes: { tabindex: "-1" } }) }, events: function (t) { return oo([io(Bn(), function (n, e) { pi(n, t), e.stop() })]) } }), bi = [Gr("onFocus"), Pt("ignore", !1)], yi = Io({ fields: bi, name: "focusing", active: hi, apis: vi }), wi = { isSupported: function (n) { return n.style !== undefined } }, xi = function (n, e, t) { if (!E.isString(t)) throw console.error("Invalid call to CSS.set. Property ", e, ":: Value ", t, ":: Element ", n), new Error("CSS value must be a string: " + t); wi.isSupported(n) && n.style.setProperty(e, t) }, Si = function (n, e) { wi.isSupported(n) && n.style.removeProperty(e) }, Ti = function (n, e, t) { var o = n.dom(); xi(o, e, t) }, ki = function (n, e) { return wi.isSupported(n) ? n.style.getPropertyValue(e) : "" }, Ci = function (n, e) { var t = n.dom(), o = ki(t, e); return y.from(o).filter(function (n) { return 0 < n.length }) }, Oi = { copy: function (n, e) { var t = n.dom(), o = e.dom(); wi.isSupported(t) && wi.isSupported(o) && (o.style.cssText = t.style.cssText) }, set: Ti, preserve: function (n, e) { var t = Po.get(n, "style"), o = e(n); return (t === undefined ? Po.remove : Po.set)(n, "style", t), o }, setAll: function (n, e) { var t = n.dom(); M.each(e, function (n, e) { xi(t, e, n) }) }, setOptions: function (n, e) { var t = n.dom(); M.each(e, function (n, e) { n.fold(function () { Si(t, e) }, function (n) { xi(t, e, n) }) }) }, remove: function (n, e) { var t = n.dom(); Si(t, e), Po.has(n, "style") && "" === Sn(Po.get(n, "style")) && Po.remove(n, "style") }, get: function (n, e) { var t = n.dom(), o = window.getComputedStyle(t).getPropertyValue(e), r = "" !== o || se.inBody(n) ? o : ki(t, e); return null === r ? undefined : r }, getRaw: Ci, getAllRaw: function (n) { var e = {}, t = n.dom(); if (wi.isSupported(t)) for (var o = 0; o < t.style.length; o++) { var r = t.style.item(o); e[r] = t.style[r] } return e }, isValidValue: function (n, e, t) { var o = Xn.fromTag(n); return Ti(o, e, t), Ci(o, e).isSome() }, reflow: function (n) { return n.dom().offsetWidth }, transfer: function (o, r, n) { ue.isElement(o) && ue.isElement(r) && vn.each(n, function (n) { var e, t; e = r, Ci(o, t = n).each(function (n) { Ci(e, t).isNone() && Ti(e, t, n) }) }) } }; function Ei(o, r) { var n = function (n) { var e = r(n); if (e <= 0 || null === e) { var t = Oi.get(n, o); return parseFloat(t) || 0 } return e }, i = function (r, n) { return vn.foldl(n, function (n, e) { var t = Oi.get(r, e), o = t === undefined ? 0 : parseInt(t, 10); return isNaN(o) ? n : n + o }, 0) }; return { set: function (n, e) { if (!E.isNumber(e) && !e.match(/^[0-9]+$/)) throw o + ".set accepts only positive integer values. Value was " + e; var t = n.dom(); wi.isSupported(t) && (t.style[o] = e + "px") }, get: n, getOuter: n, aggregate: i, max: function (n, e, t) { var o = i(n, t); return o < e ? e - o : 0 } } } var Di, Mi, Ai = Ei("height", function (n) { return se.inBody(n) ? n.dom().getBoundingClientRect().height : n.dom().offsetHeight }), Bi = function (n) { return Ai.get(n) }, Ri = function (n, e, t) { return vn.filter(Be.parents(n, t), e) }, Ii = function (n, e) { return vn.filter(Be.siblings(n), e) }, Fi = function (n) { return xe.all(n) }, Ni = function (n, e, t) { return Ri(n, function (n) { return xe.is(n, e) }, t) }, Vi = function (n, e) { return Ii(n, function (n) { return xe.is(n, e) }) }, Hi = function (n, e) { return xe.all(e, n) }, ji = function (n, e, t) { return lr.ancestor(n, function (n) { return xe.is(n, e) }, t) }, zi = function (n) { return xe.one(n) }, Li = ji, Pi = function (n, e) { return xe.one(e, n) }, Wi = function (n, e, t) { return ar(xe.is, ji, n, e, t) }, Ui = { BACKSPACE: O.constant([8]), TAB: O.constant([9]), ENTER: O.constant([13]), SHIFT: O.constant([16]), CTRL: O.constant([17]), ALT: O.constant([18]), CAPSLOCK: O.constant([20]), ESCAPE: O.constant([27]), SPACE: O.constant([32]), PAGEUP: O.constant([33]), PAGEDOWN: O.constant([34]), END: O.constant([35]), HOME: O.constant([36]), LEFT: O.constant([37]), UP: O.constant([38]), RIGHT: O.constant([39]), DOWN: O.constant([40]), INSERT: O.constant([45]), DEL: O.constant([46]), META: O.constant([91, 93, 224]), F10: O.constant([121]) }, Gi = function (n, e, t) { var o = vn.reverse(n.slice(0, e)), r = vn.reverse(n.slice(e + 1)); return vn.find(o.concat(r), t) }, $i = function (n, e, t) { var o = vn.reverse(n.slice(0, e)); return vn.find(o, t) }, qi = function (n, e, t) { var o = n.slice(0, e), r = n.slice(e + 1); return vn.find(r.concat(o), t) }, _i = function (n, e, t) { var o = n.slice(e + 1); return vn.find(o, t) }, Ki = function (e) { return function (n) { return vn.contains(e, n.raw().which) } }, Xi = function (n) { return function (e) { return vn.forall(n, function (n) { return n(e) }) } }, Yi = function (n) { return !0 === n.raw().shiftKey }, Ji = function (n) { return !0 === n.raw().ctrlKey }, Qi = (O.not(Ji), O.not(Yi)), Zi = function (n, e) { return { matches: n, classification: e } }, nu = function (n, e, t, o) { var r = n + e; return o < r ? t : r < t ? o : r }, eu = function (n, e, t) { return n <= e ? e : t <= n ? t : n }, tu = function (e, t, n) { var o = Hi(e.element(), "." + t.highlightClass()); vn.each(o, function (n) { er.remove(n, t.highlightClass()), e.getSystem().getByDom(n).each(function (n) { t.onDehighlight()(e, n) }) }) }, ou = function (n, e, t, o) { var r = ru(n, e, t, o); tu(n, e), er.add(o.element(), e.highlightClass()), r || e.onHighlight()(n, o) }, ru = function (n, e, t, o) { return er.has(o.element(), e.highlightClass()) }, iu = function (n, e, t, o) { var r = Hi(n.element(), "." + e.itemClass()); return y.from(r[o]).fold(function () { return qe.error("No element found with index " + o) }, n.getSystem().getByDom) }, uu = function (n, e, t) { return Pi(n.element(), "." + e.itemClass()).bind(n.getSystem().getByDom) }, au = function (n, e, t) { var o = Hi(n.element(), "." + e.itemClass()); return (0 < o.length ? y.some(o[o.length - 1]) : y.none()).bind(n.getSystem().getByDom) }, cu = function (t, e, n, o) { var r = Hi(t.element(), "." + e.itemClass()); return vn.findIndex(r, function (n) { return er.has(n, e.highlightClass()) }).bind(function (n) { var e = nu(n, o, 0, r.length - 1); return t.getSystem().getByDom(r[e]) }) }, su = Object.freeze({ dehighlightAll: tu, dehighlight: function (n, e, t, o) { var r = ru(n, e, t, o); er.remove(o.element(), e.highlightClass()), r && e.onDehighlight()(n, o) }, highlight: ou, highlightFirst: function (e, t, o) { uu(e, t, o).each(function (n) { ou(e, t, o, n) }) }, highlightLast: function (e, t, o) { au(e, t, o).each(function (n) { ou(e, t, o, n) }) }, highlightAt: function (e, t, o, n) { iu(e, t, o, n).fold(function (n) { throw new Error(n) }, function (n) { ou(e, t, o, n) }) }, highlightBy: function (e, t, o, n) { var r = Hi(e.element(), "." + t.itemClass()), i = Rr(vn.map(r, function (n) { return e.getSystem().getByDom(n).toOption() })); vn.find(i, n).each(function (n) { ou(e, t, o, n) }) }, isHighlighted: ru, getHighlighted: function (n, e, t) { return Pi(n.element(), "." + e.highlightClass()).bind(n.getSystem().getByDom) }, getFirst: uu, getLast: au, getPrevious: function (n, e, t) { return cu(n, e, 0, -1) }, getNext: function (n, e, t) { return cu(n, e, 0, 1) } }), fu = [Ft("highlightClass"), Ft("itemClass"), Gr("onHighlight"), Gr("onDehighlight")], lu = Io({ fields: fu, name: "highlighting", apis: su }), du = function () { return { get: function (n) { return br(n.element()) }, set: function (n, e) { n.getSystem().triggerFocus(e, n.element()) } } }, mu = function (n, e, a, t, o, i) { var u = function (e, t, o, r) { var n, i, u = a(e, t, o, r); return (n = u, i = t.event(), vn.find(n, function (n) { return n.matches(i) }).map(function (n) { return n.classification })).bind(function (n) { return n(e, t, o, r) }) }, r = { schema: function () { return n.concat([Pt("focusManager", du()), Kr("handler", r), Kr("state", e)]) }, processKey: u, toEvents: function (o, r) { var n = t(o, r), e = oo(i.map(function (t) { return io(Bn(), function (n, e) { t(n, o, r, e), e.stop() }) }).toArray().concat([io(F(), function (n, e) { u(n, e, o, r).each(function (n) { e.stop() }) })])); return D.deepMerge(n, e) }, toApis: o }; return r }, gu = function (n) { var e = [jt("onEscape"), jt("onEnter"), Pt("selector", '[data-alloy-tabstop="true"]'), Pt("firstTabstop", 0), Pt("useTabstopAt", O.constant(!0)), jt("visibilitySelector")].concat([n]), a = function (n, e) { var t = n.visibilitySelector().bind(function (n) { return Wi(e, n) }).getOr(e); return 0 < Bi(t) }, c = function (e, n, t, o, r) { return r(n, t, function (n) { return a(e = o, t = n) && e.useTabstopAt()(t); var e, t }).fold(function () { return o.cyclic() ? y.some(!0) : y.none() }, function (n) { return o.focusManager().set(e, n), y.some(!0) }) }, i = function (e, n, t, o) { var r, i, u = Hi(e.element(), t.selector()); return (r = e, i = t, i.focusManager().get(r).bind(function (n) { return Wi(n, i.selector()) })).bind(function (n) { return vn.findIndex(u, O.curry(Te, n)).bind(function (n) { return c(e, u, n, t, o) }) }) }, t = O.constant([Zi(Xi([Yi, Ki(Ui.TAB())]), function (n, e, t, o) { var r = t.cyclic() ? Gi : $i; return i(n, 0, t, r) }), Zi(Ki(Ui.TAB()), function (n, e, t, o) { var r = t.cyclic() ? qi : _i; return i(n, 0, t, r) }), Zi(Ki(Ui.ESCAPE()), function (e, t, n, o) { return n.onEscape().bind(function (n) { return n(e, t) }) }), Zi(Xi([Qi, Ki(Ui.ENTER())]), function (e, t, n, o) { return n.onEnter().bind(function (n) { return n(e, t) }) })]), o = O.constant({}), r = O.constant({}); return mu(e, Mo, t, o, r, y.some(function (e, t, n) { var o, r, i, u; (o = e, r = t, i = Hi(o.element(), r.selector()), u = vn.filter(i, function (n) { return a(r, n) }), y.from(u[r.firstTabstop()])).each(function (n) { t.focusManager().set(e, n) }) })) }, pu = gu(Ut("cyclic", O.constant(!1))), vu = gu(Ut("cyclic", O.constant(!0))), hu = function (n) { return "input" === ue.name(n) && "radio" !== Po.get(n, "type") || "textarea" === ue.name(n) }, bu = function (n, e, t) { return hu(t) && Ki(Ui.SPACE())(e.event()) ? y.none() : (qn(n, t, Fn()), y.some(!0)) }, yu = [Pt("execute", bu), Pt("useSpace", !1), Pt("useEnter", !0), Pt("useControlEnter", !1), Pt("useDown", !1)], wu = function (n, e, t, o) { return t.execute()(n, e, n.element()) }, xu = O.constant({}), Su = O.constant({}), Tu = mu(yu, Mo, function (n, e, t, o) { var r = t.useSpace() && !hu(n.element()) ? Ui.SPACE() : [], i = t.useEnter() ? Ui.ENTER() : [], u = t.useDown() ? Ui.DOWN() : [], a = r.concat(i).concat(u); return [Zi(Ki(a), wu)].concat(t.useControlEnter() ? [Zi(Xi([Ji, Ki(Ui.ENTER())]), wu)] : []) }, xu, Su, y.none()), ku = function (n) { var t = ur(y.none()); return Do({ readState: O.constant({}), setGridSize: function (n, e) { t.set(y.some({ numRows: O.constant(n), numColumns: O.constant(e) })) }, getNumRows: function () { return t.get().map(function (n) { return n.numRows() }) }, getNumColumns: function () { return t.get().map(function (n) { return n.numColumns() }) } }) }, Cu = Object.freeze({ flatgrid: ku, init: function (n) { return n.state()(n) } }), Ou = function (n) { return "rtl" === Oi.get(n, "direction") ? "rtl" : "ltr" }, Eu = function (e, t) { return function (n) { return "rtl" === Ou(n) ? t : e } }, Du = function (i) { return function (n, e, t, o) { var r = i(n.element()); return Ru(r, n, e, t, o) } }, Mu = function (n, e) { var t = Eu(n, e); return Du(t) }, Au = function (n, e) { var t = Eu(e, n); return Du(t) }, Bu = function (r) { return function (n, e, t, o) { return Ru(r, n, e, t, o) } }, Ru = function (e, t, n, o, r) { return o.focusManager().get(t).bind(function (n) { return e(t.element(), n, o, r) }).map(function (n) { return o.focusManager().set(t, n), !0 }) }, Iu = Bu, Fu = Bu, Nu = Bu, Vu = function (n) { var e, t = n.dom(); return !((e = t).offsetWidth <= 0 && e.offsetHeight <= 0) }, Hu = de.immutableBag(["index", "candidates"], []), ju = function (n, e, t) { return zu(n, e, t, Vu) }, zu = function (n, e, t, o) { var r, i, u = O.curry(Te, e), a = Hi(n, t), c = vn.filter(a, Vu); return r = c, i = u, vn.findIndex(r, i).map(function (n) { return Hu({ index: n, candidates: r }) }) }, Lu = function (n, e) { return vn.findIndex(n, function (n) { return Te(e, n) }) }, Pu = function (t, n, o, e) { return e(Math.floor(n / o), n % o).bind(function (n) { var e = n.row() * o + n.column(); return 0 <= e && e < t.length ? y.some(t[e]) : y.none() }) }, Wu = function (r, n, i, u, a) { return Pu(r, n, u, function (n, e) { var t = n === i - 1 ? r.length - n * u : u, o = nu(e, a, 0, t - 1); return y.some({ row: O.constant(n), column: O.constant(o) }) }) }, Uu = function (i, n, u, a, c) { return Pu(i, n, a, function (n, e) { var t = nu(n, c, 0, u - 1), o = t === u - 1 ? i.length - t * a : a, r = eu(e, 0, o - 1); return y.some({ row: O.constant(t), column: O.constant(r) }) }) }, Gu = [Ft("selector"), Pt("execute", bu), $r("onEscape"), Pt("captureTab", !1), Yr()], $u = function (r) { return function (n, e, t, o) { return ju(n, e, t.selector()).bind(function (n) { return r(n.candidates(), n.index(), o.getNumRows().getOr(t.initSize().numRows()), o.getNumColumns().getOr(t.initSize().numColumns())) }) } }, qu = function (n, e, t, o) { return t.captureTab() ? y.some(!0) : y.none() }, _u = $u(function (n, e, t, o) { return Wu(n, e, t, o, -1) }), Ku = $u(function (n, e, t, o) { return Wu(n, e, t, o, 1) }), Xu = $u(function (n, e, t, o) { return Uu(n, e, t, o, -1) }), Yu = $u(function (n, e, t, o) { return Uu(n, e, t, o, 1) }), Ju = O.constant([Zi(Ki(Ui.LEFT()), Mu(_u, Ku)), Zi(Ki(Ui.RIGHT()), Au(_u, Ku)), Zi(Ki(Ui.UP()), Iu(Xu)), Zi(Ki(Ui.DOWN()), Fu(Yu)), Zi(Xi([Yi, Ki(Ui.TAB())]), qu), Zi(Xi([Qi, Ki(Ui.TAB())]), qu), Zi(Ki(Ui.ESCAPE()), function (n, e, t, o) { return t.onEscape()(n, e) }), Zi(Ki(Ui.SPACE().concat(Ui.ENTER())), function (e, t, o, n) { return (r = e, i = o, i.focusManager().get(r).bind(function (n) { return Wi(n, i.selector()) })).bind(function (n) { return o.execute()(e, t, n) }); var r, i })]), Qu = O.constant({}), Zu = mu(Gu, ku, Ju, Qu, {}, y.some(function (e, t, n) { Pi(e.element(), t.selector()).each(function (n) { t.focusManager().set(e, n) }) })), na = function (n, e, t, r) { return ju(n, t, e).bind(function (n) { var e = n.index(), t = n.candidates(), o = nu(e, r, 0, t.length - 1); return y.from(t[o]) }) }, ea = [Ft("selector"), Pt("getInitial", y.none), Pt("execute", bu), Pt("executeOnMove", !1)], ta = function (e, t, o) { return (n = e, r = o, r.focusManager().get(n).bind(function (n) { return Wi(n, r.selector()) })).bind(function (n) { return o.execute()(e, t, n) }); var n, r }, oa = function (n, e, t) { return na(n, t.selector(), e, -1) }, ra = function (n, e, t) { return na(n, t.selector(), e, 1) }, ia = function (o) { return function (n, e, t) { return o(n, e, t).bind(function () { return t.executeOnMove() ? ta(n, e, t) : y.some(!0) }) } }, ua = O.constant({}), aa = O.constant({}), ca = mu(ea, Mo, function (n) { return [Zi(Ki(Ui.LEFT().concat(Ui.UP())), ia(Mu(oa, ra))), Zi(Ki(Ui.RIGHT().concat(Ui.DOWN())), ia(Au(oa, ra))), Zi(Ki(Ui.ENTER()), ta), Zi(Ki(Ui.SPACE()), ta)] }, ua, aa, y.some(function (e, t) { t.getInitial()(e).or(Pi(e.element(), t.selector())).each(function (n) { t.focusManager().set(e, n) }) })), sa = de.immutableBag(["rowIndex", "columnIndex", "cell"], []), fa = function (n, e, t) { return y.from(n[e]).bind(function (n) { return y.from(n[t]).map(function (n) { return sa({ rowIndex: e, columnIndex: t, cell: n }) }) }) }, la = function (n, e, t, o) { var r = n[e].length, i = nu(t, o, 0, r - 1); return fa(n, e, i) }, da = function (n, e, t, o) { var r = nu(t, o, 0, n.length - 1), i = n[r].length, u = eu(e, 0, i - 1); return fa(n, r, u) }, ma = function (n, e, t, o) { var r = n[e].length, i = eu(t + o, 0, r - 1); return fa(n, e, i) }, ga = function (n, e, t, o) { var r = eu(t + o, 0, n.length - 1), i = n[r].length, u = eu(e, 0, i - 1); return fa(n, r, u) }, pa = [Ht("selectors", [Ft("row"), Ft("cell")]), Pt("cycles", !0), Pt("previousSelector", y.none), Pt("execute", bu)], va = function (n, e) { return function (t, o, u) { var a = u.cycles() ? n : e; return Wi(o, u.selectors().row()).bind(function (n) { var e = Hi(n, u.selectors().cell()); return Lu(e, o).bind(function (r) { var i = Hi(t, u.selectors().row()); return Lu(i, n).bind(function (n) { var e, t, o = (e = i, t = u, vn.map(e, function (n) { return Hi(n, t.selectors().cell()) })); return a(o, n, r).map(function (n) { return n.cell() }) }) }) }) } }, ha = va(function (n, e, t) { return la(n, e, t, -1) }, function (n, e, t) { return ma(n, e, t, -1) }), ba = va(function (n, e, t) { return la(n, e, t, 1) }, function (n, e, t) { return ma(n, e, t, 1) }), ya = va(function (n, e, t) { return da(n, t, e, -1) }, function (n, e, t) { return ga(n, t, e, -1) }), wa = va(function (n, e, t) { return da(n, t, e, 1) }, function (n, e, t) { return ga(n, t, e, 1) }), xa = O.constant([Zi(Ki(Ui.LEFT()), Mu(ha, ba)), Zi(Ki(Ui.RIGHT()), Au(ha, ba)), Zi(Ki(Ui.UP()), Iu(ya)), Zi(Ki(Ui.DOWN()), Fu(wa)), Zi(Ki(Ui.SPACE().concat(Ui.ENTER())), function (e, t, o) { return br(e.element()).bind(function (n) { return o.execute()(e, t, n) }) })]), Sa = O.constant({}), Ta = O.constant({}), ka = mu(pa, Mo, xa, Sa, Ta, y.some(function (e, t) { t.previousSelector()(e).orThunk(function () { var n = t.selectors(); return Pi(e.element(), n.cell()) }).each(function (n) { t.focusManager().set(e, n) }) })), Ca = [Ft("selector"), Pt("execute", bu), Pt("moveOnTab", !1)], Oa = function (e, t, o) { return o.focusManager().get(e).bind(function (n) { return o.execute()(e, t, n) }) }, Ea = function (n, e, t) { return na(n, t.selector(), e, -1) }, Da = function (n, e, t) { return na(n, t.selector(), e, 1) }, Ma = O.constant([Zi(Ki(Ui.UP()), Nu(Ea)), Zi(Ki(Ui.DOWN()), Nu(Da)), Zi(Xi([Yi, Ki(Ui.TAB())]), function (n, e, t) { return t.moveOnTab() ? Nu(Ea)(n, e, t) : y.none() }), Zi(Xi([Qi, Ki(Ui.TAB())]), function (n, e, t) { return t.moveOnTab() ? Nu(Da)(n, e, t) : y.none() }), Zi(Ki(Ui.ENTER()), Oa), Zi(Ki(Ui.SPACE()), Oa)]), Aa = O.constant({}), Ba = O.constant({}), Ra = mu(Ca, Mo, Ma, Aa, Ba, y.some(function (e, t, n) { Pi(e.element(), t.selector()).each(function (n) { t.focusManager().set(e, n) }) })), Ia = [$r("onSpace"), $r("onEnter"), $r("onShiftEnter"), $r("onLeft"), $r("onRight"), $r("onTab"), $r("onShiftTab"), $r("onUp"), $r("onDown"), $r("onEscape"), jt("focusIn")], Fa = O.constant({}), Na = O.constant({}), Va = mu(Ia, Mo, function (n, e, t) { return [Zi(Ki(Ui.SPACE()), t.onSpace()), Zi(Xi([Qi, Ki(Ui.ENTER())]), t.onEnter()), Zi(Xi([Yi, Ki(Ui.ENTER())]), t.onShiftEnter()), Zi(Xi([Yi, Ki(Ui.TAB())]), t.onShiftTab()), Zi(Xi([Qi, Ki(Ui.TAB())]), t.onTab()), Zi(Ki(Ui.UP()), t.onUp()), Zi(Ki(Ui.DOWN()), t.onDown()), Zi(Ki(Ui.LEFT()), t.onLeft()), Zi(Ki(Ui.RIGHT()), t.onRight()), Zi(Ki(Ui.SPACE()), t.onSpace()), Zi(Ki(Ui.ESCAPE()), t.onEscape())] }, Fa, Na, y.some(function (e, t) { return t.focusIn().bind(function (n) { return n(e, t) }) })), Ha = { acyclic: pu.schema(), cyclic: vu.schema(), flow: ca.schema(), flatgrid: Zu.schema(), matrix: ka.schema(), execution: Tu.schema(), menu: Ra.schema(), special: Va.schema() }, ja = (Mi = Yt("Creating behaviour: " + (Di = { branchKey: "mode", branches: Ha, name: "keying", active: { events: function (n, e) { return n.handler().toEvents(n, e) } }, apis: { focusIn: function (n) { n.getSystem().triggerFocus(n.element(), n.element()) }, setGridSize: function (n, e, t, o, r) { pt(t, "setGridSize") ? t.setGridSize(o, r) : console.error("Layout does not support setGridSize") } }, state: Cu }).name, Fo, Di), xo(Zt(Mi.branchKey, Mi.branches), Mi.name, Mi.active, Mi.apis, Mi.extra, Mi.state)), za = function (o, n) { return e = o, t = {}, r = vn.map(n, function (n) { return e = n.name(), t = "Cannot configure " + n.name() + " for " + o, It(e, e, Je(), Ot(function (n) { return qe.error("The field: " + e + " is forbidden. " + t) })); var e, t }).concat([Ut("dump", O.identity)]), It(e, e, Xe(t), Dt(r)); var e, t, r }, La = function (n) { return n.dump() }, Pa = "placeholder", Wa = _e([{ single: ["required", "valueThunk"] }, { multiple: ["required", "valueThunks"] }]), Ua = function (n, e, t, o) { return t.uiType === Pa ? (i = t, u = o, (r = n).exists(function (n) { return n !== i.owner }) ? Wa.single(!0, O.constant(i)) : lt(u, i.name).fold(function () { throw new Error("Unknown placeholder component: " + i.name + "\nKnown: [" + M.keys(u) + "]\nNamespace: " + r.getOr("none") + "\nSpec: " + yt(i, null, 2)) }, function (n) { return n.replace() })) : Wa.single(!1, O.constant(t)); var r, i, u }, Ga = function (i, u, a, c) { return Ua(i, 0, a, c).fold(function (n, e) { var t = e(u, a.config, a.validated), o = lt(t, "components").getOr([]), r = vn.bind(o, function (n) { return Ga(i, u, n, c) }); return [D.deepMerge(t, { components: r })] }, function (n, e) { return e(u, a.config, a.validated) }) }, $a = function (e, t, n, o) { var r, i, u, a, c = M.map(o, function (n, e) { return t = e, o = n, r = !1, { name: O.constant(t), required: function () { return o.fold(function (n, e) { return n }, function (n, e) { return n }) }, used: function () { return r }, replace: function () { if (!0 === r) throw new Error("Trying to use the same placeholder more than once: " + t); return r = !0, o } }; var t, o, r }), s = (r = e, i = t, u = n, a = c, vn.bind(u, function (n) { return Ga(r, i, n, a) })); return M.each(c, function (n) { if (!1 === n.used() && n.required()) throw new Error("Placeholder: " + n.name() + " was not found in components list\nNamespace: " + e.getOr("none") + "\nComponents: " + yt(t.components(), null, 2)) }), s }, qa = Wa.single, _a = Wa.multiple, Ka = O.constant(Pa), Xa = 0, Ya = function (n) { var e = (new Date).getTime(); return n + "_" + Math.floor(1e9 * Math.random()) + ++Xa + String(e) }, Ja = _e([{ required: ["data"] }, { external: ["data"] }, { optional: ["data"] }, { group: ["data"] }]), Qa = Pt("factory", { sketch: O.identity }), Za = Pt("schema", []), nc = Ft("name"), ec = It("pname", "pname", Qe(function (n) { return "<alloy." + Ya(n.name) + ">" }), no()), tc = Pt("defaults", O.constant({})), oc = Pt("overrides", O.constant({})), rc = Dt([Qa, Za, nc, ec, tc, oc]), ic = Dt([Qa, Za, nc, tc, oc]), uc = Dt([Qa, Za, nc, ec, tc, oc]), ac = Dt([Qa, Za, nc, Ft("unit"), ec, tc, oc]), cc = function (n) { var e = function (n) { return n.name() }; return n.fold(e, e, e, e) }, sc = function (t, o) { return function (n) { var e = Jt("Converting part type", o, n); return t(e) } }, fc = sc(Ja.required, rc), lc = (sc(Ja.external, ic), sc(Ja.optional, uc)), dc = sc(Ja.group, ac), mc = O.constant("entirety"), gc = function (n, e, t, o) { var r = t; return D.deepMerge(e.defaults()(n, t, o), t, { uid: n.partUids()[e.name()] }, e.overrides()(n, t, o), { "debug.sketcher": dt("part-" + e.name(), r) }) }, pc = function (r, n) { var i = {}; return vn.each(n, function (n) { var e; (e = n, e.fold(y.some, y.none, y.some, y.some)).each(function (t) { var o = vc(r, t.pname()); i[t.name()] = function (n) { var e = Yt("Part: " + t.name() + " in " + r, Dt(t.schema()), n); return D.deepMerge(o, { config: n, validated: e }) } }) }), i }, vc = function (n, e) { return { uiType: Ka(), owner: n, name: e } }, hc = function (n, e, t) { return o = e, r = t, i = {}, u = {}, vn.each(r, function (n) { n.fold(function (o) { i[o.pname()] = qa(!0, function (n, e, t) { return o.factory().sketch(gc(n, o, e, t)) }) }, function (n) { var e = o.parts()[n.name()](); u[n.name()] = O.constant(gc(o, n, e[mc()]())) }, function (o) { i[o.pname()] = qa(!1, function (n, e, t) { return o.factory().sketch(gc(n, o, e, t)) }) }, function (r) { i[r.pname()] = _a(!0, function (e, n, t) { var o = e[r.name()](); return vn.map(o, function (n) { return r.factory().sketch(D.deepMerge(r.defaults()(e, n), n, r.overrides()(e, n))) }) }) }) }), { internals: O.constant(i), externals: O.constant(u) }; var o, r, i, u }, bc = function (n, e, t) { return $a(y.some(n), e, e.components(), t) }, yc = function (n, e, t) { var o = e.partUids()[t]; return n.getSystem().getByUid(o).toOption() }, wc = function (n, e, t) { return yc(n, e, t).getOrDie("Could not find part: " + t) }, xc = function (e, n) { var t, o = (t = n, vn.map(t, cc)); return mt(vn.map(o, function (n) { return { key: n, value: e + "-" + n } })) }, Sc = function (e) { return It("partUids", "partUids", Ze(function (n) { return xc(n.uid, e) }), no()) }, Tc = Ya("alloy-premade"), kc = Ya("api"), Cc = function (n) { return dt(Tc, n) }, Oc = function (o) { return function (n) { var e = Array.prototype.slice.call(arguments, 0), t = n.config(kc); return o.apply(undefined, [t].concat(e)) } }, Ec = O.constant(kc), Dc = O.constant("alloy-id-"), Mc = O.constant("data-alloy-id"), Ac = Dc(), Bc = Mc(), Rc = function (n, e) { var t = Ya(Ac + n); return Po.set(e, Bc, t), t }, Ic = function (n) { var e = ue.isElement(n) ? Po.get(n, Bc) : null; return y.from(e) }, Fc = function (n) { return Ya(n) }, Nc = (O.constant(Bc), function (n, e, t, o, r) { var i, u, a = (u = r, (0 < (i = o).length ? [Ht("parts", i)] : []).concat([Ft("uid"), Pt("dom", {}), Pt("components", []), Xr("originalSpec"), Pt("debug.sketcher", {})]).concat(u)); return Jt(n + " [SpecSchema]", Et(a.concat(e)), t) }), Vc = function (n, e, t, o, r) { var i, u = Hc(r), a = (i = t, vn.bind(i, function (n) { return n.fold(y.none, y.some, y.none, y.none).map(function (n) { return Ht(n.name(), n.schema().concat([Xr(mc())])) }).toArray() })), c = Sc(t), s = Nc(n, e, u, a, [c]), f = hc(0, s, t), l = bc(n, s, f.internals()); return D.deepMerge(o(s, l, u, f.externals()), { "debug.sketcher": dt(n, r) }) }, Hc = function (n) { return D.deepMerge({ uid: Fc("uid") }, n) }, jc = Et([Ft("name"), Ft("factory"), Ft("configFields"), Pt("apis", {}), Pt("extraApis", {})]), zc = Et([Ft("name"), Ft("factory"), Ft("configFields"), Ft("partFields"), Pt("apis", {}), Pt("extraApis", {})]), Lc = function (n) { var a = Yt("Sketcher for " + n.name, jc, n), e = M.map(a.apis, Oc), t = M.map(a.extraApis, function (n, e) { return po(n) }); return D.deepMerge({ name: O.constant(a.name), partFields: O.constant([]), configFields: O.constant(a.configFields), sketch: function (n) { return e = a.name, t = a.configFields, o = a.factory, i = Hc(r = n), u = Nc(e, t, i, [], []), D.deepMerge(o(u, i), { "debug.sketcher": dt(e, r) }); var e, t, o, r, i, u } }, e, t) }, Pc = function (n) { var e = Yt("Sketcher for " + n.name, zc, n), t = pc(e.name, e.partFields), o = M.map(e.apis, Oc), r = M.map(e.extraApis, function (n, e) { return po(n) }); return D.deepMerge({ name: O.constant(e.name), partFields: O.constant(e.partFields), configFields: O.constant(e.configFields), sketch: function (n) { return Vc(e.name, e.configFields, e.partFields, e.factory, n) }, parts: O.constant(t) }, o, r) }, Wc = Lc({ name: "Button", factory: function (n, e) { var t, o, r, i = (t = n.action(), o = function (n, e) { e.stop(), $n(n) }, r = Mn.detect().deviceType.isTouch() ? [io(Vn(), o)] : [io(H(), o), io(A(), function (n, e) { e.cut() })], oo(vn.flatten([t.map(function (t) { return io(Fn(), function (n, e) { t(n), e.stop() }) }).toArray(), r]))), u = lt(n.dom(), "attributes").bind(st("type")), a = lt(n.dom(), "tag"); return { uid: n.uid(), dom: n.dom(), components: n.components(), events: i, behaviours: D.deepMerge(Bo([yi.config({}), ja.config({ mode: "execution", useSpace: !0, useEnter: !0 })]), La(n.buttonBehaviours())), domModification: { attributes: D.deepMerge(u.fold(function () { return a.is("button") ? { type: "button" } : {} }, function (n) { return {} }), { role: n.role().getOr("button") }) }, eventOrder: n.eventOrder() } }, configFields: [Pt("uid", undefined), Ft("dom"), Pt("components", []), za("buttonBehaviours", [yi, ja]), jt("action"), jt("role"), Pt("eventOrder", {})] }), Uc = Object.freeze({ events: function (n) { return oo([ro(z(), O.constant(!0))]) }, exhibit: function (n, e) { return bo({ styles: { "-webkit-user-select": "none", "user-select": "none", "-ms-user-select": "none", "-moz-user-select": "-moz-none" }, attributes: { unselectable: "on" } }) } }), Gc = Io({ fields: [], name: "unselecting", active: Uc }), $c = function (n) { var e, t, o, r = Xn.fromHtml(n), i = Be.children(r), u = (t = (e = r).dom().attributes !== undefined ? e.dom().attributes : [], vn.foldl(t, function (n, e) { return "class" === e.name ? n : D.deepMerge(n, dt(e.name, e.value)) }, {})), a = (o = r, Array.prototype.slice.call(o.dom().classList, 0)), c = 0 === i.length ? {} : { innerHtml: Cr(r) }; return D.deepMerge({ tag: ue.name(r), classes: a, attributes: u }, c) }, qc = function (n) { var e = wn(n, { prefix: gi.prefix() }); return $c(e) }, _c = function (n) { return { dom: qc(n) } }, Kc = function (n) { return Bo([si.config({ toggleClass: gi.resolve("toolbar-button-selected"), toggleOnExecute: !1, aria: { mode: "pressed" } }), fi(n, function (n, e) { (e ? si.on : si.off)(n) })]) }, Xc = function (n, e, t) { return Wc.sketch({ dom: qc('<span class="${prefix}-toolbar-button ${prefix}-icon-' + n + ' ${prefix}-icon"></span>'), action: e, buttonBehaviours: D.deepMerge(Bo([Gc.config({})]), t) }) }, Yc = { forToolbar: Xc, forToolbarCommand: function (n, e) { return Xc(e, function () { n.execCommand(e) }, {}) }, forToolbarStateAction: function (n, e, t, o) { var r = Kc(t); return Xc(e, o, r) }, forToolbarStateCommand: function (n, e) { var t = Kc(e); return Xc(e, function () { n.execCommand(e) }, t) } }, Jc = function (n, e, t) { return Math.max(e, Math.min(t, n)) }, Qc = function (n, e, t, o, r, i, u) { var a = t - e; if (o < n.left) return e - 1; if (o > n.right) return t + 1; var c, s, f, l, d = Math.min(n.right, Math.max(o, n.left)) - n.left, m = Jc(d / n.width * a + e, e - 1, t + 1), g = Math.round(m); return i && e <= m && m <= t ? (c = m, s = e, f = t, l = r, u.fold(function () { var n = c - s, e = Math.round(n / l) * l; return Jc(s + e, s - 1, f + 1) }, function (n) { var e = (c - n) % l, t = Math.round(e / l), o = Math.floor((c - n) / l), r = Math.floor((f - n) / l), i = n + Math.min(r, o + t) * l; return Math.max(n, i) })) : g }, Zc = "slider.change.value", ns = Mn.detect().deviceType.isTouch(), es = function (n) { var e; return (e = n.event().raw(), ns && e.touches !== undefined && 1 === e.touches.length ? y.some(e.touches[0]) : ns && e.touches !== undefined ? y.none() : ns || e.clientX === undefined ? y.none() : y.some(e)).map(function (n) { return n.clientX }) }, ts = function (n, e) { Gn(n, Zc, { value: e }) }, os = function (i, u, a, n) { return es(n).map(function (n) { var e, t, o, r; return e = i, o = n, r = Qc(a, (t = u).min(), t.max(), o, t.stepSize(), t.snapToGrid(), t.snapStart()), ts(e, r), n }) }, rs = function (n, e) { var t, o, r, i, u = (t = e.value().get(), o = e.min(), r = e.max(), i = e.stepSize(), t < o ? t : r < t ? r : t === o ? o - 1 : Math.max(o, t - i)); ts(n, u) }, is = function (n, e) { var t, o, r, i, u = (t = e.value().get(), o = e.min(), r = e.max(), i = e.stepSize(), r < t ? t : t < o ? o : t === r ? r + 1 : Math.min(r, t + i)); ts(n, u) }, us = O.constant(Zc), as = Mn.detect().deviceType.isTouch(), cs = function (n, o) { return lc({ name: n + "-edge", overrides: function (n) { var e = oo([uo(T(), o, [n])]), t = oo([uo(A(), o, [n]), uo(B(), function (n, e) { e.mouseIsDown().get() && o(n, e) }, [n])]); return { events: as ? e : t } } }) }, ss = [cs("left", function (n, e) { ts(n, e.min() - 1) }), cs("right", function (n, e) { ts(n, e.max() + 1) }), fc({ name: "thumb", defaults: O.constant({ dom: { styles: { position: "absolute" } } }), overrides: function (n) { return { events: oo([co(T(), n, "spectrum"), co(k(), n, "spectrum"), co(C(), n, "spectrum")]) } } }), fc({ schema: [Ut("mouseIsDown", function () { return ur(!1) })], name: "spectrum", overrides: function (o) { var t = function (n, e) { var t = n.element().dom().getBoundingClientRect(); os(n, o, t, e) }, n = oo([io(T(), t), io(k(), t)]), e = oo([io(A(), t), io(B(), function (n, e) { o.mouseIsDown().get() && t(n, e) })]); return { behaviours: Bo(as ? [] : [ja.config({ mode: "special", onLeft: function (n) { return rs(n, o), y.some(!0) }, onRight: function (n) { return is(n, o), y.some(!0) } }), yi.config({})]), events: as ? n : e } } })], fs = function (n, e, t) { e.store().manager().onLoad(n, e, t) }, ls = function (n, e, t) { e.store().manager().onUnload(n, e, t) }, ds = Object.freeze({ onLoad: fs, onUnload: ls, setValue: function (n, e, t, o) { e.store().manager().setValue(n, e, t, o) }, getValue: function (n, e, t) { return e.store().manager().getValue(n, e, t) } }), ms = Object.freeze({ events: function (t, o) { var n = t.resetOnDom() ? [fo(function (n, e) { fs(n, t, o) }), lo(function (n, e) { ls(n, t, o) })] : [wo(t, o, fs)]; return oo(n) } }), gs = function () { var n = ur(null); return Do({ set: n.set, get: n.get, isNotSet: function () { return null === n.get() }, clear: function () { n.set(null) }, readState: function () { return { mode: "memory", value: n.get() } } }) }, ps = function () { var n = ur({}); return Do({ readState: function () { return { mode: "dataset", dataset: n.get() } }, set: n.set, get: n.get }) }, vs = Object.freeze({ memory: gs, dataset: ps, manual: function () { return Do({ readState: function () { } }) }, init: function (n) { return n.store().manager().state(n) } }), hs = function (n, e, t, o) { e.store().getDataKey(), t.set({}), e.store().setData()(n, o), e.onSetValue()(n, o) }, bs = [jt("initialValue"), Ft("getFallbackEntry"), Ft("getDataKey"), Ft("setData"), Kr("manager", { setValue: hs, getValue: function (n, e, t) { var o = e.store().getDataKey()(n), r = t.get(); return lt(r, o).fold(function () { return e.store().getFallbackEntry()(o) }, function (n) { return n }) }, onLoad: function (e, t, o) { t.store().initialValue().each(function (n) { hs(e, t, o, n) }) }, onUnload: function (n, e, t) { t.set({}) }, state: ps })], ys = [Ft("getValue"), Pt("setValue", O.noop), jt("initialValue"), Kr("manager", { setValue: function (n, e, t, o) { e.store().setValue()(n, o), e.onSetValue()(n, o) }, getValue: function (n, e, t) { return e.store().getValue()(n) }, onLoad: function (e, t, n) { t.store().initialValue().each(function (n) { t.store().setValue()(e, n) }) }, onUnload: O.noop, state: Mo })], ws = [jt("initialValue"), Kr("manager", { setValue: function (n, e, t, o) { t.set(o), e.onSetValue()(n, o) }, getValue: function (n, e, t) { return t.get() }, onLoad: function (n, e, t) { e.store().initialValue().each(function (n) { t.isNotSet() && t.set(n) }) }, onUnload: function (n, e, t) { t.clear() }, state: gs })], xs = [Wt("store", { mode: "memory" }, Zt("mode", { memory: ws, manual: ys, dataset: bs })), Gr("onSetValue"), Pt("resetOnDom", !1)], Ss = Io({ fields: xs, name: "representing", active: ms, apis: ds, extra: { setValueFrom: function (n, e) { var t = Ss.getValue(e); Ss.setValue(n, t) } }, state: vs }), Ts = Mn.detect().deviceType.isTouch(), ks = [Ft("min"), Ft("max"), Pt("stepSize", 1), Pt("onChange", O.noop), Pt("onInit", O.noop), Pt("onDragStart", O.noop), Pt("onDragEnd", O.noop), Pt("snapToGrid", !1), jt("snapStart"), Ft("getInitialValue"), za("sliderBehaviours", [ja, Ss]), Ut("value", function (n) { return ur(n.min) })].concat(Ts ? [] : [Ut("mouseIsDown", function () { return ur(!1) })]), Cs = Ei("width", function (n) { return n.dom().offsetWidth }), Os = function (n, e) { Cs.set(n, e) }, Es = function (n) { return Cs.get(n) }, Ds = Mn.detect().deviceType.isTouch(), Ms = Pc({ name: "Slider", configFields: ks, partFields: ss, factory: function (c, n, e, t) { var s = c.max() - c.min(), f = function (n) { var e = n.element().dom().getBoundingClientRect(); return (e.left + e.right) / 2 }, r = function (n) { return wc(n, c, "thumb") }, i = function (n) { var e, t, o, r, i = wc(n, c, "spectrum").element().dom().getBoundingClientRect(), u = n.element().dom().getBoundingClientRect(), a = (e = n, t = i, (r = (o = c).value().get()) < o.min() ? yc(e, o, "left-edge").fold(function () { return 0 }, function (n) { return f(n) - t.left }) : r > o.max() ? yc(e, o, "right-edge").fold(function () { return t.width }, function (n) { return f(n) - t.left }) : (o.value().get() - o.min()) / s * t.width); return i.left - u.left + a }, u = function (n) { var e = i(n), t = r(n), o = Es(t.element()) / 2; Oi.set(t.element(), "left", e - o + "px") }, o = function (n, e) { var t = c.value().get(), o = r(n); return t !== e || Oi.getRaw(o.element(), "left").isNone() ? (c.value().set(e), u(n), c.onChange()(n, o, e), y.some(!0)) : y.none() }, a = Ds ? [io(T(), function (n, e) { c.onDragStart()(n, r(n)) }), io(C(), function (n, e) { c.onDragEnd()(n, r(n)) })] : [io(A(), function (n, e) { e.stop(), c.onDragStart()(n, r(n)), c.mouseIsDown().set(!0) }), io(R(), function (n, e) { c.onDragEnd()(n, r(n)), c.mouseIsDown().set(!1) })]; return { uid: c.uid(), dom: c.dom(), components: n, behaviours: D.deepMerge(Bo(vn.flatten([Ds ? [] : [ja.config({ mode: "special", focusIn: function (n) { return yc(n, c, "spectrum").map(ja.focusIn).map(O.constant(!0)) } })], [Ss.config({ store: { mode: "manual", getValue: function (n) { return c.value().get() } } })]])), La(c.sliderBehaviours())), events: oo([io(us(), function (n, e) { o(n, e.event().value()) }), fo(function (n, e) { c.value().set(c.getInitialValue()()); var t = r(n); u(n), c.onInit()(n, t, c.value().get()) })].concat(a)), apis: { resetToMin: function (n) { o(n, c.min()) }, resetToMax: function (n) { o(n, c.max()) }, refresh: u }, domModification: { styles: { position: "relative" } } } }, apis: { resetToMin: function (n, e) { n.resetToMin(e) }, resetToMax: function (n, e) { n.resetToMax(e) }, refresh: function (n, e) { n.refresh(e) } } }), As = function (e, t, o) { return Yc.forToolbar(t, function () { var n = o(); e.setContextToolbar([{ label: t + " group", items: n }]) }, {}) }, Bs = function (n) { return [(r = n, i = function (n) { return n < 0 ? "black" : 360 < n ? "white" : "hsl(" + n + ", 100%, 50%)" }, Ms.sketch({ dom: qc('<div class="${prefix}-slider ${prefix}-hue-slider-container"></div>'), components: [Ms.parts()["left-edge"](_c('<div class="${prefix}-hue-slider-black"></div>')), Ms.parts().spectrum({ dom: qc('<div class="${prefix}-slider-gradient-container"></div>'), components: [_c('<div class="${prefix}-slider-gradient"></div>')], behaviours: Bo([si.config({ toggleClass: gi.resolve("thumb-active") })]) }), Ms.parts()["right-edge"](_c('<div class="${prefix}-hue-slider-white"></div>')), Ms.parts().thumb({ dom: qc('<div class="${prefix}-slider-thumb"></div>'), behaviours: Bo([si.config({ toggleClass: gi.resolve("thumb-active") })]) })], onChange: function (n, e, t) { var o = i(t); Oi.set(e.element(), "background-color", o), r.onChange(n, e, o) }, onDragStart: function (n, e) { si.on(e) }, onDragEnd: function (n, e) { si.off(e) }, onInit: function (n, e, t) { var o = i(t); Oi.set(e.element(), "background-color", o) }, stepSize: 10, min: 0, max: 360, getInitialValue: r.getInitialValue, sliderBehaviours: Bo([li(Ms.refresh)]) }))]; var r, i }, Rs = function (n, o) { var e = { onChange: function (n, e, t) { o.undoManager.transact(function () { o.formatter.apply("forecolor", { value: t }), o.nodeChanged() }) }, getInitialValue: function () { return -1 } }; return As(n, "color", function () { return Bs(e) }) }, Is = Et([Ft("getInitialValue"), Ft("onChange"), Ft("category"), Ft("sizes")]), Fs = function (n) { var r = Yt("SizeSlider", Is, n); return Ms.sketch({ dom: { tag: "div", classes: [gi.resolve("slider-" + r.category + "-size-container"), gi.resolve("slider"), gi.resolve("slider-size-container")] }, onChange: function (n, e, t) { var o; 0 <= (o = t) && o < r.sizes.length && r.onChange(t) }, onDragStart: function (n, e) { si.on(e) }, onDragEnd: function (n, e) { si.off(e) }, min: 0, max: r.sizes.length - 1, stepSize: 1, getInitialValue: r.getInitialValue, snapToGrid: !0, sliderBehaviours: Bo([li(Ms.refresh)]), components: [Ms.parts().spectrum({ dom: qc('<div class="${prefix}-slider-size-container"></div>'), components: [_c('<div class="${prefix}-slider-size-line"></div>')] }), Ms.parts().thumb({ dom: qc('<div class="${prefix}-slider-thumb"></div>'), behaviours: Bo([si.config({ toggleClass: gi.resolve("thumb-active") })]) })] }) }, Ns = function (n, e, t) { for (var o = n.dom(), r = E.isFunction(t) ? t : O.constant(!1); o.parentNode;) { o = o.parentNode; var i = Xn.fromDom(o), u = e(i); if (u.isSome()) return u; if (r(i)) break } return y.none() }, Vs = function (n, e, t) { return e(n).orThunk(function () { return t(n) ? y.none() : Ns(n, e, t) }) }, Hs = ["9px", "10px", "11px", "12px", "14px", "16px", "18px", "20px", "24px", "32px", "36px"], js = function (n) { var e, t, o = n.selection.getStart(), r = Xn.fromDom(o), i = Xn.fromDom(n.getBody()), u = (e = function (n) { return Te(i, n) }, t = r, (ue.isElement(t) ? y.some(t) : Be.parent(t)).map(function (n) { return Vs(n, function (n) { return Oi.getRaw(n, "font-size") }, e).getOrThunk(function () { return Oi.get(n, "font-size") }) }).getOr("")); return vn.find(Hs, function (n) { return u === n }).getOr("medium") }, zs = { candidates: O.constant(Hs), get: function (n) { var e, t = js(n); return (e = t, vn.findIndex(Hs, function (n) { return n === e })).getOr(2) }, apply: function (o, n) { var e; (e = n, y.from(Hs[e])).each(function (n) { var e, t; t = n, js(e = o) !== t && e.execCommand("fontSize", !1, t) }) } }, Ls = zs.candidates(), Ps = function (n) { return [_c('<span class="${prefix}-toolbar-button ${prefix}-icon-small-font ${prefix}-icon"></span>'), (e = n, Fs({ onChange: e.onChange, sizes: Ls, category: "font", getInitialValue: e.getInitialValue })), _c('<span class="${prefix}-toolbar-button ${prefix}-icon-large-font ${prefix}-icon"></span>')]; var e }, Ws = function (n) { var e = n.uid !== undefined && pt(n, "uid") ? n.uid : Fc("memento"); return { get: function (n) { return n.getSystem().getByUid(e).getOrDie() }, getOpt: function (n) { return n.getSystem().getByUid(e).fold(y.none, y.some) }, asSpec: function () { return D.deepMerge(n, { uid: e }) } } }; function Us(n, e) { return $s(document.createElement("canvas"), n, e) } function Gs(n) { return n.getContext("2d") } function $s(n, e, t) { return n.width = e, n.height = t, n } var qs = { create: Us, clone: function (n) { var e; return Gs(e = Us(n.width, n.height)).drawImage(n, 0, 0), e }, resize: $s, get2dContext: Gs, get3dContext: function (n) { var e = null; try { e = n.getContext("webgl") || n.getContext("experimental-webgl") } catch (t) { } return e || (e = null), e } }, _s = { getWidth: function (n) { return n.naturalWidth || n.width }, getHeight: function (n) { return n.naturalHeight || n.height } }, Ks = window.Promise ? window.Promise : function () { var n = function (n) { if ("object" != typeof this) throw new TypeError("Promises must be constructed via new"); if ("function" != typeof n) throw new TypeError("not a function"); this._state = null, this._value = null, this._deferreds = [], s(n, o(r, this), o(u, this)) }, e = n.immediateFn || "function" == typeof setImmediate && setImmediate || function (n) { setTimeout(n, 1) }; function o(n, e) { return function () { n.apply(e, arguments) } } var t = Array.isArray || function (n) { return "[object Array]" === Object.prototype.toString.call(n) }; function i(o) { var r = this; null !== this._state ? e(function () { var n = r._state ? o.onFulfilled : o.onRejected; if (null !== n) { var e; try { e = n(r._value) } catch (t) { return void o.reject(t) } o.resolve(e) } else (r._state ? o.resolve : o.reject)(r._value) }) : this._deferreds.push(o) } function r(n) { try { if (n === this) throw new TypeError("A promise cannot be resolved with itself."); if (n && ("object" == typeof n || "function" == typeof n)) { var e = n.then; if ("function" == typeof e) return void s(o(e, n), o(r, this), o(u, this)) } this._state = !0, this._value = n, a.call(this) } catch (t) { u.call(this, t) } } function u(n) { this._state = !1, this._value = n, a.call(this) } function a() { for (var n = 0, e = this._deferreds.length; n < e; n++)i.call(this, this._deferreds[n]); this._deferreds = null } function c(n, e, t, o) { this.onFulfilled = "function" == typeof n ? n : null, this.onRejected = "function" == typeof e ? e : null, this.resolve = t, this.reject = o } function s(n, e, t) { var o = !1; try { n(function (n) { o || (o = !0, e(n)) }, function (n) { o || (o = !0, t(n)) }) } catch (r) { if (o) return; o = !0, t(r) } } return n.prototype["catch"] = function (n) { return this.then(null, n) }, n.prototype.then = function (t, o) { var r = this; return new n(function (n, e) { i.call(r, new c(t, o, n, e)) }) }, n.all = function () { var c = Array.prototype.slice.call(1 === arguments.length && t(arguments[0]) ? arguments[0] : arguments); return new n(function (r, i) { if (0 === c.length) return r([]); var u = c.length; function a(e, n) { try { if (n && ("object" == typeof n || "function" == typeof n)) { var t = n.then; if ("function" == typeof t) return void t.call(n, function (n) { a(e, n) }, i) } c[e] = n, 0 == --u && r(c) } catch (o) { i(o) } } for (var n = 0; n < c.length; n++)a(n, c[n]) }) }, n.resolve = function (e) { return e && "object" == typeof e && e.constructor === n ? e : new n(function (n) { n(e) }) }, n.reject = function (t) { return new n(function (n, e) { e(t) }) }, n.race = function (r) { return new n(function (n, e) { for (var t = 0, o = r.length; t < o; t++)r[t].then(n, e) }) }, n }(); function Xs() { return new (he.getOrDie("FileReader")) } var Ys = { atob: function (n) { return he.getOrDie("atob")(n) }, requestAnimationFrame: function (n) { he.getOrDie("requestAnimationFrame")(n) } }; function Js(a) { return new Ks(function (n, e) { var t = URL.createObjectURL(a), o = new Image, r = function () { o.removeEventListener("load", i), o.removeEventListener("error", u) }; function i() { r(), n(o) } function u() { r(), e("Unable to load data of type " + a.type + ": " + t) } o.addEventListener("load", i), o.addEventListener("error", u), o.src = t, o.complete && i() }) } function Qs(o) { return new Ks(function (n, t) { var e = new XMLHttpRequest; e.open("GET", o, !0), e.responseType = "blob", e.onload = function () { 200 == this.status && n(this.response) }, e.onerror = function () { var n, e = this; t(0 === this.status ? ((n = new Error("No access to download image")).code = 18, n.name = "SecurityError", n) : new Error("Error " + e.status + " downloading image")) }, e.send() }) } function Zs(n) { var e = n.split(","), t = /data:([^;]+)/.exec(e[0]); if (!t) return y.none(); for (var o, r, i, u = t[1], a = e[1], c = Ys.atob(a), s = c.length, f = Math.ceil(s / 1024), l = new Array(f), d = 0; d < f; ++d) { for (var m = 1024 * d, g = Math.min(m + 1024, s), p = new Array(g - m), v = m, h = 0; v < g; ++h, ++v)p[h] = c[v].charCodeAt(0); l[d] = (o = p, new (he.getOrDie("Uint8Array"))(o)) } return y.some((r = l, i = { type: u }, new (he.getOrDie("Blob"))(r, i))) } function nf(t) { return new Ks(function (n, e) { Zs(t).fold(function () { e("uri is not base64: " + t) }, n) }) } function ef(t) { return new Ks(function (n) { var e = new Xs; e.onloadend = function () { n(e.result) }, e.readAsDataURL(t) }) } var tf, of, rf, uf, af, cf, sf, ff, lf = { blobToImage: Js, imageToBlob: function (n) { var e = n.src; return 0 === e.indexOf("data:") ? nf(e) : Qs(e) }, blobToArrayBuffer: function (t) { return new Ks(function (n) { var e = new Xs; e.onloadend = function () { n(e.result) }, e.readAsArrayBuffer(t) }) }, blobToDataUri: ef, blobToBase64: function (n) { return ef(n).then(function (n) { return n.split(",")[1] }) }, dataUriToBlobSync: Zs, canvasToBlob: function (n, t, o) { return t = t || "image/png", HTMLCanvasElement.prototype.toBlob ? new Ks(function (e) { n.toBlob(function (n) { e(n) }, t, o) }) : nf(n.toDataURL(t, o)) }, canvasToDataURL: function (n, e, t) { return e = e || "image/png", n.then(function (n) { return n.toDataURL(e, t) }) }, blobToCanvas: function (n) { return Js(n).then(function (n) { var e, t; return e = n, URL.revokeObjectURL(e.src), t = qs.create(_s.getWidth(n), _s.getHeight(n)), qs.get2dContext(t).drawImage(n, 0, 0), t }) }, uriToBlob: function (n) { return 0 === n.indexOf("blob:") ? Qs(n) : 0 === n.indexOf("data:") ? nf(n) : null } }, df = function (n) { return lf.blobToBase64(n) }, mf = function (u) { var e = Ws({ dom: { tag: "input", attributes: { accept: "image/*", type: "file", title: "" }, styles: { visibility: "hidden", position: "absolute" } }, events: oo([so(H()), io(V(), function (n, e) { var t, o, r; (t = e, o = t.event(), r = o.raw().target.files || o.raw().dataTransfer.files, y.from(r[0])).each(function (n) { var r, i; r = u, df(i = n).then(function (o) { r.undoManager.transact(function () { var n = r.editorUpload.blobCache, e = n.create(Ya("mceu"), i, o); n.add(e); var t = r.dom.createHTML("img", { src: e.blobUri() }); r.insertContent(t) }) }) }) })]) }); return Wc.sketch({ dom: qc('<span class="${prefix}-toolbar-button ${prefix}-icon-image ${prefix}-icon"></span>'), components: [e.asSpec()], action: function (n) { e.get(n).element().dom().click() } }) }, gf = function (n) { return n.dom().textContent }, pf = function (n, e) { n.dom().textContent = e }, vf = function (n) { return 0 < n.length }, hf = function (n) { return n === undefined || null === n ? "" : n }, bf = function (e, t, n) { return n.text.filter(vf).fold(function () { return Po.get(n = e, "href") === gf(n) ? y.some(t) : y.none(); var n }, y.some) }, yf = function (n) { var e = Xn.fromDom(n.selection.getStart()); return Wi(e, "a") }, wf = { getInfo: function (n) { return yf(n).fold(function () { return { url: "", text: n.selection.getContent({ format: "text" }), title: "", target: "", link: y.none() } }, function (n) { return t = gf(e = n), o = Po.get(e, "href"), r = Po.get(e, "title"), i = Po.get(e, "target"), { url: hf(o), text: t !== o ? hf(t) : "", title: hf(r), target: hf(i), link: y.some(e) }; var e, t, o, r, i }) }, applyInfo: function (r, i) { i.url.filter(vf).fold(function () { var e; e = r, i.link.bind(O.identity).each(function (n) { e.execCommand("unlink") }) }, function (t) { var n, e, o = (n = i, (e = {}).href = t, n.title.filter(vf).each(function (n) { e.title = n }), n.target.filter(vf).each(function (n) { e.target = n }), e); i.link.bind(O.identity).fold(function () { var n = i.text.filter(vf).getOr(t); r.insertContent(r.dom.createHTML("a", o, r.dom.encode(n))) }, function (e) { var n = bf(e, t, i); Po.setAll(e, o), n.each(function (n) { pf(e, n) }) }) }) }, query: yf }, xf = Mn.detect(), Sf = function (n, e) { var t = e.selection.getRng(); n(), e.selection.setRng(t) }, Tf = function (n, e) { (xf.os.isAndroid() ? Sf : O.apply)(e, n) }, kf = function (n, e) { var t, o; return { key: n, value: { config: {}, me: (t = n, o = oo(e), Io({ fields: [Ft("enabled")], name: t, active: { events: O.constant(o) } })), configAsRaw: O.constant({}), initialConfig: {}, state: No() } } }, Cf = Object.freeze({ getCurrent: function (n, e, t) { return e.find()(n) } }), Of = [Ft("find")], Ef = Io({ fields: Of, name: "composing", apis: Cf }), Df = Lc({ name: "Container", factory: function (n, e) { return { uid: n.uid(), dom: D.deepMerge({ tag: "div", attributes: { role: "presentation" } }, n.dom()), components: n.components(), behaviours: La(n.containerBehaviours()), events: n.events(), domModification: n.domModification(), eventOrder: n.eventOrder() } }, configFields: [Pt("components", []), za("containerBehaviours", []), Pt("events", {}), Pt("domModification", {}), Pt("eventOrder", {})] }), Mf = Lc({ name: "DataField", factory: function (t, n) { return { uid: t.uid(), dom: t.dom(), behaviours: D.deepMerge(Bo([Ss.config({ store: { mode: "memory", initialValue: t.getInitialValue()() } }), Ef.config({ find: y.some })]), La(t.dataBehaviours())), events: oo([fo(function (n, e) { Ss.setValue(n, t.getInitialValue()()) })]) } }, configFields: [Ft("uid"), Ft("dom"), Ft("getInitialValue"), za("dataBehaviours", [Ss, Ef])] }), Af = function (n, e) { if (e === undefined) throw new Error("Value.set was undefined"); n.dom().value = e }, Bf = function (n) { return n.dom().value }, Rf = O.constant([jt("data"), Pt("inputAttributes", {}), Pt("inputStyles", {}), Pt("type", "input"), Pt("tag", "input"), Pt("inputClasses", []), Gr("onSetValue"), Pt("styles", {}), jt("placeholder"), Pt("eventOrder", {}), za("inputBehaviours", [Ss, yi]), Pt("selectOnFocus", !0)]), If = Lc({ name: "Input", configFields: Rf(), factory: function (n, e) { return { uid: n.uid(), dom: (o = n, { tag: o.tag(), attributes: D.deepMerge(mt([{ key: "type", value: o.type() }].concat(o.placeholder().map(function (n) { return { key: "placeholder", value: n } }).toArray())), o.inputAttributes()), styles: o.inputStyles(), classes: o.inputClasses() }), components: [], behaviours: (t = n, D.deepMerge(Bo([Ss.config({ store: { mode: "manual", initialValue: t.data().getOr(undefined), getValue: function (n) { return Bf(n.element()) }, setValue: function (n, e) { Bf(n.element()) !== e && Af(n.element(), e) } }, onSetValue: t.onSetValue() }), yi.config({ onFocus: !1 === t.selectOnFocus() ? O.noop : function (n) { var e = n.element(), t = Bf(e); e.dom().setSelectionRange(0, t.length) } })]), La(t.inputBehaviours()))), eventOrder: n.eventOrder() }; var t, o } }), Ff = Object.freeze({ exhibit: function (n, e) { return bo({ attributes: mt([{ key: e.tabAttr(), value: "true" }]) }) } }), Nf = [Pt("tabAttr", "data-alloy-tabstop")], Vf = Io({ fields: Nf, name: "tabstopping", active: Ff }), Hf = function (n, e) { var t = Ws(If.sketch({ placeholder: e, onSetValue: function (n, e) { Un(n, N()) }, inputBehaviours: Bo([Ef.config({ find: y.some }), Vf.config({}), ja.config({ mode: "execution" })]), selectOnFocus: !1 })), o = Ws(Wc.sketch({ dom: qc('<button class="${prefix}-input-container-x ${prefix}-icon-cancel-circle ${prefix}-icon"></button>'), action: function (n) { var e = t.get(n); Ss.setValue(e, "") } })); return { name: n, spec: Df.sketch({ dom: qc('<div class="${prefix}-input-container"></div>'), components: [t.asSpec(), o.asSpec()], containerBehaviours: Bo([si.config({ toggleClass: gi.resolve("input-container-empty") }), Ef.config({ find: function (n) { return y.some(t.get(n)) } }), kf("input-clearing", [io(N(), function (n) { var e = t.get(n); (0 < Ss.getValue(e).length ? si.off : si.on)(n) })])]) }) } }, jf = ["input", "button", "textarea"], zf = function (n, e, t) { e.disabled() && $f(n, e, t) }, Lf = function (n) { return vn.contains(jf, ue.name(n.element())) }, Pf = function (n) { Po.set(n.element(), "disabled", "disabled") }, Wf = function (n) { Po.remove(n.element(), "disabled") }, Uf = function (n) { Po.set(n.element(), "aria-disabled", "true") }, Gf = function (n) { Po.set(n.element(), "aria-disabled", "false") }, $f = function (e, n, t) { n.disableClass().each(function (n) { er.add(e.element(), n) }), (Lf(e) ? Pf : Uf)(e) }, qf = function (n) { return Lf(n) ? Po.has(n.element(), "disabled") : "true" === Po.get(n.element(), "aria-disabled") }, _f = Object.freeze({ enable: function (e, n, t) { n.disableClass().each(function (n) { er.remove(e.element(), n) }), (Lf(e) ? Wf : Gf)(e) }, disable: $f, isDisabled: qf, onLoad: zf }), Kf = Object.freeze({ exhibit: function (n, e, t) { return bo({ classes: e.disabled() ? e.disableClass().map(vn.pure).getOr([]) : [] }) }, events: function (n, e) { return oo([ro(Fn(), function (n, e) { return qf(n) }), wo(n, e, zf)]) } }), Xf = [Pt("disabled", !1), jt("disableClass")], Yf = Io({ fields: Xf, name: "disabling", active: Kf, apis: _f }), Jf = [za("formBehaviours", [Ss])], Qf = function (n) { return "<alloy.field." + n + ">" }, Zf = function (r, n, e) { return D.deepMerge({ "debug.sketcher": { Form: e }, uid: r.uid(), dom: r.dom(), components: n, behaviours: D.deepMerge(Bo([Ss.config({ store: { mode: "manual", getValue: function (n) { var e, t, o = (e = r, t = n.getSystem(), M.map(e.partUids(), function (n, e) { return O.constant(t.getByUid(n)) })); return M.map(o, function (n, e) { return n().bind(Ef.getCurrent).map(Ss.getValue) }) }, setValue: function (t, n) { M.each(n, function (e, n) { yc(t, r, n).each(function (n) { Ef.getCurrent(n).each(function (n) { Ss.setValue(n, e) }) }) }) } } })]), La(r.formBehaviours())), apis: { getField: function (n, e) { return yc(n, r, e).bind(Ef.getCurrent) } } }) }, nl = (Oc(function (n, e, t) { return n.getField(e, t) }), function (n) { var i, e = (i = [], { field: function (n, e) { return i.push(n), t = "form", o = Qf(n), r = e, { uiType: Ka(), owner: t, name: o, config: r, validated: {} }; var t, o, r }, record: function () { return i } }), t = n(e), o = e.record(), r = vn.map(o, function (n) { return fc({ name: n, pname: Qf(n) }) }); return Vc("form", Jf, r, Zf, t) }), el = function (n) { var e = ur(y.none()), t = function () { e.get().each(n) }; return { clear: function () { t(), e.set(y.none()) }, isSet: function () { return e.get().isSome() }, set: function (n) { t(), e.set(y.some(n)) } } }, tl = { destroyable: function () { return el(function (n) { n.destroy() }) }, unbindable: function () { return el(function (n) { n.unbind() }) }, api: function () { var e = ur(y.none()), t = function () { e.get().each(function (n) { n.destroy() }) }; return { clear: function () { t(), e.set(y.none()) }, isSet: function () { return e.get().isSome() }, set: function (n) { t(), e.set(y.some(n)) }, run: function (n) { e.get().each(n) } } }, value: function () { var e = ur(y.none()); return { clear: function () { e.set(y.none()) }, set: function (n) { e.set(y.some(n)) }, isSet: function () { return e.get().isSome() }, on: function (n) { e.get().each(n) } } } }, ol = function (n) { return { xValue: n, points: [] } }, rl = function (n, e) { if (e === n.xValue) return n; var t = 0 < e - n.xValue ? 1 : -1, o = { direction: t, xValue: e }; return { xValue: e, points: (0 === n.points.length ? [] : n.points[n.points.length - 1].direction === t ? n.points.slice(0, n.points.length - 1) : n.points).concat([o]) } }, il = function (n) { if (0 === n.points.length) return 0; var e = n.points[0].direction, t = n.points[n.points.length - 1].direction; return -1 === e && -1 === t ? -1 : 1 === e && 1 === t ? 1 : 0 }, ul = function (n) { var o = "navigateEvent", e = Dt([Ft("fields"), Pt("maxFieldIndex", n.fields.length - 1), Ft("onExecute"), Ft("getInitialValue"), Ut("state", function () { return { dialogSwipeState: tl.value(), currentScreen: ur(0) } })]), u = Yt("SerialisedDialog", e, n), r = function (e, n, t) { return Wc.sketch({ dom: qc('<span class="${prefix}-icon-' + n + ' ${prefix}-icon"></span>'), action: function (n) { Gn(n, o, { direction: e }) }, buttonBehaviours: Bo([Yf.config({ disableClass: gi.resolve("toolbar-navigation-disabled"), disabled: !t })]) }) }, i = function (n, r) { var i = Hi(n.element(), "." + gi.resolve("serialised-dialog-screen")); Pi(n.element(), "." + gi.resolve("serialised-dialog-chain")).each(function (o) { 0 <= u.state.currentScreen.get() + r && u.state.currentScreen.get() + r < i.length && (Oi.getRaw(o, "left").each(function (n) { var e = parseInt(n, 10), t = Es(i[0]); Oi.set(o, "left", e - r * t + "px") }), u.state.currentScreen.set(u.state.currentScreen.get() + r)) }) }, a = function (o) { var n = Hi(o.element(), "input"); y.from(n[u.state.currentScreen.get()]).each(function (n) { o.getSystem().getByDom(n).each(function (n) { var e, t; e = o, t = n.element(), e.getSystem().triggerFocus(t, e.element()) }) }); var e = s.get(o); lu.highlightAt(e, u.state.currentScreen.get()) }, c = Ws(nl(function (t) { return { dom: qc('<div class="${prefix}-serialised-dialog"></div>'), components: [Df.sketch({ dom: qc('<div class="${prefix}-serialised-dialog-chain" style="left: 0px; position: absolute;"></div>'), components: vn.map(u.fields, function (n, e) { return e <= u.maxFieldIndex ? Df.sketch({ dom: qc('<div class="${prefix}-serialised-dialog-screen"></div>'), components: vn.flatten([[r(-1, "previous", 0 < e)], [t.field(n.name, n.spec)], [r(1, "next", e < u.maxFieldIndex)]]) }) : t.field(n.name, n.spec) }) })], formBehaviours: Bo([li(function (n, e) { var t; t = e, Pi(n.element(), "." + gi.resolve("serialised-dialog-chain")).each(function (n) { Oi.set(n, "left", -u.state.currentScreen.get() * t.width + "px") }) }), ja.config({ mode: "special", focusIn: function (n) { a(n) }, onTab: function (n) { return i(n, 1), y.some(!0) }, onShiftTab: function (n) { return i(n, -1), y.some(!0) } }), kf("form-events", [fo(function (e, n) { u.state.currentScreen.set(0), u.state.dialogSwipeState.clear(); var t = s.get(e); lu.highlightFirst(t), u.getInitialValue(e).each(function (n) { Ss.setValue(e, n) }) }), go(u.onExecute), io(j(), function (n, e) { "left" === e.event().raw().propertyName && a(n) }), io(o, function (n, e) { var t = e.event().direction(); i(n, t) })])]) } })), s = Ws({ dom: qc('<div class="${prefix}-dot-container"></div>'), behaviours: Bo([lu.config({ highlightClass: gi.resolve("dot-active"), itemClass: gi.resolve("dot-item") })]), components: vn.bind(u.fields, function (n, e) { return e <= u.maxFieldIndex ? [_c('<div class="${prefix}-dot-item ${prefix}-icon-full-dot ${prefix}-icon"></div>')] : [] }) }); return { dom: qc('<div class="${prefix}-serializer-wrapper"></div>'), components: [c.asSpec(), s.asSpec()], behaviours: Bo([ja.config({ mode: "special", focusIn: function (n) { var e = c.get(n); ja.focusIn(e) } }), kf("serializer-wrapper-events", [io(T(), function (n, e) { u.state.dialogSwipeState.set(ol(e.event().raw().touches[0].clientX)) }), io(k(), function (n, e) { u.state.dialogSwipeState.on(function (n) { e.event().prevent(), u.state.dialogSwipeState.set(rl(n, e.event().raw().touches[0].clientX)) }) }), io(C(), function (o) { u.state.dialogSwipeState.on(function (n) { var e = c.get(o), t = -1 * il(n); i(e, t) }) })])]) } }, al = L(function (t, o) { return [{ label: "the link group", items: [ul({ fields: [Hf("url", "Type or paste URL"), Hf("text", "Link text"), Hf("title", "Link title"), Hf("target", "Link target"), (n = "link", { name: n, spec: Mf.sketch({ dom: { tag: "span", styles: { display: "none" } }, getInitialValue: function () { return y.none() } }) })], maxFieldIndex: ["url", "text", "title", "target"].length - 1, getInitialValue: function () { return y.some(wf.getInfo(o)) }, onExecute: function (n) { var e = Ss.getValue(n); wf.applyInfo(o, e), t.restoreToolbar(), o.focus() } })] }]; var n }), cl = [{ title: "Headings", items: [{ title: "Heading 1", format: "h1" }, { title: "Heading 2", format: "h2" }, { title: "Heading 3", format: "h3" }, { title: "Heading 4", format: "h4" }, { title: "Heading 5", format: "h5" }, { title: "Heading 6", format: "h6" }] }, { title: "Inline", items: [{ title: "Bold", icon: "bold", format: "bold" }, { title: "Italic", icon: "italic", format: "italic" }, { title: "Underline", icon: "underline", format: "underline" }, { title: "Strikethrough", icon: "strikethrough", format: "strikethrough" }, { title: "Superscript", icon: "superscript", format: "superscript" }, { title: "Subscript", icon: "subscript", format: "subscript" }, { title: "Code", icon: "code", format: "code" }] }, { title: "Blocks", items: [{ title: "Paragraph", format: "p" }, { title: "Blockquote", format: "blockquote" }, { title: "Div", format: "div" }, { title: "Pre", format: "pre" }] }, { title: "Alignment", items: [{ title: "Left", icon: "alignleft", format: "alignleft" }, { title: "Center", icon: "aligncenter", format: "aligncenter" }, { title: "Right", icon: "alignright", format: "alignright" }, { title: "Justify", icon: "alignjustify", format: "alignjustify" }] }], sl = { events: oo([(tf = Bn(), of = function (n, e) { var t, o, r = e.event().originator(), i = e.event().target(); return o = i, !(Te(t = r, n.element()) && !Te(t, o) && (console.warn(Bn() + " did not get interpreted by the desired target. \nOriginator: " + Ar(r) + "\nTarget: " + Ar(i) + "\nCheck the " + Bn() + " event handlers"), 1)) }, { key: tf, value: eo({ can: of }) })]) }, fl = O.identity, ll = Eo.exactly(["debugInfo", "triggerFocus", "triggerEvent", "triggerEscape", "addToWorld", "removeFromWorld", "addToGui", "removeFromGui", "build", "getByUid", "getByDom", "broadcast", "broadcastOn"]), dl = function (e) { var n = function (n) { return function () { throw new Error("The component must be in a context to send: " + n + "\n" + Ar(e().element()) + " is not in context.") } }; return ll({ debugInfo: O.constant("fake"), triggerEvent: n("triggerEvent"), triggerFocus: n("triggerFocus"), triggerEscape: n("triggerEscape"), build: n("build"), addToWorld: n("addToWorld"), removeFromWorld: n("removeFromWorld"), addToGui: n("addToGui"), removeFromGui: n("removeFromGui"), getByUid: n("getByUid"), getByDom: n("getByDom"), broadcast: n("broadcast"), broadcastOn: n("broadcastOn") }) }, ml = function (e, n) { var t = vn.map(n, function (n) { return It(n.name(), n.name(), Je(), Dt([Ft("config"), Pt("state", Ao)])) }), o = Kt("component.behaviours", Dt(t), e.behaviours).fold(function (n) { throw new Error(Qt(n) + "\nComplete spec:\n" + yt(e, null, 2)) }, O.identity); return { list: n, data: M.map(o, function (n) { var e = n(); return O.constant(e.map(function (n) { return { config: n.config(), state: n.state().init(n.config()) } })) }) } }, gl = function (n) { return n.list }, pl = function (n) { return n.data }, vl = function (n, r) { var i = {}; return M.each(n, function (n, o) { M.each(n, function (n, e) { var t = ft(e, [])(i); i[e] = t.concat([r(o, n)]) }) }), i }, hl = function (n, e) { return { name: O.constant(n), modification: e } }, bl = function (n, e, t) { return 1 < n.length ? qe.error('Multiple behaviours have tried to change DOM "' + e + '". The guilty behaviours are: ' + yt(vn.map(n, function (n) { return n.name() })) + ". At this stage, this is not supported. Future releases might provide strategies for resolving this.") : 0 === n.length ? qe.value({}) : qe.value(n[0].modification().fold(function () { return {} }, function (n) { return dt(e, n) })) }, yl = function (u, a) { return vn.foldl(u, function (n, e) { var t = e.modification().getOr({}); return n.bind(function (i) { var n = M.mapToArray(t, function (n, e) { return i[e] !== undefined ? (t = a, o = e, r = u, qe.error("Mulitple behaviours have tried to change the _" + o + '_ "' + t + '". The guilty behaviours are: ' + yt(vn.bind(r, function (n) { return n.modification().getOr({})[o] !== undefined ? [n.name()] : [] }), null, 2) + ". This is not currently supported.")) : qe.value(dt(e, n)); var t, o, r }); return gt(n, i) }) }, qe.value({})).map(function (n) { return dt(a, n) }) }, wl = { classes: function (n, e) { var t = vn.bind(n, function (n) { return n.modification().getOr([]) }); return qe.value(dt(e, t)) }, attributes: yl, styles: yl, domChildren: bl, defChildren: bl, innerHtml: bl, value: bl }, xl = function (u, a, n, c) { var e = n.slice(0); try { var t = e.sort(function (n, e) { var t = n[a](), o = e[a](), r = c.indexOf(t), i = c.indexOf(o); if (-1 === r) throw new Error("The ordering for " + u + " does not have an entry for " + t + ".\nOrder specified: " + yt(c, null, 2)); if (-1 === i) throw new Error("The ordering for " + u + " does not have an entry for " + o + ".\nOrder specified: " + yt(c, null, 2)); return r < i ? -1 : i < r ? 1 : 0 }); return qe.value(t) } catch (o) { return qe.error([o]) } }, Sl = function (n, e) { return { handler: O.curry.apply(undefined, [n.handler].concat(e)), purpose: n.purpose } }, Tl = function (n) { return n.handler }, kl = function (n, e) { return { name: O.constant(n), handler: O.constant(e) } }, Cl = function (n, e, t) { var o, r, i, u = D.deepMerge(t, (o = e, r = n, i = {}, vn.each(o, function (n) { i[n.name()] = n.handlers(r) }), i)); return vl(u, kl) }, Ol = function (n) { var e, o = (e = n, E.isFunction(e) ? { can: O.constant(!0), abort: O.constant(!1), run: e } : e); return function (n, e) { var t = Array.prototype.slice.call(arguments, 0); o.abort.apply(undefined, t) ? e.stop() : o.can.apply(undefined, t) && o.run.apply(undefined, t) } }, El = function (n, e, t) { var o, r, i = e[t]; return i ? xl("Event: " + t, "name", n, i).map(function (n) { var e = vn.map(n, function (n) { return n.handler() }); return to(e) }) : (o = t, r = n, qe.error(["The event (" + o + ') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: ' + yt(vn.map(r, function (n) { return n.name() }), null, 2)])) }, Dl = function (n, u) { var e = M.mapToArray(n, function (r, i) { return (1 === r.length ? qe.value(r[0].handler()) : El(r, u, i)).map(function (n) { var e, t = Ol(n), o = 1 < r.length ? vn.filter(u, function (e) { return vn.contains(r, function (n) { return n.name() === e }) }).join(" > ") : r[0].name(); return dt(i, (e = o, { handler: t, purpose: O.constant(e) })) }) }); return gt(e, {}) }, Ml = function (n) { return Kt("custom.definition", Et([It("dom", "dom", Ye(), Et([Ft("tag"), Pt("styles", {}), Pt("classes", []), Pt("attributes", {}), jt("value"), jt("innerHtml")])), Ft("components"), Ft("uid"), Pt("events", {}), Pt("apis", O.constant({})), It("eventOrder", "eventOrder", (e = { "alloy.execute": ["disabling", "alloy.base.behaviour", "toggling"], "alloy.focus": ["alloy.base.behaviour", "focusing", "keying"], "alloy.system.init": ["alloy.base.behaviour", "disabling", "toggling", "representing"], input: ["alloy.base.behaviour", "representing", "streaming", "invalidating"], "alloy.system.detached": ["alloy.base.behaviour", "representing"] }, Ke.mergeWithThunk(O.constant(e))), no()), jt("domModification"), Xr("originalSpec"), Pt("debug.sketcher", "unknown")]), n); var e }, Al = function (n) { var e, t = { tag: n.dom().tag(), classes: n.dom().classes(), attributes: D.deepMerge((e = n, dt(Mc(), e.uid())), n.dom().attributes()), styles: n.dom().styles(), domChildren: vn.map(n.components(), function (n) { return n.element() }) }; return vo(D.deepMerge(t, n.dom().innerHtml().map(function (n) { return dt("innerHtml", n) }).getOr({}), n.dom().value().map(function (n) { return dt("value", n) }).getOr({}))) }, Bl = { add: function (e, n) { vn.each(n, function (n) { er.add(e, n) }) }, remove: function (e, n) { vn.each(n, function (n) { er.remove(e, n) }) }, toggle: function (e, n) { vn.each(n, function (n) { er.toggle(e, n) }) }, hasAll: function (e, n) { return vn.forall(n, function (n) { return er.has(e, n) }) }, hasAny: function (e, n) { return vn.exists(n, function (n) { return er.has(e, n) }) }, get: function (n) { return Zo(n) ? function (n) { for (var e = n.dom().classList, t = new Array(e.length), o = 0; o < e.length; o++)t[o] = e.item(o); return t }(n) : Xo(n) } }, Rl = function (e) { if (e.domChildren().isSome() && e.defChildren().isSome()) throw new Error("Cannot specify children and child specs! Must be one or the other.\nDef: " + (n = ho(e), yt(n, null, 2))); return e.domChildren().fold(function () { var n = e.defChildren().getOr([]); return vn.map(n, Fl) }, function (n) { return n }); var n }, Il = function (n) { var e = Xn.fromTag(n.tag()); Po.setAll(e, n.attributes().getOr({})), Bl.add(e, n.classes().getOr([])), Oi.setAll(e, n.styles().getOr({})), Or(e, n.innerHtml().getOr("")); var t = Rl(n); return Ne.append(e, t), n.value().each(function (n) { Af(e, n) }), e }, Fl = function (n) { var e = vo(n); return Il(e) }, Nl = function (n) { var e, t, o, r = (t = lt(e = n, "behaviours").getOr({}), o = vn.filter(M.keys(t), function (n) { return t[n] !== undefined }), vn.map(o, function (n) { return e.behaviours[n].me })); return ml(n, r) }, Vl = Eo.exactly(["getSystem", "config", "hasConfigured", "spec", "connect", "disconnect", "element", "syncComponents", "readState", "components", "events"]), Hl = function (t) { var n, e, o, r, i, u, a, c, s, f, l = function () { return C }, d = ur(dl(l)), m = Xt(Ml(D.deepMerge(t, { behaviours: undefined }))), g = Nl(t), p = gl(g), v = pl(g), h = Al(m), b = { "alloy.base.modification": (n = m, n.domModification().fold(function () { return bo({}) }, bo)) }, y = function (e, n, t, o) { var r = D.deepMerge({}, n); vn.each(t, function (n) { r[n.name()] = n.exhibit(e, o) }); var i = vl(r, hl), u = M.map(i, function (n, e) { return vn.bind(n, function (e) { return e.modification().fold(function () { return [] }, function (n) { return [e] }) }) }), a = M.mapToArray(u, function (e, t) { return lt(wl, t).fold(function () { return qe.error("Unknown field type: " + t) }, function (n) { return n(e, t) }) }); return gt(a, {}).map(bo) }(v, b, p, h).getOrDie(), w = (e = h, o = y, r = D.deepMerge({ tag: e.tag(), classes: o.classes().getOr([]).concat(e.classes().getOr([])), attributes: D.merge(e.attributes().getOr({}), o.attributes().getOr({})), styles: D.merge(e.styles().getOr({}), o.styles().getOr({})) }, o.innerHtml().or(e.innerHtml()).map(function (n) { return dt("innerHtml", n) }).getOr({}), yo("domChildren", o.domChildren(), e.domChildren()), yo("defChildren", o.defChildren(), e.defChildren()), o.value().or(e.value()).map(function (n) { return dt("value", n) }).getOr({})), vo(r)), x = Il(w), S = { "alloy.base.behaviour": (i = m, i.events()) }, T = (u = v, a = m.eventOrder(), c = p, s = S, f = Cl(u, c, s), Dl(f, a)).getOrDie(), k = ur(m.components()), C = Vl({ getSystem: d.get, config: function (n) { if (n === Ec()) return m.apis(); var e = v; return (E.isFunction(e[n.name()]) ? e[n.name()] : function () { throw new Error("Could not find " + n.name() + " in " + yt(t, null, 2)) })() }, hasConfigured: function (n) { return E.isFunction(v[n.name()]) }, spec: O.constant(t), readState: function (n) { return v[n]().map(function (n) { return n.state.readState() }).getOr("not enabled") }, connect: function (n) { d.set(n) }, disconnect: function () { d.set(dl(l)) }, element: O.constant(x), syncComponents: function () { var n = Be.children(x), e = vn.bind(n, function (n) { return d.get().getByDom(n).fold(function () { return [] }, function (n) { return [n] }) }); k.set(e) }, components: k.get, events: O.constant(T) }); return C }, jl = function (n) { var e, t, o = fl(n), r = (e = o, t = ft("components", [])(e), vn.map(t, Pl)), i = D.deepMerge(sl, o, dt("components", r)); return qe.value(Hl(i)) }, zl = function (n) { var e = Xn.fromText(n); return Ll({ element: e }) }, Ll = function (n) { var t = Jt("external.component", Et([Ft("element"), jt("uid")]), n), e = ur(dl()); t.uid().each(function (n) { var e; e = t.element(), Po.set(e, Bc, n) }); var o = Vl({ getSystem: e.get, config: y.none, hasConfigured: O.constant(!1), connect: function (n) { e.set(n) }, disconnect: function () { e.set(dl(function () { return o })) }, element: O.constant(t.element()), spec: O.constant(n), readState: O.constant("No state"), syncComponents: O.noop, components: O.constant([]), events: O.constant({}) }); return Cc(o) }, Pl = function (e) { return (n = e, lt(n, Tc)).fold(function () { var n = D.deepMerge({ uid: Fc("") }, e); return jl(n).getOrDie() }, function (n) { return n }); var n }, Wl = Cc, Ul = "alloy.item-hover", Gl = "alloy.item-focus", $l = function (n) { (br(n.element()).isNone() || yi.isFocused(n)) && (yi.isFocused(n) || yi.focus(n), Gn(n, Ul, { item: n })) }, ql = function (n) { Gn(n, Gl, { item: n }) }, _l = O.constant(Ul), Kl = O.constant(Gl), Xl = [Ft("data"), Ft("components"), Ft("dom"), jt("toggling"), Pt("itemBehaviours", {}), Pt("ignoreFocus", !1), Pt("domModification", {}), Kr("builder", function (n) { return { dom: D.deepMerge(n.dom(), { attributes: { role: n.toggling().isSome() ? "menuitemcheckbox" : "menuitem" } }), behaviours: D.deepMerge(Bo([n.toggling().fold(si.revoke, function (n) { return si.config(D.deepMerge({ aria: { mode: "checked" } }, n)) }), yi.config({ ignore: n.ignoreFocus(), onFocus: function (n) { ql(n) } }), ja.config({ mode: "execution" }), Ss.config({ store: { mode: "memory", initialValue: n.data() } })]), n.itemBehaviours()), events: oo([(e = Hn(), o = $n, io(e, function (e, t) { e.getSystem().getByDom(t.event().target()).each(function (n) { o(e, n, t) }) })), so(A()), io(I(), $l), io(Nn(), yi.focus)]), components: n.components(), domModification: n.domModification() }; var e, o })], Yl = [Ft("dom"), Ft("components"), Kr("builder", function (n) { return { dom: n.dom(), components: n.components(), events: oo([(e = Nn(), io(e, function (n, e) { e.stop() }))]) }; var e })], Jl = O.constant("item-widget"), Ql = O.constant([fc({ name: "widget", overrides: function (e) { return { behaviours: Bo([Ss.config({ store: { mode: "manual", getValue: function (n) { return e.data() }, setValue: function () { } } })]) } } })]), Zl = [Ft("uid"), Ft("data"), Ft("components"), Ft("dom"), Pt("autofocus", !1), Pt("domModification", {}), Sc(Ql()), Kr("builder", function (t) { var n = hc(Jl(), t, Ql()), e = bc(Jl(), t, n.internals()), o = function (n) { return yc(n, t, "widget").map(function (n) { return ja.focusIn(n), n }) }, r = function (n, e) { return hu(e.event().target()) || t.autofocus() && e.setSource(n.element()), y.none() }; return D.deepMerge({ dom: t.dom(), components: e, domModification: t.domModification(), events: oo([go(function (n, e) { o(n).each(function (n) { e.stop() }) }), io(I(), $l), io(Nn(), function (n, e) { t.autofocus() ? o(n) : yi.focus(n) })]), behaviours: Bo([Ss.config({ store: { mode: "memory", initialValue: t.data() } }), yi.config({ onFocus: function (n) { ql(n) } }), ja.config({ mode: "special", onLeft: r, onRight: r, onEscape: function (n, e) { return yi.isFocused(n) || t.autofocus() ? (t.autofocus() && e.setSource(n.element()), y.none()) : (yi.focus(n), y.some(!0)) } })]) }) })], nd = Zt("type", { widget: Zl, item: Xl, separator: Yl }), ed = O.constant([dc({ factory: { sketch: function (n) { var e = Jt("menu.spec item", nd, n); return e.builder()(e) } }, name: "items", unit: "item", defaults: function (n, e) { var t = Fc(""); return D.deepMerge({ uid: t }, e) }, overrides: function (n, e) { return { type: e.type, ignoreFocus: n.fakeFocus(), domModification: { classes: [n.markers().item()] } } } })]), td = O.constant([Ft("value"), Ft("items"), Ft("dom"), Ft("components"), Pt("eventOrder", {}), za("menuBehaviours", [lu, Ss, Ef, ja]), Wt("movement", { mode: "menu", moveOnTab: !0 }, Zt("mode", { grid: [Yr(), Kr("config", function (n, e) { return { mode: "flatgrid", selector: "." + n.markers().item(), initSize: { numColumns: e.initSize().numColumns(), numRows: e.initSize().numRows() }, focusManager: n.focusManager() } })], menu: [Pt("moveOnTab", !0), Kr("config", function (n, e) { return { mode: "menu", selector: "." + n.markers().item(), moveOnTab: e.moveOnTab(), focusManager: n.focusManager() } })] })), Nt("markers", Pr()), Pt("fakeFocus", !1), Pt("focusManager", du()), Gr("onHighlight")]), od = (O.constant("menu"), O.constant("alloy.menu-focus")), rd = Pc({ name: "Menu", configFields: td(), partFields: ed(), factory: function (n, e, t, o) { return D.deepMerge({ dom: D.deepMerge(n.dom(), { attributes: { role: "menu" } }), uid: n.uid(), behaviours: D.deepMerge(Bo([lu.config({ highlightClass: n.markers().selectedItem(), itemClass: n.markers().item(), onHighlight: n.onHighlight() }), Ss.config({ store: { mode: "memory", initialValue: n.value() } }), Ef.config({ find: O.identity }), ja.config(n.movement().config()(n, n.movement()))]), La(n.menuBehaviours())), events: oo([io(Kl(), function (e, t) { var n = t.event(); e.getSystem().getByDom(n.target()).each(function (n) { lu.highlight(e, n), t.stop(), Gn(e, od(), { menu: e, item: n }) }) }), io(_l(), function (n, e) { var t = e.event().item(); lu.highlight(n, t) })]), components: e, eventOrder: n.eventOrder() }) } }), id = function (n, e, t, o) { var r = n.getSystem().build(o); Pe(n, r, t) }, ud = function (n, e) { return n.components() }, ad = Object.freeze({ append: function (n, e, t, o) { id(n, 0, Fe.append, o) }, prepend: function (n, e, t, o) { id(n, 0, Fe.prepend, o) }, remove: function (n, e, t, o) { var r = ud(n, e); vn.find(r, function (n) { return Te(o.element(), n.element()) }).each(Ue) }, set: function (e, n, t, o) { var r, i, u, a, c, s; i = (r = e).components(), vn.each(i, We), He.empty(r.element()), r.syncComponents(), u = function () { var n = vn.map(o, e.getSystem().build); vn.each(n, function (n) { Le(e, n) }) }, a = e.element(), c = Be.owner(a), s = hr(c).bind(function (e) { var n = function (n) { return Te(e, n) }; return n(a) ? y.some(a) : lr.descendant(a, n) }), u(a), s.each(function (e) { hr(c).filter(function (n) { return Te(n, e) }).orThunk(function () { pr(e) }) }) }, contents: ud }), cd = Io({ fields: [], name: "replacing", apis: ad }), sd = function (t, o, r, n) { return lt(r, n).bind(function (n) { return lt(t, n).bind(function (n) { var e = sd(t, o, r, n); return y.some([n].concat(e)) }) }).getOr([]) }, fd = function (n, e) { var t = {}; M.each(n, function (n, e) { vn.each(n, function (n) { t[n] = e }) }); var o, r = e, i = (o = e, M.tupleMap(o, function (n, e) { return { k: n, v: e } })), u = M.map(i, function (n, e) { return [e].concat(sd(t, r, i, e)) }); return M.map(t, function (n) { return lt(u, n).getOr([n]) }) }, ld = O.constant("collapse-item"), dd = Lc({ name: "TieredMenu", configFields: [_r("onExecute"), _r("onEscape"), qr("onOpenMenu"), qr("onOpenSubmenu"), Gr("onCollapseMenu"), Pt("openImmediately", !0), Ht("data", [Ft("primary"), Ft("menus"), Ft("expansions")]), Pt("fakeFocus", !1), Gr("onHighlight"), Gr("onHover"), Ht("markers", [Ft("backgroundMenu")].concat(zr()).concat(Lr())), Ft("dom"), Pt("navigateOnHover", !0), Pt("stayInDom", !1), za("tmenuBehaviours", [ja, lu, Ef, cd]), Pt("eventOrder", {})], apis: { collapseMenu: function (n, e) { n.collapseMenu(e) } }, factory: function (u, r) { var a, c, s, f, l, n, i = function (o, n) { return M.map(n, function (n, e) { var t = rd.sketch(D.deepMerge(n, { value: e, items: n.items, markers: at(r.markers, ["item", "selectedItem"]), fakeFocus: u.fakeFocus(), onHighlight: u.onHighlight(), focusManager: u.fakeFocus() ? { get: function (n) { return lu.getHighlighted(n).map(function (n) { return n.element() }) }, set: function (e, n) { e.getSystem().getByDom(n).fold(O.noop, function (n) { lu.highlight(e, n) }) } } : du() })); return o.getSystem().build(t) }) }, d = (a = ur({}), c = ur({}), s = ur({}), f = ur(y.none()), l = ur(O.constant([])), { setContents: function (n, e, t, o) { f.set(y.some(n)), a.set(t), c.set(e), l.set(o); var r = o(e), i = fd(r, t); s.set(i) }, expand: function (t) { return lt(a.get(), t).map(function (n) { var e = lt(s.get(), t).getOr([]); return [n].concat(e) }) }, refresh: function (n) { return lt(s.get(), n) }, collapse: function (n) { return lt(s.get(), n).bind(function (n) { return 1 < n.length ? y.some(n.slice(1)) : y.none() }) }, lookupMenu: n = function (n) { return lt(c.get(), n) }, otherMenus: function (n) { var e = l.get()(c.get()); return vn.difference(M.keys(e), n) }, getPrimary: function () { return f.get().bind(n) }, getMenus: function () { return c.get() }, clear: function () { a.set({}), c.set({}), s.set({}), f.set(y.none()) }, isClear: function () { return f.get().isNone() } }), m = function (n) { return Ss.getValue(n).value }, g = function (n, e) { return M.map(u.data().menus(), function (n, e) { return vn.bind(n.items, function (n) { return "separator" === n.type ? [] : [n.data.value] }) }) }, p = function (e, n) { lu.highlight(e, n), lu.getHighlighted(n).orThunk(function () { return lu.getFirst(n) }).each(function (n) { qn(e, n.element(), Nn()) }) }, v = function (n, e) { return Rr(vn.map(e, n.lookupMenu)) }, h = function (o, r, i) { return y.from(i[0]).bind(r.lookupMenu).map(function (n) { var e = v(r, i.slice(1)); vn.each(e, function (n) { er.add(n.element(), u.markers().backgroundMenu()) }), se.inBody(n.element()) || cd.append(o, Wl(n)), Bl.remove(n.element(), [u.markers().backgroundMenu()]), p(o, n); var t = v(r, r.otherMenus(i)); return vn.each(t, function (n) { Bl.remove(n.element(), [u.markers().backgroundMenu()]), u.stayInDom() || cd.remove(o, n) }), n }) }, b = function (e, t) { var n = m(t); return d.expand(n).bind(function (n) { return y.from(n[0]).bind(d.lookupMenu).each(function (n) { se.inBody(n.element()) || cd.append(e, Wl(n)), u.onOpenSubmenu()(e, t, n), lu.highlightFirst(n) }), h(e, d, n) }) }, o = function (e, t) { var n = m(t); return d.collapse(n).bind(function (n) { return h(e, d, n).map(function (n) { return u.onCollapseMenu()(e, t, n), n }) }) }, e = function (t) { return function (e, n) { return Wi(n.getSource(), "." + u.markers().item()).bind(function (n) { return e.getSystem().getByDom(n).bind(function (n) { return t(e, n) }) }) } }, t = oo([io(od(), function (n, e) { var t = e.event().menu(); lu.highlight(n, t) }), go(function (e, n) { var t = n.event().target(); return e.getSystem().getByDom(t).bind(function (n) { return 0 === m(n).indexOf("collapse-item") ? o(e, n) : b(e, n).orThunk(function () { return u.onExecute()(e, n) }) }) }), fo(function (e, n) { var t, o; (t = e, o = i(t, u.data().menus()), d.setContents(u.data().primary(), o, u.data().expansions(), function (n) { return g(t, n) }), d.getPrimary()).each(function (n) { cd.append(e, Wl(n)), u.openImmediately() && (p(e, n), u.onOpenMenu()(e, n)) }) })].concat(u.navigateOnHover() ? [io(_l(), function (n, e) { var t, o, r = e.event().item(); t = n, o = m(r), d.refresh(o).bind(function (n) { return h(t, d, n) }), b(n, r), u.onHover()(n, r) })] : [])); return { uid: u.uid(), dom: u.dom(), behaviours: D.deepMerge(Bo([ja.config({ mode: "special", onRight: e(function (n, e) { return hu(e.element()) ? y.none() : b(n, e) }), onLeft: e(function (n, e) { return hu(e.element()) ? y.none() : o(n, e) }), onEscape: e(function (n, e) { return o(n, e).orThunk(function () { return u.onEscape()(n, e) }) }), focusIn: function (e, n) { d.getPrimary().each(function (n) { qn(e, n.element(), Nn()) }) } }), lu.config({ highlightClass: u.markers().selectedMenu(), itemClass: u.markers().menu() }), Ef.config({ find: function (n) { return lu.getHighlighted(n) } }), cd.config({})]), La(u.tmenuBehaviours())), eventOrder: u.eventOrder(), apis: { collapseMenu: function (e) { lu.getHighlighted(e).each(function (n) { lu.getHighlighted(n).each(function (n) { o(e, n) }) }) } }, events: t } }, extraApis: { tieredData: function (n, e, t) { return { primary: n, menus: e, expansions: t } }, singleData: function (n, e) { return { primary: n, menus: dt(n, e), expansions: {} } }, collapseItem: function (n) { return { value: Ya(ld()), text: n } } } }), md = function (n, e, t, o) { return lt(e.routes(), o.start()).map(O.apply).bind(function (n) { return lt(n, o.destination()).map(O.apply) }) }, gd = function (n, e, t, o) { return md(0, e, 0, o).bind(function (e) { return e.transition().map(function (n) { return { transition: O.constant(n), route: O.constant(e) } }) }) }, pd = function (t, o, n) { var e, r, i; (e = t, r = o, i = n, vd(e, r, i).bind(function (n) { return gd(e, r, i, n) })).each(function (n) { var e = n.transition(); er.remove(t.element(), e.transitionClass()), Po.remove(t.element(), o.destinationAttr()) }) }, vd = function (n, e, t) { var o = n.element(); return Po.has(o, e.destinationAttr()) ? y.some({ start: O.constant(Po.get(n.element(), e.stateAttr())), destination: O.constant(Po.get(n.element(), e.destinationAttr())) }) : y.none() }, hd = function (n, e, t, o) { pd(n, e, t), Po.has(n.element(), e.stateAttr()) && Po.get(n.element(), e.stateAttr()) !== o && e.onFinish()(n, o), Po.set(n.element(), e.stateAttr(), o) }, bd = Object.freeze({ findRoute: md, disableTransition: pd, getCurrentRoute: vd, jumpTo: hd, progressTo: function (t, o, r, i) { var n, e; e = o, Po.has((n = t).element(), e.destinationAttr()) && (Po.set(n.element(), e.stateAttr(), Po.get(n.element(), e.destinationAttr())), Po.remove(n.element(), e.destinationAttr())); var u, a, c, s = (u = t, a = o, c = i, { start: O.constant(Po.get(u.element(), a.stateAttr())), destination: O.constant(c) }); gd(t, o, r, s).fold(function () { hd(t, o, r, i) }, function (n) { pd(t, o, r); var e = n.transition(); er.add(t.element(), e.transitionClass()), Po.set(t.element(), o.destinationAttr(), i) }) }, getState: function (n, e, t) { var o = n.element(); return Po.has(o, e.stateAttr()) ? y.some(Po.get(o, e.stateAttr())) : y.none() } }), yd = Object.freeze({ events: function (r, i) { return oo([io(j(), function (t, n) { var o = n.event().raw(); vd(t, r, i).each(function (e) { md(0, r, 0, e).each(function (n) { n.transition().each(function (n) { o.propertyName === n.property() && (hd(t, r, i, e.destination()), r.onTransition()(t, e)) }) }) }) }), fo(function (n, e) { hd(n, r, i, r.initialState()) })]) } }), wd = [Pt("destinationAttr", "data-transitioning-destination"), Pt("stateAttr", "data-transitioning-state"), Ft("initialState"), Gr("onTransition"), Gr("onFinish"), Nt("routes", At(qe.value, At(qe.value, Et([Lt("transition", [Ft("property"), Ft("transitionClass")])]))))], xd = Io({ fields: wd, name: "transitioning", active: yd, apis: bd, extra: { createRoutes: function (n) { var o = {}; return M.each(n, function (n, e) { var t = e.split("<->"); o[t[0]] = dt(t[1], n), o[t[1]] = dt(t[0], n) }), o }, createBistate: function (n, e, t) { return mt([{ key: n, value: dt(e, t) }, { key: e, value: dt(n, t) }]) }, createTristate: function (n, e, t, o) { return mt([{ key: n, value: mt([{ key: e, value: o }, { key: t, value: o }]) }, { key: e, value: mt([{ key: n, value: o }, { key: t, value: o }]) }, { key: t, value: mt([{ key: n, value: o }, { key: e, value: o }]) }]) } } }), Sd = gi.resolve("scrollable"), Td = { register: function (n) { er.add(n, Sd) }, deregister: function (n) { er.remove(n, Sd) }, scrollable: O.constant(Sd) }, kd = function (n) { return lt(n, "format").getOr(n.title) }, Cd = function (n, e, t, o, r) { return { data: { value: n, text: e }, type: "item", dom: { tag: "div", classes: r ? [gi.resolve("styles-item-is-menu")] : [] }, toggling: { toggleOnExecute: !1, toggleClass: gi.resolve("format-matches"), selected: t }, itemBehaviours: Bo(r ? [] : [fi(n, function (n, e) { (e ? si.on : si.off)(n) })]), components: [{ dom: { tag: "div", attributes: { style: o }, innerHtml: e } }] } }, Od = function (n, e, t, o) { return { value: n, dom: { tag: "div" }, components: [Wc.sketch({ dom: { tag: "div", classes: [gi.resolve("styles-collapser")] }, components: o ? [{ dom: { tag: "span", classes: [gi.resolve("styles-collapse-icon")] } }, zl(n)] : [zl(n)], action: function (n) { if (o) { var e = t().get(n); dd.collapseMenu(e) } } }), { dom: { tag: "div", classes: [gi.resolve("styles-menu-items-container")] }, components: [rd.parts().items({})], behaviours: Bo([kf("adhoc-scrollable-menu", [fo(function (n, e) { Oi.set(n.element(), "overflow-y", "auto"), Oi.set(n.element(), "-webkit-overflow-scrolling", "touch"), Td.register(n.element()) }), lo(function (n) { Oi.remove(n.element(), "overflow-y"), Oi.remove(n.element(), "-webkit-overflow-scrolling"), Td.deregister(n.element()) })])]) }], items: e, menuBehaviours: Bo([xd.config({ initialState: "after", routes: xd.createTristate("before", "current", "after", { transition: { property: "transform", transitionClass: "transitioning" } }) })]) } }, Ed = function (o) { var r, i, n, e, t, u = (r = o.formats, i = function () { return a }, n = Od("Styles", [].concat(vn.map(r.items, function (n) { return Cd(kd(n), n.title, n.isSelected(), n.getPreview(), pt(r.expansions, kd(n))) })), i, !1), e = M.map(r.menus, function (n, e) { var t = vn.map(n, function (n) { return Cd(kd(n), n.title, n.isSelected !== undefined && n.isSelected(), n.getPreview !== undefined ? n.getPreview() : "", pt(r.expansions, kd(n))) }); return Od(e, t, i, !0) }), t = D.deepMerge(e, dt("styles", n)), { tmenu: dd.tieredData("styles", t, r.expansions) }), a = Ws(dd.sketch({ dom: { tag: "div", classes: [gi.resolve("styles-menu")] }, components: [], fakeFocus: !0, stayInDom: !0, onExecute: function (n, e) { var t = Ss.getValue(e); o.handle(e, t.value) }, onEscape: function () { }, onOpenMenu: function (n, e) { var t = Es(n.element()); Os(e.element(), t), xd.jumpTo(e, "current") }, onOpenSubmenu: function (n, e, t) { var o = Es(n.element()), r = Li(e.element(), '[role="menu"]').getOrDie("hacky"), i = n.getSystem().getByDom(r).getOrDie(); Os(t.element(), o), xd.progressTo(i, "before"), xd.jumpTo(t, "after"), xd.progressTo(t, "current") }, onCollapseMenu: function (n, e, t) { var o = Li(e.element(), '[role="menu"]').getOrDie("hacky"), r = n.getSystem().getByDom(o).getOrDie(); xd.progressTo(r, "after"), xd.progressTo(t, "current") }, navigateOnHover: !1, openImmediately: !0, data: u.tmenu, markers: { backgroundMenu: gi.resolve("styles-background-menu"), menu: gi.resolve("styles-menu"), selectedMenu: gi.resolve("styles-selected-menu"), item: gi.resolve("styles-item"), selectedItem: gi.resolve("styles-selected-item") } })); return a.asSpec() }, Dd = function (n) { return pt(n, "items") ? (e = n, t = D.deepMerge(ct(e, ["items"]), { menu: !0 }), o = Md(e.items), { item: t, menus: D.deepMerge(o.menus, dt(e.title, o.items)), expansions: D.deepMerge(o.expansions, dt(e.title, e.title)) }) : { item: n, menus: {}, expansions: {} }; var e, t, o }, Md = function (n) { return vn.foldr(n, function (n, e) { var t = Dd(e); return { menus: D.deepMerge(n.menus, t.menus), items: [t.item].concat(n.items), expansions: D.deepMerge(n.expansions, t.expansions) } }, { menus: {}, expansions: {}, items: [] }) }, Ad = { expand: Md }, Bd = function (a, n) { var c = function (n) { return function () { return a.formatter.match(n) } }, s = function (n) { return function () { return a.formatter.getCssText(n) } }, e = lt(n, "style_formats").getOr(cl), f = function (n) { return vn.map(n, function (n) { if (pt(n, "items")) { var e = f(n.items); return D.deepMerge((u = n, D.deepMerge(u, { isSelected: O.constant(!1), getPreview: O.constant("") })), { items: e }) } return pt(n, "format") ? (i = n, D.deepMerge(i, { isSelected: c(i.format), getPreview: s(i.format) })) : (o = Ya((t = n).title), r = D.deepMerge(t, { format: o, isSelected: c(o), getPreview: s(o) }), a.formatter.register(o, r), r); var t, o, r, i, u }) }; return f(e) }, Rd = function (t, n, o) { var e, r, i, u = (e = t, i = (r = function (n) { return vn.bind(n, function (n) { return n.items !== undefined ? 0 < r(n.items).length ? [n] : [] : !pt(n, "format") || e.formatter.canApply(n.format) ? [n] : [] }) })(n), Ad.expand(i)); return Ed({ formats: u, handle: function (n, e) { t.undoManager.transact(function () { si.isOn(n) ? t.formatter.remove(e) : t.formatter.apply(e) }), o() } }) }, Id = ["undo", "bold", "italic", "link", "image", "bullist", "styleselect"], Fd = function (n) { var e = n.replace(/\|/g, " ").trim(); return 0 < e.length ? e.split(/\s+/) : [] }, Nd = function (n) { return vn.bind(n, function (n) { return E.isArray(n) ? Nd(n) : Fd(n) }) }, Vd = function (n) { var e = n.toolbar !== undefined ? n.toolbar : Id; return E.isArray(e) ? Nd(e) : Fd(e) }, Hd = function (o, r) { var n = function (n) { return function () { return Yc.forToolbarCommand(r, n) } }, e = function (n) { return function () { return Yc.forToolbarStateCommand(r, n) } }, t = function (n, e, t) { return function () { return Yc.forToolbarStateAction(r, n, e, t) } }, i = n("undo"), u = n("redo"), a = e("bold"), c = e("italic"), s = e("underline"), f = n("removeformat"), l = t("unlink", "link", function () { r.execCommand("unlink", null, !1) }), d = t("unordered-list", "ul", function () { r.execCommand("InsertUnorderedList", null, !1) }), m = t("ordered-list", "ol", function () { r.execCommand("InsertOrderedList", null, !1) }), g = Bd(r, r.settings), p = function () { return Rd(r, g, function () { r.fire("scrollIntoView") }) }, v = function (n, e) { return { isSupported: function () { return n.forall(function (n) { return pt(r.buttons, n) }) }, sketch: e } }; return { undo: v(y.none(), i), redo: v(y.none(), u), bold: v(y.none(), a), italic: v(y.none(), c), underline: v(y.none(), s), removeformat: v(y.none(), f), link: v(y.none(), function () { return e = o, t = r, Yc.forToolbarStateAction(t, "link", "link", function () { var n = al(e, t); e.setContextToolbar(n), Tf(t, function () { e.focusToolbar() }), wf.query(t).each(function (n) { t.selection.select(n.dom()) }) }); var e, t }), unlink: v(y.none(), l), image: v(y.none(), function () { return mf(r) }), bullist: v(y.some("bullist"), d), numlist: v(y.some("numlist"), m), fontsizeselect: v(y.none(), function () { return e = r, n = { onChange: function (n) { zs.apply(e, n) }, getInitialValue: function () { return zs.get(e) } }, As(o, "font-size", function () { return Ps(n) }); var e, n }), forecolor: v(y.none(), function () { return Rs(o, r) }), styleselect: v(y.none(), function () { return Yc.forToolbar("style-formats", function (n) { r.fire("toReading"), o.dropup().appear(p, si.on, n) }, Bo([si.config({ toggleClass: gi.resolve("toolbar-button-selected"), toggleOnExecute: !1, aria: { mode: "pressed" } }), Qr.config({ channels: mt([di(Sr.orientationChanged(), si.off), di(Sr.dropupDismissed(), si.off)]) })])) }) } }, jd = function (n, t) { var e = Vd(n), o = {}; return vn.bind(e, function (n) { var e = !pt(o, n) && pt(t, n) && t[n].isSupported() ? [t[n].sketch()] : []; return o[n] = !0, e }) }, zd = function (m, g) { return function (n) { if (m(n)) { var e, t, o, r, i, u, a, c = Xn.fromDom(n.target), s = function () { n.stopPropagation() }, f = function () { n.preventDefault() }, l = O.compose(f, s), d = (e = c, t = n.clientX, o = n.clientY, r = s, i = f, u = l, a = n, { target: O.constant(e), x: O.constant(t), y: O.constant(o), stop: r, prevent: i, kill: u, raw: O.constant(a) }); g(d) } } }, Ld = function (n, e, t, o, r) { var i = zd(t, o); return n.dom().addEventListener(e, i, r), { unbind: O.curry(Pd, n, e, i, r) } }, Pd = function (n, e, t, o) { n.dom().removeEventListener(e, t, o) }, Wd = function (n, e, t, o) { return Ld(n, e, t, o, !1) }, Ud = function (n, e, t, o) { return Ld(n, e, t, o, !0) }, Gd = O.constant(!0), $d = { bind: function (n, e, t) { return Wd(n, e, Gd, t) }, capture: function (n, e, t) { return Ud(n, e, Gd, t) } }, qd = function (n) { var e = n.matchMedia("(orientation: portrait)").matches; return { isPortrait: O.constant(e) } }, _d = qd, Kd = function (o, e) { var n = Xn.fromDom(o), r = null, t = $d.bind(n, "orientationchange", function () { clearInterval(r); var n = qd(o); e.onChange(n), i(function () { e.onReady(n) }) }), i = function (n) { clearInterval(r); var e = o.innerHeight, t = 0; r = setInterval(function () { e !== o.innerHeight ? (clearInterval(r), n(y.some(o.innerHeight))) : 20 < t && (clearInterval(r), n(y.none())), t++ }, 50) }; return { onAdjustment: i, destroy: function () { t.unbind() } } }, Xd = function (n) { var e = Mn.detect().os.isiOS(), t = qd(n).isPortrait(); return e && !t ? n.screen.height : n.screen.width }, Yd = function (n) { return n.raw().touches === undefined || 1 !== n.raw().touches.length ? y.none() : y.some(n.raw().touches[0]) }, Jd = function (t) { var o, r, i, u = ur(y.none()), a = (o = function (n) { u.set(y.none()), t.triggerEvent(jn(), n) }, r = 400, i = null, { cancel: function () { null !== i && (clearTimeout(i), i = null) }, schedule: function () { for (var n = [], e = 0; e < arguments.length; e++)n[e] = arguments[e]; var t = arguments; i = setTimeout(function () { o.apply(null, t), i = null }, r) } }), c = mt([{ key: T(), value: function (t) { return Yd(t).each(function (n) { a.cancel(); var e = { x: O.constant(n.clientX), y: O.constant(n.clientY), target: t.target }; a.schedule(t), u.set(y.some(e)) }), y.none() } }, { key: k(), value: function (n) { return a.cancel(), Yd(n).each(function (i) { u.get().each(function (n) { var e, t, o, r; e = i, t = n, o = Math.abs(e.clientX - t.x()), r = Math.abs(e.clientY - t.y()), (5 < o || 5 < r) && u.set(y.none()) }) }), y.none() } }, { key: C(), value: function (e) { return a.cancel(), u.get().filter(function (n) { return Te(n.target(), e.target()) }).map(function (n) { return t.triggerEvent(Vn(), e) }) } }]); return { fireIfReady: function (e, n) { return lt(c, n).bind(function (n) { return n(e) }) } } }, Qd = function (t) { var e = Jd({ triggerEvent: function (n, e) { t.onTapContent(e) } }); return { fireTouchstart: function (n) { e.fireIfReady(n, "touchstart") }, onTouchend: function () { return $d.bind(t.body(), "touchend", function (n) { e.fireIfReady(n, "touchend") }) }, onTouchmove: function () { return $d.bind(t.body(), "touchmove", function (n) { e.fireIfReady(n, "touchmove") }) } } }, Zd = 6 <= Mn.detect().os.version.major, nm = function (o, e, t) { var r = Qd(o), i = Be.owner(e), u = function (n) { return !Te(n.start(), n.finish()) || n.soffset() !== n.foffset() }, n = function () { var n = o.doc().dom().hasFocus() && o.getSelection().exists(u); t.getByDom(e).each(!0 === (n || hr(i).filter(function (n) { return "input" === ue.name(n) }).exists(function (n) { return n.dom().selectionStart !== n.dom().selectionEnd })) ? si.on : si.off) }, a = [$d.bind(o.body(), "touchstart", function (n) { o.onTouchContent(), r.fireTouchstart(n) }), r.onTouchmove(), r.onTouchend(), $d.bind(e, "touchstart", function (n) { o.onTouchToolstrip() }), o.onToReading(function () { vr(o.body()) }), o.onToEditing(O.noop), o.onScrollToCursor(function (n) { n.preventDefault(), o.getCursorBox().each(function (n) { var e = o.win(), t = n.top() > e.innerHeight || n.bottom() > e.innerHeight ? n.bottom() - e.innerHeight + 50 : 0; 0 !== t && e.scrollTo(e.pageXOffset, e.pageYOffset + t) }) })].concat(!0 === Zd ? [] : [$d.bind(Xn.fromDom(o.win()), "blur", function () { t.getByDom(e).each(si.off) }), $d.bind(i, "select", n), $d.bind(o.doc(), "selectionchange", n)]); return { destroy: function () { vn.each(a, function (n) { n.unbind() }) } } }, em = function (n, e) { var t = parseInt(Po.get(n, e), 10); return isNaN(t) ? 0 : t }, tm = (rf = ue.isText, uf = "text", af = function (n) { return rf(n) ? y.from(n.dom().nodeValue) : y.none() }, cf = Mn.detect().browser, { get: function (n) { if (!rf(n)) throw new Error("Can only get " + uf + " value of a " + uf + " node"); return sf(n).getOr("") }, getOption: sf = cf.isIE() && 10 === cf.version.major ? function (n) { try { return af(n) } catch (e) { return y.none() } } : af, set: function (n, e) { if (!rf(n)) throw new Error("Can only set raw " + uf + " value of a " + uf + " node"); n.dom().nodeValue = e } }), om = function (n) { return tm.getOption(n) }, rm = function (n) { return "img" === ue.name(n) ? 1 : om(n).fold(function () { return Be.children(n).length }, function (n) { return n.length }) }, im = rm, um = _e([{ before: ["element"] }, { on: ["element", "offset"] }, { after: ["element"] }]), am = { before: um.before, on: um.on, after: um.after, cata: function (n, e, t, o) { return n.fold(e, t, o) }, getStart: function (n) { return n.fold(O.identity, O.identity, O.identity) } }, cm = _e([{ domRange: ["rng"] }, { relative: ["startSitu", "finishSitu"] }, { exact: ["start", "soffset", "finish", "foffset"] }]), sm = de.immutable("start", "soffset", "finish", "foffset"), fm = { domRange: cm.domRange, relative: cm.relative, exact: cm.exact, exactFromRange: function (n) { return cm.exact(n.start(), n.soffset(), n.finish(), n.foffset()) }, range: sm, getWin: function (n) { var e = n.match({ domRange: function (n) { return Xn.fromDom(n.startContainer) }, relative: function (n, e) { return am.getStart(n) }, exact: function (n, e, t, o) { return n } }); return Be.defaultView(e) } }, lm = function (n, e, t, o) { var r = Be.owner(n).dom().createRange(); return r.setStart(n.dom(), e), r.setEnd(t.dom(), o), r }, dm = function (n, e, t, o) { var r = lm(n, e, t, o), i = Te(n, t) && e === o; return r.collapsed && !i }, mm = function (n, e) { n.selectNodeContents(e.dom()) }, gm = function (n) { n.deleteContents() }, pm = function (n) { return { left: O.constant(n.left), top: O.constant(n.top), right: O.constant(n.right), bottom: O.constant(n.bottom), width: O.constant(n.width), height: O.constant(n.height) } }, vm = { create: function (n) { return n.document.createRange() }, replaceWith: function (n, e) { gm(n), n.insertNode(e.dom()) }, selectNodeContents: function (n, e) { var t = n.document.createRange(); return mm(t, e), t }, selectNodeContentsUsing: mm, relativeToNative: function (n, e, t) { var o, r, i = n.document.createRange(); return o = i, e.fold(function (n) { o.setStartBefore(n.dom()) }, function (n, e) { o.setStart(n.dom(), e) }, function (n) { o.setStartAfter(n.dom()) }), r = i, t.fold(function (n) { r.setEndBefore(n.dom()) }, function (n, e) { r.setEnd(n.dom(), e) }, function (n) { r.setEndAfter(n.dom()) }), i }, exactToNative: function (n, e, t, o, r) { var i = n.document.createRange(); return i.setStart(e.dom(), t), i.setEnd(o.dom(), r), i }, deleteContents: gm, cloneFragment: function (n) { var e = n.cloneContents(); return Xn.fromDom(e) }, getFirstRect: function (n) { var e = n.getClientRects(), t = 0 < e.length ? e[0] : n.getBoundingClientRect(); return 0 < t.width || 0 < t.height ? y.some(t).map(pm) : y.none() }, getBounds: function (n) { var e = n.getBoundingClientRect(); return 0 < e.width || 0 < e.height ? y.some(e).map(pm) : y.none() }, isWithin: function (n, e) { return e.compareBoundaryPoints(n.END_TO_START, n) < 1 && -1 < e.compareBoundaryPoints(n.START_TO_END, n) }, toString: function (n) { return n.toString() } }, hm = _e([{ ltr: ["start", "soffset", "finish", "foffset"] }, { rtl: ["start", "soffset", "finish", "foffset"] }]), bm = function (n, e, t) { return e(Xn.fromDom(t.startContainer), t.startOffset, Xn.fromDom(t.endContainer), t.endOffset) }, ym = function (n, e) { var r, t, o, i = (r = n, e.match({ domRange: function (n) { return { ltr: O.constant(n), rtl: y.none } }, relative: function (n, e) { return { ltr: L(function () { return vm.relativeToNative(r, n, e) }), rtl: L(function () { return y.some(vm.relativeToNative(r, e, n)) }) } }, exact: function (n, e, t, o) { return { ltr: L(function () { return vm.exactToNative(r, n, e, t, o) }), rtl: L(function () { return y.some(vm.exactToNative(r, t, o, n, e)) }) } } })); return (o = (t = i).ltr()).collapsed ? t.rtl().filter(function (n) { return !1 === n.collapsed }).map(function (n) { return hm.rtl(Xn.fromDom(n.endContainer), n.endOffset, Xn.fromDom(n.startContainer), n.startOffset) }).getOrThunk(function () { return bm(0, hm.ltr, o) }) : bm(0, hm.ltr, o) }, wm = (hm.ltr, hm.rtl, ym), xm = function (i, n) { return ym(i, n).match({ ltr: function (n, e, t, o) { var r = i.document.createRange(); return r.setStart(n.dom(), e), r.setEnd(t.dom(), o), r }, rtl: function (n, e, t, o) { var r = i.document.createRange(); return r.setStart(t.dom(), o), r.setEnd(n.dom(), e), r } }) }, Sm = (document.caretPositionFromPoint || document.caretRangeFromPoint, function (n, e) { var t = ue.name(n); return "input" === t ? am.after(n) : vn.contains(["br", "img"], t) ? 0 === e ? am.before(n) : am.after(n) : am.on(n, e) }), Tm = function (n, e, t, o) { var r = Sm(n, e), i = Sm(t, o); return fm.relative(r, i) }, km = Tm, Cm = function (n, e) { y.from(n.getSelection()).each(function (n) { n.removeAllRanges(), n.addRange(e) }) }, Om = function (n, e, t, o, r) { var i = vm.exactToNative(n, e, t, o, r); Cm(n, i) }, Em = function (i, n) { return wm(i, n).match({ ltr: function (n, e, t, o) { Om(i, n, e, t, o) }, rtl: function (n, e, t, o) { var r = i.getSelection(); r.setBaseAndExtent ? r.setBaseAndExtent(n.dom(), e, t.dom(), o) : r.extend ? (r.collapse(n.dom(), e), r.extend(t.dom(), o)) : Om(i, t, o, n, e) } }) }, Dm = function (n) { var e = Xn.fromDom(n.anchorNode), t = Xn.fromDom(n.focusNode); return dm(e, n.anchorOffset, t, n.focusOffset) ? y.some(fm.range(Xn.fromDom(n.anchorNode), n.anchorOffset, Xn.fromDom(n.focusNode), n.focusOffset)) : function (n) { if (0 < n.rangeCount) { var e = n.getRangeAt(0), t = n.getRangeAt(n.rangeCount - 1); return y.some(fm.range(Xn.fromDom(e.startContainer), e.startOffset, Xn.fromDom(t.endContainer), t.endOffset)) } return y.none() }(n) }, Mm = function (n) { var e = n.getSelection(); return 0 < e.rangeCount ? Dm(e) : y.none() }, Am = function (n, e, t, o, r) { var i = km(e, t, o, r); Em(n, i) }, Bm = Mm, Rm = function (n) { return Mm(n).map(function (n) { return fm.exact(n.start(), n.soffset(), n.finish(), n.foffset()) }) }, Im = function (n) { n.getSelection().removeAllRanges() }, Fm = function (n, e) { var t = xm(n, e); return vm.getFirstRect(t) }, Nm = function (n) { return { left: n.left, top: n.top, right: n.right, bottom: n.bottom, width: O.constant(2), height: n.height } }, Vm = function (n) { return { left: O.constant(n.left), top: O.constant(n.top), right: O.constant(n.right), bottom: O.constant(n.bottom), width: O.constant(n.width), height: O.constant(n.height) } }, Hm = { getRectangles: function (n) { var e = n.getSelection(); return e !== undefined && 0 < e.rangeCount ? function (t) { if (t.collapsed) { var o = Xn.fromDom(t.startContainer); return Be.parent(o).bind(function (n) { var e = fm.exact(o, t.startOffset, n, im(n)); return Fm(t.startContainer.ownerDocument.defaultView, e).map(Nm).map(vn.pure) }).getOr([]) } return vn.map(t.getClientRects(), Vm) }(e.getRangeAt(0)) : [] } }, jm = function (n) { n.focus(); var e = Xn.fromDom(n.document.body); (hr().exists(function (n) { return vn.contains(["input", "textarea"], ue.name(n)) }) ? function (n) { setTimeout(function () { n() }, 0) } : O.apply)(function () { hr().each(vr), pr(e) }) }, zm = "data-" + gi.resolve("last-outer-height"), Lm = function (n, e) { Po.set(n, zm, e) }, Pm = function (n) { return { top: O.constant(n.top()), bottom: O.constant(n.top() + n.height()) } }, Wm = function (n, e) { var t = em(e, zm), o = n.innerHeight; return o < t ? y.some(t - o) : y.none() }, Um = function (n, u) { var e = Xn.fromDom(u.document.body), t = $d.bind(Xn.fromDom(n), "resize", function () { Wm(n, e).each(function (i) { var n, e; (n = u, e = Hm.getRectangles(n), 0 < e.length ? y.some(e[0]).map(Pm) : y.none()).each(function (n) { var e, t, o, r = (e = u, o = i, (t = n).top() > e.innerHeight || t.bottom() > e.innerHeight ? Math.min(o, t.bottom() - e.innerHeight + 50) : 0); 0 !== r && u.scrollTo(u.pageXOffset, u.pageYOffset + r) }) }), Lm(e, n.innerHeight) }); return Lm(e, n.innerHeight), { toEditing: function () { jm(u) }, destroy: function () { t.unbind() } } }, Gm = function (n) { return y.some(Xn.fromDom(n.dom().contentWindow.document.body)) }, $m = function (n) { return y.some(Xn.fromDom(n.dom().contentWindow.document)) }, qm = function (n) { return y.from(n.dom().contentWindow) }, _m = function (n) { return qm(n).bind(Bm) }, Km = function (n) { return n.getFrame() }, Xm = function (n, t) { return function (e) { return e[n].getOrThunk(function () { var n = Km(e); return function () { return t(n) } })() } }, Ym = function (n, e, t, o) { return n[t].getOrThunk(function () { return function (n) { return $d.bind(e, o, n) } }) }, Jm = function (n) { return { left: O.constant(n.left), top: O.constant(n.top), right: O.constant(n.right), bottom: O.constant(n.bottom), width: O.constant(n.width), height: O.constant(n.height) } }, Qm = { getBody: Xm("getBody", Gm), getDoc: Xm("getDoc", $m), getWin: Xm("getWin", qm), getSelection: Xm("getSelection", _m), getFrame: Km, getActiveApi: function (a) { var c = Km(a); return Gm(c).bind(function (u) { return $m(c).bind(function (i) { return qm(c).map(function (r) { var n = Xn.fromDom(i.dom().documentElement), e = a.getCursorBox.getOrThunk(function () { return function () { return Rm(r).bind(function (n) { return Fm(r, n).orThunk(function () { return Bm(r).filter(function (n) { return Te(n.start(), n.finish()) && n.soffset() === n.foffset() }).bind(function (n) { var e = n.start().dom().getBoundingClientRect(); return 0 < e.width || 0 < e.height ? y.some(e).map(Jm) : y.none() }) }) }) } }), t = a.setSelection.getOrThunk(function () { return function (n, e, t, o) { Am(r, n, e, t, o) } }), o = a.clearSelection.getOrThunk(function () { return function () { Im(r) } }); return { body: O.constant(u), doc: O.constant(i), win: O.constant(r), html: O.constant(n), getSelection: O.curry(_m, c), setSelection: t, clearSelection: o, frame: O.constant(c), onKeyup: Ym(a, i, "onKeyup", "keyup"), onNodeChanged: Ym(a, i, "onNodeChanged", "selectionchange"), onDomChanged: a.onDomChanged, onScrollToCursor: a.onScrollToCursor, onScrollToElement: a.onScrollToElement, onToReading: a.onToReading, onToEditing: a.onToEditing, onToolbarScrollStart: a.onToolbarScrollStart, onTouchContent: a.onTouchContent, onTapContent: a.onTapContent, onTouchToolstrip: a.onTouchToolstrip, getCursorBox: e } }) }) }) } }, Zm = "data-ephox-mobile-fullscreen-style", ng = "position:absolute!important;", eg = "top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;", tg = Mn.detect().os.isAndroid(), og = function (n, e) { var t, o, r = function (o) { return function (n) { var e = Po.get(n, "style"), t = e === undefined ? "no-styles" : e.trim(); t !== o && (Po.set(n, Zm, t), Po.set(n, "style", o)) } }, i = Ni(n, "*"), u = vn.bind(i, function (n) { return Vi(n, "*") }), a = (t = e, (o = Oi.get(t, "background-color")) !== undefined && "" !== o ? "background-color:" + o + "!important" : "background-color:rgb(255,255,255)!important;"); vn.each(u, r("display:none!important;")), vn.each(i, r(ng + eg + a)), r((!0 === tg ? "" : ng) + eg + a)(n) }, rg = function () { var n = Fi("[" + Zm + "]"); vn.each(n, function (n) { var e = Po.get(n, Zm); "no-styles" !== e ? Po.set(n, "style", e) : Po.remove(n, "style"), Po.remove(n, Zm) }) }, ig = function () { var e = zi("head").getOrDie(), n = zi('meta[name="viewport"]').getOrThunk(function () { var n = Xn.fromTag("meta"); return Po.set(n, "name", "viewport"), Fe.append(e, n), n }), t = Po.get(n, "content"); return { maximize: function () { Po.set(n, "content", "width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0") }, restore: function () { t !== undefined && null !== t && 0 < t.length ? Po.set(n, "content", t) : Po.set(n, "content", "user-scalable=yes") } } }, ug = function (e, n) { var t = ig(), o = tl.api(), r = tl.api(); return { enter: function () { n.hide(), er.add(e.container, gi.resolve("fullscreen-maximized")), er.add(e.container, gi.resolve("android-maximized")), t.maximize(), er.add(e.body, gi.resolve("android-scroll-reload")), o.set(Um(e.win, Qm.getWin(e.editor).getOrDie("no"))), Qm.getActiveApi(e.editor).each(function (n) { og(e.container, n.body()), r.set(nm(n, e.toolstrip, e.alloy)) }) }, exit: function () { t.restore(), n.show(), er.remove(e.container, gi.resolve("fullscreen-maximized")), er.remove(e.container, gi.resolve("android-maximized")), rg(), er.remove(e.body, gi.resolve("android-scroll-reload")), r.clear(), o.clear() } } }, ag = function (e, t) { var o = null; return { cancel: function () { null !== o && (clearTimeout(o), o = null) }, throttle: function () { var n = arguments; null === o && (o = setTimeout(function () { e.apply(null, n), n = o = null }, t)) } } }, cg = function (e, t) { var o = null; return { cancel: function () { null !== o && (clearTimeout(o), o = null) }, throttle: function () { var n = arguments; null !== o && clearTimeout(o), o = setTimeout(function () { e.apply(null, n), n = o = null }, t) } } }, sg = function (n, e) { var t = Ws(Df.sketch({ dom: qc('<div aria-hidden="true" class="${prefix}-mask-tap-icon"></div>'), containerBehaviours: Bo([si.config({ toggleClass: gi.resolve("mask-tap-icon-selected"), toggleOnExecute: !1 })]) })), o = ag(n, 200); return Df.sketch({ dom: qc('<div class="${prefix}-disabled-mask"></div>'), components: [Df.sketch({ dom: qc('<div class="${prefix}-content-container"></div>'), components: [Wc.sketch({ dom: qc('<div class="${prefix}-content-tap-section"></div>'), components: [t.asSpec()], action: function (n) { o.throttle() }, buttonBehaviours: Bo([si.config({ toggleClass: gi.resolve("mask-tap-icon-selected") })]) })] })] }) }, fg = Dt([Ht("editor", [Ft("getFrame"), jt("getBody"), jt("getDoc"), jt("getWin"), jt("getSelection"), jt("setSelection"), jt("clearSelection"), jt("cursorSaver"), jt("onKeyup"), jt("onNodeChanged"), jt("getCursorBox"), Ft("onDomChanged"), Pt("onTouchContent", O.noop), Pt("onTapContent", O.noop), Pt("onTouchToolstrip", O.noop), Pt("onScrollToCursor", O.constant({ unbind: O.noop })), Pt("onScrollToElement", O.constant({ unbind: O.noop })), Pt("onToEditing", O.constant({ unbind: O.noop })), Pt("onToReading", O.constant({ unbind: O.noop })), Pt("onToolbarScrollStart", O.identity)]), Ft("socket"), Ft("toolstrip"), Ft("dropup"), Ft("toolbar"), Ft("container"), Ft("alloy"), Ut("win", function (n) { return Be.owner(n.socket).dom().defaultView }), Ut("body", function (n) { return Xn.fromDom(n.socket.dom().ownerDocument.body) }), Pt("translate", O.identity), Pt("setReadOnly", O.noop), Pt("readOnlyOnInit", O.constant(!0))]), lg = { produce: function (n) { var e = Yt("Getting AndroidWebapp schema", fg, n); Oi.set(e.toolstrip, "width", "100%"); var t = Pl(sg(function () { e.setReadOnly(!0), r.enter() }, e.translate)); e.alloy.add(t); var o = { show: function () { e.alloy.add(t) }, hide: function () { e.alloy.remove(t) } }; Fe.append(e.container, t.element()); var r = ug(e, o); return { setReadOnly: e.setReadOnly, refreshStructure: O.noop, enter: r.enter, exit: r.exit, destroy: O.noop } } }, dg = O.constant([Pt("shell", !0), za("toolbarBehaviours", [cd])]), mg = O.constant([lc({ name: "groups", overrides: function (n) { return { behaviours: Bo([cd.config({})]) } } })]), gg = (O.constant("Toolbar"), Pc({ name: "Toolbar", configFields: dg(), partFields: mg(), factory: function (e, n, t, o) { var r = function (n) { return e.shell() ? y.some(n) : yc(n, e, "groups") }, i = e.shell() ? { behaviours: [cd.config({})], components: [] } : { behaviours: [], components: n }; return { uid: e.uid(), dom: e.dom(), components: i.components, behaviours: D.deepMerge(Bo(i.behaviours), La(e.toolbarBehaviours())), apis: { setGroups: function (n, e) { r(n).fold(function () { throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"), new Error("Toolbar was defined to not be a shell, but no groups container was specified in components") }, function (n) { cd.set(n, e) }) } }, domModification: { attributes: { role: "group" } } } }, apis: { setGroups: function (n, e, t) { n.setGroups(e, t) } } })), pg = O.constant([Ft("items"), (ff = ["itemClass"], Ht("markers", vn.map(ff, Ft))), za("tgroupBehaviours", [ja])]), vg = O.constant([dc({ name: "items", unit: "item", overrides: function (n) { return { domModification: { classes: [n.markers().itemClass()] } } } })]), hg = (O.constant("ToolbarGroup"), Pc({ name: "ToolbarGroup", configFields: pg(), partFields: vg(), factory: function (n, e, t, o) { return D.deepMerge({ dom: { attributes: { role: "toolbar" } } }, { uid: n.uid(), dom: n.dom(), components: e, behaviours: D.deepMerge(Bo([ja.config({ mode: "flow", selector: "." + n.markers().itemClass() })]), La(n.tgroupBehaviours())), "debug.sketcher": t["debug.sketcher"] }) } })), bg = "data-" + gi.resolve("horizontal-scroll"), yg = function (n) { return 0 < n.dom().scrollTop || function (n) { n.dom().scrollTop = 1; var e = 0 !== n.dom().scrollTop; return n.dom().scrollTop = 0, e }(n) }, wg = function (n) { return 0 < n.dom().scrollLeft || function (n) { n.dom().scrollLeft = 1; var e = 0 !== n.dom().scrollLeft; return n.dom().scrollLeft = 0, e }(n) }, xg = function (n) { return "true" === Po.get(n, bg) ? wg : yg }, Sg = { exclusive: function (n, e) { return $d.bind(n, "touchmove", function (n) { Wi(n.target(), e).filter(xg).fold(function () { n.raw().preventDefault() }, O.noop) }) }, markAsHorizontal: function (n) { Po.set(n, bg, "true") } }; function Tg() { var e = function (n) { var e = !0 === n.scrollable ? "${prefix}-toolbar-scrollable-group" : ""; return { dom: qc('<div aria-label="' + n.label + '" class="${prefix}-toolbar-group ' + e + '"></div>'), tgroupBehaviours: Bo([kf("adhoc-scrollable-toolbar", !0 === n.scrollable ? [mo(function (n, e) { Oi.set(n.element(), "overflow-x", "auto"), Sg.markAsHorizontal(n.element()), Td.register(n.element()) })] : [])]), components: [Df.sketch({ components: [hg.parts().items({})] })], markers: { itemClass: gi.resolve("toolbar-group-item") }, items: n.items } }, t = Pl(gg.sketch({ dom: qc('<div class="${prefix}-toolbar"></div>'), components: [gg.parts().groups({})], toolbarBehaviours: Bo([si.config({ toggleClass: gi.resolve("context-toolbar"), toggleOnExecute: !1, aria: { mode: "none" } }), ja.config({ mode: "cyclic" })]), shell: !0 })), n = Pl(Df.sketch({ dom: { classes: [gi.resolve("toolstrip")] }, components: [Wl(t)], containerBehaviours: Bo([si.config({ toggleClass: gi.resolve("android-selection-context-toolbar"), toggleOnExecute: !1 })]) })), o = function () { gg.setGroups(t, r.get()), si.off(t) }, r = ur([]); return { wrapper: O.constant(n), toolbar: O.constant(t), createGroups: function (n) { return vn.map(n, O.compose(hg.sketch, e)) }, setGroups: function (n) { r.set(n), o() }, setContextToolbar: function (n) { si.on(t), gg.setGroups(t, n) }, restoreToolbar: function () { si.isOn(t) && o() }, refresh: function () { }, focus: function () { ja.focusIn(t) } } } var kg = function (n, e) { cd.append(n, Wl(e)) }, Cg = function (n, e) { cd.remove(n, e) }, Og = { makeEditSwitch: function (n) { return Pl(Wc.sketch({ dom: qc('<div class="${prefix}-mask-edit-icon ${prefix}-icon"></div>'), action: function () { n.run(function (n) { n.setReadOnly(!1) }) } })) }, makeSocket: function () { return Pl(Df.sketch({ dom: qc('<div class="${prefix}-editor-socket"></div>'), components: [], containerBehaviours: Bo([cd.config({})]) })) }, updateMode: function (n, e, t, o) { (!0 === t ? ir.toAlpha : ir.toOmega)(o), (t ? kg : Cg)(n, e) } }, Eg = function (e, n) { return n.getAnimationRoot().fold(function () { return e.element() }, function (n) { return n(e) }) }, Dg = function (n) { return n.dimension().property() }, Mg = function (n, e) { return n.dimension().getDimension()(e) }, Ag = function (n, e) { var t = Eg(n, e); Bl.remove(t, [e.shrinkingClass(), e.growingClass()]) }, Bg = function (n, e) { er.remove(n.element(), e.openClass()), er.add(n.element(), e.closedClass()), Oi.set(n.element(), Dg(e), "0px"), Oi.reflow(n.element()) }, Rg = function (n, e) { er.remove(n.element(), e.closedClass()), er.add(n.element(), e.openClass()), Oi.remove(n.element(), Dg(e)) }, Ig = function (n, e, t) { t.setCollapsed(), Oi.set(n.element(), Dg(e), Mg(e, n.element())), Oi.reflow(n.element()); var o = Eg(n, e); er.add(o, e.shrinkingClass()), Bg(n, e), e.onStartShrink()(n) }, Fg = function (n, e, t) { var o = function (n, e) { Rg(n, e); var t = Mg(e, n.element()); return Bg(n, e), t }(n, e), r = Eg(n, e); er.add(r, e.growingClass()), Rg(n, e), Oi.set(n.element(), Dg(e), o), t.setExpanded(), e.onStartGrow()(n) }, Ng = function (n, e, t) { var o = Eg(n, e); return !0 === er.has(o, e.growingClass()) }, Vg = function (n, e, t) { var o = Eg(n, e); return !0 === er.has(o, e.shrinkingClass()) }, Hg = Object.freeze({ grow: function (n, e, t) { t.isExpanded() || Fg(n, e, t) }, shrink: function (n, e, t) { t.isExpanded() && Ig(n, e, t) }, immediateShrink: function (n, e, t) { var o, r; t.isExpanded() && (o = n, r = e, t.setCollapsed(), Oi.set(o.element(), Dg(r), Mg(r, o.element())), Oi.reflow(o.element()), Ag(o, r), Bg(o, r), r.onStartShrink()(o), r.onShrunk()(o)) }, hasGrown: function (n, e, t) { return t.isExpanded() }, hasShrunk: function (n, e, t) { return t.isCollapsed() }, isGrowing: Ng, isShrinking: Vg, isTransitioning: function (n, e, t) { return !0 === Ng(n, e) || !0 === Vg(n, e) }, toggleGrow: function (n, e, t) { (t.isExpanded() ? Ig : Fg)(n, e, t) }, disableTransitions: Ag }), jg = Object.freeze({ exhibit: function (n, e) { var t = e.expanded(); return bo(t ? { classes: [e.openClass()], styles: {} } : { classes: [e.closedClass()], styles: dt(e.dimension().property(), "0px") }) }, events: function (t, o) { return oo([io(j(), function (n, e) { e.event().raw().propertyName === t.dimension().property() && (Ag(n, t), o.isExpanded() && Oi.remove(n.element(), t.dimension().property()), (o.isExpanded() ? t.onGrown() : t.onShrunk())(n, e)) })]) } }), zg = [Ft("closedClass"), Ft("openClass"), Ft("shrinkingClass"), Ft("growingClass"), jt("getAnimationRoot"), Gr("onShrunk"), Gr("onStartShrink"), Gr("onGrown"), Gr("onStartGrow"), Pt("expanded", !1), Nt("dimension", Zt("property", { width: [Kr("property", "width"), Kr("getDimension", function (n) { return Es(n) + "px" })], height: [Kr("property", "height"), Kr("getDimension", function (n) { return Bi(n) + "px" })] }))], Lg = Object.freeze({ init: function (n) { var e = ur(n.expanded()); return Do({ isExpanded: function () { return !0 === e.get() }, isCollapsed: function () { return !1 === e.get() }, setCollapsed: O.curry(e.set, !1), setExpanded: O.curry(e.set, !0), readState: function () { return "expanded: " + e.get() } }) } }), Pg = Io({ fields: zg, name: "sliding", active: jg, apis: Hg, state: Lg }), Wg = function (e, t) { var o = Pl(Df.sketch({ dom: { tag: "div", classes: gi.resolve("dropup") }, components: [], containerBehaviours: Bo([cd.config({}), Pg.config({ closedClass: gi.resolve("dropup-closed"), openClass: gi.resolve("dropup-open"), shrinkingClass: gi.resolve("dropup-shrinking"), growingClass: gi.resolve("dropup-growing"), dimension: { property: "height" }, onShrunk: function (n) { e(), t(), cd.set(n, []) }, onGrown: function (n) { e(), t() } }), li(function (n, e) { r(O.noop) })]) })), r = function (n) { window.requestAnimationFrame(function () { n(), Pg.shrink(o) }) }; return { appear: function (n, e, t) { !0 === Pg.hasShrunk(o) && !1 === Pg.isTransitioning(o) && window.requestAnimationFrame(function () { e(t), cd.set(o, [n()]), Pg.grow(o) }) }, disappear: r, component: O.constant(o), element: o.element } }, Ug = Mn.detect().browser.isFirefox(), Gg = Et([Vt("triggerEvent"), Vt("broadcastEvent"), Pt("stopBackspace", !0)]), $g = function (e, n) { var t, o, r, i, u = Yt("Getting GUI events settings", Gg, n), a = Mn.detect().deviceType.isTouch() ? ["touchstart", "touchmove", "touchend", "gesturestart"] : ["mousedown", "mouseup", "mouseover", "mousemove", "mouseout", "click"], c = Jd(u), s = vn.map(a.concat(["selectstart", "input", "contextmenu", "change", "transitionend", "dragstart", "dragover", "drop"]), function (n) { return $d.bind(e, n, function (e) { c.fireIfReady(e, n).each(function (n) { n && e.kill() }), u.triggerEvent(n, e) && e.kill() }) }), f = $d.bind(e, "keydown", function (n) { var e; u.triggerEvent("keydown", n) ? n.kill() : !0 !== u.stopBackspace || (e = n).raw().which !== Ui.BACKSPACE()[0] || vn.contains(["input", "textarea"], ue.name(e.target())) || n.prevent() }), l = (t = e, o = function (n) { u.triggerEvent("focusin", n) && n.kill() }, Ug ? $d.capture(t, "focus", o) : $d.bind(t, "focusin", o)), d = (r = e, i = function (n) { u.triggerEvent("focusout", n) && n.kill(), setTimeout(function () { u.triggerEvent(Rn(), n) }, 0) }, Ug ? $d.capture(r, "blur", i) : $d.bind(r, "focusout", i)), m = Be.defaultView(e), g = $d.bind(m, "scroll", function (n) { u.broadcastEvent(Ln(), n) && n.kill() }); return { unbind: function () { vn.each(s, function (n) { n.unbind() }), f.unbind(), l.unbind(), d.unbind(), g.unbind() } } }, qg = function (n, e) { var t = lt(n, "target").map(function (n) { return n() }).getOr(e); return ur(t) }, _g = _e([{ stopped: [] }, { resume: ["element"] }, { complete: [] }]), Kg = function (n, o, e, t, r, i) { var u, a, c, s, f = n(o, t), l = (u = e, a = r, c = ur(!1), s = ur(!1), { stop: function () { c.set(!0) }, cut: function () { s.set(!0) }, isStopped: c.get, isCut: s.get, event: O.constant(u), setSource: a.set, getSource: a.get }); return f.fold(function () { return i.logEventNoHandlers(o, t), _g.complete() }, function (e) { var t = e.descHandler(); return Tl(t)(l), l.isStopped() ? (i.logEventStopped(o, e.element(), t.purpose()), _g.stopped()) : l.isCut() ? (i.logEventCut(o, e.element(), t.purpose()), _g.complete()) : Be.parent(e.element()).fold(function () { return i.logNoParent(o, e.element(), t.purpose()), _g.complete() }, function (n) { return i.logEventResponse(o, e.element(), t.purpose()), _g.resume(n) }) }) }, Xg = function (e, t, o, n, r, i) { return Kg(e, t, o, n, r, i).fold(function () { return !0 }, function (n) { return Xg(e, t, o, n, r, i) }, function () { return !1 }) }, Yg = function (n, e, t) { var o, r, i = (o = e, r = ur(!1), { stop: function () { r.set(!0) }, cut: O.noop, isStopped: r.get, isCut: O.constant(!1), event: O.constant(o), setTarget: O.die("Cannot set target of a broadcasted event"), getTarget: O.die("Cannot get target of a broadcasted event") }); return vn.each(n, function (n) { var e = n.descHandler(); Tl(e)(i) }), i.isStopped() }, Jg = function (n, e, t, o, r) { var i = qg(t, o); return Xg(n, e, t, o, i, r) }, Qg = function (n, e, t) { return lr.closest(n, function (n) { return e(n).isSome() }, t).bind(e) }, Zg = de.immutable("element", "descHandler"), np = function (n, e) { return { id: O.constant(n), descHandler: O.constant(e) } }; function ep() { var i = {}; return { registerId: function (o, r, n) { M.each(n, function (n, e) { var t = i[e] !== undefined ? i[e] : {}; t[r] = Sl(n, o), i[e] = t }) }, unregisterId: function (t) { M.each(i, function (n, e) { n.hasOwnProperty(t) && delete n[t] }) }, filterByType: function (n) { return lt(i, n).map(function (n) { return M.mapToArray(n, function (n, e) { return np(e, n) }) }).getOr([]) }, find: function (n, e, t) { var r = st(e)(i); return Qg(t, function (n) { return t = r, Ic(o = n).fold(function () { return y.none() }, function (n) { var e = st(n); return t.bind(e).map(function (n) { return Zg(o, n) }) }); var t, o }, n) } } } function tp() { var i = ep(), u = {}, a = function (n) { Ic(n.element()).each(function (n) { u[n] = undefined, i.unregisterId(n) }) }; return { find: function (n, e, t) { return i.find(n, e, t) }, filter: function (n) { return i.filterByType(n) }, register: function (n) { var e, t, o = (t = (e = n).element(), Ic(t).fold(function () { return Rc("uid-", e.element()) }, function (n) { return n })); pt(u, o) && function (n, e) { var t = u[e]; if (t !== n) throw new Error('The tagId "' + e + '" is already used by: ' + Ar(t.element()) + "\nCannot use it for: " + Ar(n.element()) + "\nThe conflicting element is" + (se.inBody(t.element()) ? " " : " not ") + "already in the DOM"); a(n) }(n, o); var r = [n]; i.registerId(r, o, n.events()), u[o] = n }, unregister: a, getById: function (n) { return st(n)(u) } } } var op = function (t) { var o = function (e) { return Be.parent(t.element()).fold(function () { return !0 }, function (n) { return Te(e, n) }) }, r = tp(), s = function (n, e) { return r.find(o, n, e) }, n = $g(t.element(), { triggerEvent: function (u, a) { return jr(u, a.target(), function (n) { return e = s, t = u, r = n, i = (o = a).target(), Jg(e, t, o, i, r); var e, t, o, r, i }) }, broadcastEvent: function (n, e) { var t = r.filter(n); return Yg(t, e) } }), i = ll({ debugInfo: O.constant("real"), triggerEvent: function (e, t, o) { jr(e, t, function (n) { Jg(s, e, o, t, n) }) }, triggerFocus: function (a, c) { Ic(a).fold(function () { pr(a) }, function (n) { jr(Bn(), a, function (n) { var e, t, o, r, i, u; e = s, t = Bn(), o = { originator: O.constant(c), target: O.constant(a) }, i = n, u = qg(o, r = a), Kg(e, t, o, r, u, i) }) }) }, triggerEscape: function (n, e) { i.triggerEvent("keydown", n.element(), e.event()) }, getByUid: function (n) { return m(n) }, getByDom: function (n) { return g(n) }, build: Pl, addToGui: function (n) { a(n) }, removeFromGui: function (n) { c(n) }, addToWorld: function (n) { e(n) }, removeFromWorld: function (n) { u(n) }, broadcast: function (n) { l(n) }, broadcastOn: function (n, e) { d(n, e) } }), e = function (n) { n.connect(i), ue.isText(n.element()) || (r.register(n), vn.each(n.components(), e), i.triggerEvent(zn(), n.element(), { target: O.constant(n.element()) })) }, u = function (n) { ue.isText(n.element()) || (vn.each(n.components(), u), r.unregister(n)), n.disconnect() }, a = function (n) { Le(t, n) }, c = function (n) { Ue(n) }, f = function (t) { var n = r.filter(In()); vn.each(n, function (n) { var e = n.descHandler(); Tl(e)(t) }) }, l = function (n) { f({ universal: O.constant(!0), data: O.constant(n) }) }, d = function (n, e) { f({ universal: O.constant(!1), channels: O.constant(n), data: O.constant(e) }) }, m = function (n) { return r.getById(n).fold(function () { return qe.error(new Error('Could not find component with uid: "' + n + '" in system.')) }, qe.value) }, g = function (n) { var e = Ic(n).getOr("not found"); return m(e) }; return e(t), { root: O.constant(t), element: t.element, destroy: function () { n.unbind(), He.remove(t.element()) }, add: a, remove: c, getByUid: m, getByDom: g, addToWorld: e, removeFromWorld: u, broadcast: l, broadcastOn: d } }, rp = O.constant(gi.resolve("readonly-mode")), ip = O.constant(gi.resolve("edit-mode")); function up(n) { var e = Pl(Df.sketch({ dom: { classes: [gi.resolve("outer-container")].concat(n.classes) }, containerBehaviours: Bo([ir.config({ alpha: rp(), omega: ip() })]) })); return op(e) } var ap = function (n, e) { var t = Xn.fromTag("input"); Oi.setAll(t, { opacity: "0", position: "absolute", top: "-1000px", left: "-1000px" }), Fe.append(n, t), pr(t), e(t), He.remove(t) }, cp = function (n) { var e = n.getSelection(); if (0 < e.rangeCount) { var t = e.getRangeAt(0), o = n.document.createRange(); o.setStart(t.startContainer, t.startOffset), o.setEnd(t.endContainer, t.endOffset), e.removeAllRanges(), e.addRange(o) } }, sp = { resume: function (n, e) { hr().each(function (n) { Te(n, e) || vr(n) }), n.focus(), pr(Xn.fromDom(n.document.body)), cp(n) } }, fp = { stubborn: function (n, e, t, o) { var r = function () { sp.resume(e, o) }, i = $d.bind(t, "keydown", function (n) { vn.contains(["input", "textarea"], ue.name(n.target())) || r() }); return { toReading: function () { ap(n, vr) }, toEditing: r, onToolbarTouch: function () { }, destroy: function () { i.unbind() } } }, timid: function (n, e, t, o) { var r = function () { vr(o) }; return { toReading: function () { r() }, toEditing: function () { sp.resume(e, o) }, onToolbarTouch: function () { r() }, destroy: O.noop } } }, lp = function (t, o, r, i, n) { var u = function () { o.run(function (n) { n.refreshSelection() }) }, e = function (n, e) { var t = n - i.dom().scrollTop; o.run(function (n) { n.scrollIntoView(t, t + e) }) }, a = function () { o.run(function (n) { n.clearSelection() }) }, c = function () { t.getCursorBox().each(function (n) { e(n.top(), n.height()) }), o.run(function (n) { n.syncHeight() }) }, s = Qd(t), f = cg(c, 300), l = [t.onKeyup(function () { a(), f.throttle() }), t.onNodeChanged(u), t.onDomChanged(f.throttle), t.onDomChanged(u), t.onScrollToCursor(function (n) { n.preventDefault(), f.throttle() }), t.onScrollToElement(function (n) { n.element(), e(o, i) }), t.onToEditing(function () { o.run(function (n) { n.toEditing() }) }), t.onToReading(function () { o.run(function (n) { n.toReading() }) }), $d.bind(t.doc(), "touchend", function (n) { Te(t.html(), n.target()) || Te(t.body(), n.target()) }), $d.bind(r, "transitionend", function (n) { var e; "height" === n.raw().propertyName && (e = Bi(r), o.run(function (n) { n.setViewportOffset(e) }), u(), c()) }), $d.capture(r, "touchstart", function (n) { var e; o.run(function (n) { n.highlightSelection() }), e = n, o.run(function (n) { n.onToolbarTouch(e) }), t.onTouchToolstrip() }), $d.bind(t.body(), "touchstart", function (n) { a(), t.onTouchContent(), s.fireTouchstart(n) }), s.onTouchmove(), s.onTouchend(), $d.bind(t.body(), "click", function (n) { n.kill() }), $d.bind(r, "touchmove", function () { t.onToolbarScrollStart() })]; return { destroy: function () { vn.each(l, function (n) { n.unbind() }) } } }, dp = function (n) { var t = y.none(), e = [], o = function (n) { r() ? u(n) : e.push(n) }, r = function () { return t.isSome() }, i = function (n) { vn.each(n, u) }, u = function (e) { t.each(function (n) { setTimeout(function () { e(n) }, 0) }) }; return n(function (n) { t = y.some(n), i(e), e = [] }), { get: o, map: function (t) { return dp(function (e) { o(function (n) { e(t(n)) }) }) }, isReady: r } }, mp = { nu: dp, pure: function (e) { return dp(function (n) { n(e) }) } }, gp = function (t) { return function () { var n = Array.prototype.slice.call(arguments), e = this; setTimeout(function () { t.apply(e, n) }, 0) } }, pp = function (e) { var n = function (n) { e(gp(n)) }; return { map: function (o) { return pp(function (t) { n(function (n) { var e = o(n); t(e) }) }) }, bind: function (t) { return pp(function (e) { n(function (n) { t(n).get(e) }) }) }, anonBind: function (t) { return pp(function (e) { n(function (n) { t.get(e) }) }) }, toLazy: function () { return mp.nu(n) }, get: n } }, vp = { nu: pp, pure: function (e) { return pp(function (n) { n(e) }) } }, hp = function (n, e, t) { return Math.abs(n - e) <= t ? y.none() : n < e ? y.some(n + t) : y.some(n - t) }, bp = function () { var s = null; return { animate: function (o, r, n, i, e, t) { var u = !1, a = function (n) { u = !0, e(n) }; clearInterval(s); var c = function (n) { clearInterval(s), a(n) }; s = setInterval(function () { var t = o(); hp(t, r, n).fold(function () { clearInterval(s), a(r) }, function (n) { if (i(n, c), !u) { var e = o(); (e !== n || Math.abs(e - r) > Math.abs(t - r)) && (clearInterval(s), a(r)) } }) }, t) } } }, yp = function (e, t) { return Ir([{ width: 320, height: 480, keyboard: { portrait: 300, landscape: 240 } }, { width: 320, height: 568, keyboard: { portrait: 300, landscape: 240 } }, { width: 375, height: 667, keyboard: { portrait: 305, landscape: 240 } }, { width: 414, height: 736, keyboard: { portrait: 320, landscape: 240 } }, { width: 768, height: 1024, keyboard: { portrait: 320, landscape: 400 } }, { width: 1024, height: 1366, keyboard: { portrait: 380, landscape: 460 } }], function (n) { return e <= n.width && t <= n.height ? y.some(n.keyboard) : y.none() }).getOr({ portrait: t / 5, landscape: e / 4 }) }, wp = function (n) { var e, t = _d(n).isPortrait(), o = yp((e = n).screen.width, e.screen.height), r = t ? o.portrait : o.landscape; return (t ? n.screen.height : n.screen.width) - n.innerHeight > r ? 0 : r }, xp = function (n, e) { var t = Be.owner(n).dom().defaultView; return Bi(n) + Bi(e) - wp(t) }, Sp = xp, Tp = function (n, e, t) { var o = xp(e, t), r = Bi(e) + Bi(t) - o; Oi.set(n, "padding-bottom", r + "px") }, kp = _e([{ fixed: ["element", "property", "offsetY"] }, { scroller: ["element", "offsetY"] }]), Cp = "data-" + gi.resolve("position-y-fixed"), Op = "data-" + gi.resolve("y-property"), Ep = "data-" + gi.resolve("scrolling"), Dp = "data-" + gi.resolve("last-window-height"), Mp = function (n) { return em(n, Cp) }, Ap = function (n, e) { var t = Po.get(n, Op); return kp.fixed(n, t, e) }, Bp = function (n, e) { return kp.scroller(n, e) }, Rp = function (n) { var e = Mp(n); return ("true" === Po.get(n, Ep) ? Bp : Ap)(n, e) }, Ip = function (n, e, t) { var o = Be.owner(n).dom().defaultView.innerHeight; return Po.set(n, Dp, o + "px"), o - e - t }, Fp = function (n) { var e = Hi(n, "[" + Cp + "]"); return vn.map(e, Rp) }, Np = function (o, r, i, u) { var n, e, t, a, c, s, f, l, d = Be.owner(o).dom().defaultView, m = (l = Po.get(f = i, "style"), Oi.setAll(f, { position: "absolute", top: "0px" }), Po.set(f, Cp, "0px"), Po.set(f, Op, "top"), { restore: function () { Po.set(f, "style", l || ""), Po.remove(f, Cp), Po.remove(f, Op) } }), g = Bi(i), p = Bi(u), v = Ip(o, g, p), h = (t = g, a = v, s = Po.get(c = o, "style"), Td.register(c), Oi.setAll(c, { position: "absolute", height: a + "px", width: "100%", top: t + "px" }), Po.set(c, Cp, t + "px"), Po.set(c, Ep, "true"), Po.set(c, Op, "top"), { restore: function () { Td.deregister(c), Po.set(c, "style", s || ""), Po.remove(c, Cp), Po.remove(c, Ep), Po.remove(c, Op) } }), b = (e = Po.get(n = u, "style"), Oi.setAll(n, { position: "absolute", bottom: "0px" }), Po.set(n, Cp, "0px"), Po.set(n, Op, "bottom"), { restore: function () { Po.set(n, "style", e || ""), Po.remove(n, Cp), Po.remove(n, Op) } }), y = !0, w = function () { var n = d.innerHeight; return em(o, Dp) < n }, x = function () { if (y) { var n = Bi(i), e = Bi(u), t = Ip(o, n, e); Po.set(o, Cp, n + "px"), Oi.set(o, "height", t + "px"), Oi.set(u, "bottom", -(n + t + e) + "px"), Tp(r, o, u) } }; return Tp(r, o, u), { setViewportOffset: function (n) { Po.set(o, Cp, n + "px"), x() }, isExpanding: w, isShrinking: O.not(w), refresh: x, restore: function () { y = !1, m.restore(), h.restore(), b.restore() } } }, Vp = Mp, Hp = bp(), jp = "data-" + gi.resolve("last-scroll-top"), zp = function (n) { var e = Oi.getRaw(n, "top").getOr(0); return parseInt(e, 10) }, Lp = function (n) { return parseInt(n.dom().scrollTop, 10) }, Pp = function (n, e) { var t = e + Vp(n) + "px"; Oi.set(n, "top", t) }, Wp = function (t, o, r) { return vp.nu(function (n) { var e = O.curry(Lp, t); Hp.animate(e, o, 15, function (n) { t.dom().scrollTop = n, Oi.set(t, "top", zp(t) + 15 + "px") }, function () { t.dom().scrollTop = o, Oi.set(t, "top", r + "px"), n(o) }, 10) }) }, Up = function (r, i) { return vp.nu(function (n) { var e = O.curry(Lp, r); Po.set(r, jp, e()); var t = Math.abs(i - e()), o = Math.ceil(t / 10); Hp.animate(e, i, o, function (n, e) { em(r, jp) !== r.dom().scrollTop ? e(r.dom().scrollTop) : (r.dom().scrollTop = n, Po.set(r, jp, n)) }, function () { r.dom().scrollTop = i, Po.set(r, jp, i), n(i) }, 10) }) }, Gp = function (i, u) { return vp.nu(function (n) { var e = O.curry(zp, i), t = function (n) { Oi.set(i, "top", n + "px") }, o = Math.abs(u - e()), r = Math.ceil(o / 10); Hp.animate(e, u, r, t, function () { t(u), n(u) }, 10) }) }, $p = function (e, t, o) { var r = Be.owner(e).dom().defaultView; return vp.nu(function (n) { Pp(e, o), Pp(t, o), r.scrollTo(0, o), n(o) }) }, qp = function (n, e, t, o, r) { var i = Sp(e, t), u = O.curry(cp, n); i < o || i < r ? Up(e, e.dom().scrollTop - i + r).get(u) : o < 0 && Up(e, e.dom().scrollTop + o).get(u) }, _p = function (u, n) { return n(function (o) { var r = [], i = 0; 0 === u.length ? o([]) : vn.each(u, function (n, e) { var t; n.get((t = e, function (n) { r[t] = n, ++i >= u.length && o(r) })) }) }) }, Kp = function (n) { return _p(n, vp.nu) }, Xp = Kp, Yp = function (n, c) { return n.fold(function (n, e, t) { return o = n, r = e, u = c + (i = t), Oi.set(o, r, u + "px"), vp.pure(i); var o, r, i, u }, function (n, e) { return t = n, r = c + (o = e), i = Oi.getRaw(t, "top").getOr(o), u = r - parseInt(i, 10), a = t.dom().scrollTop + u, Wp(t, a, r); var t, o, r, i, u, a }) }, Jp = function (n, e) { var t = Fp(n), o = vn.map(t, function (n) { return Yp(n, e) }); return Xp(o) }, Qp = function (e, t, n, o, r, i) { var u, a, c = (u = function (n) { return $p(e, t, n) }, a = ur(mp.pure({})), { start: function (e) { var n = mp.nu(function (n) { return u(e).get(n) }); a.set(n) }, idle: function (n) { a.get().get(function () { n() }) } }), s = cg(function () { c.idle(function () { Jp(n, o.pageYOffset).get(function () { var n; (n = Hm.getRectangles(i), y.from(n[0]).bind(function (n) { var e = n.top() - t.dom().scrollTop; return e > o.innerHeight + 5 || e < -5 ? y.some({ top: O.constant(e), bottom: O.constant(e + n.height()) }) : y.none() })).each(function (n) { t.dom().scrollTop = t.dom().scrollTop + n.top() }), c.start(0), r.refresh() }) }) }, 1e3), f = $d.bind(Xn.fromDom(o), "scroll", function () { o.pageYOffset < 0 || s.throttle() }); return Jp(n, o.pageYOffset).get(O.identity), { unbind: f.unbind } }, Zp = function (n) { var t = n.cWin(), e = n.ceBody(), o = n.socket(), r = n.toolstrip(), i = n.toolbar(), u = n.contentElement(), a = n.keyboardType(), c = n.outerWindow(), s = n.dropup(), f = Np(o, e, r, s), l = a(n.outerBody(), t, se.body(), u, r, i), d = Kd(c, { onChange: O.noop, onReady: f.refresh }); d.onAdjustment(function () { f.refresh() }); var m = $d.bind(Xn.fromDom(c), "resize", function () { f.isExpanding() && f.refresh() }), g = Qp(r, o, n.outerBody(), c, f, t), p = function (t, e) { var n = t.document, o = Xn.fromTag("div"); er.add(o, gi.resolve("unfocused-selections")), Fe.append(Xn.fromDom(n.documentElement), o); var r = $d.bind(o, "touchstart", function (n) { n.prevent(), sp.resume(t, e), u() }), i = function (n) { var e = Xn.fromTag("span"); return Bl.add(e, [gi.resolve("layer-editor"), gi.resolve("unfocused-selection")]), Oi.setAll(e, { left: n.left() + "px", top: n.top() + "px", width: n.width() + "px", height: n.height() + "px" }), e }, u = function () { He.empty(o) }; return { update: function () { u(); var n = Hm.getRectangles(t), e = vn.map(n, i); Ne.append(o, e) }, isActive: function () { return 0 < Be.children(o).length }, destroy: function () { r.unbind(), He.remove(o) }, clear: u } }(t, u), v = function () { p.clear() }; return { toEditing: function () { l.toEditing(), v() }, toReading: function () { l.toReading() }, onToolbarTouch: function (n) { l.onToolbarTouch(n) }, refreshSelection: function () { p.isActive() && p.update() }, clearSelection: v, highlightSelection: function () { p.update() }, scrollIntoView: function (n, e) { qp(t, o, s, n, e) }, updateToolbarPadding: O.noop, setViewportOffset: function (n) { f.setViewportOffset(n), Gp(o, n).get(O.identity) }, syncHeight: function () { Oi.set(u, "height", u.dom().contentWindow.document.body.scrollHeight + "px") }, refreshStructure: f.refresh, destroy: function () { f.restore(), d.destroy(), g.unbind(), m.unbind(), l.destroy(), p.destroy(), ap(se.body(), vr) } } }, nv = function (o, n) { var r = ig(), i = tl.value(), u = tl.value(), a = tl.api(), c = tl.api(); return { enter: function () { n.hide(); var t = Xn.fromDom(document); Qm.getActiveApi(o.editor).each(function (n) { i.set({ socketHeight: Oi.getRaw(o.socket, "height"), iframeHeight: Oi.getRaw(n.frame(), "height"), outerScroll: document.body.scrollTop }), u.set({ exclusives: Sg.exclusive(t, "." + Td.scrollable()) }), er.add(o.container, gi.resolve("fullscreen-maximized")), og(o.container, n.body()), r.maximize(), Oi.set(o.socket, "overflow", "scroll"), Oi.set(o.socket, "-webkit-overflow-scrolling", "touch"), pr(n.body()); var e = de.immutableBag(["cWin", "ceBody", "socket", "toolstrip", "toolbar", "dropup", "contentElement", "cursor", "keyboardType", "isScrolling", "outerWindow", "outerBody"], []); a.set(Zp(e({ cWin: n.win(), ceBody: n.body(), socket: o.socket, toolstrip: o.toolstrip, toolbar: o.toolbar, dropup: o.dropup.element(), contentElement: n.frame(), cursor: O.noop, outerBody: o.body, outerWindow: o.win, keyboardType: fp.stubborn, isScrolling: function () { return u.get().exists(function (n) { return n.socket.isScrolling() }) } }))), a.run(function (n) { n.syncHeight() }), c.set(lp(n, a, o.toolstrip, o.socket, o.dropup)) }) }, refreshStructure: function () { a.run(function (n) { n.refreshStructure() }) }, exit: function () { r.restore(), c.clear(), a.clear(), n.show(), i.on(function (n) { n.socketHeight.each(function (n) { Oi.set(o.socket, "height", n) }), n.iframeHeight.each(function (n) { Oi.set(o.editor.getFrame(), "height", n) }), document.body.scrollTop = n.scrollTop }), i.clear(), u.on(function (n) { n.exclusives.unbind() }), u.clear(), er.remove(o.container, gi.resolve("fullscreen-maximized")), rg(), Td.deregister(o.toolbar), Oi.remove(o.socket, "overflow"), Oi.remove(o.socket, "-webkit-overflow-scrolling"), vr(o.editor.getFrame()), Qm.getActiveApi(o.editor).each(function (n) { n.clearSelection() }) } } }, ev = { produce: function (n) { var e = Yt("Getting IosWebapp schema", fg, n); Oi.set(e.toolstrip, "width", "100%"), Oi.set(e.container, "position", "relative"); var t = Pl(sg(function () { e.setReadOnly(e.readOnlyOnInit()), o.enter() }, e.translate)); e.alloy.add(t); var o = nv(e, { show: function () { e.alloy.add(t) }, hide: function () { e.alloy.remove(t) } }); return { setReadOnly: e.setReadOnly, refreshStructure: o.refreshStructure, enter: o.enter, exit: o.exit, destroy: O.noop } } }, tv = tinymce.util.Tools.resolve("tinymce.EditorManager"), ov = function (n) { var e = lt(n.settings, "skin_url").fold(function () { return tv.baseURL + "/skins/lightgray" }, function (n) { return n }); return { content: e + "/content.mobile.min.css", ui: e + "/skin.mobile.min.css" } }, rv = function (n, e, t) { n.system().broadcastOn([Sr.formatChanged()], { command: e, state: t }) }, iv = function (o, n) { var e = M.keys(n.formatter.get()); vn.each(e, function (e) { n.formatter.formatChanged(e, function (n) { rv(o, e, n) }) }), vn.each(["ul", "ol"], function (t) { n.selection.selectorChanged(t, function (n, e) { rv(o, t, n) }) }) }, uv = (O.constant(["x-small", "small", "medium", "large", "x-large"]), function (n) { var e = function () { n._skinLoaded = !0, n.fire("SkinLoaded") }; return function () { n.initialized ? e() : n.on("init", e) } }), av = O.constant("toReading"), cv = O.constant("toEditing"); wr.add("mobile", function (C) { return { getNotificationManagerImpl: function () { return { open: O.identity, close: O.noop, reposition: O.noop, getArgs: O.identity } }, renderUI: function (n) { var e = ov(C); 0 == (!1 === C.settings.skin) ? (C.contentCSS.push(e.content), yr.DOM.styleSheetLoader.load(e.ui, uv(C))) : uv(C)(); var t, o, r, i, u, a, c, s, f, l, d, m, g, p, v = function () { C.fire("scrollIntoView") }, h = Xn.fromTag("div"), b = Mn.detect().os.isAndroid() ? (s = v, f = up({ classes: [gi.resolve("android-container")] }), l = Tg(), d = tl.api(), m = Og.makeEditSwitch(d), g = Og.makeSocket(), p = Wg(O.noop, s), f.add(l.wrapper()), f.add(g), f.add(p.component()), { system: O.constant(f), element: f.element, init: function (n) { d.set(lg.produce(n)) }, exit: function () { d.run(function (n) { n.exit(), cd.remove(g, m) }) }, setToolbarGroups: function (n) { var e = l.createGroups(n); l.setGroups(e) }, setContextToolbar: function (n) { var e = l.createGroups(n); l.setContextToolbar(e) }, focusToolbar: function () { l.focus() }, restoreToolbar: function () { l.restoreToolbar() }, updateMode: function (n) { Og.updateMode(g, m, n, f.root()) }, socket: O.constant(g), dropup: O.constant(p) }) : (t = v, o = up({ classes: [gi.resolve("ios-container")] }), r = Tg(), i = tl.api(), u = Og.makeEditSwitch(i), a = Og.makeSocket(), c = Wg(function () { i.run(function (n) { n.refreshStructure() }) }, t), o.add(r.wrapper()), o.add(a), o.add(c.component()), { system: O.constant(o), element: o.element, init: function (n) { i.set(ev.produce(n)) }, exit: function () { i.run(function (n) { cd.remove(a, u), n.exit() }) }, setToolbarGroups: function (n) { var e = r.createGroups(n); r.setGroups(e) }, setContextToolbar: function (n) { var e = r.createGroups(n); r.setContextToolbar(e) }, focusToolbar: function () { r.focus() }, restoreToolbar: function () { r.restoreToolbar() }, updateMode: function (n) { Og.updateMode(a, u, n, o.root()) }, socket: O.constant(a), dropup: O.constant(c) }), y = Xn.fromDom(n.targetNode); Fe.after(y, h), function (n, e) { Fe.append(n, e.element()); var t = Be.children(e.element()); vn.each(t, function (n) { e.getByDom(n).each(ze) }) }(h, b.system()); var w = n.targetNode.ownerDocument.defaultView, x = Kd(w, { onChange: function () { b.system().broadcastOn([Sr.orientationChanged()], { width: Xd(w) }) }, onReady: O.noop }), S = function (n, e, t, o) { !1 === o && C.selection.collapse(); var r = T(n, e, t); b.setToolbarGroups(!0 === o ? r.readOnly : r.main), C.setMode(!0 === o ? "readonly" : "design"), C.fire(!0 === o ? av() : cv()), b.updateMode(o) }, T = function (n, e, t) { var o = n.get(), r = { readOnly: o.backToMask.concat(e.get()), main: o.backToMask.concat(t.get()) }; return r }, k = function (n, e) { return C.on(n, e), { unbind: function () { C.off(n) } } }; return C.on("init", function () { b.init({ editor: { getFrame: function () { return Xn.fromDom(C.contentAreaContainer.querySelector("iframe")) }, onDomChanged: function () { return { unbind: O.noop } }, onToReading: function (n) { return k(av(), n) }, onToEditing: function (n) { return k(cv(), n) }, onScrollToCursor: function (e) { return C.on("scrollIntoView", function (n) { e(n) }), { unbind: function () { C.off("scrollIntoView"), x.destroy() } } }, onTouchToolstrip: function () { t() }, onTouchContent: function () { var n, e = Xn.fromDom(C.editorContainer.querySelector("." + gi.resolve("toolbar"))); (n = e, br(n).bind(function (n) { return b.system().getByDom(n).toOption() })).each($n), b.restoreToolbar(), t() }, onTapContent: function (n) { var e = n.target(); "img" === ue.name(e) ? (C.selection.select(e.dom()), n.kill()) : "a" === ue.name(e) && b.system().getByDom(Xn.fromDom(C.editorContainer)).each(function (n) { ir.isAlpha(n) && xr(e.dom()) }) } }, container: Xn.fromDom(C.editorContainer), socket: Xn.fromDom(C.contentAreaContainer), toolstrip: Xn.fromDom(C.editorContainer.querySelector("." + gi.resolve("toolstrip"))), toolbar: Xn.fromDom(C.editorContainer.querySelector("." + gi.resolve("toolbar"))), dropup: b.dropup(), alloy: b.system(), translate: O.noop, setReadOnly: function (n) { S(c, a, u, n) }, readOnlyOnInit: function () { return !1 } }); var t = function () { b.dropup().disappear(function () { b.system().broadcastOn([Sr.dropupDismissed()], {}) }) }, n = { label: "The first group", scrollable: !1, items: [Yc.forToolbar("back", function () { C.selection.collapse(), b.exit() }, {})] }, e = { label: "Back to read only", scrollable: !1, items: [Yc.forToolbar("readonly-back", function () { S(c, a, u, !0) }, {})] }, o = Hd(b, C), r = jd(C.settings, o), i = { label: "The extra group", scrollable: !1, items: [] }, u = ur([{ label: "the action group", scrollable: !0, items: r }, i]), a = ur([{ label: "The read only mode group", scrollable: !0, items: [] }, i]), c = ur({ backToMask: [n], backToReadOnly: [e] }); iv(b, C) }), { iframeContainer: b.socket().element().dom(), editorContainer: b.element().dom() } } } }) }();
!function () { "use strict"; var e, t, n, i, r, o = tinymce.util.Tools.resolve("tinymce.ThemeManager"), l = tinymce.util.Tools.resolve("tinymce.EditorManager"), w = tinymce.util.Tools.resolve("tinymce.util.Tools"), d = function (e) { return !1 !== c(e) }, c = function (e) { return e.getParam("menubar") }, f = function (e) { return e.getParam("toolbar_items_size") }, h = function (e) { return e.getParam("menu") }, m = function (e) { return !1 === e.settings.skin }, g = function (e) { var t = e.getParam("resize", "vertical"); return !1 === t ? "none" : "both" === t ? "both" : "vertical" }, p = tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"), v = tinymce.util.Tools.resolve("tinymce.ui.Factory"), b = tinymce.util.Tools.resolve("tinymce.util.I18n"), s = function (e) { return e.fire("SkinLoaded") }, y = function (e) { return e.fire("ResizeEditor") }, x = function (e) { return e.fire("BeforeRenderUI") }, a = function (t, n) { return function () { var e = t.find(n)[0]; e && e.focus(!0) } }, _ = function (e, t) { e.shortcuts.add("Alt+F9", "", a(t, "menubar")), e.shortcuts.add("Alt+F10,F10", "", a(t, "toolbar")), e.shortcuts.add("Alt+F11", "", a(t, "elementpath")), t.on("cancel", function () { e.focus() }) }, R = tinymce.util.Tools.resolve("tinymce.geom.Rect"), u = tinymce.util.Tools.resolve("tinymce.util.Delay"), C = function (e) { return function () { return e } }, k = { noop: function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t] }, noarg: function (n) { return function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; return n() } }, compose: function (n, i) { return function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; return n(i.apply(null, arguments)) } }, constant: C, identity: function (e) { return e }, tripleEquals: function (e, t) { return e === t }, curry: function (o) { for (var e = [], t = 1; t < arguments.length; t++)e[t - 1] = arguments[t]; for (var s = new Array(arguments.length - 1), n = 1; n < arguments.length; n++)s[n - 1] = arguments[n]; return function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; for (var n = new Array(arguments.length), i = 0; i < n.length; i++)n[i] = arguments[i]; var r = s.concat(n); return o.apply(null, r) } }, not: function (n) { return function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; return !n.apply(null, arguments) } }, die: function (e) { return function () { throw new Error(e) } }, apply: function (e) { return e() }, call: function (e) { e() }, never: C(!1), always: C(!0) }, E = k.never, H = k.always, S = function () { return M }, M = (i = { fold: function (e, t) { return e() }, is: E, isSome: E, isNone: H, getOr: n = function (e) { return e }, getOrThunk: t = function (e) { return e() }, getOrDie: function (e) { throw new Error(e || "error: getOrDie called on none.") }, or: n, orThunk: t, map: S, ap: S, each: function () { }, bind: S, flatten: S, exists: E, forall: H, filter: S, equals: e = function (e) { return e.isNone() }, equals_: e, toArray: function () { return [] }, toString: k.constant("none()") }, Object.freeze && Object.freeze(i), i), T = function (n) { var e = function () { return n }, t = function () { return r }, i = function (e) { return e(n) }, r = { fold: function (e, t) { return t(n) }, is: function (e) { return n === e }, isSome: H, isNone: E, getOr: e, getOrThunk: e, getOrDie: e, or: t, orThunk: t, map: function (e) { return T(e(n)) }, ap: function (e) { return e.fold(S, function (e) { return T(e(n)) }) }, each: function (e) { e(n) }, bind: i, flatten: e, exists: i, forall: i, filter: function (e) { return e(n) ? r : M }, equals: function (e) { return e.is(n) }, equals_: function (e, t) { return e.fold(E, function (e) { return t(n, e) }) }, toArray: function () { return [n] }, toString: function () { return "some(" + n + ")" } }; return r }, P = { some: T, none: S, from: function (e) { return null === e || e === undefined ? M : T(e) } }, W = function (e) { return e ? e.getRoot().uiContainer : null }, D = { getUiContainerDelta: function (e) { var t = W(e); if (t && "static" !== p.DOM.getStyle(t, "position", !0)) { var n = p.DOM.getPos(t), i = t.scrollLeft - n.x, r = t.scrollTop - n.y; return P.some({ x: i, y: r }) } return P.none() }, setUiContainer: function (e, t) { var n = p.DOM.select(e.settings.ui_container)[0]; t.getRoot().uiContainer = n }, getUiContainer: W, inheritUiContainer: function (e, t) { return t.uiContainer = W(e) } }, N = function (i, e, r) { var o, s = []; if (e) return w.each(e.split(/[ ,]/), function (t) { var e, n = function () { var e = i.selection; t.settings.stateSelector && e.selectorChanged(t.settings.stateSelector, function (e) { t.active(e) }, !0), t.settings.disabledStateSelector && e.selectorChanged(t.settings.disabledStateSelector, function (e) { t.disabled(e) }) }; "|" === t ? o = null : (o || (o = { type: "buttongroup", items: [] }, s.push(o)), i.buttons[t] && (e = t, "function" == typeof (t = i.buttons[e]) && (t = t()), t.type = t.type || "button", t.size = r, t = v.create(t), o.items.push(t), i.initialized ? n() : i.on("init", n))) }), { type: "toolbar", layout: "flow", items: s } }, A = N, B = function (n, i) { var e, t, r = []; if (w.each(!1 === (t = (e = n).getParam("toolbar")) ? [] : w.isArray(t) ? w.grep(t, function (e) { return 0 < e.length }) : function (e, t) { for (var n = [], i = 1; i < 10; i++) { var r = e["toolbar" + i]; if (!r) break; n.push(r) } var o = e.toolbar ? [e.toolbar] : [t]; return 0 < n.length ? n : o }(e.settings, "undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image"), function (e) { var t; (t = e) && r.push(N(n, t, i)) }), r.length) return { type: "panel", layout: "stack", classes: "toolbar-grp", ariaRoot: !0, ariaRemember: !0, items: r } }, O = p.DOM, z = function (e) { return { left: e.x, top: e.y, width: e.w, height: e.h, right: e.x + e.w, bottom: e.y + e.h } }, L = function (e, t) { e.moveTo(t.left, t.top) }, I = function (e, t, n, i, r, o) { return o = z({ x: t, y: n, w: o.w, h: o.h }), e && (o = e({ elementRect: z(i), contentAreaRect: z(r), panelRect: o })), o }, F = function (x) { var i, o = function () { return x.contextToolbars || [] }, n = function (e, t) { var n, i, r, o, s, a, l, u = x.getParam("inline_toolbar_position_handler"); if (!x.removed) { if (!e || !e.toolbar.panel) return c = x, void w.each(c.contextToolbars, function (e) { e.panel && e.panel.hide() }); var c, d, f, h, m; l = ["bc-tc", "tc-bc", "tl-bl", "bl-tl", "tr-br", "br-tr"], s = e.toolbar.panel, t && s.show(), d = e.element, f = O.getPos(x.getContentAreaContainer()), h = x.dom.getRect(d), "BODY" === (m = x.dom.getRoot()).nodeName && (h.x -= m.ownerDocument.documentElement.scrollLeft || m.scrollLeft, h.y -= m.ownerDocument.documentElement.scrollTop || m.scrollTop), h.x += f.x, h.y += f.y, r = h, i = O.getRect(s.getEl()), o = O.getRect(x.getContentAreaContainer() || x.getBody()); var g, p, v, b = D.getUiContainerDelta(s).getOr({ x: 0, y: 0 }); if (r.x += b.x, r.y += b.y, i.x += b.x, i.y += b.y, o.x += b.x, o.y += b.y, "inline" !== O.getStyle(e.element, "display", !0)) { var y = e.element.getBoundingClientRect(); r.w = y.width, r.h = y.height } x.inline || (o.w = x.getDoc().documentElement.offsetWidth), x.selection.controlSelection.isResizable(e.element) && r.w < 25 && (r = R.inflate(r, 0, 8)), n = R.findBestRelativePosition(i, r, o, l), r = R.clamp(r, o), n ? (a = R.relativePosition(i, r, n), L(s, I(u, a.x, a.y, r, o, i))) : (o.h += i.h, (r = R.intersect(o, r)) ? (n = R.findBestRelativePosition(i, r, o, ["bc-tc", "bl-tl", "br-tr"])) ? (a = R.relativePosition(i, r, n), L(s, I(u, a.x, a.y, r, o, i))) : L(s, I(u, r.x, r.y, r, o, i)) : s.hide()), g = s, v = function (e, t) { return e === t }, p = (p = n) ? p.substr(0, 2) : "", w.each({ t: "down", b: "up" }, function (e, t) { g.classes.toggle("arrow-" + e, v(t, p.substr(0, 1))) }), w.each({ l: "left", r: "right" }, function (e, t) { g.classes.toggle("arrow-" + e, v(t, p.substr(1, 1))) }) } }, r = function (e) { return function () { u.requestAnimationFrame(function () { x.selection && n(a(x.selection.getNode()), e) }) } }, t = function (e) { var t; if (e.toolbar.panel) return e.toolbar.panel.show(), void n(e); t = v.create({ type: "floatpanel", role: "dialog", classes: "tinymce tinymce-inline arrow", ariaLabel: "Inline toolbar", layout: "flex", direction: "column", align: "stretch", autohide: !1, autofix: !0, fixed: !0, border: 1, items: A(x, e.toolbar.items), oncancel: function () { x.focus() } }), D.setUiContainer(x, t), function (e) { if (!i) { var t = r(!0), n = D.getUiContainer(e); i = x.selection.getScrollContainer() || x.getWin(), O.bind(i, "scroll", t), O.bind(n, "scroll", t), x.on("remove", function () { O.unbind(i, "scroll", t), O.unbind(n, "scroll", t) }) } }(t), (e.toolbar.panel = t).renderTo().reflow(), n(e) }, s = function () { w.each(o(), function (e) { e.panel && e.panel.hide() }) }, a = function (e) { var t, n, i, r = o(); for (t = (i = x.$(e).parents().add(e)).length - 1; 0 <= t; t--)for (n = r.length - 1; 0 <= n; n--)if (r[n].predicate(i[t])) return { toolbar: r[n], element: i[t] }; return null }; x.on("click keyup setContent ObjectResized", function (e) { ("setcontent" !== e.type || e.selection) && u.setEditorTimeout(x, function () { var e; (e = a(x.selection.getNode())) ? (s(), t(e)) : s() }) }), x.on("blur hide contextmenu", s), x.on("ObjectResizeStart", function () { var e = a(x.selection.getNode()); e && e.toolbar.panel && e.toolbar.panel.hide() }), x.on("ResizeEditor ResizeWindow", r(!0)), x.on("nodeChange", r(!1)), x.on("remove", function () { w.each(o(), function (e) { e.panel && e.panel.remove() }), x.contextToolbars = {} }), x.shortcuts.add("ctrl+shift+e > ctrl+shift+p", "", function () { var e = a(x.selection.getNode()); e && e.toolbar.panel && e.toolbar.panel.items()[0].focus() }) }, U = function (t) { return function (e) { return function (e) { if (null === e) return "null"; var t = typeof e; return "object" === t && Array.prototype.isPrototypeOf(e) ? "array" : "object" === t && String.prototype.isPrototypeOf(e) ? "string" : t }(e) === t } }, V = { isString: U("string"), isObject: U("object"), isArray: U("array"), isNull: U("null"), isBoolean: U("boolean"), isUndefined: U("undefined"), isFunction: U("function"), isNumber: U("number") }, j = (r = Array.prototype.indexOf) === undefined ? function (e, t) { return K(e, t) } : function (e, t) { return r.call(e, t) }, q = function (e, t) { return -1 < j(e, t) }, Y = function (e, t) { for (var n = e.length, i = new Array(n), r = 0; r < n; r++) { var o = e[r]; i[r] = t(o, r, e) } return i }, $ = function (e, t) { for (var n = 0, i = e.length; n < i; n++)t(e[n], n, e) }, X = function (e, t) { for (var n = e.length - 1; 0 <= n; n--)t(e[n], n, e) }, J = function (e, t) { for (var n = [], i = 0, r = e.length; i < r; i++) { var o = e[i]; t(o, i, e) && n.push(o) } return n }, G = function (e, t) { for (var n = 0, i = e.length; n < i; n++)if (t(e[n], n, e)) return P.some(n); return P.none() }, K = function (e, t) { for (var n = 0, i = e.length; n < i; ++n)if (e[n] === t) return n; return -1 }, Z = Array.prototype.push, Q = function (e) { for (var t = [], n = 0, i = e.length; n < i; ++n) { if (!Array.prototype.isPrototypeOf(e[n])) throw new Error("Arr.flatten item " + n + " was not an array, input: " + e); Z.apply(t, e[n]) } return t }, ee = function (e, t) { for (var n = 0, i = e.length; n < i; ++n)if (!0 !== t(e[n], n, e)) return !1; return !0 }, te = Array.prototype.slice, ne = V.isFunction(Array.from) ? Array.from : function (e) { return te.call(e) }, ie = { map: Y, each: $, eachr: X, partition: function (e, t) { for (var n = [], i = [], r = 0, o = e.length; r < o; r++) { var s = e[r]; (t(s, r, e) ? n : i).push(s) } return { pass: n, fail: i } }, filter: J, groupBy: function (e, t) { if (0 === e.length) return []; for (var n = t(e[0]), i = [], r = [], o = 0, s = e.length; o < s; o++) { var a = e[o], l = t(a); l !== n && (i.push(r), r = []), n = l, r.push(a) } return 0 !== r.length && i.push(r), i }, indexOf: function (e, t) { var n = j(e, t); return -1 === n ? P.none() : P.some(n) }, foldr: function (e, t, n) { return X(e, function (e) { n = t(n, e) }), n }, foldl: function (e, t, n) { return $(e, function (e) { n = t(n, e) }), n }, find: function (e, t) { for (var n = 0, i = e.length; n < i; n++) { var r = e[n]; if (t(r, n, e)) return P.some(r) } return P.none() }, findIndex: G, flatten: Q, bind: function (e, t) { var n = Y(e, t); return Q(n) }, forall: ee, exists: function (e, t) { return G(e, t).isSome() }, contains: q, equal: function (e, n) { return e.length === n.length && ee(e, function (e, t) { return e === n[t] }) }, reverse: function (e) { var t = te.call(e, 0); return t.reverse(), t }, chunk: function (e, t) { for (var n = [], i = 0; i < e.length; i += t) { var r = e.slice(i, i + t); n.push(r) } return n }, difference: function (e, t) { return J(e, function (e) { return !q(t, e) }) }, mapToObject: function (e, t) { for (var n = {}, i = 0, r = e.length; i < r; i++) { var o = e[i]; n[String(o)] = t(o, i) } return n }, pure: function (e) { return [e] }, sort: function (e, t) { var n = te.call(e, 0); return n.sort(t), n }, range: function (e, t) { for (var n = [], i = 0; i < e; i++)n.push(t(i)); return n }, head: function (e) { return 0 === e.length ? P.none() : P.some(e[0]) }, last: function (e) { return 0 === e.length ? P.none() : P.some(e[e.length - 1]) }, from: ne }, re = { file: { title: "File", items: "newdocument restoredraft | preview | print" }, edit: { title: "Edit", items: "undo redo | cut copy paste pastetext | selectall" }, view: { title: "View", items: "code | visualaid visualchars visualblocks | spellchecker | preview fullscreen" }, insert: { title: "Insert", items: "image link media template codesample inserttable | charmap hr | pagebreak nonbreaking anchor toc | insertdatetime" }, format: { title: "Format", items: "bold italic underline strikethrough superscript subscript codeformat | blockformats align | removeformat" }, tools: { title: "Tools", items: "spellchecker spellcheckerlanguage | a11ycheck" }, table: { title: "Table" }, help: { title: "Help" } }, oe = function (e, t) { return "|" === e ? { name: "|", item: { text: "|" } } : t ? { name: e, item: t } : null }, se = function (e) { return e && "|" === e.item.text }, ae = function (n, e, t, r) { var i, o, s, a, l, u, c, d; return e ? (o = e[r], a = !0) : o = re[r], o && (i = { text: o.title }, s = [], w.each((o.items || "").split(/[ ,]/), function (e) { var t = oe(e, n[e]); t && s.push(t) }), a || w.each(n, function (e, t) { var n, i; e.context !== r || (n = s, i = t, ie.findIndex(n, function (e) { return e.name === i }).isSome()) || ("before" === e.separator && s.push({ name: "|", item: { text: "|" } }), e.prependToContext ? s.unshift(oe(t, e)) : s.push(oe(t, e)), "after" === e.separator && s.push({ name: "|", item: { text: "|" } })) }), i.menu = ie.map((l = s, u = t, c = ie.filter(l, function (e) { return !1 === u.hasOwnProperty(e.name) }), d = ie.filter(c, function (e, t, n) { return !se(e) || !se(n[t - 1]) }), ie.filter(d, function (e, t, n) { return !se(e) || 0 < t && t < n.length - 1 })), function (e) { return e.item }), !i.menu.length) ? null : i }, le = function (e) { for (var t, n = [], i = function (e) { var t, n = [], i = h(e); if (i) for (t in i) n.push(t); else for (t in re) n.push(t); return n }(e), r = w.makeMap((t = e, t.getParam("removed_menuitems", "")).split(/[ ,]/)), o = c(e), s = "string" == typeof o ? o.split(/[ ,]/) : i, a = 0; a < s.length; a++) { var l = s[a], u = ae(e.menuItems, h(e), r, l); u && n.push(u) } return n }, ue = p.DOM, ce = function (e) { return { width: e.clientWidth, height: e.clientHeight } }, de = function (e, t, n) { var i, r, o, s; i = e.getContainer(), r = e.getContentAreaContainer().firstChild, o = ce(i), s = ce(r), null !== t && (t = Math.max(e.getParam("min_width", 100, "number"), t), t = Math.min(e.getParam("max_width", 65535, "number"), t), ue.setStyle(i, "width", t + (o.width - s.width)), ue.setStyle(r, "width", t)), n = Math.max(e.getParam("min_height", 100, "number"), n), n = Math.min(e.getParam("max_height", 65535, "number"), n), ue.setStyle(r, "height", n), y(e) }, fe = de, he = function (e, t, n) { var i = e.getContentAreaContainer(); de(e, i.clientWidth + t, i.clientHeight + n) }, me = tinymce.util.Tools.resolve("tinymce.Env"), ge = function (e, t, n) { var i, r = e.settings[n]; r && r((i = t.getEl("body"), { element: function () { return i } })) }, pe = function (c, d, f) { return function (e) { var t, n, i, r, o, s = e.control, a = s.parents().filter("panel")[0], l = a.find("#" + d)[0], u = (t = f, n = d, w.grep(t, function (e) { return e.name === n })[0]); i = d, r = a, o = f, w.each(o, function (e) { var t = r.items().filter("#" + e.name)[0]; t && t.visible() && e.name !== i && (ge(e, t, "onhide"), t.visible(!1)) }), s.parent().items().each(function (e) { e.active(!1) }), l && l.visible() ? (ge(u, l, "onhide"), l.hide(), s.active(!1)) : (l ? l.show() : (l = v.create({ type: "container", name: d, layout: "stack", classes: "sidebar-panel", html: "" }), a.prepend(l), ge(u, l, "onrender")), ge(u, l, "onshow"), s.active(!0)), y(c) } }, ve = function (e) { return !(me.ie && !(11 <= me.ie) || !e.sidebars) && 0 < e.sidebars.length }, be = function (n) { return { type: "panel", name: "sidebar", layout: "stack", classes: "sidebar", items: [{ type: "toolbar", layout: "stack", classes: "sidebar-toolbar", items: w.map(n.sidebars, function (e) { var t = e.settings; return { type: "button", icon: t.icon, image: t.image, tooltip: t.tooltip, onclick: pe(n, e.name, n.sidebars) } }) }] } }, ye = function (e) { var t = function () { e._skinLoaded = !0, s(e) }; return function () { e.initialized ? t() : e.on("init", t) } }, xe = p.DOM, we = function (e) { return { type: "panel", name: "iframe", layout: "stack", classes: "edit-area", border: e, html: "" } }, _e = function (t, e, n) { var i, r, o, s, a; if (!1 === m(t) && n.skinUiCss ? xe.styleSheetLoader.load(n.skinUiCss, ye(t)) : ye(t)(), i = e.panel = v.create({ type: "panel", role: "application", classes: "tinymce", style: "visibility: hidden", layout: "stack", border: 1, items: [{ type: "container", classes: "top-part", items: [!1 === d(t) ? null : { type: "menubar", border: "0 0 1 0", items: le(t) }, B(t, f(t))] }, ve(t) ? (s = t, { type: "panel", layout: "stack", classes: "edit-aria-container", border: "1 0 0 0", items: [we("0"), be(s)] }) : we("1 0 0 0")] }), D.setUiContainer(t, i), "none" !== g(t) && (r = { type: "resizehandle", direction: g(t), onResizeStart: function () { var e = t.getContentAreaContainer().firstChild; o = { width: e.clientWidth, height: e.clientHeight } }, onResize: function (e) { "both" === g(t) ? fe(t, o.width + e.deltaX, o.height + e.deltaY) : fe(t, null, o.height + e.deltaY) } }), t.getParam("statusbar", !0, "boolean")) { var l = b.translate(["Powered by {0}", '<a href="https://www.tinymce.com/?utm_campaign=editor_referral&utm_medium=poweredby&utm_source=tinymce" rel="noopener" target="_blank" role="presentation" tabindex="-1">tinymce</a>']), u = t.getParam("branding", !0, "boolean") ? { type: "label", classes: "branding", html: " " + l } : null; i.add({ type: "panel", name: "statusbar", classes: "statusbar", layout: "flow", border: "1 0 0 0", ariaRoot: !0, items: [{ type: "elementpath", editor: t }, r, u] }) } return x(t), t.on("SwitchMode", (a = i, function (e) { a.find("*").disabled("readonly" === e.mode) })), i.renderBefore(n.targetNode).reflow(), t.getParam("readonly", !1, "boolean") && t.setMode("readonly"), n.width && xe.setStyle(i.getEl(), "width", n.width), t.on("remove", function () { i.remove(), i = null }), _(t, i), F(t), { iframeContainer: i.find("#iframe")[0].getEl(), editorContainer: i.getEl() } }, Re = tinymce.util.Tools.resolve("tinymce.dom.DomQuery"), Ce = 0, ke = { id: function () { return "mceu_" + Ce++ }, create: function (e, t, n) { var i = document.createElement(e); return p.DOM.setAttribs(i, t), "string" == typeof n ? i.innerHTML = n : w.each(n, function (e) { e.nodeType && i.appendChild(e) }), i }, createFragment: function (e) { return p.DOM.createFragment(e) }, getWindowSize: function () { return p.DOM.getViewPort() }, getSize: function (e) { var t, n; if (e.getBoundingClientRect) { var i = e.getBoundingClientRect(); t = Math.max(i.width || i.right - i.left, e.offsetWidth), n = Math.max(i.height || i.bottom - i.bottom, e.offsetHeight) } else t = e.offsetWidth, n = e.offsetHeight; return { width: t, height: n } }, getPos: function (e, t) { return p.DOM.getPos(e, t || ke.getContainer()) }, getContainer: function () { return me.container ? me.container : document.body }, getViewPort: function (e) { return p.DOM.getViewPort(e) }, get: function (e) { return document.getElementById(e) }, addClass: function (e, t) { return p.DOM.addClass(e, t) }, removeClass: function (e, t) { return p.DOM.removeClass(e, t) }, hasClass: function (e, t) { return p.DOM.hasClass(e, t) }, toggleClass: function (e, t, n) { return p.DOM.toggleClass(e, t, n) }, css: function (e, t, n) { return p.DOM.setStyle(e, t, n) }, getRuntimeStyle: function (e, t) { return p.DOM.getStyle(e, t, !0) }, on: function (e, t, n, i) { return p.DOM.bind(e, t, n, i) }, off: function (e, t, n) { return p.DOM.unbind(e, t, n) }, fire: function (e, t, n) { return p.DOM.fire(e, t, n) }, innerHtml: function (e, t) { p.DOM.setHTML(e, t) } }, Ee = function (e) { return "static" === ke.getRuntimeStyle(e, "position") }, He = function (e) { return e.state.get("fixed") }; function Se(e, t, n) { var i, r, o, s, a, l, u, c, d, f; return d = Me(), o = (r = ke.getPos(t, D.getUiContainer(e))).x, s = r.y, He(e) && Ee(document.body) && (o -= d.x, s -= d.y), i = e.getEl(), a = (f = ke.getSize(i)).width, l = f.height, u = (f = ke.getSize(t)).width, c = f.height, "b" === (n = (n || "").split(""))[0] && (s += c), "r" === n[1] && (o += u), "c" === n[0] && (s += Math.round(c / 2)), "c" === n[1] && (o += Math.round(u / 2)), "b" === n[3] && (s -= l), "r" === n[4] && (o -= a), "c" === n[3] && (s -= Math.round(l / 2)), "c" === n[4] && (o -= Math.round(a / 2)), { x: o, y: s, w: a, h: l } } var Me = function () { var e = window, t = Math.max(e.pageXOffset, document.body.scrollLeft, document.documentElement.scrollLeft), n = Math.max(e.pageYOffset, document.body.scrollTop, document.documentElement.scrollTop); return { x: t, y: n, w: t + (e.innerWidth || document.documentElement.clientWidth), h: n + (e.innerHeight || document.documentElement.clientHeight) } }, Te = function (e) { var t, n = D.getUiContainer(e); return n && !He(e) ? { x: 0, y: 0, w: (t = n).scrollWidth - 1, h: t.scrollHeight - 1 } : Me() }, Pe = { testMoveRel: function (e, t) { for (var n = Te(this), i = 0; i < t.length; i++) { var r = Se(this, e, t[i]); if (He(this)) { if (0 < r.x && r.x + r.w < n.w && 0 < r.y && r.y + r.h < n.h) return t[i] } else if (r.x > n.x && r.x + r.w < n.w && r.y > n.y && r.y + r.h < n.h) return t[i] } return t[0] }, moveRel: function (e, t) { "string" != typeof t && (t = this.testMoveRel(e, t)); var n = Se(this, e, t); return this.moveTo(n.x, n.y) }, moveBy: function (e, t) { var n = this.layoutRect(); return this.moveTo(n.x + e, n.y + t), this }, moveTo: function (e, t) { var n = this; function i(e, t, n) { return e < 0 ? 0 : t < e + n && (e = t - n) < 0 ? 0 : e } if (n.settings.constrainToViewport) { var r = Te(this), o = n.layoutRect(); e = i(e, r.w, o.w), t = i(t, r.h, o.h) } var s = D.getUiContainer(n); return s && Ee(s) && !He(n) && (e -= s.scrollLeft, t -= s.scrollTop), s && (e += 1, t += 1), n.state.get("rendered") ? n.layoutRect({ x: e, y: t }).repaint() : (n.settings.x = e, n.settings.y = t), n.fire("move", { x: e, y: t }), n } }, We = tinymce.util.Tools.resolve("tinymce.util.Class"), De = tinymce.util.Tools.resolve("tinymce.util.EventDispatcher"), Ne = function (e) { var t; if (e) return "number" == typeof e ? { top: e = e || 0, left: e, bottom: e, right: e } : (1 === (t = (e = e.split(" ")).length) ? e[1] = e[2] = e[3] = e[0] : 2 === t ? (e[2] = e[0], e[3] = e[1]) : 3 === t && (e[3] = e[1]), { top: parseInt(e[0], 10) || 0, right: parseInt(e[1], 10) || 0, bottom: parseInt(e[2], 10) || 0, left: parseInt(e[3], 10) || 0 }) }, Ae = function (i, e) { function t(e) { var t = parseFloat(function (e) { var t = i.ownerDocument.defaultView; if (t) { var n = t.getComputedStyle(i, null); return n ? (e = e.replace(/[A-Z]/g, function (e) { return "-" + e }), n.getPropertyValue(e)) : null } return i.currentStyle[e] }(e)); return isNaN(t) ? 0 : t } return { top: t(e + "TopWidth"), right: t(e + "RightWidth"), bottom: t(e + "BottomWidth"), left: t(e + "LeftWidth") } }; function Be() { } function Oe(e) { this.cls = [], this.cls._map = {}, this.onchange = e || Be, this.prefix = "" } w.extend(Oe.prototype, { add: function (e) { return e && !this.contains(e) && (this.cls._map[e] = !0, this.cls.push(e), this._change()), this }, remove: function (e) { if (this.contains(e)) { var t = void 0; for (t = 0; t < this.cls.length && this.cls[t] !== e; t++); this.cls.splice(t, 1), delete this.cls._map[e], this._change() } return this }, toggle: function (e, t) { var n = this.contains(e); return n !== t && (n ? this.remove(e) : this.add(e), this._change()), this }, contains: function (e) { return !!this.cls._map[e] }, _change: function () { delete this.clsValue, this.onchange.call(this) } }), Oe.prototype.toString = function () { var e; if (this.clsValue) return this.clsValue; e = ""; for (var t = 0; t < this.cls.length; t++)0 < t && (e += " "), e += this.prefix + this.cls[t]; return e }; var ze, Le, Ie, Fe = /^([\w\\*]+)?(?:#([\w\-\\]+))?(?:\.([\w\\\.]+))?(?:\[\@?([\w\\]+)([\^\$\*!~]?=)([\w\\]+)\])?(?:\:(.+))?/i, Ue = /((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g, Ve = /^\s*|\s*$/g, je = We.extend({ init: function (e) { var o = this.match; function s(e, t, n) { var i; function r(e) { e && t.push(e) } return r(function (t) { if (t) return t = t.toLowerCase(), function (e) { return "*" === t || e.type === t } }((i = Fe.exec(e.replace(Ve, "")))[1])), r(function (t) { if (t) return function (e) { return e._name === t } }(i[2])), r(function (n) { if (n) return n = n.split("."), function (e) { for (var t = n.length; t--;)if (!e.classes.contains(n[t])) return !1; return !0 } }(i[3])), r(function (n, i, r) { if (n) return function (e) { var t = e[n] ? e[n]() : ""; return i ? "=" === i ? t === r : "*=" === i ? 0 <= t.indexOf(r) : "~=" === i ? 0 <= (" " + t + " ").indexOf(" " + r + " ") : "!=" === i ? t !== r : "^=" === i ? 0 === t.indexOf(r) : "$=" === i && t.substr(t.length - r.length) === r : !!r } }(i[4], i[5], i[6])), r(function (i) { var t; if (i) return (i = /(?:not\((.+)\))|(.+)/i.exec(i))[1] ? (t = a(i[1], []), function (e) { return !o(e, t) }) : (i = i[2], function (e, t, n) { return "first" === i ? 0 === t : "last" === i ? t === n - 1 : "even" === i ? t % 2 == 0 : "odd" === i ? t % 2 == 1 : !!e[i] && e[i]() }) }(i[7])), t.pseudo = !!i[7], t.direct = n, t } function a(e, t) { var n, i, r, o = []; do { if (Ue.exec(""), (i = Ue.exec(e)) && (e = i[3], o.push(i[1]), i[2])) { n = i[3]; break } } while (i); for (n && a(n, t), e = [], r = 0; r < o.length; r++)">" !== o[r] && e.push(s(o[r], [], ">" === o[r - 1])); return t.push(e), t } this._selectors = a(e, []) }, match: function (e, t) { var n, i, r, o, s, a, l, u, c, d, f, h, m; for (n = 0, i = (t = t || this._selectors).length; n < i; n++) { for (m = e, h = 0, r = (o = (s = t[n]).length) - 1; 0 <= r; r--)for (u = s[r]; m;) { if (u.pseudo) for (c = d = (f = m.parent().items()).length; c-- && f[c] !== m;); for (a = 0, l = u.length; a < l; a++)if (!u[a](m, c, d)) { a = l + 1; break } if (a === l) { h++; break } if (r === o - 1) break; m = m.parent() } if (h === o) return !0 } return !1 }, find: function (e) { var t, n, u = [], i = this._selectors; function c(e, t, n) { var i, r, o, s, a, l = t[n]; for (i = 0, r = e.length; i < r; i++) { for (a = e[i], o = 0, s = l.length; o < s; o++)if (!l[o](a, i, r)) { o = s + 1; break } if (o === s) n === t.length - 1 ? u.push(a) : a.items && c(a.items(), t, n + 1); else if (l.direct) return; a.items && c(a.items(), t, n) } } if (e.items) { for (t = 0, n = i.length; t < n; t++)c(e.items(), i[t], 0); 1 < n && (u = function (e) { for (var t, n = [], i = e.length; i--;)(t = e[i]).__checked || (n.push(t), t.__checked = 1); for (i = n.length; i--;)delete n[i].__checked; return n }(u)) } return ze || (ze = je.Collection), new ze(u) } }), qe = Array.prototype.push, Ye = Array.prototype.slice; Ie = { length: 0, init: function (e) { e && this.add(e) }, add: function (e) { return w.isArray(e) ? qe.apply(this, e) : e instanceof Le ? this.add(e.toArray()) : qe.call(this, e), this }, set: function (e) { var t, n = this, i = n.length; for (n.length = 0, n.add(e), t = n.length; t < i; t++)delete n[t]; return n }, filter: function (t) { var e, n, i, r, o = []; for ("string" == typeof t ? (t = new je(t), r = function (e) { return t.match(e) }) : r = t, e = 0, n = this.length; e < n; e++)r(i = this[e]) && o.push(i); return new Le(o) }, slice: function () { return new Le(Ye.apply(this, arguments)) }, eq: function (e) { return -1 === e ? this.slice(e) : this.slice(e, +e + 1) }, each: function (e) { return w.each(this, e), this }, toArray: function () { return w.toArray(this) }, indexOf: function (e) { for (var t = this.length; t-- && this[t] !== e;); return t }, reverse: function () { return new Le(w.toArray(this).reverse()) }, hasClass: function (e) { return !!this[0] && this[0].classes.contains(e) }, prop: function (t, n) { var e; return n !== undefined ? (this.each(function (e) { e[t] && e[t](n) }), this) : (e = this[0]) && e[t] ? e[t]() : void 0 }, exec: function (t) { var n = w.toArray(arguments).slice(1); return this.each(function (e) { e[t] && e[t].apply(e, n) }), this }, remove: function () { for (var e = this.length; e--;)this[e].remove(); return this }, addClass: function (t) { return this.each(function (e) { e.classes.add(t) }) }, removeClass: function (t) { return this.each(function (e) { e.classes.remove(t) }) } }, w.each("fire on off show hide append prepend before after reflow".split(" "), function (n) { Ie[n] = function () { var t = w.toArray(arguments); return this.each(function (e) { n in e && e[n].apply(e, t) }), this } }), w.each("text name disabled active selected checked visible parent value data".split(" "), function (t) { Ie[t] = function (e) { return this.prop(t, e) } }), Le = We.extend(Ie); var $e = je.Collection = Le, Xe = function (e) { this.create = e.create }; Xe.create = function (r, o) { return new Xe({ create: function (t, n) { var i, e = function (e) { t.set(n, e.value) }; return t.on("change:" + n, function (e) { r.set(o, e.value) }), r.on("change:" + o, e), (i = t._bindings) || (i = t._bindings = [], t.on("destroy", function () { for (var e = i.length; e--;)i[e]() })), i.push(function () { r.off("change:" + o, e) }), r.get(o) } }) }; var Je = tinymce.util.Tools.resolve("tinymce.util.Observable"); function Ge(e) { return 0 < e.nodeType } var Ke, Ze, Qe = We.extend({ Mixins: [Je], init: function (e) { var t, n; for (t in e = e || {}) (n = e[t]) instanceof Xe && (e[t] = n.create(this, t)); this.data = e }, set: function (t, n) { var i, r, o = this.data[t]; if (n instanceof Xe && (n = n.create(this, t)), "object" == typeof t) { for (i in t) this.set(i, t[i]); return this } return function e(t, n) { var i, r; if (t === n) return !0; if (null === t || null === n) return t === n; if ("object" != typeof t || "object" != typeof n) return t === n; if (w.isArray(n)) { if (t.length !== n.length) return !1; for (i = t.length; i--;)if (!e(t[i], n[i])) return !1 } if (Ge(t) || Ge(n)) return t === n; for (i in r = {}, n) { if (!e(t[i], n[i])) return !1; r[i] = !0 } for (i in t) if (!r[i] && !e(t[i], n[i])) return !1; return !0 }(o, n) || (this.data[t] = n, r = { target: this, name: t, value: n, oldValue: o }, this.fire("change:" + t, r), this.fire("change", r)), this }, get: function (e) { return this.data[e] }, has: function (e) { return e in this.data }, bind: function (e) { return Xe.create(this, e) }, destroy: function () { this.fire("destroy") } }), et = {}, tt = { add: function (e) { var t = e.parent(); if (t) { if (!t._layout || t._layout.isNative()) return; et[t._id] || (et[t._id] = t), Ke || (Ke = !0, u.requestAnimationFrame(function () { var e, t; for (e in Ke = !1, et) (t = et[e]).state.get("rendered") && t.reflow(); et = {} }, document.body)) } }, remove: function (e) { et[e._id] && delete et[e._id] } }, nt = "onmousewheel" in document, it = !1, rt = 0, ot = { Statics: { classPrefix: "mce-" }, isRtl: function () { return Ze.rtl }, classPrefix: "mce-", init: function (t) { var e, n, i = this; function r(e) { var t; for (e = e.split(" "), t = 0; t < e.length; t++)i.classes.add(e[t]) } i.settings = t = w.extend({}, i.Defaults, t), i._id = t.id || "mceu_" + rt++ , i._aria = { role: t.role }, i._elmCache = {}, i.$ = Re, i.state = new Qe({ visible: !0, active: !1, disabled: !1, value: "" }), i.data = new Qe(t.data), i.classes = new Oe(function () { i.state.get("rendered") && (i.getEl().className = this.toString()) }), i.classes.prefix = i.classPrefix, (e = t.classes) && (i.Defaults && (n = i.Defaults.classes) && e !== n && r(n), r(e)), w.each("title text name visible disabled active value".split(" "), function (e) { e in t && i[e](t[e]) }), i.on("click", function () { if (i.disabled()) return !1 }), i.settings = t, i.borderBox = Ne(t.border), i.paddingBox = Ne(t.padding), i.marginBox = Ne(t.margin), t.hidden && i.hide() }, Properties: "parent,name", getContainerElm: function () { var e = D.getUiContainer(this); return e || ke.getContainer() }, getParentCtrl: function (e) { for (var t, n = this.getRoot().controlIdLookup; e && n && !(t = n[e.id]);)e = e.parentNode; return t }, initLayoutRect: function () { var e, t, n, i, r, o, s, a, l, u, c = this, d = c.settings, f = c.getEl(); e = c.borderBox = c.borderBox || Ae(f, "border"), c.paddingBox = c.paddingBox || Ae(f, "padding"), c.marginBox = c.marginBox || Ae(f, "margin"), u = ke.getSize(f), a = d.minWidth, l = d.minHeight, r = a || u.width, o = l || u.height, n = d.width, i = d.height, s = void 0 !== (s = d.autoResize) ? s : !n && !i, n = n || r, i = i || o; var h = e.left + e.right, m = e.top + e.bottom, g = d.maxWidth || 65535, p = d.maxHeight || 65535; return c._layoutRect = t = { x: d.x || 0, y: d.y || 0, w: n, h: i, deltaW: h, deltaH: m, contentW: n - h, contentH: i - m, innerW: n - h, innerH: i - m, startMinWidth: a || 0, startMinHeight: l || 0, minW: Math.min(r, g), minH: Math.min(o, p), maxW: g, maxH: p, autoResize: s, scrollW: 0 }, c._lastLayoutRect = {}, t }, layoutRect: function (e) { var t, n, i, r, o, s = this, a = s._layoutRect; return a || (a = s.initLayoutRect()), e ? (i = a.deltaW, r = a.deltaH, e.x !== undefined && (a.x = e.x), e.y !== undefined && (a.y = e.y), e.minW !== undefined && (a.minW = e.minW), e.minH !== undefined && (a.minH = e.minH), (n = e.w) !== undefined && (n = (n = n < a.minW ? a.minW : n) > a.maxW ? a.maxW : n, a.w = n, a.innerW = n - i), (n = e.h) !== undefined && (n = (n = n < a.minH ? a.minH : n) > a.maxH ? a.maxH : n, a.h = n, a.innerH = n - r), (n = e.innerW) !== undefined && (n = (n = n < a.minW - i ? a.minW - i : n) > a.maxW - i ? a.maxW - i : n, a.innerW = n, a.w = n + i), (n = e.innerH) !== undefined && (n = (n = n < a.minH - r ? a.minH - r : n) > a.maxH - r ? a.maxH - r : n, a.innerH = n, a.h = n + r), e.contentW !== undefined && (a.contentW = e.contentW), e.contentH !== undefined && (a.contentH = e.contentH), (t = s._lastLayoutRect).x === a.x && t.y === a.y && t.w === a.w && t.h === a.h || ((o = Ze.repaintControls) && o.map && !o.map[s._id] && (o.push(s), o.map[s._id] = !0), t.x = a.x, t.y = a.y, t.w = a.w, t.h = a.h), s) : a }, repaint: function () { var e, t, n, i, r, o, s, a, l, u, c = this; l = document.createRange ? function (e) { return e } : Math.round, e = c.getEl().style, i = c._layoutRect, a = c._lastRepaintRect || {}, o = (r = c.borderBox).left + r.right, s = r.top + r.bottom, i.x !== a.x && (e.left = l(i.x) + "px", a.x = i.x), i.y !== a.y && (e.top = l(i.y) + "px", a.y = i.y), i.w !== a.w && (u = l(i.w - o), e.width = (0 <= u ? u : 0) + "px", a.w = i.w), i.h !== a.h && (u = l(i.h - s), e.height = (0 <= u ? u : 0) + "px", a.h = i.h), c._hasBody && i.innerW !== a.innerW && (u = l(i.innerW), (n = c.getEl("body")) && ((t = n.style).width = (0 <= u ? u : 0) + "px"), a.innerW = i.innerW), c._hasBody && i.innerH !== a.innerH && (u = l(i.innerH), (n = n || c.getEl("body")) && ((t = t || n.style).height = (0 <= u ? u : 0) + "px"), a.innerH = i.innerH), c._lastRepaintRect = a, c.fire("repaint", {}, !1) }, updateLayoutRect: function () { var e = this; e.parent()._lastRect = null, ke.css(e.getEl(), { width: "", height: "" }), e._layoutRect = e._lastRepaintRect = e._lastLayoutRect = null, e.initLayoutRect() }, on: function (e, t) { var n, i, r, o = this; return st(o).on(e, "string" != typeof (n = t) ? n : function (e) { return i || o.parentsAndSelf().each(function (e) { var t = e.settings.callbacks; if (t && (i = t[n])) return r = e, !1 }), i ? i.call(r, e) : (e.action = n, void this.fire("execute", e)) }), o }, off: function (e, t) { return st(this).off(e, t), this }, fire: function (e, t, n) { if ((t = t || {}).control || (t.control = this), t = st(this).fire(e, t), !1 !== n && this.parent) for (var i = this.parent(); i && !t.isPropagationStopped();)i.fire(e, t, !1), i = i.parent(); return t }, hasEventListeners: function (e) { return st(this).has(e) }, parents: function (e) { var t, n = new $e; for (t = this.parent(); t; t = t.parent())n.add(t); return e && (n = n.filter(e)), n }, parentsAndSelf: function (e) { return new $e(this).add(this.parents(e)) }, next: function () { var e = this.parent().items(); return e[e.indexOf(this) + 1] }, prev: function () { var e = this.parent().items(); return e[e.indexOf(this) - 1] }, innerHtml: function (e) { return this.$el.html(e), this }, getEl: function (e) { var t = e ? this._id + "-" + e : this._id; return this._elmCache[t] || (this._elmCache[t] = Re("#" + t)[0]), this._elmCache[t] }, show: function () { return this.visible(!0) }, hide: function () { return this.visible(!1) }, focus: function () { try { this.getEl().focus() } catch (e) { } return this }, blur: function () { return this.getEl().blur(), this }, aria: function (e, t) { var n = this, i = n.getEl(n.ariaTarget); return void 0 === t ? n._aria[e] : (n._aria[e] = t, n.state.get("rendered") && i.setAttribute("role" === e ? e : "aria-" + e, t), n) }, encode: function (e, t) { return !1 !== t && (e = this.translate(e)), (e || "").replace(/[&<>"]/g, function (e) { return "&#" + e.charCodeAt(0) + ";" }) }, translate: function (e) { return Ze.translate ? Ze.translate(e) : e }, before: function (e) { var t = this.parent(); return t && t.insert(e, t.items().indexOf(this), !0), this }, after: function (e) { var t = this.parent(); return t && t.insert(e, t.items().indexOf(this)), this }, remove: function () { var t, e, n = this, i = n.getEl(), r = n.parent(); if (n.items) { var o = n.items().toArray(); for (e = o.length; e--;)o[e].remove() } r && r.items && (t = [], r.items().each(function (e) { e !== n && t.push(e) }), r.items().set(t), r._lastRect = null), n._eventsRoot && n._eventsRoot === n && Re(i).off(); var s = n.getRoot().controlIdLookup; return s && delete s[n._id], i && i.parentNode && i.parentNode.removeChild(i), n.state.set("rendered", !1), n.state.destroy(), n.fire("remove"), n }, renderBefore: function (e) { return Re(e).before(this.renderHtml()), this.postRender(), this }, renderTo: function (e) { return Re(e || this.getContainerElm()).append(this.renderHtml()), this.postRender(), this }, preRender: function () { }, render: function () { }, renderHtml: function () { return '<div id="' + this._id + '" class="' + this.classes + '"></div>' }, postRender: function () { var e, t, n, i, r, o = this, s = o.settings; for (i in o.$el = Re(o.getEl()), o.state.set("rendered", !0), s) 0 === i.indexOf("on") && o.on(i.substr(2), s[i]); if (o._eventsRoot) { for (n = o.parent(); !r && n; n = n.parent())r = n._eventsRoot; if (r) for (i in r._nativeEvents) o._nativeEvents[i] = !0 } at(o), s.style && (e = o.getEl()) && (e.setAttribute("style", s.style), e.style.cssText = s.style), o.settings.border && (t = o.borderBox, o.$el.css({ "border-top-width": t.top, "border-right-width": t.right, "border-bottom-width": t.bottom, "border-left-width": t.left })); var a = o.getRoot(); for (var l in a.controlIdLookup || (a.controlIdLookup = {}), (a.controlIdLookup[o._id] = o)._aria) o.aria(l, o._aria[l]); !1 === o.state.get("visible") && (o.getEl().style.display = "none"), o.bindStates(), o.state.on("change:visible", function (e) { var t, n = e.value; o.state.get("rendered") && (o.getEl().style.display = !1 === n ? "none" : "", o.getEl().getBoundingClientRect()), (t = o.parent()) && (t._lastRect = null), o.fire(n ? "show" : "hide"), tt.add(o) }), o.fire("postrender", {}, !1) }, bindStates: function () { }, scrollIntoView: function (e) { var t, n, i, r, o, s, a = this.getEl(), l = a.parentNode, u = function (e, t) { var n, i, r = e; for (n = i = 0; r && r !== t && r.nodeType;)n += r.offsetLeft || 0, i += r.offsetTop || 0, r = r.offsetParent; return { x: n, y: i } }(a, l); return t = u.x, n = u.y, i = a.offsetWidth, r = a.offsetHeight, o = l.clientWidth, s = l.clientHeight, "end" === e ? (t -= o - i, n -= s - r) : "center" === e && (t -= o / 2 - i / 2, n -= s / 2 - r / 2), l.scrollLeft = t, l.scrollTop = n, this }, getRoot: function () { for (var e, t = this, n = []; t;) { if (t.rootControl) { e = t.rootControl; break } n.push(t), t = (e = t).parent() } e || (e = this); for (var i = n.length; i--;)n[i].rootControl = e; return e }, reflow: function () { tt.remove(this); var e = this.parent(); return e && e._layout && !e._layout.isNative() && e.reflow(), this } }; function st(n) { return n._eventDispatcher || (n._eventDispatcher = new De({ scope: n, toggleEvent: function (e, t) { t && De.isNative(e) && (n._nativeEvents || (n._nativeEvents = {}), n._nativeEvents[e] = !0, n.state.get("rendered") && at(n)) } })), n._eventDispatcher } function at(a) { var e, t, n, l, i, r; function o(e) { var t = a.getParentCtrl(e.target); t && t.fire(e.type, e) } function s() { var e = l._lastHoverCtrl; e && (e.fire("mouseleave", { target: e.getEl() }), e.parents().each(function (e) { e.fire("mouseleave", { target: e.getEl() }) }), l._lastHoverCtrl = null) } function u(e) { var t, n, i, r = a.getParentCtrl(e.target), o = l._lastHoverCtrl, s = 0; if (r !== o) { if ((n = (l._lastHoverCtrl = r).parents().toArray().reverse()).push(r), o) { for ((i = o.parents().toArray().reverse()).push(o), s = 0; s < i.length && n[s] === i[s]; s++); for (t = i.length - 1; s <= t; t--)(o = i[t]).fire("mouseleave", { target: o.getEl() }) } for (t = s; t < n.length; t++)(r = n[t]).fire("mouseenter", { target: r.getEl() }) } } function c(e) { e.preventDefault(), "mousewheel" === e.type ? (e.deltaY = -.025 * e.wheelDelta, e.wheelDeltaX && (e.deltaX = -.025 * e.wheelDeltaX)) : (e.deltaX = 0, e.deltaY = e.detail), e = a.fire("wheel", e) } if (i = a._nativeEvents) { for ((n = a.parents().toArray()).unshift(a), e = 0, t = n.length; !l && e < t; e++)l = n[e]._eventsRoot; for (l || (l = n[n.length - 1] || a), a._eventsRoot = l, t = e, e = 0; e < t; e++)n[e]._eventsRoot = l; var d = l._delegates; for (r in d || (d = l._delegates = {}), i) { if (!i) return !1; "wheel" !== r || it ? ("mouseenter" === r || "mouseleave" === r ? l._hasMouseEnter || (Re(l.getEl()).on("mouseleave", s).on("mouseover", u), l._hasMouseEnter = 1) : d[r] || (Re(l.getEl()).on(r, o), d[r] = !0), i[r] = !1) : nt ? Re(a.getEl()).on("mousewheel", c) : Re(a.getEl()).on("DOMMouseScroll", c) } } } w.each("text title visible disabled active value".split(" "), function (t) { ot[t] = function (e) { return 0 === arguments.length ? this.state.get(t) : (void 0 !== e && this.state.set(t, e), this) } }); var lt = Ze = We.extend(ot), ut = function (e) { return !!e.getAttribute("data-mce-tabstop") }; function ct(e) { var o, r, n = e.root; function i(e) { return e && 1 === e.nodeType } try { o = document.activeElement } catch (t) { o = document.body } function s(e) { return i(e = e || o) ? e.getAttribute("role") : null } function a(e) { for (var t, n = e || o; n = n.parentNode;)if (t = s(n)) return t } function l(e) { var t = o; if (i(t)) return t.getAttribute("aria-" + e) } function u(e) { var t = e.tagName.toUpperCase(); return "INPUT" === t || "TEXTAREA" === t || "SELECT" === t } function c(t) { var r = []; return function e(t) { if (1 === t.nodeType && "none" !== t.style.display && !t.disabled) { var n; (u(n = t) && !n.hidden || ut(n) || /^(button|menuitem|checkbox|tab|menuitemcheckbox|option|gridcell|slider)$/.test(s(n))) && r.push(t); for (var i = 0; i < t.childNodes.length; i++)e(t.childNodes[i]) } }(t || n.getEl()), r } function d(e) { var t, n; (n = (e = e || r).parents().toArray()).unshift(e); for (var i = 0; i < n.length && !(t = n[i]).settings.ariaRoot; i++); return t } function f(e, t) { return e < 0 ? e = t.length - 1 : e >= t.length && (e = 0), t[e] && t[e].focus(), e } function h(e, t) { var n = -1, i = d(); t = t || c(i.getEl()); for (var r = 0; r < t.length; r++)t[r] === o && (n = r); n += e, i.lastAriaIndex = f(n, t) } function m() { "tablist" === a() ? h(-1, c(o.parentNode)) : r.parent().submenu ? b() : h(-1) } function g() { var e = s(), t = a(); "tablist" === t ? h(1, c(o.parentNode)) : "menuitem" === e && "menu" === t && l("haspopup") ? y() : h(1) } function p() { h(-1) } function v() { var e = s(), t = a(); "menuitem" === e && "menubar" === t ? y() : "button" === e && l("haspopup") ? y({ key: "down" }) : h(1) } function b() { r.fire("cancel") } function y(e) { e = e || {}, r.fire("click", { target: o, aria: e }) } return r = n.getParentCtrl(o), n.on("keydown", function (e) { function t(e, t) { u(o) || ut(o) || "slider" !== s(o) && !1 !== t(e) && e.preventDefault() } if (!e.isDefaultPrevented()) switch (e.keyCode) { case 37: t(e, m); break; case 39: t(e, g); break; case 38: t(e, p); break; case 40: t(e, v); break; case 27: b(); break; case 14: case 13: case 32: t(e, y); break; case 9: !function (e) { if ("tablist" === a()) { var t = c(r.getEl("body"))[0]; t && t.focus() } else h(e.shiftKey ? -1 : 1) }(e), e.preventDefault() } }), n.on("focusin", function (e) { o = e.target, r = e.control }), { focusFirst: function (e) { var t = d(e), n = c(t.getEl()); t.settings.ariaRemember && "lastAriaIndex" in t ? f(t.lastAriaIndex, n) : f(0, n) } } } var dt = {}, ft = lt.extend({ init: function (e) { var t = this; t._super(e), (e = t.settings).fixed && t.state.set("fixed", !0), t._items = new $e, t.isRtl() && t.classes.add("rtl"), t.bodyClasses = new Oe(function () { t.state.get("rendered") && (t.getEl("body").className = this.toString()) }), t.bodyClasses.prefix = t.classPrefix, t.classes.add("container"), t.bodyClasses.add("container-body"), e.containerCls && t.classes.add(e.containerCls), t._layout = v.create((e.layout || "") + "layout"), t.settings.items ? t.add(t.settings.items) : t.add(t.render()), t._hasBody = !0 }, items: function () { return this._items }, find: function (e) { return (e = dt[e] = dt[e] || new je(e)).find(this) }, add: function (e) { return this.items().add(this.create(e)).parent(this), this }, focus: function (e) { var t, n, i, r = this; if (!e || !(n = r.keyboardNav || r.parents().eq(-1)[0].keyboardNav)) return i = r.find("*"), r.statusbar && i.add(r.statusbar.items()), i.each(function (e) { if (e.settings.autofocus) return t = null, !1; e.canFocus && (t = t || e) }), t && t.focus(), r; n.focusFirst(r) }, replace: function (e, t) { for (var n, i = this.items(), r = i.length; r--;)if (i[r] === e) { i[r] = t; break } 0 <= r && ((n = t.getEl()) && n.parentNode.removeChild(n), (n = e.getEl()) && n.parentNode.removeChild(n)), t.parent(this) }, create: function (e) { var t, n = this, i = []; return w.isArray(e) || (e = [e]), w.each(e, function (e) { e && (e instanceof lt || ("string" == typeof e && (e = { type: e }), t = w.extend({}, n.settings.defaults, e), e.type = t.type = t.type || e.type || n.settings.defaultType || (t.defaults ? t.defaults.type : null), e = v.create(t)), i.push(e)) }), i }, renderNew: function () { var i = this; return i.items().each(function (e, t) { var n; e.parent(i), e.state.get("rendered") || ((n = i.getEl("body")).hasChildNodes() && t <= n.childNodes.length - 1 ? Re(n.childNodes[t]).before(e.renderHtml()) : Re(n).append(e.renderHtml()), e.postRender(), tt.add(e)) }), i._layout.applyClasses(i.items().filter(":visible")), i._lastRect = null, i }, append: function (e) { return this.add(e).renderNew() }, prepend: function (e) { return this.items().set(this.create(e).concat(this.items().toArray())), this.renderNew() }, insert: function (e, t, n) { var i, r, o; return e = this.create(e), i = this.items(), !n && t < i.length - 1 && (t += 1), 0 <= t && t < i.length && (r = i.slice(0, t).toArray(), o = i.slice(t).toArray(), i.set(r.concat(e, o))), this.renderNew() }, fromJSON: function (e) { for (var t in e) this.find("#" + t).value(e[t]); return this }, toJSON: function () { var i = {}; return this.find("*").each(function (e) { var t = e.name(), n = e.value(); t && void 0 !== n && (i[t] = n) }), i }, renderHtml: function () { var e = this, t = e._layout, n = this.settings.role; return e.preRender(), t.preRender(e), '<div id="' + e._id + '" class="' + e.classes + '"' + (n ? ' role="' + this.settings.role + '"' : "") + '><div id="' + e._id + '-body" class="' + e.bodyClasses + '">' + (e.settings.html || "") + t.renderHtml(e) + "</div></div>" }, postRender: function () { var e, t = this; return t.items().exec("postRender"), t._super(), t._layout.postRender(t), t.state.set("rendered", !0), t.settings.style && t.$el.css(t.settings.style), t.settings.border && (e = t.borderBox, t.$el.css({ "border-top-width": e.top, "border-right-width": e.right, "border-bottom-width": e.bottom, "border-left-width": e.left })), t.parent() || (t.keyboardNav = ct({ root: t })), t }, initLayoutRect: function () { var e = this._super(); return this._layout.recalc(this), e }, recalc: function () { var e = this, t = e._layoutRect, n = e._lastRect; if (!n || n.w !== t.w || n.h !== t.h) return e._layout.recalc(e), t = e.layoutRect(), e._lastRect = { x: t.x, y: t.y, w: t.w, h: t.h }, !0 }, reflow: function () { var e; if (tt.remove(this), this.visible()) { for (lt.repaintControls = [], lt.repaintControls.map = {}, this.recalc(), e = lt.repaintControls.length; e--;)lt.repaintControls[e].repaint(); "flow" !== this.settings.layout && "stack" !== this.settings.layout && this.repaint(), lt.repaintControls = [] } return this } }); function ht(e) { var t, n; if (e.changedTouches) for (t = "screenX screenY pageX pageY clientX clientY".split(" "), n = 0; n < t.length; n++)e[t[n]] = e.changedTouches[0][t[n]] } function mt(e, h) { var m, g, t, p, v, b, y, x = h.document || document; h = h || {}; var w = x.getElementById(h.handle || e); t = function (e) { var t, n, i, r, o, s, a, l, u, c, d, f = (t = x, u = Math.max, n = t.documentElement, i = t.body, r = u(n.scrollWidth, i.scrollWidth), o = u(n.clientWidth, i.clientWidth), s = u(n.offsetWidth, i.offsetWidth), a = u(n.scrollHeight, i.scrollHeight), l = u(n.clientHeight, i.clientHeight), { width: r < s ? o : r, height: a < u(n.offsetHeight, i.offsetHeight) ? l : a }); ht(e), e.preventDefault(), g = e.button, c = w, b = e.screenX, y = e.screenY, d = window.getComputedStyle ? window.getComputedStyle(c, null).getPropertyValue("cursor") : c.runtimeStyle.cursor, m = Re("<div></div>").css({ position: "absolute", top: 0, left: 0, width: f.width, height: f.height, zIndex: 2147483647, opacity: 1e-4, cursor: d }).appendTo(x.body), Re(x).on("mousemove touchmove", v).on("mouseup touchend", p), h.start(e) }, v = function (e) { if (ht(e), e.button !== g) return p(e); e.deltaX = e.screenX - b, e.deltaY = e.screenY - y, e.preventDefault(), h.drag(e) }, p = function (e) { ht(e), Re(x).off("mousemove touchmove", v).off("mouseup touchend", p), m.remove(), h.stop && h.stop(e) }, this.destroy = function () { Re(w).off() }, Re(w).on("mousedown touchstart", t) } var gt, pt, vt, bt, yt = { init: function () { this.on("repaint", this.renderScroll) }, renderScroll: function () { var p = this, v = 2; function n() { var m, g, e; function t(e, t, n, i, r, o) { var s, a, l, u, c, d, f, h; if (a = p.getEl("scroll" + e)) { if (f = t.toLowerCase(), h = n.toLowerCase(), Re(p.getEl("absend")).css(f, p.layoutRect()[i] - 1), !r) return void Re(a).css("display", "none"); Re(a).css("display", "block"), s = p.getEl("body"), l = p.getEl("scroll" + e + "t"), u = s["client" + n] - 2 * v, c = (u -= m && g ? a["client" + o] : 0) / s["scroll" + n], (d = {})[f] = s["offset" + t] + v, d[h] = u, Re(a).css(d), (d = {})[f] = s["scroll" + t] * c, d[h] = u * c, Re(l).css(d) } } e = p.getEl("body"), m = e.scrollWidth > e.clientWidth, g = e.scrollHeight > e.clientHeight, t("h", "Left", "Width", "contentW", m, "Height"), t("v", "Top", "Height", "contentH", g, "Width") } p.settings.autoScroll && (p._hasScroll || (p._hasScroll = !0, function () { function e(s, a, l, u, c) { var d, e = p._id + "-scroll" + s, t = p.classPrefix; Re(p.getEl()).append('<div id="' + e + '" class="' + t + "scrollbar " + t + "scrollbar-" + s + '"><div id="' + e + 't" class="' + t + 'scrollbar-thumb"></div></div>'), p.draghelper = new mt(e + "t", { start: function () { d = p.getEl("body")["scroll" + a], Re("#" + e).addClass(t + "active") }, drag: function (e) { var t, n, i, r, o = p.layoutRect(); n = o.contentW > o.innerW, i = o.contentH > o.innerH, r = p.getEl("body")["client" + l] - 2 * v, t = (r -= n && i ? p.getEl("scroll" + s)["client" + c] : 0) / p.getEl("body")["scroll" + l], p.getEl("body")["scroll" + a] = d + e["delta" + u] / t }, stop: function () { Re("#" + e).removeClass(t + "active") } }) } p.classes.add("scroll"), e("v", "Top", "Height", "Y", "Width"), e("h", "Left", "Width", "X", "Height") }(), p.on("wheel", function (e) { var t = p.getEl("body"); t.scrollLeft += 10 * (e.deltaX || 0), t.scrollTop += 10 * e.deltaY, n() }), Re(p.getEl("body")).on("scroll", n)), n()) } }, xt = ft.extend({ Defaults: { layout: "fit", containerCls: "panel" }, Mixins: [yt], renderHtml: function () { var e = this, t = e._layout, n = e.settings.html; return e.preRender(), t.preRender(e), void 0 === n ? n = '<div id="' + e._id + '-body" class="' + e.bodyClasses + '">' + t.renderHtml(e) + "</div>" : ("function" == typeof n && (n = n.call(e)), e._hasBody = !1), '<div id="' + e._id + '" class="' + e.classes + '" hidefocus="1" tabindex="-1" role="group">' + (e._preBodyHtml || "") + n + "</div>" } }), wt = { resizeToContent: function () { this._layoutRect.autoResize = !0, this._lastRect = null, this.reflow() }, resizeTo: function (e, t) { if (e <= 1 || t <= 1) { var n = ke.getWindowSize(); e = e <= 1 ? e * n.w : e, t = t <= 1 ? t * n.h : t } return this._layoutRect.autoResize = !1, this.layoutRect({ minW: e, minH: t, w: e, h: t }).reflow() }, resizeBy: function (e, t) { var n = this.layoutRect(); return this.resizeTo(n.w + e, n.h + t) } }, _t = [], Rt = []; function Ct(e, t) { for (; e;) { if (e === t) return !0; e = e.parent() } } function kt() { gt || (gt = function (e) { 2 !== e.button && function (e) { for (var t = _t.length; t--;) { var n = _t[t], i = n.getParentCtrl(e.target); if (n.settings.autohide) { if (i && (Ct(i, n) || n.parent() === i)) continue; (e = n.fire("autohide", { target: e.target })).isDefaultPrevented() || n.hide() } } }(e) }, Re(document).on("click touchstart", gt)) } function Et(r) { var e = ke.getViewPort().y; function t(e, t) { for (var n, i = 0; i < _t.length; i++)if (_t[i] !== r) for (n = _t[i].parent(); n && (n = n.parent());)n === r && _t[i].fixed(e).moveBy(0, t).repaint() } r.settings.autofix && (r.state.get("fixed") ? r._autoFixY > e && (r.fixed(!1).layoutRect({ y: r._autoFixY }).repaint(), t(!1, r._autoFixY - e)) : (r._autoFixY = r.layoutRect().y, r._autoFixY < e && (r.fixed(!0).layoutRect({ y: 0 }).repaint(), t(!0, e - r._autoFixY)))) } function Ht(e, t) { var n, i, r = St.zIndex || 65535; if (e) Rt.push(t); else for (n = Rt.length; n--;)Rt[n] === t && Rt.splice(n, 1); if (Rt.length) for (n = 0; n < Rt.length; n++)Rt[n].modal && (r++ , i = Rt[n]), Rt[n].getEl().style.zIndex = r, Rt[n].zIndex = r, r++; var o = Re("#" + t.classPrefix + "modal-block", t.getContainerElm())[0]; i ? Re(o).css("z-index", i.zIndex - 1) : o && (o.parentNode.removeChild(o), bt = !1), St.currentZIndex = r } var St = xt.extend({ Mixins: [Pe, wt], init: function (e) { var i = this; i._super(e), (i._eventsRoot = i).classes.add("floatpanel"), e.autohide && (kt(), function () { if (!vt) { var e = document.documentElement, t = e.clientWidth, n = e.clientHeight; vt = function () { document.all && t === e.clientWidth && n === e.clientHeight || (t = e.clientWidth, n = e.clientHeight, St.hideAll()) }, Re(window).on("resize", vt) } }(), _t.push(i)), e.autofix && (pt || (pt = function () { var e; for (e = _t.length; e--;)Et(_t[e]) }, Re(window).on("scroll", pt)), i.on("move", function () { Et(this) })), i.on("postrender show", function (e) { if (e.control === i) { var t, n = i.classPrefix; i.modal && !bt && ((t = Re("#" + n + "modal-block", i.getContainerElm()))[0] || (t = Re('<div id="' + n + 'modal-block" class="' + n + "reset " + n + 'fade"></div>').appendTo(i.getContainerElm())), u.setTimeout(function () { t.addClass(n + "in"), Re(i.getEl()).addClass(n + "in") }), bt = !0), Ht(!0, i) } }), i.on("show", function () { i.parents().each(function (e) { if (e.state.get("fixed")) return i.fixed(!0), !1 }) }), e.popover && (i._preBodyHtml = '<div class="' + i.classPrefix + 'arrow"></div>', i.classes.add("popover").add("bottom").add(i.isRtl() ? "end" : "start")), i.aria("label", e.ariaLabel), i.aria("labelledby", i._id), i.aria("describedby", i.describedBy || i._id + "-none") }, fixed: function (e) { var t = this; if (t.state.get("fixed") !== e) { if (t.state.get("rendered")) { var n = ke.getViewPort(); e ? t.layoutRect().y -= n.y : t.layoutRect().y += n.y } t.classes.toggle("fixed", e), t.state.set("fixed", e) } return t }, show: function () { var e, t = this._super(); for (e = _t.length; e-- && _t[e] !== this;); return -1 === e && _t.push(this), t }, hide: function () { return Mt(this), Ht(!1, this), this._super() }, hideAll: function () { St.hideAll() }, close: function () { return this.fire("close").isDefaultPrevented() || (this.remove(), Ht(!1, this)), this }, remove: function () { Mt(this), this._super() }, postRender: function () { return this.settings.bodyRole && this.getEl("body").setAttribute("role", this.settings.bodyRole), this._super() } }); function Mt(e) { var t; for (t = _t.length; t--;)_t[t] === e && _t.splice(t, 1); for (t = Rt.length; t--;)Rt[t] === e && Rt.splice(t, 1) } St.hideAll = function () { for (var e = _t.length; e--;) { var t = _t[e]; t && t.settings.autohide && (t.hide(), _t.splice(e, 1)) } }; var Tt = function (e, t) { return !(!e || t.settings.ui_container) }, Pt = function (s, e, t) { var a, n, l = p.DOM, i = s.getParam("fixed_toolbar_container"); i && (n = l.select(i)[0]); var r = function () { if (a && a.moveRel && a.visible() && !a._fixed) { var e = s.selection.getScrollContainer(), t = s.getBody(), n = 0, i = 0; if (e) { var r = l.getPos(t), o = l.getPos(e); n = Math.max(0, o.x - r.x), i = Math.max(0, o.y - r.y) } a.fixed(!1).moveRel(t, s.rtl ? ["tr-br", "br-tr"] : ["tl-bl", "bl-tl", "tr-br"]).moveBy(n, i) } }, o = function () { a && (a.show(), r(), l.addClass(s.getBody(), "mce-edit-focus")) }, u = function () { a && (a.hide(), St.hideAll(), l.removeClass(s.getBody(), "mce-edit-focus")) }, c = function () { a ? a.visible() || o() : (a = e.panel = v.create({ type: n ? "panel" : "floatpanel", role: "application", classes: "tinymce tinymce-inline", layout: "flex", direction: "column", align: "stretch", autohide: !1, autofix: Tt(n, s), fixed: Tt(n, s), border: 1, items: [!1 === d(s) ? null : { type: "menubar", border: "0 0 1 0", items: le(s) }, B(s, f(s))] }), D.setUiContainer(s, a), x(s), n ? a.renderTo(n).reflow() : a.renderTo().reflow(), _(s, a), o(), F(s), s.on("nodeChange", r), s.on("ResizeWindow", r), s.on("activate", o), s.on("deactivate", u), s.nodeChanged()) }; return s.settings.content_editable = !0, s.on("focus", function () { !1 === m(s) && t.skinUiCss ? l.styleSheetLoader.load(t.skinUiCss, c, c) : c() }), s.on("blur hide", u), s.on("remove", function () { a && (a.remove(), a = null) }), !1 === m(s) && t.skinUiCss ? l.styleSheetLoader.load(t.skinUiCss, ye(s)) : ye(s)(), {} }; function Wt(i, r) { var o, s, a = this, l = lt.classPrefix; a.show = function (e, t) { function n() { o && (Re(i).append('<div class="' + l + "throbber" + (r ? " " + l + "throbber-inline" : "") + '"></div>'), t && t()) } return a.hide(), o = !0, e ? s = u.setTimeout(n, e) : n(), a }, a.hide = function () { var e = i.lastChild; return u.clearTimeout(s), e && -1 !== e.className.indexOf("throbber") && e.parentNode.removeChild(e), o = !1, a } } var Dt = function (e, t) { var n; e.on("ProgressState", function (e) { n = n || new Wt(t.panel.getEl("body")), e.state ? n.show(e.time) : n.hide() }) }, Nt = function (e, t, n) { var i = function (e) { var t = e.settings, n = t.skin, i = t.skin_url; if (!1 !== n) { var r = n || "lightgray"; i = i ? e.documentBaseURI.toAbsolute(i) : l.baseURL + "/skins/" + r } return i }(e); return i && (n.skinUiCss = i + "/skin.min.css", e.contentCSS.push(i + "/content" + (e.inline ? ".inline" : "") + ".min.css")), Dt(e, t), e.getParam("inline", !1, "boolean") ? Pt(e, t, n) : _e(e, t, n) }, At = lt.extend({ Mixins: [Pe], Defaults: { classes: "widget tooltip tooltip-n" }, renderHtml: function () { var e = this, t = e.classPrefix; return '<div id="' + e._id + '" class="' + e.classes + '" role="presentation"><div class="' + t + 'tooltip-arrow"></div><div class="' + t + 'tooltip-inner">' + e.encode(e.state.get("text")) + "</div></div>" }, bindStates: function () { var t = this; return t.state.on("change:text", function (e) { t.getEl().lastChild.innerHTML = t.encode(e.value) }), t._super() }, repaint: function () { var e, t; e = this.getEl().style, t = this._layoutRect, e.left = t.x + "px", e.top = t.y + "px", e.zIndex = 131070 } }), Bt = lt.extend({ init: function (i) { var r = this; r._super(i), i = r.settings, r.canFocus = !0, i.tooltip && !1 !== Bt.tooltips && (r.on("mouseenter", function (e) { var t = r.tooltip().moveTo(-65535); if (e.control === r) { var n = t.text(i.tooltip).show().testMoveRel(r.getEl(), ["bc-tc", "bc-tl", "bc-tr"]); t.classes.toggle("tooltip-n", "bc-tc" === n), t.classes.toggle("tooltip-nw", "bc-tl" === n), t.classes.toggle("tooltip-ne", "bc-tr" === n), t.moveRel(r.getEl(), n) } else t.hide() }), r.on("mouseleave mousedown click", function () { r.tooltip().remove(), r._tooltip = null })), r.aria("label", i.ariaLabel || i.tooltip) }, tooltip: function () { return this._tooltip || (this._tooltip = new At({ type: "tooltip" }), D.inheritUiContainer(this, this._tooltip), this._tooltip.renderTo()), this._tooltip }, postRender: function () { var e = this, t = e.settings; e._super(), e.parent() || !t.width && !t.height || (e.initLayoutRect(), e.repaint()), t.autofocus && e.focus() }, bindStates: function () { var t = this; function n(e) { t.aria("disabled", e), t.classes.toggle("disabled", e) } function i(e) { t.aria("pressed", e), t.classes.toggle("active", e) } return t.state.on("change:disabled", function (e) { n(e.value) }), t.state.on("change:active", function (e) { i(e.value) }), t.state.get("disabled") && n(!0), t.state.get("active") && i(!0), t._super() }, remove: function () { this._super(), this._tooltip && (this._tooltip.remove(), this._tooltip = null) } }), Ot = Bt.extend({ Defaults: { value: 0 }, init: function (e) { this._super(e), this.classes.add("progress"), this.settings.filter || (this.settings.filter = function (e) { return Math.round(e) }) }, renderHtml: function () { var e = this._id, t = this.classPrefix; return '<div id="' + e + '" class="' + this.classes + '"><div class="' + t + 'bar-container"><div class="' + t + 'bar"></div></div><div class="' + t + 'text">0%</div></div>' }, postRender: function () { return this._super(), this.value(this.settings.value), this }, bindStates: function () { var t = this; function n(e) { e = t.settings.filter(e), t.getEl().lastChild.innerHTML = e + "%", t.getEl().firstChild.firstChild.style.width = e + "%" } return t.state.on("change:value", function (e) { n(e.value) }), n(t.state.get("value")), t._super() } }), zt = function (e, t) { e.getEl().lastChild.textContent = t + (e.progressBar ? " " + e.progressBar.value() + "%" : "") }, Lt = lt.extend({ Mixins: [Pe], Defaults: { classes: "widget notification" }, init: function (e) { var t = this; t._super(e), t.maxWidth = e.maxWidth, e.text && t.text(e.text), e.icon && (t.icon = e.icon), e.color && (t.color = e.color), e.type && t.classes.add("notification-" + e.type), e.timeout && (e.timeout < 0 || 0 < e.timeout) && !e.closeButton ? t.closeButton = !1 : (t.classes.add("has-close"), t.closeButton = !0), e.progressBar && (t.progressBar = new Ot), t.on("click", function (e) { -1 !== e.target.className.indexOf(t.classPrefix + "close") && t.close() }) }, renderHtml: function () { var e, t = this, n = t.classPrefix, i = "", r = "", o = ""; return t.icon && (i = '<i class="' + n + "ico " + n + "i-" + t.icon + '"></i>'), e = ' style="max-width: ' + t.maxWidth + "px;" + (t.color ? "background-color: " + t.color + ';"' : '"'), t.closeButton && (r = '<button type="button" class="' + n + 'close" aria-hidden="true">\xd7</button>'), t.progressBar && (o = t.progressBar.renderHtml()), '<div id="' + t._id + '" class="' + t.classes + '"' + e + ' role="presentation">' + i + '<div class="' + n + 'notification-inner">' + t.state.get("text") + "</div>" + o + r + '<div style="clip: rect(1px, 1px, 1px, 1px);height: 1px;overflow: hidden;position: absolute;width: 1px;" aria-live="assertive" aria-relevant="additions" aria-atomic="true"></div></div>' }, postRender: function () { var e = this; return u.setTimeout(function () { e.$el.addClass(e.classPrefix + "in"), zt(e, e.state.get("text")) }, 100), e._super() }, bindStates: function () { var t = this; return t.state.on("change:text", function (e) { t.getEl().firstChild.innerHTML = e.value, zt(t, e.value) }), t.progressBar && (t.progressBar.bindStates(), t.progressBar.state.on("change:value", function (e) { zt(t, t.state.get("text")) })), t._super() }, close: function () { return this.fire("close").isDefaultPrevented() || this.remove(), this }, repaint: function () { var e, t; e = this.getEl().style, t = this._layoutRect, e.left = t.x + "px", e.top = t.y + "px", e.zIndex = 65534 } }); function It(o) { var s = function (e) { return e.inline ? e.getElement() : e.getContentAreaContainer() }; return { open: function (e, t) { var n, i = w.extend(e, { maxWidth: (n = s(o), ke.getSize(n).width) }), r = new Lt(i); return 0 < (r.args = i).timeout && (r.timer = setTimeout(function () { r.close(), t() }, i.timeout)), r.on("close", function () { t() }), r.renderTo(), r }, close: function (e) { e.close() }, reposition: function (e) { var t; t = e, ie.each(t, function (e) { e.moveTo(0, 0) }), function (n) { if (0 < n.length) { var e = n.slice(0, 1)[0], t = s(o); e.moveRel(t, "tc-tc"), ie.each(n, function (e, t) { 0 < t && e.moveRel(n[t - 1].getEl(), "bc-tc") }) } }(e) }, getArgs: function (e) { return e.args } } } var Ft = [], Ut = ""; function Vt(e) { var t, n = Re("meta[name=viewport]")[0]; !1 !== me.overrideViewPort && (n || ((n = document.createElement("meta")).setAttribute("name", "viewport"), document.getElementsByTagName("head")[0].appendChild(n)), (t = n.getAttribute("content")) && void 0 !== Ut && (Ut = t), n.setAttribute("content", e ? "width=device-width,initial-scale=1.0,user-scalable=0,minimum-scale=1.0,maximum-scale=1.0" : Ut)) } function jt(e, t) { (function () { for (var e = 0; e < Ft.length; e++)if (Ft[e]._fullscreen) return !0; return !1 })() && !1 === t && Re([document.documentElement, document.body]).removeClass(e + "fullscreen") } var qt = St.extend({ modal: !0, Defaults: { border: 1, layout: "flex", containerCls: "panel", role: "dialog", callbacks: { submit: function () { this.fire("submit", { data: this.toJSON() }) }, close: function () { this.close() } } }, init: function (e) { var n = this; n._super(e), n.isRtl() && n.classes.add("rtl"), n.classes.add("window"), n.bodyClasses.add("window-body"), n.state.set("fixed", !0), e.buttons && (n.statusbar = new xt({ layout: "flex", border: "1 0 0 0", spacing: 3, padding: 10, align: "center", pack: n.isRtl() ? "start" : "end", defaults: { type: "button" }, items: e.buttons }), n.statusbar.classes.add("foot"), n.statusbar.parent(n)), n.on("click", function (e) { var t = n.classPrefix + "close"; (ke.hasClass(e.target, t) || ke.hasClass(e.target.parentNode, t)) && n.close() }), n.on("cancel", function () { n.close() }), n.on("move", function (e) { e.control === n && St.hideAll() }), n.aria("describedby", n.describedBy || n._id + "-none"), n.aria("label", e.title), n._fullscreen = !1 }, recalc: function () { var e, t, n, i, r = this, o = r.statusbar; r._fullscreen && (r.layoutRect(ke.getWindowSize()), r.layoutRect().contentH = r.layoutRect().innerH), r._super(), e = r.layoutRect(), r.settings.title && !r._fullscreen && (t = e.headerW) > e.w && (n = e.x - Math.max(0, t / 2), r.layoutRect({ w: t, x: n }), i = !0), o && (o.layoutRect({ w: r.layoutRect().innerW }).recalc(), (t = o.layoutRect().minW + e.deltaW) > e.w && (n = e.x - Math.max(0, t - e.w), r.layoutRect({ w: t, x: n }), i = !0)), i && r.recalc() }, initLayoutRect: function () { var e, t = this, n = t._super(), i = 0; if (t.settings.title && !t._fullscreen) { e = t.getEl("head"); var r = ke.getSize(e); n.headerW = r.width, n.headerH = r.height, i += n.headerH } t.statusbar && (i += t.statusbar.layoutRect().h), n.deltaH += i, n.minH += i, n.h += i; var o = ke.getWindowSize(); return n.x = t.settings.x || Math.max(0, o.w / 2 - n.w / 2), n.y = t.settings.y || Math.max(0, o.h / 2 - n.h / 2), n }, renderHtml: function () { var e = this, t = e._layout, n = e._id, i = e.classPrefix, r = e.settings, o = "", s = "", a = r.html; return e.preRender(), t.preRender(e), r.title && (o = '<div id="' + n + '-head" class="' + i + 'window-head"><div id="' + n + '-title" class="' + i + 'title">' + e.encode(r.title) + '</div><div id="' + n + '-dragh" class="' + i + 'dragh"></div><button type="button" class="' + i + 'close" aria-hidden="true"><i class="mce-ico mce-i-remove"></i></button></div>'), r.url && (a = '<iframe src="' + r.url + '" tabindex="-1"></iframe>'), void 0 === a && (a = t.renderHtml(e)), e.statusbar && (s = e.statusbar.renderHtml()), '<div id="' + n + '" class="' + e.classes + '" hidefocus="1"><div class="' + e.classPrefix + 'reset" role="application">' + o + '<div id="' + n + '-body" class="' + e.bodyClasses + '">' + a + "</div>" + s + "</div></div>" }, fullscreen: function (e) { var n, t, i = this, r = document.documentElement, o = i.classPrefix; if (e !== i._fullscreen) if (Re(window).on("resize", function () { var e; if (i._fullscreen) if (n) i._timer || (i._timer = u.setTimeout(function () { var e = ke.getWindowSize(); i.moveTo(0, 0).resizeTo(e.w, e.h), i._timer = 0 }, 50)); else { e = (new Date).getTime(); var t = ke.getWindowSize(); i.moveTo(0, 0).resizeTo(t.w, t.h), 50 < (new Date).getTime() - e && (n = !0) } }), t = i.layoutRect(), i._fullscreen = e) { i._initial = { x: t.x, y: t.y, w: t.w, h: t.h }, i.borderBox = Ne("0"), i.getEl("head").style.display = "none", t.deltaH -= t.headerH + 2, Re([r, document.body]).addClass(o + "fullscreen"), i.classes.add("fullscreen"); var s = ke.getWindowSize(); i.moveTo(0, 0).resizeTo(s.w, s.h) } else i.borderBox = Ne(i.settings.border), i.getEl("head").style.display = "", t.deltaH += t.headerH, Re([r, document.body]).removeClass(o + "fullscreen"), i.classes.remove("fullscreen"), i.moveTo(i._initial.x, i._initial.y).resizeTo(i._initial.w, i._initial.h); return i.reflow() }, postRender: function () { var t, n = this; setTimeout(function () { n.classes.add("in"), n.fire("open") }, 0), n._super(), n.statusbar && n.statusbar.postRender(), n.focus(), this.dragHelper = new mt(n._id + "-dragh", { start: function () { t = { x: n.layoutRect().x, y: n.layoutRect().y } }, drag: function (e) { n.moveTo(t.x + e.deltaX, t.y + e.deltaY) } }), n.on("submit", function (e) { e.isDefaultPrevented() || n.close() }), Ft.push(n), Vt(!0) }, submit: function () { return this.fire("submit", { data: this.toJSON() }) }, remove: function () { var e, t = this; for (t.dragHelper.destroy(), t._super(), t.statusbar && this.statusbar.remove(), jt(t.classPrefix, !1), e = Ft.length; e--;)Ft[e] === t && Ft.splice(e, 1); Vt(0 < Ft.length) }, getContentWindow: function () { var e = this.getEl().getElementsByTagName("iframe")[0]; return e ? e.contentWindow : null } }); !function () { if (!me.desktop) { var n = { w: window.innerWidth, h: window.innerHeight }; u.setInterval(function () { var e = window.innerWidth, t = window.innerHeight; n.w === e && n.h === t || (n = { w: e, h: t }, Re(window).trigger("resize")) }, 100) } Re(window).on("resize", function () { var e, t, n = ke.getWindowSize(); for (e = 0; e < Ft.length; e++)t = Ft[e].layoutRect(), Ft[e].moveTo(Ft[e].settings.x || Math.max(0, n.w / 2 - t.w / 2), Ft[e].settings.y || Math.max(0, n.h / 2 - t.h / 2)) }) }(); var Yt, $t = qt.extend({ init: function (e) { e = { border: 1, padding: 20, layout: "flex", pack: "center", align: "center", containerCls: "panel", autoScroll: !0, buttons: { type: "button", text: "Ok", action: "ok" }, items: { type: "label", multiline: !0, maxWidth: 500, maxHeight: 200 } }, this._super(e) }, Statics: { OK: 1, OK_CANCEL: 2, YES_NO: 3, YES_NO_CANCEL: 4, msgBox: function (e) { var t, i = e.callback || function () { }; function n(e, t, n) { return { type: "button", text: e, subtype: n ? "primary" : "", onClick: function (e) { e.control.parents()[1].close(), i(t) } } } switch (e.buttons) { case $t.OK_CANCEL: t = [n("Ok", !0, !0), n("Cancel", !1)]; break; case $t.YES_NO: case $t.YES_NO_CANCEL: t = [n("Yes", 1, !0), n("No", 0)], e.buttons === $t.YES_NO_CANCEL && t.push(n("Cancel", -1)); break; default: t = [n("Ok", !0, !0)] }return new qt({ padding: 20, x: e.x, y: e.y, minWidth: 300, minHeight: 100, layout: "flex", pack: "center", align: "center", buttons: t, title: e.title, role: "alertdialog", items: { type: "label", multiline: !0, maxWidth: 500, maxHeight: 200, text: e.text }, onPostRender: function () { this.aria("describedby", this.items()[0]._id) }, onClose: e.onClose, onCancel: function () { i(!1) } }).renderTo(document.body).reflow() }, alert: function (e, t) { return "string" == typeof e && (e = { text: e }), e.callback = t, $t.msgBox(e) }, confirm: function (e, t) { return "string" == typeof e && (e = { text: e }), e.callback = t, e.buttons = $t.OK_CANCEL, $t.msgBox(e) } } }), Xt = function (n) { return { renderUI: function (e) { return Nt(n, this, e) }, resizeTo: function (e, t) { return fe(n, e, t) }, resizeBy: function (e, t) { return he(n, e, t) }, getNotificationManagerImpl: function () { return It(n) }, getWindowManagerImpl: function () { return { open: function (n, e, t) { var i; return n.title = n.title || " ", n.url = n.url || n.file, n.url && (n.width = parseInt(n.width || 320, 10), n.height = parseInt(n.height || 240, 10)), n.body && (n.items = { defaults: n.defaults, type: n.bodyType || "form", items: n.body, data: n.data, callbacks: n.commands }), n.url || n.buttons || (n.buttons = [{ text: "Ok", subtype: "primary", onclick: function () { i.find("form")[0].submit() } }, { text: "Cancel", onclick: function () { i.close() } }]), (i = new qt(n)).on("close", function () { t(i) }), n.data && i.on("postRender", function () { this.find("*").each(function (e) { var t = e.name(); t in n.data && e.value(n.data[t]) }) }), i.features = n || {}, i.params = e || {}, i = i.renderTo(document.body).reflow() }, alert: function (e, t, n) { var i; return (i = $t.alert(e, function () { t() })).on("close", function () { n(i) }), i }, confirm: function (e, t, n) { var i; return (i = $t.confirm(e, function (e) { t(e) })).on("close", function () { n(i) }), i }, close: function (e) { e.close() }, getParams: function (e) { return e.params }, setParams: function (e, t) { e.params = t } } } } }, Jt = We.extend({ Defaults: { firstControlClass: "first", lastControlClass: "last" }, init: function (e) { this.settings = w.extend({}, this.Defaults, e) }, preRender: function (e) { e.bodyClasses.add(this.settings.containerClass) }, applyClasses: function (e) { var t, n, i, r, o = this.settings; t = o.firstControlClass, n = o.lastControlClass, e.each(function (e) { e.classes.remove(t).remove(n).add(o.controlClass), e.visible() && (i || (i = e), r = e) }), i && i.classes.add(t), r && r.classes.add(n) }, renderHtml: function (e) { var t = ""; return this.applyClasses(e.items()), e.items().each(function (e) { t += e.renderHtml() }), t }, recalc: function () { }, postRender: function () { }, isNative: function () { return !1 } }), Gt = Jt.extend({ Defaults: { containerClass: "abs-layout", controlClass: "abs-layout-item" }, recalc: function (e) { e.items().filter(":visible").each(function (e) { var t = e.settings; e.layoutRect({ x: t.x, y: t.y, w: t.w, h: t.h }), e.recalc && e.recalc() }) }, renderHtml: function (e) { return '<div id="' + e._id + '-absend" class="' + e.classPrefix + 'abs-end"></div>' + this._super(e) } }), Kt = Bt.extend({ Defaults: { classes: "widget btn", role: "button" }, init: function (e) { var t, n = this; n._super(e), e = n.settings, t = n.settings.size, n.on("click mousedown", function (e) { e.preventDefault() }), n.on("touchstart", function (e) { n.fire("click", e), e.preventDefault() }), e.subtype && n.classes.add(e.subtype), t && n.classes.add("btn-" + t), e.icon && n.icon(e.icon) }, icon: function (e) { return arguments.length ? (this.state.set("icon", e), this) : this.state.get("icon") }, repaint: function () { var e, t = this.getEl().firstChild; t && ((e = t.style).width = e.height = "100%"), this._super() }, renderHtml: function () { var e, t, n = this, i = n._id, r = n.classPrefix, o = n.state.get("icon"), s = n.state.get("text"), a = "", l = n.settings; return (e = l.image) ? (o = "none", "string" != typeof e && (e = window.getSelection ? e[0] : e[1]), e = " style=\"background-image: url('" + e + "')\"") : e = "", s && (n.classes.add("btn-has-text"), a = '<span class="' + r + 'txt">' + n.encode(s) + "</span>"), o = o ? r + "ico " + r + "i-" + o : "", t = "boolean" == typeof l.active ? ' aria-pressed="' + l.active + '"' : "", '<div id="' + i + '" class="' + n.classes + '" tabindex="-1"' + t + '><button id="' + i + '-button" role="presentation" type="button" tabindex="-1">' + (o ? '<i class="' + o + '"' + e + "></i>" : "") + a + "</button></div>" }, bindStates: function () { var o = this, n = o.$, i = o.classPrefix + "txt"; function s(e) { var t = n("span." + i, o.getEl()); e ? (t[0] || (n("button:first", o.getEl()).append('<span class="' + i + '"></span>'), t = n("span." + i, o.getEl())), t.html(o.encode(e))) : t.remove(), o.classes.toggle("btn-has-text", !!e) } return o.state.on("change:text", function (e) { s(e.value) }), o.state.on("change:icon", function (e) { var t = e.value, n = o.classPrefix; t = (o.settings.icon = t) ? n + "ico " + n + "i-" + o.settings.icon : ""; var i = o.getEl().firstChild, r = i.getElementsByTagName("i")[0]; t ? (r && r === i.firstChild || (r = document.createElement("i"), i.insertBefore(r, i.firstChild)), r.className = t) : r && i.removeChild(r), s(o.state.get("text")) }), o._super() } }), Zt = Kt.extend({ init: function (e) { e = w.extend({ text: "Browse...", multiple: !1, accept: null }, e), this._super(e), this.classes.add("browsebutton"), e.multiple && this.classes.add("multiple") }, postRender: function () { var n = this, t = ke.create("input", { type: "file", id: n._id + "-browse", accept: n.settings.accept }); n._super(), Re(t).on("change", function (e) { var t = e.target.files; n.value = function () { return t.length ? n.settings.multiple ? t : t[0] : null }, e.preventDefault(), t.length && n.fire("change", e) }), Re(t).on("click", function (e) { e.stopPropagation() }), Re(n.getEl("button")).on("click", function (e) { e.stopPropagation(), t.click() }), n.getEl().appendChild(t) }, remove: function () { Re(this.getEl("button")).off(), Re(this.getEl("input")).off(), this._super() } }), Qt = ft.extend({ Defaults: { defaultType: "button", role: "group" }, renderHtml: function () { var e = this, t = e._layout; return e.classes.add("btn-group"), e.preRender(), t.preRender(e), '<div id="' + e._id + '" class="' + e.classes + '"><div id="' + e._id + '-body">' + (e.settings.html || "") + t.renderHtml(e) + "</div></div>" } }), en = Bt.extend({ Defaults: { classes: "checkbox", role: "checkbox", checked: !1 }, init: function (e) { var t = this; t._super(e), t.on("click mousedown", function (e) { e.preventDefault() }), t.on("click", function (e) { e.preventDefault(), t.disabled() || t.checked(!t.checked()) }), t.checked(t.settings.checked) }, checked: function (e) { return arguments.length ? (this.state.set("checked", e), this) : this.state.get("checked") }, value: function (e) { return arguments.length ? this.checked(e) : this.checked() }, renderHtml: function () { var e = this, t = e._id, n = e.classPrefix; return '<div id="' + t + '" class="' + e.classes + '" unselectable="on" aria-labelledby="' + t + '-al" tabindex="-1"><i class="' + n + "ico " + n + 'i-checkbox"></i><span id="' + t + '-al" class="' + n + 'label">' + e.encode(e.state.get("text")) + "</span></div>" }, bindStates: function () { var o = this; function t(e) { o.classes.toggle("checked", e), o.aria("checked", e) } return o.state.on("change:text", function (e) { o.getEl("al").firstChild.data = o.translate(e.value) }), o.state.on("change:checked change:value", function (e) { o.fire("change"), t(e.value) }), o.state.on("change:icon", function (e) { var t = e.value, n = o.classPrefix; if (void 0 === t) return o.settings.icon; t = (o.settings.icon = t) ? n + "ico " + n + "i-" + o.settings.icon : ""; var i = o.getEl().firstChild, r = i.getElementsByTagName("i")[0]; t ? (r && r === i.firstChild || (r = document.createElement("i"), i.insertBefore(r, i.firstChild)), r.className = t) : r && i.removeChild(r) }), o.state.get("checked") && t(!0), o._super() } }), tn = tinymce.util.Tools.resolve("tinymce.util.VK"), nn = Bt.extend({ init: function (i) { var r = this; r._super(i), i = r.settings, r.classes.add("combobox"), r.subinput = !0, r.ariaTarget = "inp", i.menu = i.menu || i.values, i.menu && (i.icon = "caret"), r.on("click", function (e) { var t = e.target, n = r.getEl(); if (Re.contains(n, t) || t === n) for (; t && t !== n;)t.id && -1 !== t.id.indexOf("-open") && (r.fire("action"), i.menu && (r.showMenu(), e.aria && r.menu.items()[0].focus())), t = t.parentNode }), r.on("keydown", function (e) { var t; 13 === e.keyCode && "INPUT" === e.target.nodeName && (e.preventDefault(), r.parents().reverse().each(function (e) { if (e.toJSON) return t = e, !1 }), r.fire("submit", { data: t.toJSON() })) }), r.on("keyup", function (e) { if ("INPUT" === e.target.nodeName) { var t = r.state.get("value"), n = e.target.value; n !== t && (r.state.set("value", n), r.fire("autocomplete", e)) } }), r.on("mouseover", function (e) { var t = r.tooltip().moveTo(-65535); if (r.statusLevel() && -1 !== e.target.className.indexOf(r.classPrefix + "status")) { var n = r.statusMessage() || "Ok", i = t.text(n).show().testMoveRel(e.target, ["bc-tc", "bc-tl", "bc-tr"]); t.classes.toggle("tooltip-n", "bc-tc" === i), t.classes.toggle("tooltip-nw", "bc-tl" === i), t.classes.toggle("tooltip-ne", "bc-tr" === i), t.moveRel(e.target, i) } }) }, statusLevel: function (e) { return 0 < arguments.length && this.state.set("statusLevel", e), this.state.get("statusLevel") }, statusMessage: function (e) { return 0 < arguments.length && this.state.set("statusMessage", e), this.state.get("statusMessage") }, showMenu: function () { var e, t = this, n = t.settings; t.menu || ((e = n.menu || []).length ? e = { type: "menu", items: e } : e.type = e.type || "menu", t.menu = v.create(e).parent(t).renderTo(t.getContainerElm()), t.fire("createmenu"), t.menu.reflow(), t.menu.on("cancel", function (e) { e.control === t.menu && t.focus() }), t.menu.on("show hide", function (e) { e.control.items().each(function (e) { e.active(e.value() === t.value()) }) }).fire("show"), t.menu.on("select", function (e) { t.value(e.control.value()) }), t.on("focusin", function (e) { "INPUT" === e.target.tagName.toUpperCase() && t.menu.hide() }), t.aria("expanded", !0)), t.menu.show(), t.menu.layoutRect({ w: t.layoutRect().w }), t.menu.moveRel(t.getEl(), t.isRtl() ? ["br-tr", "tr-br"] : ["bl-tl", "tl-bl"]) }, focus: function () { this.getEl("inp").focus() }, repaint: function () { var e, t, n = this, i = n.getEl(), r = n.getEl("open"), o = n.layoutRect(), s = 0, a = i.firstChild; n.statusLevel() && "none" !== n.statusLevel() && (s = parseInt(ke.getRuntimeStyle(a, "padding-right"), 10) - parseInt(ke.getRuntimeStyle(a, "padding-left"), 10)), e = r ? o.w - ke.getSize(r).width - 10 : o.w - 10; var l = document; return l.all && (!l.documentMode || l.documentMode <= 8) && (t = n.layoutRect().h - 2 + "px"), Re(a).css({ width: e - s, lineHeight: t }), n._super(), n }, postRender: function () { var t = this; return Re(this.getEl("inp")).on("change", function (e) { t.state.set("value", e.target.value), t.fire("change", e) }), t._super() }, renderHtml: function () { var e, t, n, i = this, r = i._id, o = i.settings, s = i.classPrefix, a = i.state.get("value") || "", l = "", u = ""; return "spellcheck" in o && (u += ' spellcheck="' + o.spellcheck + '"'), o.maxLength && (u += ' maxlength="' + o.maxLength + '"'), o.size && (u += ' size="' + o.size + '"'), o.subtype && (u += ' type="' + o.subtype + '"'), n = '<i id="' + r + '-status" class="mce-status mce-ico" style="display: none"></i>', i.disabled() && (u += ' disabled="disabled"'), (e = o.icon) && "caret" !== e && (e = s + "ico " + s + "i-" + o.icon), t = i.state.get("text"), (e || t) && (l = '<div id="' + r + '-open" class="' + s + "btn " + s + 'open" tabIndex="-1" role="button"><button id="' + r + '-action" type="button" hidefocus="1" tabindex="-1">' + ("caret" !== e ? '<i class="' + e + '"></i>' : '<i class="' + s + 'caret"></i>') + (t ? (e ? " " : "") + t : "") + "</button></div>", i.classes.add("has-open")), '<div id="' + r + '" class="' + i.classes + '"><input id="' + r + '-inp" class="' + s + 'textbox" value="' + i.encode(a, !1) + '" hidefocus="1"' + u + ' placeholder="' + i.encode(o.placeholder) + '" />' + n + l + "</div>" }, value: function (e) { return arguments.length ? (this.state.set("value", e), this) : (this.state.get("rendered") && this.state.set("value", this.getEl("inp").value), this.state.get("value")) }, showAutoComplete: function (e, i) { var r = this; if (0 !== e.length) { r.menu ? r.menu.items().remove() : r.menu = v.create({ type: "menu", classes: "combobox-menu", layout: "flow" }).parent(r).renderTo(), w.each(e, function (e) { var t, n; r.menu.add({ text: e.title, url: e.previewUrl, match: i, classes: "menu-item-ellipsis", onclick: (t = e.value, n = e.title, function () { r.fire("selectitem", { title: n, value: t }) }) }) }), r.menu.renderNew(), r.hideMenu(), r.menu.on("cancel", function (e) { e.control.parent() === r.menu && (e.stopPropagation(), r.focus(), r.hideMenu()) }), r.menu.on("select", function () { r.focus() }); var t = r.layoutRect().w; r.menu.layoutRect({ w: t, minW: 0, maxW: t }), r.menu.repaint(), r.menu.reflow(), r.menu.show(), r.menu.moveRel(r.getEl(), r.isRtl() ? ["br-tr", "tr-br"] : ["bl-tl", "tl-bl"]) } else r.hideMenu() }, hideMenu: function () { this.menu && this.menu.hide() }, bindStates: function () { var r = this; r.state.on("change:value", function (e) { r.getEl("inp").value !== e.value && (r.getEl("inp").value = e.value) }), r.state.on("change:disabled", function (e) { r.getEl("inp").disabled = e.value }), r.state.on("change:statusLevel", function (e) { var t = r.getEl("status"), n = r.classPrefix, i = e.value; ke.css(t, "display", "none" === i ? "none" : ""), ke.toggleClass(t, n + "i-checkmark", "ok" === i), ke.toggleClass(t, n + "i-warning", "warn" === i), ke.toggleClass(t, n + "i-error", "error" === i), r.classes.toggle("has-status", "none" !== i), r.repaint() }), ke.on(r.getEl("status"), "mouseleave", function () { r.tooltip().hide() }), r.on("cancel", function (e) { r.menu && r.menu.visible() && (e.stopPropagation(), r.hideMenu()) }); var n = function (e, t) { t && 0 < t.items().length && t.items().eq(e)[0].focus() }; return r.on("keydown", function (e) { var t = e.keyCode; "INPUT" === e.target.nodeName && (t === tn.DOWN ? (e.preventDefault(), r.fire("autocomplete"), n(0, r.menu)) : t === tn.UP && (e.preventDefault(), n(-1, r.menu))) }), r._super() }, remove: function () { Re(this.getEl("inp")).off(), this.menu && this.menu.remove(), this._super() } }), rn = nn.extend({ init: function (e) { var t = this; e.spellcheck = !1, e.onaction && (e.icon = "none"), t._super(e), t.classes.add("colorbox"), t.on("change keyup postrender", function () { t.repaintColor(t.value()) }) }, repaintColor: function (e) { var t = this.getEl("open"), n = t ? t.getElementsByTagName("i")[0] : null; if (n) try { n.style.background = e } catch (i) { } }, bindStates: function () { var t = this; return t.state.on("change:value", function (e) { t.state.get("rendered") && t.repaintColor(e.value) }), t._super() } }), on = Kt.extend({ showPanel: function () { var t = this, e = t.settings; if (t.classes.add("opened"), t.panel) t.panel.show(); else { var n = e.panel; n.type && (n = { layout: "grid", items: n }), n.role = n.role || "dialog", n.popover = !0, n.autohide = !0, n.ariaRoot = !0, t.panel = new St(n).on("hide", function () { t.classes.remove("opened") }).on("cancel", function (e) { e.stopPropagation(), t.focus(), t.hidePanel() }).parent(t).renderTo(t.getContainerElm()), t.panel.fire("show"), t.panel.reflow() } var i = t.panel.testMoveRel(t.getEl(), e.popoverAlign || (t.isRtl() ? ["bc-tc", "bc-tl", "bc-tr"] : ["bc-tc", "bc-tr", "bc-tl", "tc-bc", "tc-br", "tc-bl"])); t.panel.classes.toggle("start", "l" === i.substr(-1)), t.panel.classes.toggle("end", "r" === i.substr(-1)); var r = "t" === i.substr(0, 1); t.panel.classes.toggle("bottom", !r), t.panel.classes.toggle("top", r), t.panel.moveRel(t.getEl(), i) }, hidePanel: function () { this.panel && this.panel.hide() }, postRender: function () { var t = this; return t.aria("haspopup", !0), t.on("click", function (e) { e.control === t && (t.panel && t.panel.visible() ? t.hidePanel() : (t.showPanel(), t.panel.focus(!!e.aria))) }), t._super() }, remove: function () { return this.panel && (this.panel.remove(), this.panel = null), this._super() } }), sn = p.DOM, an = on.extend({ init: function (e) { this._super(e), this.classes.add("splitbtn"), this.classes.add("colorbutton") }, color: function (e) { return e ? (this._color = e, this.getEl("preview").style.backgroundColor = e, this) : this._color }, resetColor: function () { return this._color = null, this.getEl("preview").style.backgroundColor = null, this }, renderHtml: function () { var e = this, t = e._id, n = e.classPrefix, i = e.state.get("text"), r = e.settings.icon ? n + "ico " + n + "i-" + e.settings.icon : "", o = e.settings.image ? " style=\"background-image: url('" + e.settings.image + "')\"" : "", s = ""; return i && (e.classes.add("btn-has-text"), s = '<span class="' + n + 'txt">' + e.encode(i) + "</span>"), '<div id="' + t + '" class="' + e.classes + '" role="button" tabindex="-1" aria-haspopup="true"><button role="presentation" hidefocus="1" type="button" tabindex="-1">' + (r ? '<i class="' + r + '"' + o + "></i>" : "") + '<span id="' + t + '-preview" class="' + n + 'preview"></span>' + s + '</button><button type="button" class="' + n + 'open" hidefocus="1" tabindex="-1"> <i class="' + n + 'caret"></i></button></div>' }, postRender: function () { var t = this, n = t.settings.onclick; return t.on("click", function (e) { e.aria && "down" === e.aria.key || e.control !== t || sn.getParent(e.target, "." + t.classPrefix + "open") || (e.stopImmediatePropagation(), n.call(t, e)) }), delete t.settings.onclick, t._super() } }), ln = tinymce.util.Tools.resolve("tinymce.util.Color"), un = Bt.extend({ Defaults: { classes: "widget colorpicker" }, init: function (e) { this._super(e) }, postRender: function () { var n, i, r, o, s, a = this, l = a.color(); function u(e, t) { var n, i, r = ke.getPos(e); return n = t.pageX - r.x, i = t.pageY - r.y, { x: n = Math.max(0, Math.min(n / e.clientWidth, 1)), y: i = Math.max(0, Math.min(i / e.clientHeight, 1)) } } function c(e, t) { var n = (360 - e.h) / 360; ke.css(r, { top: 100 * n + "%" }), t || ke.css(s, { left: e.s + "%", top: 100 - e.v + "%" }), o.style.background = ln({ s: 100, v: 100, h: e.h }).toHex(), a.color().parse({ s: e.s, v: e.v, h: e.h }) } function e(e) { var t; t = u(o, e), n.s = 100 * t.x, n.v = 100 * (1 - t.y), c(n), a.fire("change") } function t(e) { var t; t = u(i, e), (n = l.toHsv()).h = 360 * (1 - t.y), c(n, !0), a.fire("change") } i = a.getEl("h"), r = a.getEl("hp"), o = a.getEl("sv"), s = a.getEl("svp"), a._repaint = function () { c(n = l.toHsv()) }, a._super(), a._svdraghelper = new mt(a._id + "-sv", { start: e, drag: e }), a._hdraghelper = new mt(a._id + "-h", { start: t, drag: t }), a._repaint() }, rgb: function () { return this.color().toRgb() }, value: function (e) { if (!arguments.length) return this.color().toHex(); this.color().parse(e), this._rendered && this._repaint() }, color: function () { return this._color || (this._color = ln()), this._color }, renderHtml: function () { var e, t = this._id, o = this.classPrefix, s = "#ff0000,#ff0080,#ff00ff,#8000ff,#0000ff,#0080ff,#00ffff,#00ff80,#00ff00,#80ff00,#ffff00,#ff8000,#ff0000"; return e = '<div id="' + t + '-h" class="' + o + 'colorpicker-h" style="background: -ms-linear-gradient(top,' + s + ");background: linear-gradient(to bottom," + s + ');">' + function () { var e, t, n, i, r = ""; for (n = "filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr=", e = 0, t = (i = s.split(",")).length - 1; e < t; e++)r += '<div class="' + o + 'colorpicker-h-chunk" style="height:' + 100 / t + "%;" + n + i[e] + ",endColorstr=" + i[e + 1] + ");-ms-" + n + i[e] + ",endColorstr=" + i[e + 1] + ')"></div>'; return r }() + '<div id="' + t + '-hp" class="' + o + 'colorpicker-h-marker"></div></div>', '<div id="' + t + '" class="' + this.classes + '"><div id="' + t + '-sv" class="' + o + 'colorpicker-sv"><div class="' + o + 'colorpicker-overlay1"><div class="' + o + 'colorpicker-overlay2"><div id="' + t + '-svp" class="' + o + 'colorpicker-selector1"><div class="' + o + 'colorpicker-selector2"></div></div></div></div></div>' + e + "</div>" } }), cn = Bt.extend({ init: function (e) { e = w.extend({ height: 100, text: "Drop an image here", multiple: !1, accept: null }, e), this._super(e), this.classes.add("dropzone"), e.multiple && this.classes.add("multiple") }, renderHtml: function () { var e, t, n = this.settings; return e = { id: this._id, hidefocus: "1" }, t = ke.create("div", e, "<span>" + this.translate(n.text) + "</span>"), n.height && ke.css(t, "height", n.height + "px"), n.width && ke.css(t, "width", n.width + "px"), t.className = this.classes, t.outerHTML }, postRender: function () { var i = this, e = function (e) { e.preventDefault(), i.classes.toggle("dragenter"), i.getEl().className = i.classes }; i._super(), i.$el.on("dragover", function (e) { e.preventDefault() }), i.$el.on("dragenter", e), i.$el.on("dragleave", e), i.$el.on("drop", function (e) { if (e.preventDefault(), !i.state.get("disabled")) { var t = function (e) { var t = i.settings.accept; if ("string" != typeof t) return e; var n = new RegExp("(" + t.split(/\s*,\s*/).join("|") + ")$", "i"); return w.grep(e, function (e) { return n.test(e.name) }) }(e.dataTransfer.files); i.value = function () { return t.length ? i.settings.multiple ? t : t[0] : null }, t.length && i.fire("change", e) } }) }, remove: function () { this.$el.off(), this._super() } }), dn = Bt.extend({ init: function (e) { var n = this; e.delimiter || (e.delimiter = "\xbb"), n._super(e), n.classes.add("path"), n.canFocus = !0, n.on("click", function (e) { var t; (t = e.target.getAttribute("data-index")) && n.fire("select", { value: n.row()[t], index: t }) }), n.row(n.settings.row) }, focus: function () { return this.getEl().firstChild.focus(), this }, row: function (e) { return arguments.length ? (this.state.set("row", e), this) : this.state.get("row") }, renderHtml: function () { return '<div id="' + this._id + '" class="' + this.classes + '">' + this._getDataPathHtml(this.state.get("row")) + "</div>" }, bindStates: function () { var t = this; return t.state.on("change:row", function (e) { t.innerHtml(t._getDataPathHtml(e.value)) }), t._super() }, _getDataPathHtml: function (e) { var t, n, i = e || [], r = "", o = this.classPrefix; for (t = 0, n = i.length; t < n; t++)r += (0 < t ? '<div class="' + o + 'divider" aria-hidden="true"> ' + this.settings.delimiter + " </div>" : "") + '<div role="button" class="' + o + "path-item" + (t === n - 1 ? " " + o + "last" : "") + '" data-index="' + t + '" tabindex="-1" id="' + this._id + "-" + t + '" aria-level="' + (t + 1) + '">' + i[t].name + "</div>"; return r || (r = '<div class="' + o + 'path-item">\xa0</div>'), r } }), fn = dn.extend({ postRender: function () { var o = this, s = o.settings.editor; function a(e) { if (1 === e.nodeType) { if ("BR" === e.nodeName || e.getAttribute("data-mce-bogus")) return !0; if ("bookmark" === e.getAttribute("data-mce-type")) return !0 } return !1 } return !1 !== s.settings.elementpath && (o.on("select", function (e) { s.focus(), s.selection.select(this.row()[e.index].element), s.nodeChanged() }), s.on("nodeChange", function (e) { for (var t = [], n = e.parents, i = n.length; i--;)if (1 === n[i].nodeType && !a(n[i])) { var r = s.fire("ResolveName", { name: n[i].nodeName.toLowerCase(), target: n[i] }); if (r.isDefaultPrevented() || t.push({ name: r.name, element: n[i] }), r.isPropagationStopped()) break } o.row(t) })), o._super() } }), hn = ft.extend({ Defaults: { layout: "flex", align: "center", defaults: { flex: 1 } }, renderHtml: function () { var e = this, t = e._layout, n = e.classPrefix; return e.classes.add("formitem"), t.preRender(e), '<div id="' + e._id + '" class="' + e.classes + '" hidefocus="1" tabindex="-1">' + (e.settings.title ? '<div id="' + e._id + '-title" class="' + n + 'title">' + e.settings.title + "</div>" : "") + '<div id="' + e._id + '-body" class="' + e.bodyClasses + '">' + (e.settings.html || "") + t.renderHtml(e) + "</div></div>" } }), mn = ft.extend({ Defaults: { containerCls: "form", layout: "flex", direction: "column", align: "stretch", flex: 1, padding: 15, labelGap: 30, spacing: 10, callbacks: { submit: function () { this.submit() } } }, preRender: function () { var i = this, e = i.items(); i.settings.formItemDefaults || (i.settings.formItemDefaults = { layout: "flex", autoResize: "overflow", defaults: { flex: 1 } }), e.each(function (e) { var t, n = e.settings.label; n && ((t = new hn(w.extend({ items: { type: "label", id: e._id + "-l", text: n, flex: 0, forId: e._id, disabled: e.disabled() } }, i.settings.formItemDefaults))).type = "formitem", e.aria("labelledby", e._id + "-l"), "undefined" == typeof e.settings.flex && (e.settings.flex = 1), i.replace(e, t), t.add(e)) }) }, submit: function () { return this.fire("submit", { data: this.toJSON() }) }, postRender: function () { this._super(), this.fromJSON(this.settings.data) }, bindStates: function () { var n = this; function e() { var e, t, i = 0, r = []; if (!1 !== n.settings.labelGapCalc) for (("children" === n.settings.labelGapCalc ? n.find("formitem") : n.items()).filter("formitem").each(function (e) { var t = e.items()[0], n = t.getEl().clientWidth; i = i < n ? n : i, r.push(t) }), t = n.settings.labelGap || 0, e = r.length; e--;)r[e].settings.minWidth = i + t } n._super(), n.on("show", e), e() } }), gn = mn.extend({ Defaults: { containerCls: "fieldset", layout: "flex", direction: "column", align: "stretch", flex: 1, padding: "25 15 5 15", labelGap: 30, spacing: 10, border: 1 }, renderHtml: function () { var e = this, t = e._layout, n = e.classPrefix; return e.preRender(), t.preRender(e), '<fieldset id="' + e._id + '" class="' + e.classes + '" hidefocus="1" tabindex="-1">' + (e.settings.title ? '<legend id="' + e._id + '-title" class="' + n + 'fieldset-title">' + e.settings.title + "</legend>" : "") + '<div id="' + e._id + '-body" class="' + e.bodyClasses + '">' + (e.settings.html || "") + t.renderHtml(e) + "</div></fieldset>" } }), pn = 0, vn = function (e) { var t = (new Date).getTime(); return e + "_" + Math.floor(1e9 * Math.random()) + ++pn + String(t) }, bn = function (e) { if (null === e || e === undefined) throw new Error("Node cannot be null or undefined"); return { dom: k.constant(e) } }, yn = { fromHtml: function (e, t) { var n = (t || document).createElement("div"); if (n.innerHTML = e, !n.hasChildNodes() || 1 < n.childNodes.length) throw console.error("HTML does not have a single root node", e), "HTML must have a single root node"; return bn(n.childNodes[0]) }, fromTag: function (e, t) { var n = (t || document).createElement(e); return bn(n) }, fromText: function (e, t) { var n = (t || document).createTextNode(e); return bn(n) }, fromDom: bn, fromPoint: function (e, t, n) { return P.from(e.dom().elementFromPoint(t, n)).map(bn) } }, xn = function (e) { var t, n = !1; return function () { return n || (n = !0, t = e.apply(null, arguments)), t } }, wn = 9, _n = 1, Rn = 3, Cn = function (e) { return e.dom().nodeType }, kn = function (t) { return function (e) { return Cn(e) === t } }, En = (kn(_n), kn(Rn), kn(wn), xn(function () { return En(yn.fromDom(document)) }), function (e) { var t = e.dom().body; if (null === t || t === undefined) throw "Body is not available yet"; return yn.fromDom(t) }), Hn = (Yt = Object.keys) === undefined ? function (e) { var t = []; for (var n in e) e.hasOwnProperty(n) && t.push(n); return t } : Yt, Sn = function (e, t) { for (var n = Hn(e), i = 0, r = n.length; i < r; i++) { var o = n[i]; t(e[o], o, e) } }, Mn = function (i, r) { var o = {}; return Sn(i, function (e, t) { var n = r(e, t, i); o[n.k] = n.v }), o }, Tn = function (e, n) { var i = []; return Sn(e, function (e, t) { i.push(n(e, t)) }), i }, Pn = function (e) { return Tn(e, function (e) { return e }) }, Wn = { bifilter: function (e, n) { var i = {}, r = {}; return Sn(e, function (e, t) { (n(e, t) ? i : r)[t] = e }), { t: i, f: r } }, each: Sn, map: function (e, i) { return Mn(e, function (e, t, n) { return { k: t, v: i(e, t, n) } }) }, mapToArray: Tn, tupleMap: Mn, find: function (e, t) { for (var n = Hn(e), i = 0, r = n.length; i < r; i++) { var o = n[i], s = e[o]; if (t(s, o, e)) return P.some(s) } return P.none() }, keys: Hn, values: Pn, size: function (e) { return Pn(e).length } }, Dn = function (e) { return e.slice(0).sort() }, Nn = { sort: Dn, reqMessage: function (e, t) { throw new Error("All required keys (" + Dn(e).join(", ") + ") were not specified. Specified keys were: " + Dn(t).join(", ") + ".") }, unsuppMessage: function (e) { throw new Error("Unsupported keys for object: " + Dn(e).join(", ")) }, validateStrArr: function (t, e) { if (!V.isArray(e)) throw new Error("The " + t + " fields must be an array. Was: " + e + "."); ie.each(e, function (e) { if (!V.isString(e)) throw new Error("The value " + e + " in the " + t + " fields was not a string.") }) }, invalidTypeMessage: function (e, t) { throw new Error("All values need to be of type: " + t + ". Keys (" + Dn(e).join(", ") + ") were not.") }, checkDupes: function (e) { var n = Dn(e); ie.find(n, function (e, t) { return t < n.length - 1 && e === n[t + 1] }).each(function (e) { throw new Error("The field: " + e + " occurs more than once in the combined fields: [" + n.join(", ") + "].") }) } }, An = { immutable: function () { for (var t = [], e = 0; e < arguments.length; e++)t[e] = arguments[e]; return function () { for (var n = [], e = 0; e < arguments.length; e++)n[e] = arguments[e]; if (t.length !== n.length) throw new Error('Wrong number of arguments to struct. Expected "[' + t.length + ']", got ' + n.length + " arguments"); var i = {}; return ie.each(t, function (e, t) { i[e] = k.constant(n[t]) }), i } }, immutableBag: function (r, o) { var s = r.concat(o); if (0 === s.length) throw new Error("You must specify at least one required or optional field."); return Nn.validateStrArr("required", r), Nn.validateStrArr("optional", o), Nn.checkDupes(s), function (t) { var n = Wn.keys(t); ie.forall(r, function (e) { return ie.contains(n, e) }) || Nn.reqMessage(r, n); var e = ie.filter(n, function (e) { return !ie.contains(s, e) }); 0 < e.length && Nn.unsuppMessage(e); var i = {}; return ie.each(r, function (e) { i[e] = k.constant(t[e]) }), ie.each(o, function (e) { i[e] = k.constant(Object.prototype.hasOwnProperty.call(t, e) ? P.some(t[e]) : P.none()) }), i } } }, Bn = ("undefined" != typeof window ? window : Function("return this;")(), function (e, t) { var n = function (e, t) { for (var n = 0; n < e.length; n++) { var i = e[n]; if (i.test(t)) return i } return undefined }(e, t); if (!n) return { major: 0, minor: 0 }; var i = function (e) { return Number(t.replace(n, "$" + e)) }; return zn(i(1), i(2)) }), On = function () { return zn(0, 0) }, zn = function (e, t) { return { major: e, minor: t } }, Ln = { nu: zn, detect: function (e, t) { var n = String(t).toLowerCase(); return 0 === e.length ? On() : Bn(e, n) }, unknown: On }, In = "Firefox", Fn = function (e, t) { return function () { return t === e } }, Un = function (e) { var t = e.current; return { current: t, version: e.version, isEdge: Fn("Edge", t), isChrome: Fn("Chrome", t), isIE: Fn("IE", t), isOpera: Fn("Opera", t), isFirefox: Fn(In, t), isSafari: Fn("Safari", t) } }, Vn = { unknown: function () { return Un({ current: undefined, version: Ln.unknown() }) }, nu: Un, edge: k.constant("Edge"), chrome: k.constant("Chrome"), ie: k.constant("IE"), opera: k.constant("Opera"), firefox: k.constant(In), safari: k.constant("Safari") }, jn = "Windows", qn = "Android", Yn = "Solaris", $n = "FreeBSD", Xn = function (e, t) { return function () { return t === e } }, Jn = function (e) { var t = e.current; return { current: t, version: e.version, isWindows: Xn(jn, t), isiOS: Xn("iOS", t), isAndroid: Xn(qn, t), isOSX: Xn("OSX", t), isLinux: Xn("Linux", t), isSolaris: Xn(Yn, t), isFreeBSD: Xn($n, t) } }, Gn = { unknown: function () { return Jn({ current: undefined, version: Ln.unknown() }) }, nu: Jn, windows: k.constant(jn), ios: k.constant("iOS"), android: k.constant(qn), linux: k.constant("Linux"), osx: k.constant("OSX"), solaris: k.constant(Yn), freebsd: k.constant($n) }, Kn = function (e, t) { var n = String(t).toLowerCase(); return ie.find(e, function (e) { return e.search(n) }) }, Zn = function (e, n) { return Kn(e, n).map(function (e) { var t = Ln.detect(e.versionRegexes, n); return { current: e.name, version: t } }) }, Qn = function (e, n) { return Kn(e, n).map(function (e) { var t = Ln.detect(e.versionRegexes, n); return { current: e.name, version: t } }) }, ei = function (e, t) { return -1 !== e.indexOf(t) }, ti = /.*?version\/\ ?([0-9]+)\.([0-9]+).*/, ni = function (t) { return function (e) { return ei(e, t) } }, ii = [{ name: "Edge", versionRegexes: [/.*?edge\/ ?([0-9]+)\.([0-9]+)$/], search: function (e) { return ei(e, "edge/") && ei(e, "chrome") && ei(e, "safari") && ei(e, "applewebkit") } }, { name: "Chrome", versionRegexes: [/.*?chrome\/([0-9]+)\.([0-9]+).*/, ti], search: function (e) { return ei(e, "chrome") && !ei(e, "chromeframe") } }, { name: "IE", versionRegexes: [/.*?msie\ ?([0-9]+)\.([0-9]+).*/, /.*?rv:([0-9]+)\.([0-9]+).*/], search: function (e) { return ei(e, "msie") || ei(e, "trident") } }, { name: "Opera", versionRegexes: [ti, /.*?opera\/([0-9]+)\.([0-9]+).*/], search: ni("opera") }, { name: "Firefox", versionRegexes: [/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/], search: ni("firefox") }, { name: "Safari", versionRegexes: [ti, /.*?cpu os ([0-9]+)_([0-9]+).*/], search: function (e) { return (ei(e, "safari") || ei(e, "mobile/")) && ei(e, "applewebkit") } }], ri = [{ name: "Windows", search: ni("win"), versionRegexes: [/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/] }, { name: "iOS", search: function (e) { return ei(e, "iphone") || ei(e, "ipad") }, versionRegexes: [/.*?version\/\ ?([0-9]+)\.([0-9]+).*/, /.*cpu os ([0-9]+)_([0-9]+).*/, /.*cpu iphone os ([0-9]+)_([0-9]+).*/] }, { name: "Android", search: ni("android"), versionRegexes: [/.*?android\ ?([0-9]+)\.([0-9]+).*/] }, { name: "OSX", search: ni("os x"), versionRegexes: [/.*?os\ x\ ?([0-9]+)_([0-9]+).*/] }, { name: "Linux", search: ni("linux"), versionRegexes: [] }, { name: "Solaris", search: ni("sunos"), versionRegexes: [] }, { name: "FreeBSD", search: ni("freebsd"), versionRegexes: [] }], oi = { browsers: k.constant(ii), oses: k.constant(ri) }, si = function (e) { var t, n, i, r, o, s, a, l, u, c, d, f = oi.browsers(), h = oi.oses(), m = Zn(f, e).fold(Vn.unknown, Vn.nu), g = Qn(h, e).fold(Gn.unknown, Gn.nu); return { browser: m, os: g, deviceType: (n = m, i = e, r = (t = g).isiOS() && !0 === /ipad/i.test(i), o = t.isiOS() && !r, s = t.isAndroid() && 3 === t.version.major, a = t.isAndroid() && 4 === t.version.major, l = r || s || a && !0 === /mobile/i.test(i), u = t.isiOS() || t.isAndroid(), c = u && !l, d = n.isSafari() && t.isiOS() && !1 === /safari/i.test(i), { isiPad: k.constant(r), isiPhone: k.constant(o), isTablet: k.constant(l), isPhone: k.constant(c), isTouch: k.constant(u), isAndroid: t.isAndroid, isiOS: t.isiOS, isWebView: k.constant(d) }) } }, ai = xn(function () { var e = navigator.userAgent; return si(e) }), li = _n, ui = wn, ci = function (e) { return e.nodeType !== li && e.nodeType !== ui || 0 === e.childElementCount }, di = { all: function (e, t) { var n = t === undefined ? document : t.dom(); return ci(n) ? [] : ie.map(n.querySelectorAll(e), yn.fromDom) }, is: function (e, t) { var n = e.dom(); if (n.nodeType !== li) return !1; if (n.matches !== undefined) return n.matches(t); if (n.msMatchesSelector !== undefined) return n.msMatchesSelector(t); if (n.webkitMatchesSelector !== undefined) return n.webkitMatchesSelector(t); if (n.mozMatchesSelector !== undefined) return n.mozMatchesSelector(t); throw new Error("Browser lacks native selectors") }, one: function (e, t) { var n = t === undefined ? document : t.dom(); return ci(n) ? P.none() : P.from(n.querySelector(e)).map(yn.fromDom) } }, fi = (ai().browser.isIE(), An.immutable("element", "offset"), function (e, t) { return di.all(t, e) }), hi = w.trim, mi = function (t) { return function (e) { if (e && 1 === e.nodeType) { if (e.contentEditable === t) return !0; if (e.getAttribute("data-mce-contenteditable") === t) return !0 } return !1 } }, gi = mi("true"), pi = mi("false"), vi = function (e, t, n, i, r) { return { type: e, title: t, url: n, level: i, attach: r } }, bi = function (e) { return e.innerText || e.textContent }, yi = function (e) { return (t = e) && "A" === t.nodeName && (t.id || t.name) && wi(e); var t }, xi = function (e) { return e && /^(H[1-6])$/.test(e.nodeName) }, wi = function (e) { return function (e) { for (; e = e.parentNode;) { var t = e.contentEditable; if (t && "inherit" !== t) return gi(e) } return !1 }(e) && !pi(e) }, _i = function (e) { return xi(e) && wi(e) }, Ri = function (e) { var t, n, i = (t = e).id ? t.id : vn("h"); return vi("header", bi(e), "#" + i, xi(n = e) ? parseInt(n.nodeName.substr(1), 10) : 0, function () { e.id = i }) }, Ci = function (e) { var t = e.id || e.name, n = bi(e); return vi("anchor", n || "#" + t, "#" + t, 0, k.noop) }, ki = function (e) { var t, n; return t = "h1,h2,h3,h4,h5,h6,a:not([href])", n = e, ie.map(fi(yn.fromDom(n), t), function (e) { return e.dom() }) }, Ei = function (e) { return 0 < hi(e.title).length }, Hi = function (e) { var t, n, i = ki(e); return ie.filter((n = i, ie.map(ie.filter(n, _i), Ri)).concat((t = i, ie.map(ie.filter(t, yi), Ci))), Ei) }, Si = {}, Mi = function (e) { return { title: e.title, value: { title: { raw: e.title }, url: e.url, attach: e.attach } } }, Ti = function (e, t) { return { title: e, value: { title: e, url: t, attach: k.noop } } }, Pi = function (e, t, n) { var i = t in e ? e[t] : n; return !1 === i ? null : i }, Wi = function (e, i, r, t) { var n, o, s, a, l = { title: "-" }, u = function (e) { var t = e.hasOwnProperty(r) ? e[r] : [], n = ie.filter(t, function (e) { return t = e, n = i, !ie.exists(n, function (e) { return e.url === t }); var t, n }); return w.map(n, function (e) { return { title: e, value: { title: e, url: e, attach: k.noop } } }) }, c = function (t) { var e, n = ie.filter(i, function (e) { return e.type === t }); return e = n, w.map(e, Mi) }; return !1 === t.typeahead_urls ? [] : "file" === r ? (n = [Di(e, u(Si)), Di(e, c("header")), Di(e, (o = c("anchor"), s = Pi(t, "anchor_top", "#top"), a = Pi(t, "anchor_bottom", "#bottom"), null !== s && o.unshift(Ti("<top>", s)), null !== a && o.push(Ti("<bottom>", a)), o))], ie.foldl(n, function (e, t) { return 0 === e.length || 0 === t.length ? e.concat(t) : e.concat(l, t) }, [])) : Di(e, u(Si)) }, Di = function (e, t) { var n = e.toLowerCase(), i = w.grep(t, function (e) { return -1 !== e.title.toLowerCase().indexOf(n) }); return 1 === i.length && i[0].title === e ? [] : i }, Ni = function (r, i, o, s) { var t = function (e) { var t = Hi(o), n = Wi(e, t, s, i); r.showAutoComplete(n, e) }; r.on("autocomplete", function () { t(r.value()) }), r.on("selectitem", function (e) { var t = e.value; r.value(t.url); var n, i = (n = t.title).raw ? n.raw : n; "image" === s ? r.fire("change", { meta: { alt: i, attach: t.attach } }) : r.fire("change", { meta: { text: i, attach: t.attach } }), r.focus() }), r.on("click", function (e) { 0 === r.value().length && "INPUT" === e.target.nodeName && t("") }), r.on("PostRender", function () { r.getRoot().on("submit", function (e) { var t, n, i; e.isDefaultPrevented() || (t = r.value(), i = Si[n = s], /^https?/.test(t) && (i ? ie.indexOf(i, t).isNone() && (Si[n] = i.slice(0, 5).concat(t)) : Si[n] = [t])) }) }) }, Ai = function (o, e, n) { var i = e.filepicker_validator_handler; i && o.state.on("change:value", function (e) { var t; 0 !== (t = e.value).length ? i({ url: t, type: n }, function (e) { var t, n, i, r = (n = (t = e).status, i = t.message, "valid" === n ? { status: "ok", message: i } : "unknown" === n ? { status: "warn", message: i } : "invalid" === n ? { status: "warn", message: i } : { status: "none", message: "" }); o.statusMessage(r.message), o.statusLevel(r.status) }) : o.statusLevel("none") }) }, Bi = nn.extend({ Statics: { clearHistory: function () { Si = {} } }, init: function (e) { var t, n, i, r = this, o = window.tinymce ? window.tinymce.activeEditor : l.activeEditor, s = o.settings, a = e.filetype; e.spellcheck = !1, (i = s.file_picker_types || s.file_browser_callback_types) && (i = w.makeMap(i, /[, ]/)), i && !i[a] || (!(n = s.file_picker_callback) || i && !i[a] ? !(n = s.file_browser_callback) || i && !i[a] || (t = function () { n(r.getEl("inp").id, r.value(), a, window) }) : t = function () { var e = r.fire("beforecall").meta; e = w.extend({ filetype: a }, e), n.call(o, function (e, t) { r.value(e).fire("change", { meta: t }) }, r.value(), e) }), t && (e.icon = "browse", e.onaction = t), r._super(e), r.classes.add("filepicker"), Ni(r, s, o.getBody(), a), Ai(r, s, a) } }), Oi = Gt.extend({ recalc: function (e) { var t = e.layoutRect(), n = e.paddingBox; e.items().filter(":visible").each(function (e) { e.layoutRect({ x: n.left, y: n.top, w: t.innerW - n.right - n.left, h: t.innerH - n.top - n.bottom }), e.recalc && e.recalc() }) } }), zi = Gt.extend({ recalc: function (e) { var t, n, i, r, o, s, a, l, u, c, d, f, h, m, g, p, v, b, y, x, w, _, R, C, k, E, H, S, M, T, P, W, D, N, A, B, O, z = [], L = Math.max, I = Math.min; for (i = e.items().filter(":visible"), r = e.layoutRect(), o = e.paddingBox, s = e.settings, f = e.isRtl() ? s.direction || "row-reversed" : s.direction, a = s.align, l = e.isRtl() ? s.pack || "end" : s.pack, u = s.spacing || 0, "row-reversed" !== f && "column-reverse" !== f || (i = i.set(i.toArray().reverse()), f = f.split("-")[0]), "column" === f ? (C = "y", _ = "h", R = "minH", k = "maxH", H = "innerH", E = "top", S = "deltaH", M = "contentH", N = "left", W = "w", T = "x", P = "innerW", D = "minW", A = "right", B = "deltaW", O = "contentW") : (C = "x", _ = "w", R = "minW", k = "maxW", H = "innerW", E = "left", S = "deltaW", M = "contentW", N = "top", W = "h", T = "y", P = "innerH", D = "minH", A = "bottom", B = "deltaH", O = "contentH"), d = r[H] - o[E] - o[E], w = c = 0, t = 0, n = i.length; t < n; t++)m = (h = i[t]).layoutRect(), d -= t < n - 1 ? u : 0, 0 < (g = h.settings.flex) && (c += g, m[k] && z.push(h), m.flex = g), d -= m[R], w < (p = o[N] + m[D] + o[A]) && (w = p); if ((y = {})[R] = d < 0 ? r[R] - d + r[S] : r[H] - d + r[S], y[D] = w + r[B], y[M] = r[H] - d, y[O] = w, y.minW = I(y.minW, r.maxW), y.minH = I(y.minH, r.maxH), y.minW = L(y.minW, r.startMinWidth), y.minH = L(y.minH, r.startMinHeight), !r.autoResize || y.minW === r.minW && y.minH === r.minH) { for (b = d / c, t = 0, n = z.length; t < n; t++)(v = (m = (h = z[t]).layoutRect())[k]) < (p = m[R] + m.flex * b) ? (d -= m[k] - m[R], c -= m.flex, m.flex = 0, m.maxFlexSize = v) : m.maxFlexSize = 0; for (b = d / c, x = o[E], y = {}, 0 === c && ("end" === l ? x = d + o[E] : "center" === l ? (x = Math.round(r[H] / 2 - (r[H] - d) / 2) + o[E]) < 0 && (x = o[E]) : "justify" === l && (x = o[E], u = Math.floor(d / (i.length - 1)))), y[T] = o[N], t = 0, n = i.length; t < n; t++)p = (m = (h = i[t]).layoutRect()).maxFlexSize || m[R], "center" === a ? y[T] = Math.round(r[P] / 2 - m[W] / 2) : "stretch" === a ? (y[W] = L(m[D] || 0, r[P] - o[N] - o[A]), y[T] = o[N]) : "end" === a && (y[T] = r[P] - m[W] - o.top), 0 < m.flex && (p += m.flex * b), y[_] = p, y[C] = x, h.layoutRect(y), h.recalc && h.recalc(), x += p + u } else if (y.w = y.minW, y.h = y.minH, e.layoutRect(y), this.recalc(e), null === e._lastRect) { var F = e.parent(); F && (F._lastRect = null, F.recalc()) } } }), Li = Jt.extend({ Defaults: { containerClass: "flow-layout", controlClass: "flow-layout-item", endClass: "break" }, recalc: function (e) { e.items().filter(":visible").each(function (e) { e.recalc && e.recalc() }) }, isNative: function () { return !0 } }), Ii = function (e, t) { return di.one(t, e) }, Fi = function (e, t) { return function () { e.execCommand("mceToggleFormat", !1, t) } }, Ui = function (e, n) { return function () { var t = this; e.formatter ? e.formatter.formatChanged(n, function (e) { t.active(e) }) : e.on("init", function () { e.formatter.formatChanged(n, function (e) { t.active(e) }) }) } }, Vi = function (n) { n.addMenuItem("align", { text: "Align", menu: [{ text: "Left", icon: "alignleft", onclick: Fi(n, "alignleft") }, { text: "Center", icon: "aligncenter", onclick: Fi(n, "aligncenter") }, { text: "Right", icon: "alignright", onclick: Fi(n, "alignright") }, { text: "Justify", icon: "alignjustify", onclick: Fi(n, "alignjustify") }] }), w.each({ alignleft: ["Align left", "JustifyLeft"], aligncenter: ["Align center", "JustifyCenter"], alignright: ["Align right", "JustifyRight"], alignjustify: ["Justify", "JustifyFull"], alignnone: ["No alignment", "JustifyNone"] }, function (e, t) { n.addButton(t, { active: !1, tooltip: e[0], cmd: e[1], onPostRender: Ui(n, t) }) }) }, ji = function (e) { return e ? e.split(",")[0] : "" }, qi = function (a, l) { return function () { var s = this; a.on("init nodeChange", function (e) { var t, n, i, r = a.queryCommandValue("FontName"), o = (t = l, n = r, w.each(t, function (e) { e.value.toLowerCase() === n.toLowerCase() && (i = e.value) }), w.each(t, function (e) { i || ji(e.value).toLowerCase() !== ji(n).toLowerCase() || (i = e.value) }), i); s.value(o || null), !o && r && s.text(ji(r)) }) } }, Yi = function (n) { n.addButton("fontselect", function () { var e, t = (e = function (e) { for (var t = (e = e.replace(/;$/, "").split(";")).length; t--;)e[t] = e[t].split("="); return e }(n.settings.font_formats || "Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats"), w.map(e, function (e) { return { text: { raw: e[0] }, value: e[1], textStyle: -1 === e[1].indexOf("dings") ? "font-family:" + e[1] : "" } })); return { type: "listbox", text: "Font Family", tooltip: "Font Family", values: t, fixedWidth: !0, onPostRender: qi(n, t), onselect: function (e) { e.control.settings.value && n.execCommand("FontName", !1, e.control.settings.value) } } }) }, $i = function (e) { Yi(e) }, Xi = function (e, t) { return /[0-9.]+px$/.test(e) ? (n = 72 * parseInt(e, 10) / 96, i = t || 0, r = Math.pow(10, i), Math.round(n * r) / r + "pt") : e; var n, i, r }, Ji = function (e, t, n) { var i; return w.each(e, function (e) { e.value === n ? i = n : e.value === t && (i = t) }), i }, Gi = function (n) { n.addButton("fontsizeselect", function () { var e, s, a, t = (e = n.settings.fontsize_formats || "8pt 10pt 12pt 14pt 18pt 24pt 36pt", w.map(e.split(" "), function (e) { var t = e, n = e, i = e.split("="); return 1 < i.length && (t = i[0], n = i[1]), { text: t, value: n } })); return { type: "listbox", text: "Font Sizes", tooltip: "Font Sizes", values: t, fixedWidth: !0, onPostRender: (s = n, a = t, function () { var o = this; s.on("init nodeChange", function (e) { var t, n, i, r; if (t = s.queryCommandValue("FontSize")) for (i = 3; !r && 0 <= i; i--)n = Xi(t, i), r = Ji(a, n, t); o.value(r || null), r || o.text(n) }) }), onclick: function (e) { e.control.settings.value && n.execCommand("FontSize", !1, e.control.settings.value) } } }) }, Ki = function (e) { Gi(e) }, Zi = function (n, e) { var i = e.length; return w.each(e, function (e) { e.menu && (e.hidden = 0 === Zi(n, e.menu)); var t = e.format; t && (e.hidden = !n.formatter.canApply(t)), e.hidden && i-- }), i }, Qi = function (n, e) { var i = e.items().length; return e.items().each(function (e) { e.menu && e.visible(0 < Qi(n, e.menu)), !e.menu && e.settings.menu && e.visible(0 < Zi(n, e.settings.menu)); var t = e.settings.format; t && e.visible(n.formatter.canApply(t)), e.visible() || i-- }), i }, er = function (e) { var i, r, o, t, s, n, a, l, u = (r = 0, o = [], t = [{ title: "Headings", items: [{ title: "Heading 1", format: "h1" }, { title: "Heading 2", format: "h2" }, { title: "Heading 3", format: "h3" }, { title: "Heading 4", format: "h4" }, { title: "Heading 5", format: "h5" }, { title: "Heading 6", format: "h6" }] }, { title: "Inline", items: [{ title: "Bold", icon: "bold", format: "bold" }, { title: "Italic", icon: "italic", format: "italic" }, { title: "Underline", icon: "underline", format: "underline" }, { title: "Strikethrough", icon: "strikethrough", format: "strikethrough" }, { title: "Superscript", icon: "superscript", format: "superscript" }, { title: "Subscript", icon: "subscript", format: "subscript" }, { title: "Code", icon: "code", format: "code" }] }, { title: "Blocks", items: [{ title: "Paragraph", format: "p" }, { title: "Blockquote", format: "blockquote" }, { title: "Div", format: "div" }, { title: "Pre", format: "pre" }] }, { title: "Alignment", items: [{ title: "Left", icon: "alignleft", format: "alignleft" }, { title: "Center", icon: "aligncenter", format: "aligncenter" }, { title: "Right", icon: "alignright", format: "alignright" }, { title: "Justify", icon: "alignjustify", format: "alignjustify" }] }], s = function (e) { var i = []; if (e) return w.each(e, function (e) { var t = { text: e.title, icon: e.icon }; if (e.items) t.menu = s(e.items); else { var n = e.format || "custom" + r++; e.format || (e.name = n, o.push(e)), t.format = n, t.cmd = e.cmd } i.push(t) }), i }, (i = e).on("init", function () { w.each(o, function (e) { i.formatter.register(e.name, e) }) }), { type: "menu", items: i.settings.style_formats_merge ? i.settings.style_formats ? s(t.concat(i.settings.style_formats)) : s(t) : s(i.settings.style_formats || t), onPostRender: function (e) { i.fire("renderFormatsMenu", { control: e.control }) }, itemDefaults: { preview: !0, textStyle: function () { if (this.settings.format) return i.formatter.getCssText(this.settings.format) }, onPostRender: function () { var n = this; n.parent().on("show", function () { var e, t; (e = n.settings.format) && (n.disabled(!i.formatter.canApply(e)), n.active(i.formatter.match(e))), (t = n.settings.cmd) && n.active(i.queryCommandState(t)) }) }, onclick: function () { this.settings.format && Fi(i, this.settings.format)(), this.settings.cmd && i.execCommand(this.settings.cmd) } } }); n = u, e.addMenuItem("formats", { text: "Formats", menu: n }), l = u, (a = e).addButton("styleselect", { type: "menubutton", text: "Formats", menu: l, onShowMenu: function () { a.settings.style_formats_autohide && Qi(a, this.menu) } }) }, tr = function (n, e) { return function () { var r, o, s, t = []; return w.each(e, function (e) { t.push({ text: e[0], value: e[1], textStyle: function () { return n.formatter.getCssText(e[1]) } }) }), { type: "listbox", text: e[0][0], values: t, fixedWidth: !0, onselect: function (e) { if (e.control) { var t = e.control.value(); Fi(n, t)() } }, onPostRender: (r = n, o = t, function () { var t = this; r.on("nodeChange", function (e) { var n = r.formatter, i = null; w.each(e.parents, function (t) { if (w.each(o, function (e) { if (s ? n.matchNode(t, s, { value: e.value }) && (i = e.value) : n.matchNode(t, e.value) && (i = e.value), i) return !1 }), i) return !1 }), t.value(i) }) }) } } }, nr = function (e) { var t, n, i = function (e) { for (var t = (e = e.replace(/;$/, "").split(";")).length; t--;)e[t] = e[t].split("="); return e }(e.settings.block_formats || "Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre"); e.addMenuItem("blockformats", { text: "Blocks", menu: (t = e, n = i, w.map(n, function (e) { return { text: e[0], onclick: Fi(t, e[1]), textStyle: function () { return t.formatter.getCssText(e[1]) } } })) }), e.addButton("formatselect", tr(e, i)) }, ir = function (t, e) { var n, i; if ("string" == typeof e) i = e.split(" "); else if (w.isArray(e)) return ie.flatten(w.map(e, function (e) { return ir(t, e) })); return n = w.grep(i, function (e) { return "|" === e || e in t.menuItems }), w.map(n, function (e) { return "|" === e ? { text: "-" } : t.menuItems[e] }) }, rr = function (e) { return e && "-" === e.text }, or = function (e) { var t = ie.filter(e, function (e, t, n) { return !rr(e) || !rr(n[t - 1]) }); return ie.filter(t, function (e, t, n) { return !rr(e) || 0 < t && t < n.length - 1 }) }, sr = function (e) { var t, n, i, r, o = e.settings.insert_button_items; return or(o ? ir(e, o) : (t = e, n = "insert", i = [{ text: "-" }], r = w.grep(t.menuItems, function (e) { return e.context === n }), w.each(r, function (e) { "before" === e.separator && i.push({ text: "|" }), e.prependToContext ? i.unshift(e) : i.push(e), "after" === e.separator && i.push({ text: "|" }) }), i)) }, ar = function (e) { var t; (t = e).addButton("insert", { type: "menubutton", icon: "insert", menu: [], oncreatemenu: function () { this.menu.add(sr(t)), this.menu.renderNew() } }) }, lr = function (e) { var n, i, r; n = e, w.each({ bold: "Bold", italic: "Italic", underline: "Underline", strikethrough: "Strikethrough", subscript: "Subscript", superscript: "Superscript" }, function (e, t) { n.addButton(t, { active: !1, tooltip: e, onPostRender: Ui(n, t), onclick: Fi(n, t) }) }), i = e, w.each({ outdent: ["Decrease indent", "Outdent"], indent: ["Increase indent", "Indent"], cut: ["Cut", "Cut"], copy: ["Copy", "Copy"], paste: ["Paste", "Paste"], help: ["Help", "mceHelp"], selectall: ["Select all", "SelectAll"], visualaid: ["Visual aids", "mceToggleVisualAid"], newdocument: ["New document", "mceNewDocument"], removeformat: ["Clear formatting", "RemoveFormat"], remove: ["Remove", "Delete"] }, function (e, t) { i.addButton(t, { tooltip: e[0], cmd: e[1] }) }), r = e, w.each({ blockquote: ["Blockquote", "mceBlockQuote"], subscript: ["Subscript", "Subscript"], superscript: ["Superscript", "Superscript"] }, function (e, t) { r.addButton(t, { active: !1, tooltip: e[0], cmd: e[1], onPostRender: Ui(r, t) }) }) }, ur = function (e) { var n; lr(e), n = e, w.each({ bold: ["Bold", "Bold", "Meta+B"], italic: ["Italic", "Italic", "Meta+I"], underline: ["Underline", "Underline", "Meta+U"], strikethrough: ["Strikethrough", "Strikethrough"], subscript: ["Subscript", "Subscript"], superscript: ["Superscript", "Superscript"], removeformat: ["Clear formatting", "RemoveFormat"], newdocument: ["New document", "mceNewDocument"], cut: ["Cut", "Cut", "Meta+X"], copy: ["Copy", "Copy", "Meta+C"], paste: ["Paste", "Paste", "Meta+V"], selectall: ["Select all", "SelectAll", "Meta+A"] }, function (e, t) { n.addMenuItem(t, { text: e[0], icon: t, shortcut: e[2], cmd: e[1] }) }), n.addMenuItem("codeformat", { text: "Code", icon: "code", onclick: Fi(n, "code") }) }, cr = function (n, i) { return function () { var e = this, t = function () { var e = "redo" === i ? "hasRedo" : "hasUndo"; return !!n.undoManager && n.undoManager[e]() }; e.disabled(!t()), n.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode", function () { e.disabled(n.readonly || !t()) }) } }, dr = function (e) { var t, n; (t = e).addMenuItem("undo", { text: "Undo", icon: "undo", shortcut: "Meta+Z", onPostRender: cr(t, "undo"), cmd: "undo" }), t.addMenuItem("redo", { text: "Redo", icon: "redo", shortcut: "Meta+Y", onPostRender: cr(t, "redo"), cmd: "redo" }), (n = e).addButton("undo", { tooltip: "Undo", onPostRender: cr(n, "undo"), cmd: "undo" }), n.addButton("redo", { tooltip: "Redo", onPostRender: cr(n, "redo"), cmd: "redo" }) }, fr = function (e) { var t, n; (t = e).addMenuItem("visualaid", { text: "Visual aids", selectable: !0, onPostRender: (n = t, function () { var t = this; n.on("VisualAid", function (e) { t.active(e.hasVisual) }), t.active(n.hasVisual) }), cmd: "mceToggleVisualAid" }) }, hr = { setup: function (e) { var t; e.rtl && (lt.rtl = !0), e.on("mousedown", function () { St.hideAll() }), (t = e).settings.ui_container && (me.container = Ii(yn.fromDom(document.body), t.settings.ui_container).fold(k.constant(null), function (e) { return e.dom() })), Bt.tooltips = !me.iOS, lt.translate = function (e) { return l.translate(e) }, nr(e), Vi(e), ur(e), dr(e), Ki(e), $i(e), er(e), fr(e), ar(e) } }, mr = Gt.extend({ recalc: function (e) { var t, n, i, r, o, s, a, l, u, c, d, f, h, m, g, p, v, b, y, x, w, _, R, C, k, E, H, S, M = [], T = []; t = e.settings, r = e.items().filter(":visible"), o = e.layoutRect(), i = t.columns || Math.ceil(Math.sqrt(r.length)), n = Math.ceil(r.length / i), b = t.spacingH || t.spacing || 0, y = t.spacingV || t.spacing || 0, x = t.alignH || t.align, w = t.alignV || t.align, p = e.paddingBox, S = "reverseRows" in t ? t.reverseRows : e.isRtl(), x && "string" == typeof x && (x = [x]), w && "string" == typeof w && (w = [w]); for (d = 0; d < i; d++)M.push(0); for (f = 0; f < n; f++)T.push(0); for (f = 0; f < n; f++)for (d = 0; d < i && (c = r[f * i + d]); d++)C = (u = c.layoutRect()).minW, k = u.minH, M[d] = C > M[d] ? C : M[d], T[f] = k > T[f] ? k : T[f]; for (E = o.innerW - p.left - p.right, d = _ = 0; d < i; d++)_ += M[d] + (0 < d ? b : 0), E -= (0 < d ? b : 0) + M[d]; for (H = o.innerH - p.top - p.bottom, f = R = 0; f < n; f++)R += T[f] + (0 < f ? y : 0), H -= (0 < f ? y : 0) + T[f]; if (_ += p.left + p.right, R += p.top + p.bottom, (l = {}).minW = _ + (o.w - o.innerW), l.minH = R + (o.h - o.innerH), l.contentW = l.minW - o.deltaW, l.contentH = l.minH - o.deltaH, l.minW = Math.min(l.minW, o.maxW), l.minH = Math.min(l.minH, o.maxH), l.minW = Math.max(l.minW, o.startMinWidth), l.minH = Math.max(l.minH, o.startMinHeight), !o.autoResize || l.minW === o.minW && l.minH === o.minH) { var P; o.autoResize && ((l = e.layoutRect(l)).contentW = l.minW - o.deltaW, l.contentH = l.minH - o.deltaH), P = "start" === t.packV ? 0 : 0 < H ? Math.floor(H / n) : 0; var W = 0, D = t.flexWidths; if (D) for (d = 0; d < D.length; d++)W += D[d]; else W = i; var N = E / W; for (d = 0; d < i; d++)M[d] += D ? D[d] * N : N; for (m = p.top, f = 0; f < n; f++) { for (h = p.left, a = T[f] + P, d = 0; d < i && (c = r[S ? f * i + i - 1 - d : f * i + d]); d++)g = c.settings, u = c.layoutRect(), s = Math.max(M[d], u.startMinWidth), u.x = h, u.y = m, "center" === (v = g.alignH || (x ? x[d] || x[0] : null)) ? u.x = h + s / 2 - u.w / 2 : "right" === v ? u.x = h + s - u.w : "stretch" === v && (u.w = s), "center" === (v = g.alignV || (w ? w[d] || w[0] : null)) ? u.y = m + a / 2 - u.h / 2 : "bottom" === v ? u.y = m + a - u.h : "stretch" === v && (u.h = a), c.layoutRect(u), h += s + b, c.recalc && c.recalc(); m += a + y } } else if (l.w = l.minW, l.h = l.minH, e.layoutRect(l), this.recalc(e), null === e._lastRect) { var A = e.parent(); A && (A._lastRect = null, A.recalc()) } } }), gr = Bt.extend({ renderHtml: function () { var e = this; return e.classes.add("iframe"), e.canFocus = !1, '<iframe id="' + e._id + '" class="' + e.classes + '" tabindex="-1" src="' + (e.settings.url || "javascript:''") + '" frameborder="0"></iframe>' }, src: function (e) { this.getEl().src = e }, html: function (e, t) { var n = this, i = this.getEl().contentWindow.document.body; return i ? (i.innerHTML = e, t && t()) : u.setTimeout(function () { n.html(e) }), this } }), pr = Bt.extend({ init: function (e) { this._super(e), this.classes.add("widget").add("infobox"), this.canFocus = !1 }, severity: function (e) { this.classes.remove("error"), this.classes.remove("warning"), this.classes.remove("success"), this.classes.add(e) }, help: function (e) { this.state.set("help", e) }, renderHtml: function () { var e = this, t = e.classPrefix; return '<div id="' + e._id + '" class="' + e.classes + '"><div id="' + e._id + '-body">' + e.encode(e.state.get("text")) + '<button role="button" tabindex="-1"><i class="' + t + "ico " + t + 'i-help"></i></button></div></div>' }, bindStates: function () { var t = this; return t.state.on("change:text", function (e) { t.getEl("body").firstChild.data = t.encode(e.value), t.state.get("rendered") && t.updateLayoutRect() }), t.state.on("change:help", function (e) { t.classes.toggle("has-help", e.value), t.state.get("rendered") && t.updateLayoutRect() }), t._super() } }), vr = Bt.extend({ init: function (e) { var t = this; t._super(e), t.classes.add("widget").add("label"), t.canFocus = !1, e.multiline && t.classes.add("autoscroll"), e.strong && t.classes.add("strong") }, initLayoutRect: function () { var e = this, t = e._super(); return e.settings.multiline && (ke.getSize(e.getEl()).width > t.maxW && (t.minW = t.maxW, e.classes.add("multiline")), e.getEl().style.width = t.minW + "px", t.startMinH = t.h = t.minH = Math.min(t.maxH, ke.getSize(e.getEl()).height)), t }, repaint: function () { return this.settings.multiline || (this.getEl().style.lineHeight = this.layoutRect().h + "px"), this._super() }, severity: function (e) { this.classes.remove("error"), this.classes.remove("warning"), this.classes.remove("success"), this.classes.add(e) }, renderHtml: function () { var e, t, n = this, i = n.settings.forId, r = n.settings.html ? n.settings.html : n.encode(n.state.get("text")); return !i && (t = n.settings.forName) && (e = n.getRoot().find("#" + t)[0]) && (i = e._id), i ? '<label id="' + n._id + '" class="' + n.classes + '"' + (i ? ' for="' + i + '"' : "") + ">" + r + "</label>" : '<span id="' + n._id + '" class="' + n.classes + '">' + r + "</span>" }, bindStates: function () { var t = this; return t.state.on("change:text", function (e) { t.innerHtml(t.encode(e.value)), t.state.get("rendered") && t.updateLayoutRect() }), t._super() } }), br = ft.extend({ Defaults: { role: "toolbar", layout: "flow" }, init: function (e) { this._super(e), this.classes.add("toolbar") }, postRender: function () { return this.items().each(function (e) { e.classes.add("toolbar-item") }), this._super() } }), yr = br.extend({ Defaults: { role: "menubar", containerCls: "menubar", ariaRoot: !0, defaults: { type: "menubutton" } } }), xr = Kt.extend({ init: function (e) { var t = this; t._renderOpen = !0, t._super(e), e = t.settings, t.classes.add("menubtn"), e.fixedWidth && t.classes.add("fixed-width"), t.aria("haspopup", !0), t.state.set("menu", e.menu || t.render()) }, showMenu: function (e) { var t, n = this; if (n.menu && n.menu.visible() && !1 !== e) return n.hideMenu(); n.menu || (t = n.state.get("menu") || [], n.classes.add("opened"), t.length ? t = { type: "menu", animate: !0, items: t } : (t.type = t.type || "menu", t.animate = !0), t.renderTo ? n.menu = t.parent(n).show().renderTo() : n.menu = v.create(t).parent(n).renderTo(), n.fire("createmenu"), n.menu.reflow(), n.menu.on("cancel", function (e) { e.control.parent() === n.menu && (e.stopPropagation(), n.focus(), n.hideMenu()) }), n.menu.on("select", function () { n.focus() }), n.menu.on("show hide", function (e) { e.control === n.menu && (n.activeMenu("show" === e.type), n.classes.toggle("opened", "show" === e.type)), n.aria("expanded", "show" === e.type) }).fire("show")), n.menu.show(), n.menu.layoutRect({ w: n.layoutRect().w }), n.menu.repaint(), n.menu.moveRel(n.getEl(), n.isRtl() ? ["br-tr", "tr-br"] : ["bl-tl", "tl-bl"]), n.fire("showmenu") }, hideMenu: function () { this.menu && (this.menu.items().each(function (e) { e.hideMenu && e.hideMenu() }), this.menu.hide()) }, activeMenu: function (e) { this.classes.toggle("active", e) }, renderHtml: function () { var e, t = this, n = t._id, i = t.classPrefix, r = t.settings.icon, o = t.state.get("text"), s = ""; return (e = t.settings.image) ? (r = "none", "string" != typeof e && (e = window.getSelection ? e[0] : e[1]), e = " style=\"background-image: url('" + e + "')\"") : e = "", o && (t.classes.add("btn-has-text"), s = '<span class="' + i + 'txt">' + t.encode(o) + "</span>"), r = t.settings.icon ? i + "ico " + i + "i-" + r : "", t.aria("role", t.parent() instanceof yr ? "menuitem" : "button"), '<div id="' + n + '" class="' + t.classes + '" tabindex="-1" aria-labelledby="' + n + '"><button id="' + n + '-open" role="presentation" type="button" tabindex="-1">' + (r ? '<i class="' + r + '"' + e + "></i>" : "") + s + ' <i class="' + i + 'caret"></i></button></div>' }, postRender: function () { var r = this; return r.on("click", function (e) { e.control === r && function (e, t) { for (; e;) { if (t === e) return !0; e = e.parentNode } return !1 }(e.target, r.getEl()) && (r.focus(), r.showMenu(!e.aria), e.aria && r.menu.items().filter(":visible")[0].focus()) }), r.on("mouseenter", function (e) { var t, n = e.control, i = r.parent(); n && i && n instanceof xr && n.parent() === i && (i.items().filter("MenuButton").each(function (e) { e.hideMenu && e !== n && (e.menu && e.menu.visible() && (t = !0), e.hideMenu()) }), t && (n.focus(), n.showMenu())) }), r._super() }, bindStates: function () { var e = this; return e.state.on("change:menu", function () { e.menu && e.menu.remove(), e.menu = null }), e._super() }, remove: function () { this._super(), this.menu && this.menu.remove() } }), wr = St.extend({ Defaults: { defaultType: "menuitem", border: 1, layout: "stack", role: "application", bodyRole: "menu", ariaRoot: !0 }, init: function (e) { if (e.autohide = !0, e.constrainToViewport = !0, "function" == typeof e.items && (e.itemsFactory = e.items, e.items = []), e.itemDefaults) for (var t = e.items, n = t.length; n--;)t[n] = w.extend({}, e.itemDefaults, t[n]); this._super(e), this.classes.add("menu"), e.animate && 11 !== me.ie && this.classes.add("animate") }, repaint: function () { return this.classes.toggle("menu-align", !0), this._super(), this.getEl().style.height = "", this.getEl("body").style.height = "", this }, cancel: function () { this.hideAll(), this.fire("select") }, load: function () { var t, n = this; function i() { n.throbber && (n.throbber.hide(), n.throbber = null) } n.settings.itemsFactory && (n.throbber || (n.throbber = new Wt(n.getEl("body"), !0), 0 === n.items().length ? (n.throbber.show(), n.fire("loading")) : n.throbber.show(100, function () { n.items().remove(), n.fire("loading") }), n.on("hide close", i)), n.requestTime = t = (new Date).getTime(), n.settings.itemsFactory(function (e) { 0 !== e.length ? n.requestTime === t && (n.getEl().style.width = "", n.getEl("body").style.width = "", i(), n.items().remove(), n.getEl("body").innerHTML = "", n.add(e), n.renderNew(), n.fire("loaded")) : n.hide() })) }, hideAll: function () { return this.find("menuitem").exec("hideMenu"), this._super() }, preRender: function () { var n = this; return n.items().each(function (e) { var t = e.settings; if (t.icon || t.image || t.selectable) return !(n._hasIcons = !0) }), n.settings.itemsFactory && n.on("postrender", function () { n.settings.itemsFactory && n.load() }), n.on("show hide", function (e) { e.control === n && ("show" === e.type ? u.setTimeout(function () { n.classes.add("in") }, 0) : n.classes.remove("in")) }), n._super() } }), _r = xr.extend({ init: function (i) { var t, r, o, n, s = this; s._super(i), i = s.settings, s._values = t = i.values, t && ("undefined" != typeof i.value && function e(t) { for (var n = 0; n < t.length; n++) { if (r = t[n].selected || i.value === t[n].value) return o = o || t[n].text, s.state.set("value", t[n].value), !0; if (t[n].menu && e(t[n].menu)) return !0 } }(t), !r && 0 < t.length && (o = t[0].text, s.state.set("value", t[0].value)), s.state.set("menu", t)), s.state.set("text", i.text || o), s.classes.add("listbox"), s.on("select", function (e) { var t = e.control; n && (e.lastControl = n), i.multiple ? t.active(!t.active()) : s.value(e.control.value()), n = t }) }, value: function (t) { return 0 === arguments.length ? this.state.get("value") : (void 0 === t || (this.settings.values ? 0 < w.grep(this.settings.values, function (e) { return e.value === t }).length ? this.state.set("value", t) : null === t && this.state.set("value", null) : this.state.set("value", t)), this) }, bindStates: function () { var i = this; return i.on("show", function (e) { var t, n; t = e.control, n = i.value(), t instanceof wr && t.items().each(function (e) { e.hasMenus() || e.active(e.value() === n) }) }), i.state.on("change:value", function (t) { var n = function e(t, n) { var i; if (t) for (var r = 0; r < t.length; r++) { if (t[r].value === n) return t[r]; if (t[r].menu && (i = e(t[r].menu, n))) return i } }(i.state.get("menu"), t.value); n ? i.text(n.text) : i.text(i.settings.text) }), i._super() } }), Rr = Bt.extend({ Defaults: { border: 0, role: "menuitem" }, init: function (e) { var t, n = this; n._super(e), e = n.settings, n.classes.add("menu-item"), e.menu && n.classes.add("menu-item-expand"), e.preview && n.classes.add("menu-item-preview"), "-" !== (t = n.state.get("text")) && "|" !== t || (n.classes.add("menu-item-sep"), n.aria("role", "separator"), n.state.set("text", "-")), e.selectable && (n.aria("role", "menuitemcheckbox"), n.classes.add("menu-item-checkbox"), e.icon = "selected"), e.preview || e.selectable || n.classes.add("menu-item-normal"), n.on("mousedown", function (e) { e.preventDefault() }), e.menu && !e.ariaHideMenu && n.aria("haspopup", !0) }, hasMenus: function () { return !!this.settings.menu }, showMenu: function () { var t, n = this, e = n.settings, i = n.parent(); if (i.items().each(function (e) { e !== n && e.hideMenu() }), e.menu) { (t = n.menu) ? t.show() : ((t = e.menu).length ? t = { type: "menu", items: t } : t.type = t.type || "menu", i.settings.itemDefaults && (t.itemDefaults = i.settings.itemDefaults), (t = n.menu = v.create(t).parent(n).renderTo()).reflow(), t.on("cancel", function (e) { e.stopPropagation(), n.focus(), t.hide() }), t.on("show hide", function (e) { e.control.items && e.control.items().each(function (e) { e.active(e.settings.selected) }) }).fire("show"), t.on("hide", function (e) { e.control === t && n.classes.remove("selected") }), t.submenu = !0), t._parentMenu = i, t.classes.add("menu-sub"); var r = t.testMoveRel(n.getEl(), n.isRtl() ? ["tl-tr", "bl-br", "tr-tl", "br-bl"] : ["tr-tl", "br-bl", "tl-tr", "bl-br"]); t.moveRel(n.getEl(), r), r = "menu-sub-" + (t.rel = r), t.classes.remove(t._lastRel).add(r), t._lastRel = r, n.classes.add("selected"), n.aria("expanded", !0) } }, hideMenu: function () { var e = this; return e.menu && (e.menu.items().each(function (e) { e.hideMenu && e.hideMenu() }), e.menu.hide(), e.aria("expanded", !1)), e }, renderHtml: function () { var e, t = this, n = t._id, i = t.settings, r = t.classPrefix, o = t.state.get("text"), s = t.settings.icon, a = "", l = i.shortcut, u = t.encode(i.url); function c(e) { return e.replace(/[.*+?^${}()|[\]\\]/g, "\\$&") } function d(e) { var t = i.match || ""; return t ? e.replace(new RegExp(c(t), "gi"), function (e) { return "!mce~match[" + e + "]mce~match!" }) : e } function f(e) { return e.replace(new RegExp(c("!mce~match["), "g"), "<b>").replace(new RegExp(c("]mce~match!"), "g"), "</b>") } return s && t.parent().classes.add("menu-has-icons"), i.image && (a = " style=\"background-image: url('" + i.image + "')\""), l && (l = function (e) { var t, n, i = {}; for (i = me.mac ? { alt: "&#x2325;", ctrl: "&#x2318;", shift: "&#x21E7;", meta: "&#x2318;" } : { meta: "Ctrl" }, e = e.split("+"), t = 0; t < e.length; t++)(n = i[e[t].toLowerCase()]) && (e[t] = n); return e.join("+") }(l)), s = r + "ico " + r + "i-" + (t.settings.icon || "none"), e = "-" !== o ? '<i class="' + s + '"' + a + "></i>\xa0" : "", o = f(t.encode(d(o))), u = f(t.encode(d(u))), '<div id="' + n + '" class="' + t.classes + '" tabindex="-1">' + e + ("-" !== o ? '<span id="' + n + '-text" class="' + r + 'text">' + o + "</span>" : "") + (l ? '<div id="' + n + '-shortcut" class="' + r + 'menu-shortcut">' + l + "</div>" : "") + (i.menu ? '<div class="' + r + 'caret"></div>' : "") + (u ? '<div class="' + r + 'menu-item-link">' + u + "</div>" : "") + "</div>" }, postRender: function () { var t = this, n = t.settings, e = n.textStyle; if ("function" == typeof e && (e = e.call(this)), e) { var i = t.getEl("text"); i && (i.setAttribute("style", e), t._textStyle = e) } return t.on("mouseenter click", function (e) { e.control === t && (n.menu || "click" !== e.type ? (t.showMenu(), e.aria && t.menu.focus(!0)) : (t.fire("select"), u.requestAnimationFrame(function () { t.parent().hideAll() }))) }), t._super(), t }, hover: function () { return this.parent().items().each(function (e) { e.classes.remove("selected") }), this.classes.toggle("selected", !0), this }, active: function (e) { return function (e, t) { var n = e._textStyle; if (n) { var i = e.getEl("text"); i.setAttribute("style", n), t && (i.style.color = "", i.style.backgroundColor = "") } }(this, e), void 0 !== e && this.aria("checked", e), this._super(e) }, remove: function () { this._super(), this.menu && this.menu.remove() } }), Cr = en.extend({ Defaults: { classes: "radio", role: "radio" } }), kr = Bt.extend({ renderHtml: function () { var e = this, t = e.classPrefix; return e.classes.add("resizehandle"), "both" === e.settings.direction && e.classes.add("resizehandle-both"), e.canFocus = !1, '<div id="' + e._id + '" class="' + e.classes + '"><i class="' + t + "ico " + t + 'i-resize"></i></div>' }, postRender: function () { var t = this; t._super(), t.resizeDragHelper = new mt(this._id, { start: function () { t.fire("ResizeStart") }, drag: function (e) { "both" !== t.settings.direction && (e.deltaX = 0), t.fire("Resize", e) }, stop: function () { t.fire("ResizeEnd") } }) }, remove: function () { return this.resizeDragHelper && this.resizeDragHelper.destroy(), this._super() } }); function Er(e) { var t = ""; if (e) for (var n = 0; n < e.length; n++)t += '<option value="' + e[n] + '">' + e[n] + "</option>"; return t } var Hr = Bt.extend({ Defaults: { classes: "selectbox", role: "selectbox", options: [] }, init: function (e) { var n = this; n._super(e), n.settings.size && (n.size = n.settings.size), n.settings.options && (n._options = n.settings.options), n.on("keydown", function (e) { var t; 13 === e.keyCode && (e.preventDefault(), n.parents().reverse().each(function (e) { if (e.toJSON) return t = e, !1 }), n.fire("submit", { data: t.toJSON() })) }) }, options: function (e) { return arguments.length ? (this.state.set("options", e), this) : this.state.get("options") }, renderHtml: function () { var e, t = this, n = ""; return e = Er(t._options), t.size && (n = ' size = "' + t.size + '"'), '<select id="' + t._id + '" class="' + t.classes + '"' + n + ">" + e + "</select>" }, bindStates: function () { var t = this; return t.state.on("change:options", function (e) { t.getEl().innerHTML = Er(e.value) }), t._super() } }); function Sr(e, t, n) { return e < t && (e = t), n < e && (e = n), e } function Mr(e, t, n) { e.setAttribute("aria-" + t, n) } function Tr(e, t) { var n, i, r, o, s; "v" === e.settings.orientation ? (r = "top", i = "height", n = "h") : (r = "left", i = "width", n = "w"), s = e.getEl("handle"), o = ((e.layoutRect()[n] || 100) - ke.getSize(s)[i]) * ((t - e._minValue) / (e._maxValue - e._minValue)) + "px", s.style[r] = o, s.style.height = e.layoutRect().h + "px", Mr(s, "valuenow", t), Mr(s, "valuetext", "" + e.settings.previewFilter(t)), Mr(s, "valuemin", e._minValue), Mr(s, "valuemax", e._maxValue) } var Pr = Bt.extend({ init: function (e) { var t = this; e.previewFilter || (e.previewFilter = function (e) { return Math.round(100 * e) / 100 }), t._super(e), t.classes.add("slider"), "v" === e.orientation && t.classes.add("vertical"), t._minValue = V.isNumber(e.minValue) ? e.minValue : 0, t._maxValue = V.isNumber(e.maxValue) ? e.maxValue : 100, t._initValue = t.state.get("value") }, renderHtml: function () { var e = this._id, t = this.classPrefix; return '<div id="' + e + '" class="' + this.classes + '"><div id="' + e + '-handle" class="' + t + 'slider-handle" role="slider" tabindex="-1"></div></div>' }, reset: function () { this.value(this._initValue).repaint() }, postRender: function () { var e, t, n, i, r, o, s, a, l, u, c, d, f, h, m = this; e = m._minValue, t = m._maxValue, "v" === m.settings.orientation ? (n = "screenY", i = "top", r = "height", o = "h") : (n = "screenX", i = "left", r = "width", o = "w"), m._super(), function (o, s) { function t(e) { var t, n, i, r; t = Sr(t = (((t = m.value()) + (r = n = o)) / ((i = s) - r) + .05 * e) * (i - n) - n, o, s), m.value(t), m.fire("dragstart", { value: t }), m.fire("drag", { value: t }), m.fire("dragend", { value: t }) } m.on("keydown", function (e) { switch (e.keyCode) { case 37: case 38: t(-1); break; case 39: case 40: t(1) } }) }(e, t), s = e, a = t, l = m.getEl("handle"), m._dragHelper = new mt(m._id, { handle: m._id + "-handle", start: function (e) { u = e[n], c = parseInt(m.getEl("handle").style[i], 10), d = (m.layoutRect()[o] || 100) - ke.getSize(l)[r], m.fire("dragstart", { value: h }) }, drag: function (e) { var t = e[n] - u; f = Sr(c + t, 0, d), l.style[i] = f + "px", h = s + f / d * (a - s), m.value(h), m.tooltip().text("" + m.settings.previewFilter(h)).show().moveRel(l, "bc tc"), m.fire("drag", { value: h }) }, stop: function () { m.tooltip().hide(), m.fire("dragend", { value: h }) } }) }, repaint: function () { this._super(), Tr(this, this.value()) }, bindStates: function () { var t = this; return t.state.on("change:value", function (e) { Tr(t, e.value) }), t._super() } }), Wr = Bt.extend({ renderHtml: function () { return this.classes.add("spacer"), this.canFocus = !1, '<div id="' + this._id + '" class="' + this.classes + '"></div>' } }), Dr = xr.extend({ Defaults: { classes: "widget btn splitbtn", role: "button" }, repaint: function () { var e, t, n = this.getEl(), i = this.layoutRect(); return this._super(), e = n.firstChild, t = n.lastChild, Re(e).css({ width: i.w - ke.getSize(t).width, height: i.h - 2 }), Re(t).css({ height: i.h - 2 }), this }, activeMenu: function (e) { Re(this.getEl().lastChild).toggleClass(this.classPrefix + "active", e) }, renderHtml: function () { var e, t, n = this, i = n._id, r = n.classPrefix, o = n.state.get("icon"), s = n.state.get("text"), a = n.settings, l = ""; return (e = a.image) ? (o = "none", "string" != typeof e && (e = window.getSelection ? e[0] : e[1]), e = " style=\"background-image: url('" + e + "')\"") : e = "", o = a.icon ? r + "ico " + r + "i-" + o : "", s && (n.classes.add("btn-has-text"), l = '<span class="' + r + 'txt">' + n.encode(s) + "</span>"), t = "boolean" == typeof a.active ? ' aria-pressed="' + a.active + '"' : "", '<div id="' + i + '" class="' + n.classes + '" role="button"' + t + ' tabindex="-1"><button type="button" hidefocus="1" tabindex="-1">' + (o ? '<i class="' + o + '"' + e + "></i>" : "") + l + '</button><button type="button" class="' + r + 'open" hidefocus="1" tabindex="-1">' + (n._menuBtnText ? (o ? "\xa0" : "") + n._menuBtnText : "") + ' <i class="' + r + 'caret"></i></button></div>' }, postRender: function () { var n = this.settings.onclick; return this.on("click", function (e) { var t = e.target; if (e.control === this) for (; t;) { if (e.aria && "down" !== e.aria.key || "BUTTON" === t.nodeName && -1 === t.className.indexOf("open")) return e.stopImmediatePropagation(), void (n && n.call(this, e)); t = t.parentNode } }), delete this.settings.onclick, this._super() } }), Nr = Li.extend({ Defaults: { containerClass: "stack-layout", controlClass: "stack-layout-item", endClass: "break" }, isNative: function () { return !0 } }), Ar = xt.extend({ Defaults: { layout: "absolute", defaults: { type: "panel" } }, activateTab: function (n) { var e; this.activeTabId && (e = this.getEl(this.activeTabId), Re(e).removeClass(this.classPrefix + "active"), e.setAttribute("aria-selected", "false")), this.activeTabId = "t" + n, (e = this.getEl("t" + n)).setAttribute("aria-selected", "true"), Re(e).addClass(this.classPrefix + "active"), this.items()[n].show().fire("showtab"), this.reflow(), this.items().each(function (e, t) { n !== t && e.hide() }) }, renderHtml: function () { var i = this, e = i._layout, r = "", o = i.classPrefix; return i.preRender(), e.preRender(i), i.items().each(function (e, t) { var n = i._id + "-t" + t; e.aria("role", "tabpanel"), e.aria("labelledby", n), r += '<div id="' + n + '" class="' + o + 'tab" unselectable="on" role="tab" aria-controls="' + e._id + '" aria-selected="false" tabIndex="-1">' + i.encode(e.settings.title) + "</div>" }), '<div id="' + i._id + '" class="' + i.classes + '" hidefocus="1" tabindex="-1"><div id="' + i._id + '-head" class="' + o + 'tabs" role="tablist">' + r + '</div><div id="' + i._id + '-body" class="' + i.bodyClasses + '">' + e.renderHtml(i) + "</div></div>" }, postRender: function () { var i = this; i._super(), i.settings.activeTab = i.settings.activeTab || 0, i.activateTab(i.settings.activeTab), this.on("click", function (e) { var t = e.target.parentNode; if (t && t.id === i._id + "-head") for (var n = t.childNodes.length; n--;)t.childNodes[n] === e.target && i.activateTab(n) }) }, initLayoutRect: function () { var e, t, n, i = this; t = (t = ke.getSize(i.getEl("head")).width) < 0 ? 0 : t, n = 0, i.items().each(function (e) { t = Math.max(t, e.layoutRect().minW), n = Math.max(n, e.layoutRect().minH) }), i.items().each(function (e) { e.settings.x = 0, e.settings.y = 0, e.settings.w = t, e.settings.h = n, e.layoutRect({ x: 0, y: 0, w: t, h: n }) }); var r = ke.getSize(i.getEl("head")).height; return i.settings.minWidth = t, i.settings.minHeight = n + r, (e = i._super()).deltaH += r, e.innerH = e.h - e.deltaH, e } }), Br = Bt.extend({ init: function (e) { var n = this; n._super(e), n.classes.add("textbox"), e.multiline ? n.classes.add("multiline") : (n.on("keydown", function (e) { var t; 13 === e.keyCode && (e.preventDefault(), n.parents().reverse().each(function (e) { if (e.toJSON) return t = e, !1 }), n.fire("submit", { data: t.toJSON() })) }), n.on("keyup", function (e) { n.state.set("value", e.target.value) })) }, repaint: function () { var e, t, n, i, r, o = this, s = 0; e = o.getEl().style, t = o._layoutRect, r = o._lastRepaintRect || {}; var a = document; return !o.settings.multiline && a.all && (!a.documentMode || a.documentMode <= 8) && (e.lineHeight = t.h - s + "px"), i = (n = o.borderBox).left + n.right + 8, s = n.top + n.bottom + (o.settings.multiline ? 8 : 0), t.x !== r.x && (e.left = t.x + "px", r.x = t.x), t.y !== r.y && (e.top = t.y + "px", r.y = t.y), t.w !== r.w && (e.width = t.w - i + "px", r.w = t.w), t.h !== r.h && (e.height = t.h - s + "px", r.h = t.h), o._lastRepaintRect = r, o.fire("repaint", {}, !1), o }, renderHtml: function () { var t, e, n = this, i = n.settings; return t = { id: n._id, hidefocus: "1" }, w.each(["rows", "spellcheck", "maxLength", "size", "readonly", "min", "max", "step", "list", "pattern", "placeholder", "required", "multiple"], function (e) { t[e] = i[e] }), n.disabled() && (t.disabled = "disabled"), i.subtype && (t.type = i.subtype), (e = ke.create(i.multiline ? "textarea" : "input", t)).value = n.state.get("value"), e.className = n.classes, e.outerHTML }, value: function (e) { return arguments.length ? (this.state.set("value", e), this) : (this.state.get("rendered") && this.state.set("value", this.getEl().value), this.state.get("value")) }, postRender: function () { var t = this; t.getEl().value = t.state.get("value"), t._super(), t.$el.on("change", function (e) { t.state.set("value", e.target.value), t.fire("change", e) }) }, bindStates: function () { var t = this; return t.state.on("change:value", function (e) { t.getEl().value !== e.value && (t.getEl().value = e.value) }), t.state.on("change:disabled", function (e) { t.getEl().disabled = e.value }), t._super() }, remove: function () { this.$el.off(), this._super() } }), Or = function () { return { Selector: je, Collection: $e, ReflowQueue: tt, Control: lt, Factory: v, KeyboardNavigation: ct, Container: ft, DragHelper: mt, Scrollable: yt, Panel: xt, Movable: Pe, Resizable: wt, FloatPanel: St, Window: qt, MessageBox: $t, Tooltip: At, Widget: Bt, Progress: Ot, Notification: Lt, Layout: Jt, AbsoluteLayout: Gt, Button: Kt, ButtonGroup: Qt, Checkbox: en, ComboBox: nn, ColorBox: rn, PanelButton: on, ColorButton: an, ColorPicker: un, Path: dn, ElementPath: fn, FormItem: hn, Form: mn, FieldSet: gn, FilePicker: Bi, FitLayout: Oi, FlexLayout: zi, FlowLayout: Li, FormatControls: hr, GridLayout: mr, Iframe: gr, InfoBox: pr, Label: vr, Toolbar: br, MenuBar: yr, MenuButton: xr, MenuItem: Rr, Throbber: Wt, Menu: wr, ListBox: _r, Radio: Cr, ResizeHandle: kr, SelectBox: Hr, Slider: Pr, Spacer: Wr, SplitButton: Dr, StackLayout: Nr, TabPanel: Ar, TextBox: Br, DropZone: cn, BrowseButton: Zt } }, zr = function (n) { n.ui ? w.each(Or(), function (e, t) { n.ui[t] = e }) : n.ui = Or() }; w.each(Or(), function (e, t) { v.add(t, e) }), zr(window.tinymce ? window.tinymce : {}), o.add("modern", function (e) { return hr.setup(e), Xt(e) }) }();
!function () { "use strict"; var t = tinymce.util.Tools.resolve("tinymce.PluginManager"), a = tinymce.util.Tools.resolve("tinymce.util.Tools"), s = function (t, e, n) { var r = "UL" === e ? "InsertUnorderedList" : "InsertOrderedList"; t.execCommand(r, !1, !1 === n ? null : { "list-style-type": n }) }, o = function (n) { n.addCommand("ApplyUnorderedListStyle", function (t, e) { s(n, "UL", e["list-style-type"]) }), n.addCommand("ApplyOrderedListStyle", function (t, e) { s(n, "OL", e["list-style-type"]) }) }, e = function (t) { var e = t.getParam("advlist_number_styles", "default,lower-alpha,lower-greek,lower-roman,upper-alpha,upper-roman"); return e ? e.split(/[ ,]/) : [] }, n = function (t) { var e = t.getParam("advlist_bullet_styles", "default,circle,disc,square"); return e ? e.split(/[ ,]/) : [] }, u = function (t) { return t && /^(TH|TD)$/.test(t.nodeName) }, c = function (r) { return function (t) { return t && /^(OL|UL|DL)$/.test(t.nodeName) && (n = t, (e = r).$.contains(e.getBody(), n)); var e, n } }, d = function (t) { var e = t.dom.getParent(t.selection.getNode(), "ol,ul"); return t.dom.getStyle(e, "listStyleType") || "" }, p = function (t) { return a.map(t, function (t) { return { text: t.replace(/\-/g, " ").replace(/\b\w/g, function (t) { return t.toUpperCase() }), data: "default" === t ? "" : t } }) }, f = function (i, l) { return function (t) { var o = t.control; i.on("NodeChange", function (t) { var e = function (t, e) { for (var n = 0; n < t.length; n++)if (e(t[n])) return n; return -1 }(t.parents, u), n = -1 !== e ? t.parents.slice(0, e) : t.parents, r = a.grep(n, c(i)); o.active(0 < r.length && r[0].nodeName === l) }) } }, m = function (e, t, n, r, o, i) { var l; e.addButton(t, { active: !1, type: "splitbutton", tooltip: n, menu: p(i), onPostRender: f(e, o), onshow: (l = e, function (t) { var e = d(l); t.control.items().each(function (t) { t.active(t.settings.data === e) }) }), onselect: function (t) { s(e, o, t.control.settings.data) }, onclick: function () { e.execCommand(r) } }) }, r = function (t, e, n, r, o, i) { var l, a, s, u, c; 0 < i.length ? m(t, e, n, r, o, i) : (a = e, s = n, u = r, c = o, (l = t).addButton(a, { active: !1, type: "button", tooltip: s, onPostRender: f(l, c), onclick: function () { l.execCommand(u) } })) }, i = function (t) { r(t, "numlist", "Numbered list", "InsertOrderedList", "OL", e(t)), r(t, "bullist", "Bullet list", "InsertUnorderedList", "UL", n(t)) }; t.add("advlist", function (t) { var e, n, r; n = "lists", r = (e = t).settings.plugins ? e.settings.plugins : "", -1 !== a.inArray(r.split(/[ ,]/), n) && (i(t), o(t)) }) }();
!function () { "use strict"; var t = tinymce.util.Tools.resolve("tinymce.PluginManager"), a = function (t) { return /^[A-Za-z][A-Za-z0-9\-:._]*$/.test(t) }, e = function (t) { var e = t.selection.getNode(); return "A" === e.tagName && "" === t.dom.getAttrib(e, "href") ? e.id || e.name : "" }, i = function (t, e) { var n = t.selection.getNode(); "A" === n.tagName && "" === t.dom.getAttrib(n, "href") ? (n.removeAttribute("name"), n.id = e) : (t.focus(), t.selection.collapse(!0), t.execCommand("mceInsertContent", !1, t.dom.createHTML("a", { id: e }))) }, n = function (r) { var t = e(r); r.windowManager.open({ title: "Anchor", body: { type: "textbox", name: "id", size: 40, label: "Id", value: t }, onsubmit: function (t) { var e, n, o = t.data.id; e = r, (a(n = o) ? (i(e, n), 0) : (e.windowManager.alert("Id should start with a letter, followed only by letters, numbers, dashes, dots, colons or underscores."), 1)) && t.preventDefault() } }) }, o = function (t) { t.addCommand("mceAnchor", function () { n(t) }) }, r = function (o) { return function (t) { for (var e = 0; e < t.length; e++)(n = t[e]).attr("href") || !n.attr("id") && !n.attr("name") || n.firstChild || t[e].attr("contenteditable", o); var n } }, c = function (t) { t.on("PreInit", function () { t.parser.addNodeFilter("a", r("false")), t.serializer.addNodeFilter("a", r(null)) }) }, d = function (t) { t.addButton("anchor", { icon: "anchor", tooltip: "Anchor", cmd: "mceAnchor", stateSelector: "a:not([href])" }), t.addMenuItem("anchor", { icon: "anchor", text: "Anchor", context: "insert", cmd: "mceAnchor" }) }; t.add("anchor", function (t) { c(t), o(t), d(t) }) }();
!function () { "use strict"; var e = tinymce.util.Tools.resolve("tinymce.PluginManager"), i = tinymce.util.Tools.resolve("tinymce.Env"), m = function (e) { return e.getParam("autolink_pattern", /^(https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.|(?:mailto:)?[A-Z0-9._%+\-]+@)(.+)$/i) }, y = function (e) { return e.getParam("default_link_target", "") }, o = function (e, t) { if (t < 0 && (t = 0), 3 === e.nodeType) { var n = e.data.length; n < t && (t = n) } return t }, k = function (e, t, n) { 1 !== t.nodeType || t.hasChildNodes() ? e.setStart(t, o(t, n)) : e.setStartBefore(t) }, p = function (e, t, n) { 1 !== t.nodeType || t.hasChildNodes() ? e.setEnd(t, o(t, n)) : e.setEndAfter(t) }, r = function (e, t, n) { var i, o, r, a, f, s, d, l, c, u, g = m(e), h = y(e); if ("A" !== e.selection.getNode().tagName) { if ((i = e.selection.getRng(!0).cloneRange()).startOffset < 5) { if (!(l = i.endContainer.previousSibling)) { if (!i.endContainer.firstChild || !i.endContainer.firstChild.nextSibling) return; l = i.endContainer.firstChild.nextSibling } if (c = l.length, k(i, l, c), p(i, l, c), i.endOffset < 5) return; o = i.endOffset, a = l } else { if (3 !== (a = i.endContainer).nodeType && a.firstChild) { for (; 3 !== a.nodeType && a.firstChild;)a = a.firstChild; 3 === a.nodeType && (k(i, a, 0), p(i, a, a.nodeValue.length)) } o = 1 === i.endOffset ? 2 : i.endOffset - 1 - t } for (r = o; k(i, a, 2 <= o ? o - 2 : 0), p(i, a, 1 <= o ? o - 1 : 0), o -= 1, " " !== (u = i.toString()) && "" !== u && 160 !== u.charCodeAt(0) && 0 <= o - 2 && u !== n;); var C; (C = i.toString()) === n || " " === C || 160 === C.charCodeAt(0) ? (k(i, a, o), p(i, a, r), o += 1) : (0 === i.startOffset ? k(i, a, 0) : k(i, a, o), p(i, a, r)), "." === (s = i.toString()).charAt(s.length - 1) && p(i, a, r - 1), (d = (s = i.toString().trim()).match(g)) && ("www." === d[1] ? d[1] = "http://www." : /@$/.test(d[1]) && !/^mailto:/.test(d[1]) && (d[1] = "mailto:" + d[1]), f = e.selection.getBookmark(), e.selection.setRng(i), e.execCommand("createlink", !1, d[1] + d[2]), h && e.dom.setAttrib(e.selection.getNode(), "target", h), e.selection.moveToBookmark(f), e.nodeChanged()) } }, t = function (t) { var n; t.on("keydown", function (e) { 13 !== e.keyCode || r(t, -1, "") }), i.ie ? t.on("focus", function () { if (!n) { n = !0; try { t.execCommand("AutoUrlDetect", !1, !0) } catch (e) { } } }) : (t.on("keypress", function (e) { 41 !== e.keyCode || r(t, -1, "(") }), t.on("keyup", function (e) { 32 !== e.keyCode || r(t, 0, "") })) }; e.add("autolink", function (e) { t(e) }) }();
!function () { "use strict"; var i = function (t) { var e = t, n = function () { return e }; return { get: n, set: function (t) { e = t }, clone: function () { return i(n()) } } }, t = tinymce.util.Tools.resolve("tinymce.PluginManager"), y = tinymce.util.Tools.resolve("tinymce.Env"), r = tinymce.util.Tools.resolve("tinymce.util.Delay"), h = function (t) { return parseInt(t.getParam("autoresize_min_height", t.getElement().offsetHeight), 10) }, v = function (t) { return parseInt(t.getParam("autoresize_max_height", 0), 10) }, o = function (t) { return t.getParam("autoresize_overflow_padding", 1) }, a = function (t) { return t.getParam("autoresize_bottom_margin", 50) }, n = function (t) { return t.getParam("autoresize_on_init", !0) }, u = function (t, e, n, i, o) { r.setEditorTimeout(t, function () { _(t, e), n-- ? u(t, e, n, i, o) : o && o() }, i) }, S = function (t, e) { var n = t.getBody(); n && (n.style.overflowY = e ? "" : "hidden", e || (n.scrollTop = 0)) }, _ = function (t, e) { var n, i, o, r, a, u, s, l, g, c, f, d = t.dom; if (i = t.getDoc()) if ((m = t).plugins.fullscreen && m.plugins.fullscreen.isFullscreen()) S(t, !0); else { var m; o = i.body, r = h(t), u = d.getStyle(o, "margin-top", !0), s = d.getStyle(o, "margin-bottom", !0), l = d.getStyle(o, "padding-top", !0), g = d.getStyle(o, "padding-bottom", !0), c = d.getStyle(o, "border-top-width", !0), f = d.getStyle(o, "border-bottom-width", !0), a = o.offsetHeight + parseInt(u, 10) + parseInt(s, 10) + parseInt(l, 10) + parseInt(g, 10) + parseInt(c, 10) + parseInt(f, 10), (isNaN(a) || a <= 0) && (a = y.ie ? o.scrollHeight : y.webkit && 0 === o.clientHeight ? 0 : o.offsetHeight), a > h(t) && (r = a); var p = v(t); p && p < a ? (r = p, S(t, !0)) : S(t, !1), r !== e.get() && (n = r - e.get(), d.setStyle(t.iframeElement, "height", r + "px"), e.set(r), y.webkit && n < 0 && _(t, e)) } }, s = { setup: function (i, e) { i.on("init", function () { var t, e, n = i.dom; t = o(i), e = a(i), !1 !== t && n.setStyles(i.getBody(), { paddingLeft: t, paddingRight: t }), !1 !== e && n.setStyles(i.getBody(), { paddingBottom: e }) }), i.on("nodechange setcontent keyup FullscreenStateChanged", function (t) { _(i, e) }), n(i) && i.on("init", function () { u(i, e, 20, 100, function () { u(i, e, 5, 1e3) }) }) }, resize: _ }, l = function (t, e) { t.addCommand("mceAutoResize", function () { s.resize(t, e) }) }; t.add("autoresize", function (t) { if (!t.inline) { var e = i(0); l(t, e), s.setup(t, e) } }) }();
!function () { "use strict"; var n = function (t) { var e = t, r = function () { return e }; return { get: r, set: function (t) { e = t }, clone: function () { return n(r()) } } }, t = tinymce.util.Tools.resolve("tinymce.PluginManager"), a = tinymce.util.Tools.resolve("tinymce.util.LocalStorage"), o = tinymce.util.Tools.resolve("tinymce.util.Tools"), r = function (t) { return t.fire("RestoreDraft") }, i = function (t) { return t.fire("StoreDraft") }, s = function (t) { return t.fire("RemoveDraft") }, e = function (t, e) { return ((t = /^(\d+)([ms]?)$/.exec("" + (t || e)))[2] ? { s: 1e3, m: 6e4 }[t[2]] : 1) * parseInt(t, 10) }, u = function (t) { return t.getParam("autosave_ask_before_unload", !0) }, f = function (t) { var e = t.getParam("autosave_prefix", "tinymce-autosave-{path}{query}{hash}-{id}-"); return e = (e = (e = (e = e.replace(/\{path\}/g, document.location.pathname)).replace(/\{query\}/g, document.location.search)).replace(/\{hash\}/g, document.location.hash)).replace(/\{id\}/g, t.id) }, c = function (t) { return e(t.settings.autosave_interval, "30s") }, l = function (t) { return e(t.settings.autosave_retention, "20m") }, m = function (t, e) { var r = t.settings.forced_root_block; return "" === (e = o.trim(void 0 === e ? t.getBody().innerHTML : e)) || new RegExp("^<" + r + "[^>]*>((\xa0|&nbsp;|[ \t]|<br[^>]*>)+?|)</" + r + ">|<br>$", "i").test(e) }, v = function (t) { var e = parseInt(a.getItem(f(t) + "time"), 10) || 0; return !((new Date).getTime() - e > l(t) && (d(t, !1), 1)) }, d = function (t, e) { var r = f(t); a.removeItem(r + "draft"), a.removeItem(r + "time"), !1 !== e && s(t) }, D = function (t) { var e = f(t); !m(t) && t.isDirty() && (a.setItem(e + "draft", t.getContent({ format: "raw", no_events: !0 })), a.setItem(e + "time", (new Date).getTime().toString()), i(t)) }, g = function (t) { var e = f(t); v(t) && (t.setContent(a.getItem(e + "draft"), { format: "raw" }), r(t)) }, y = { isEmpty: m, hasDraft: v, removeDraft: d, storeDraft: D, restoreDraft: g, startStoreDraft: function (t, e) { var r = c(t); e.get() || (setInterval(function () { t.removed || D(t) }, r), e.set(!0)) }, restoreLastDraft: function (t) { t.undoManager.transact(function () { g(t), d(t) }), t.focus() } }, p = function (e, r) { return function () { var t = Array.prototype.slice.call(arguments); return e.apply(null, [r].concat(t)) } }, h = function (t) { return { hasDraft: p(y.hasDraft, t), storeDraft: p(y.storeDraft, t), restoreDraft: p(y.restoreDraft, t), removeDraft: p(y.removeDraft, t), isEmpty: p(y.isEmpty, t) } }, _ = tinymce.util.Tools.resolve("tinymce.EditorManager"); _._beforeUnloadHandler = function () { var e; return o.each(_.get(), function (t) { t.plugins.autosave && t.plugins.autosave.storeDraft(), !e && t.isDirty() && u(t) && (e = t.translate("You have unsaved changes are you sure you want to navigate away?")) }), e }; var b = function (t) { window.onbeforeunload = _._beforeUnloadHandler }, I = function (r, n) { return function (t) { var e = t.control; e.disabled(!y.hasDraft(r)), r.on("StoreDraft RestoreDraft RemoveDraft", function () { e.disabled(!y.hasDraft(r)) }), y.startStoreDraft(r, n) } }, w = function (t, e) { t.addButton("restoredraft", { title: "Restore last draft", onclick: function () { y.restoreLastDraft(t) }, onPostRender: I(t, e) }), t.addMenuItem("restoredraft", { text: "Restore last draft", onclick: function () { y.restoreLastDraft(t) }, onPostRender: I(t, e), context: "file" }) }; t.add("autosave", function (t) { var e = n(!1); return b(t), w(t, e), h(t) }) }();
!function () { "use strict"; var o = tinymce.util.Tools.resolve("tinymce.PluginManager"), t = tinymce.util.Tools.resolve("tinymce.util.Tools"), e = function (e) { e = t.trim(e); var o = function (o, t) { e = e.replace(o, t) }; return o(/<a.*?href=\"(.*?)\".*?>(.*?)<\/a>/gi, "[url=$1]$2[/url]"), o(/<font.*?color=\"(.*?)\".*?class=\"codeStyle\".*?>(.*?)<\/font>/gi, "[code][color=$1]$2[/color][/code]"), o(/<font.*?color=\"(.*?)\".*?class=\"quoteStyle\".*?>(.*?)<\/font>/gi, "[quote][color=$1]$2[/color][/quote]"), o(/<font.*?class=\"codeStyle\".*?color=\"(.*?)\".*?>(.*?)<\/font>/gi, "[code][color=$1]$2[/color][/code]"), o(/<font.*?class=\"quoteStyle\".*?color=\"(.*?)\".*?>(.*?)<\/font>/gi, "[quote][color=$1]$2[/color][/quote]"), o(/<span style=\"color: ?(.*?);\">(.*?)<\/span>/gi, "[color=$1]$2[/color]"), o(/<font.*?color=\"(.*?)\".*?>(.*?)<\/font>/gi, "[color=$1]$2[/color]"), o(/<span style=\"font-size:(.*?);\">(.*?)<\/span>/gi, "[size=$1]$2[/size]"), o(/<font>(.*?)<\/font>/gi, "$1"), o(/<img.*?src=\"(.*?)\".*?\/>/gi, "[img]$1[/img]"), o(/<span class=\"codeStyle\">(.*?)<\/span>/gi, "[code]$1[/code]"), o(/<span class=\"quoteStyle\">(.*?)<\/span>/gi, "[quote]$1[/quote]"), o(/<strong class=\"codeStyle\">(.*?)<\/strong>/gi, "[code][b]$1[/b][/code]"), o(/<strong class=\"quoteStyle\">(.*?)<\/strong>/gi, "[quote][b]$1[/b][/quote]"), o(/<em class=\"codeStyle\">(.*?)<\/em>/gi, "[code][i]$1[/i][/code]"), o(/<em class=\"quoteStyle\">(.*?)<\/em>/gi, "[quote][i]$1[/i][/quote]"), o(/<u class=\"codeStyle\">(.*?)<\/u>/gi, "[code][u]$1[/u][/code]"), o(/<u class=\"quoteStyle\">(.*?)<\/u>/gi, "[quote][u]$1[/u][/quote]"), o(/<\/(strong|b)>/gi, "[/b]"), o(/<(strong|b)>/gi, "[b]"), o(/<\/(em|i)>/gi, "[/i]"), o(/<(em|i)>/gi, "[i]"), o(/<\/u>/gi, "[/u]"), o(/<span style=\"text-decoration: ?underline;\">(.*?)<\/span>/gi, "[u]$1[/u]"), o(/<u>/gi, "[u]"), o(/<blockquote[^>]*>/gi, "[quote]"), o(/<\/blockquote>/gi, "[/quote]"), o(/<br \/>/gi, "\n"), o(/<br\/>/gi, "\n"), o(/<br>/gi, "\n"), o(/<p>/gi, ""), o(/<\/p>/gi, "\n"), o(/&nbsp;|\u00a0/gi, " "), o(/&quot;/gi, '"'), o(/&lt;/gi, "<"), o(/&gt;/gi, ">"), o(/&amp;/gi, "&"), e }, i = function (e) { e = t.trim(e); var o = function (o, t) { e = e.replace(o, t) }; return o(/\n/gi, "<br />"), o(/\[b\]/gi, "<strong>"), o(/\[\/b\]/gi, "</strong>"), o(/\[i\]/gi, "<em>"), o(/\[\/i\]/gi, "</em>"), o(/\[u\]/gi, "<u>"), o(/\[\/u\]/gi, "</u>"), o(/\[url=([^\]]+)\](.*?)\[\/url\]/gi, '<a href="$1">$2</a>'), o(/\[url\](.*?)\[\/url\]/gi, '<a href="$1">$1</a>'), o(/\[img\](.*?)\[\/img\]/gi, '<img src="$1" />'), o(/\[color=(.*?)\](.*?)\[\/color\]/gi, '<font color="$1">$2</font>'), o(/\[code\](.*?)\[\/code\]/gi, '<span class="codeStyle">$1</span>&nbsp;'), o(/\[quote.*?\](.*?)\[\/quote\]/gi, '<span class="quoteStyle">$1</span>&nbsp;'), e }; o.add("bbcode", function () { return { init: function (o) { o.on("beforeSetContent", function (o) { o.content = i(o.content) }), o.on("postProcess", function (o) { o.set && (o.content = i(o.content)), o.get && (o.content = e(o.content)) }) } } }) }();
!function () { "use strict"; var e = tinymce.util.Tools.resolve("tinymce.PluginManager"), i = function (e, t) { return e.fire("insertCustomChar", { chr: t }) }, l = function (e, t) { var a = i(e, t).chr; e.execCommand("mceInsertContent", !1, a) }, a = tinymce.util.Tools.resolve("tinymce.util.Tools"), r = function (e) { return e.settings.charmap }, n = function (e) { return e.settings.charmap_append }, o = a.isArray, c = function (e) { return o(e) ? [].concat((t = e, a.grep(t, function (e) { return o(e) && 2 === e.length }))) : "function" == typeof e ? e() : []; var t }, s = function (e) { return function (e, t) { var a = r(e); a && (t = c(a)); var i = n(e); return i ? [].concat(t).concat(c(i)) : t }(e, [["160", "no-break space"], ["173", "soft hyphen"], ["34", "quotation mark"], ["162", "cent sign"], ["8364", "euro sign"], ["163", "pound sign"], ["165", "yen sign"], ["169", "copyright sign"], ["174", "registered sign"], ["8482", "trade mark sign"], ["8240", "per mille sign"], ["181", "micro sign"], ["183", "middle dot"], ["8226", "bullet"], ["8230", "three dot leader"], ["8242", "minutes / feet"], ["8243", "seconds / inches"], ["167", "section sign"], ["182", "paragraph sign"], ["223", "sharp s / ess-zed"], ["8249", "single left-pointing angle quotation mark"], ["8250", "single right-pointing angle quotation mark"], ["171", "left pointing guillemet"], ["187", "right pointing guillemet"], ["8216", "left single quotation mark"], ["8217", "right single quotation mark"], ["8220", "left double quotation mark"], ["8221", "right double quotation mark"], ["8218", "single low-9 quotation mark"], ["8222", "double low-9 quotation mark"], ["60", "less-than sign"], ["62", "greater-than sign"], ["8804", "less-than or equal to"], ["8805", "greater-than or equal to"], ["8211", "en dash"], ["8212", "em dash"], ["175", "macron"], ["8254", "overline"], ["164", "currency sign"], ["166", "broken bar"], ["168", "diaeresis"], ["161", "inverted exclamation mark"], ["191", "turned question mark"], ["710", "circumflex accent"], ["732", "small tilde"], ["176", "degree sign"], ["8722", "minus sign"], ["177", "plus-minus sign"], ["247", "division sign"], ["8260", "fraction slash"], ["215", "multiplication sign"], ["185", "superscript one"], ["178", "superscript two"], ["179", "superscript three"], ["188", "fraction one quarter"], ["189", "fraction one half"], ["190", "fraction three quarters"], ["402", "function / florin"], ["8747", "integral"], ["8721", "n-ary sumation"], ["8734", "infinity"], ["8730", "square root"], ["8764", "similar to"], ["8773", "approximately equal to"], ["8776", "almost equal to"], ["8800", "not equal to"], ["8801", "identical to"], ["8712", "element of"], ["8713", "not an element of"], ["8715", "contains as member"], ["8719", "n-ary product"], ["8743", "logical and"], ["8744", "logical or"], ["172", "not sign"], ["8745", "intersection"], ["8746", "union"], ["8706", "partial differential"], ["8704", "for all"], ["8707", "there exists"], ["8709", "diameter"], ["8711", "backward difference"], ["8727", "asterisk operator"], ["8733", "proportional to"], ["8736", "angle"], ["180", "acute accent"], ["184", "cedilla"], ["170", "feminine ordinal indicator"], ["186", "masculine ordinal indicator"], ["8224", "dagger"], ["8225", "double dagger"], ["192", "A - grave"], ["193", "A - acute"], ["194", "A - circumflex"], ["195", "A - tilde"], ["196", "A - diaeresis"], ["197", "A - ring above"], ["256", "A - macron"], ["198", "ligature AE"], ["199", "C - cedilla"], ["200", "E - grave"], ["201", "E - acute"], ["202", "E - circumflex"], ["203", "E - diaeresis"], ["274", "E - macron"], ["204", "I - grave"], ["205", "I - acute"], ["206", "I - circumflex"], ["207", "I - diaeresis"], ["298", "I - macron"], ["208", "ETH"], ["209", "N - tilde"], ["210", "O - grave"], ["211", "O - acute"], ["212", "O - circumflex"], ["213", "O - tilde"], ["214", "O - diaeresis"], ["216", "O - slash"], ["332", "O - macron"], ["338", "ligature OE"], ["352", "S - caron"], ["217", "U - grave"], ["218", "U - acute"], ["219", "U - circumflex"], ["220", "U - diaeresis"], ["362", "U - macron"], ["221", "Y - acute"], ["376", "Y - diaeresis"], ["562", "Y - macron"], ["222", "THORN"], ["224", "a - grave"], ["225", "a - acute"], ["226", "a - circumflex"], ["227", "a - tilde"], ["228", "a - diaeresis"], ["229", "a - ring above"], ["257", "a - macron"], ["230", "ligature ae"], ["231", "c - cedilla"], ["232", "e - grave"], ["233", "e - acute"], ["234", "e - circumflex"], ["235", "e - diaeresis"], ["275", "e - macron"], ["236", "i - grave"], ["237", "i - acute"], ["238", "i - circumflex"], ["239", "i - diaeresis"], ["299", "i - macron"], ["240", "eth"], ["241", "n - tilde"], ["242", "o - grave"], ["243", "o - acute"], ["244", "o - circumflex"], ["245", "o - tilde"], ["246", "o - diaeresis"], ["248", "o slash"], ["333", "o macron"], ["339", "ligature oe"], ["353", "s - caron"], ["249", "u - grave"], ["250", "u - acute"], ["251", "u - circumflex"], ["252", "u - diaeresis"], ["363", "u - macron"], ["253", "y - acute"], ["254", "thorn"], ["255", "y - diaeresis"], ["563", "y - macron"], ["913", "Alpha"], ["914", "Beta"], ["915", "Gamma"], ["916", "Delta"], ["917", "Epsilon"], ["918", "Zeta"], ["919", "Eta"], ["920", "Theta"], ["921", "Iota"], ["922", "Kappa"], ["923", "Lambda"], ["924", "Mu"], ["925", "Nu"], ["926", "Xi"], ["927", "Omicron"], ["928", "Pi"], ["929", "Rho"], ["931", "Sigma"], ["932", "Tau"], ["933", "Upsilon"], ["934", "Phi"], ["935", "Chi"], ["936", "Psi"], ["937", "Omega"], ["945", "alpha"], ["946", "beta"], ["947", "gamma"], ["948", "delta"], ["949", "epsilon"], ["950", "zeta"], ["951", "eta"], ["952", "theta"], ["953", "iota"], ["954", "kappa"], ["955", "lambda"], ["956", "mu"], ["957", "nu"], ["958", "xi"], ["959", "omicron"], ["960", "pi"], ["961", "rho"], ["962", "final sigma"], ["963", "sigma"], ["964", "tau"], ["965", "upsilon"], ["966", "phi"], ["967", "chi"], ["968", "psi"], ["969", "omega"], ["8501", "alef symbol"], ["982", "pi symbol"], ["8476", "real part symbol"], ["978", "upsilon - hook symbol"], ["8472", "Weierstrass p"], ["8465", "imaginary part"], ["8592", "leftwards arrow"], ["8593", "upwards arrow"], ["8594", "rightwards arrow"], ["8595", "downwards arrow"], ["8596", "left right arrow"], ["8629", "carriage return"], ["8656", "leftwards double arrow"], ["8657", "upwards double arrow"], ["8658", "rightwards double arrow"], ["8659", "downwards double arrow"], ["8660", "left right double arrow"], ["8756", "therefore"], ["8834", "subset of"], ["8835", "superset of"], ["8836", "not a subset of"], ["8838", "subset of or equal to"], ["8839", "superset of or equal to"], ["8853", "circled plus"], ["8855", "circled times"], ["8869", "perpendicular"], ["8901", "dot operator"], ["8968", "left ceiling"], ["8969", "right ceiling"], ["8970", "left floor"], ["8971", "right floor"], ["9001", "left-pointing angle bracket"], ["9002", "right-pointing angle bracket"], ["9674", "lozenge"], ["9824", "black spade suit"], ["9827", "black club suit"], ["9829", "black heart suit"], ["9830", "black diamond suit"], ["8194", "en space"], ["8195", "em space"], ["8201", "thin space"], ["8204", "zero width non-joiner"], ["8205", "zero width joiner"], ["8206", "left-to-right mark"], ["8207", "right-to-left mark"]]) }, t = function (t) { return { getCharMap: function () { return s(t) }, insertChar: function (e) { l(t, e) } } }, u = function (e) { var t, a, i, r = Math.min(e.length, 25), n = Math.ceil(e.length / r); for (t = '<table role="presentation" cellspacing="0" class="mce-charmap"><tbody>', i = 0; i < n; i++) { for (t += "<tr>", a = 0; a < r; a++) { var o = i * r + a; if (o < e.length) { var l = e[o], c = parseInt(l[0], 10), s = l ? String.fromCharCode(c) : "&nbsp;"; t += '<td title="' + l[1] + '"><div tabindex="-1" title="' + l[1] + '" role="button" data-chr="' + c + '">' + s + "</div></td>" } else t += "<td />" } t += "</tr>" } return t += "</tbody></table>" }, d = function (e) { for (; e;) { if ("TD" === e.nodeName) return e; e = e.parentNode } }, m = function (n) { var o, e = { type: "container", html: u(s(n)), onclick: function (e) { var t = e.target; if (/^(TD|DIV)$/.test(t.nodeName)) { var a = d(t).firstChild; if (a && a.hasAttribute("data-chr")) { var i = a.getAttribute("data-chr"), r = parseInt(i, 10); isNaN(r) || l(n, String.fromCharCode(r)), e.ctrlKey || o.close() } } }, onmouseover: function (e) { var t = d(e.target); t && t.firstChild ? (o.find("#preview").text(t.firstChild.firstChild.data), o.find("#previewTitle").text(t.title)) : (o.find("#preview").text(" "), o.find("#previewTitle").text(" ")) } }; o = n.windowManager.open({ title: "Special character", spacing: 10, padding: 10, items: [e, { type: "container", layout: "flex", direction: "column", align: "center", spacing: 5, minWidth: 160, minHeight: 160, items: [{ type: "label", name: "preview", text: " ", style: "font-size: 40px; text-align: center", border: 1, minWidth: 140, minHeight: 80 }, { type: "spacer", minHeight: 20 }, { type: "label", name: "previewTitle", text: " ", style: "white-space: pre-wrap;", border: 1, minWidth: 140 }] }], buttons: [{ text: "Close", onclick: function () { o.close() } }] }) }, g = function (e) { e.addCommand("mceShowCharmap", function () { m(e) }) }, p = function (e) { e.addButton("charmap", { icon: "charmap", tooltip: "Special character", cmd: "mceShowCharmap" }), e.addMenuItem("charmap", { icon: "charmap", text: "Special character", cmd: "mceShowCharmap", context: "insert" }) }; e.add("charmap", function (e) { return g(e), p(e), t(e) }) }();
!function () { "use strict"; var t = tinymce.util.Tools.resolve("tinymce.PluginManager"), n = tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"), o = function (t) { return t.getParam("code_dialog_width", 600) }, i = function (t) { return t.getParam("code_dialog_height", Math.min(n.DOM.getViewPort().h - 200, 500)) }, c = function (t, n) { t.focus(), t.undoManager.transact(function () { t.setContent(n) }), t.selection.setCursorLocation(), t.nodeChanged() }, d = function (t) { return t.getContent({ source_view: !0 }) }, e = function (n) { var t = o(n), e = i(n); n.windowManager.open({ title: "Source code", body: { type: "textbox", name: "code", multiline: !0, minWidth: t, minHeight: e, spellcheck: !1, style: "direction: ltr; text-align: left" }, onSubmit: function (t) { c(n, t.data.code) } }).find("#code").value(d(n)) }, u = function (t) { t.addCommand("mceCodeEditor", function () { e(t) }) }, a = function (t) { t.addButton("code", { icon: "code", tooltip: "Source code", onclick: function () { e(t) } }), t.addMenuItem("code", { icon: "code", text: "Source code", onclick: function () { e(t) } }) }; t.add("code", function (t) { return u(t), a(t), {} }) }();
!function () { "use strict"; var n = function (e) { var t = e, a = function () { return t }; return { get: a, set: function (e) { t = e }, clone: function () { return n(a()) } } }, e = tinymce.util.Tools.resolve("tinymce.PluginManager"), i = tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"), s = function (e) { return e.settings.codesample_content_css }, a = function (e) { return e.settings.codesample_languages }, o = function (e) { return Math.min(i.DOM.getViewPort().w, e.getParam("codesample_dialog_width", 800)) }, l = function (e) { return Math.min(i.DOM.getViewPort().w, e.getParam("codesample_dialog_height", 650)) }, t = {}, u = void 0 !== t ? t : "undefined" != typeof WorkerGlobalScope && self instanceof WorkerGlobalScope ? self : {}, r = function () { var c = /\blang(?:uage)?-(?!\*)(\w+)\b/i, S = u.Prism = { util: { encode: function (e) { return e instanceof o ? new o(e.type, S.util.encode(e.content), e.alias) : "Array" === S.util.type(e) ? e.map(S.util.encode) : e.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/\u00a0/g, " ") }, type: function (e) { return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1] }, clone: function (e) { switch (S.util.type(e)) { case "Object": var t = {}; for (var a in e) e.hasOwnProperty(a) && (t[a] = S.util.clone(e[a])); return t; case "Array": return e.map && e.map(function (e) { return S.util.clone(e) }) }return e } }, languages: { extend: function (e, t) { var a = S.util.clone(S.languages[e]); for (var n in t) a[n] = t[n]; return a }, insertBefore: function (a, e, t, n) { var i = (n = n || S.languages)[a]; if (2 === arguments.length) { for (var r in t = e) t.hasOwnProperty(r) && (i[r] = t[r]); return i } var s = {}; for (var o in i) if (i.hasOwnProperty(o)) { if (o === e) for (var r in t) t.hasOwnProperty(r) && (s[r] = t[r]); s[o] = i[o] } return S.languages.DFS(S.languages, function (e, t) { t === n[a] && e !== a && (this[e] = s) }), n[a] = s }, DFS: function (e, t, a) { for (var n in e) e.hasOwnProperty(n) && (t.call(e, n, e[n], a || n), "Object" === S.util.type(e[n]) ? S.languages.DFS(e[n], t) : "Array" === S.util.type(e[n]) && S.languages.DFS(e[n], t, n)) } }, plugins: {}, highlightAll: function (e, t) { for (var a = document.querySelectorAll('code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'), n = 0, i = void 0; i = a[n++];)S.highlightElement(i, !0 === e, t) }, highlightElement: function (e, t, a) { for (var n, i, r = e; r && !c.test(r.className);)r = r.parentNode; r && (n = (r.className.match(c) || [, ""])[1], i = S.languages[n]), e.className = e.className.replace(c, "").replace(/\s+/g, " ") + " language-" + n, r = e.parentNode, /pre/i.test(r.nodeName) && (r.className = r.className.replace(c, "").replace(/\s+/g, " ") + " language-" + n); var s = e.textContent, o = { element: e, language: n, grammar: i, code: s }; if (s && i) if (S.hooks.run("before-highlight", o), t && u.Worker) { var l = new Worker(S.filename); l.onmessage = function (e) { o.highlightedCode = e.data, S.hooks.run("before-insert", o), o.element.innerHTML = o.highlightedCode, a && a.call(o.element), S.hooks.run("after-highlight", o), S.hooks.run("complete", o) }, l.postMessage(JSON.stringify({ language: o.language, code: o.code, immediateClose: !0 })) } else o.highlightedCode = S.highlight(o.code, o.grammar, o.language), S.hooks.run("before-insert", o), o.element.innerHTML = o.highlightedCode, a && a.call(e), S.hooks.run("after-highlight", o), S.hooks.run("complete", o); else S.hooks.run("complete", o) }, highlight: function (e, t, a) { var n = S.tokenize(e, t); return o.stringify(S.util.encode(n), a) }, tokenize: function (e, t, a) { var n = S.Token, i = [e], r = t.rest; if (r) { for (var s in r) t[s] = r[s]; delete t.rest } e: for (var s in t) if (t.hasOwnProperty(s) && t[s]) { var o = t[s]; o = "Array" === S.util.type(o) ? o : [o]; for (var l = 0; l < o.length; ++l) { var c = o[l], u = c.inside, g = !!c.lookbehind, d = 0, p = c.alias; c = c.pattern || c; for (var f = 0; f < i.length; f++) { var h = i[f]; if (i.length > e.length) break e; if (!(h instanceof n)) { c.lastIndex = 0; var m = c.exec(h); if (m) { g && (d = m[1].length); var b = m.index - 1 + d, y = b + (m = m[0].slice(d)).length, v = h.slice(0, b + 1), k = h.slice(y + 1), w = [f, 1]; v && w.push(v); var x = new n(s, u ? S.tokenize(m, u) : m, p); w.push(x), k && w.push(k), Array.prototype.splice.apply(i, w) } } } } } return i }, hooks: { all: {}, add: function (e, t) { var a = S.hooks.all; a[e] = a[e] || [], a[e].push(t) }, run: function (e, t) { var a = S.hooks.all[e]; if (a && a.length) for (var n = 0, i = void 0; i = a[n++];)i(t) } } }, o = S.Token = function (e, t, a) { this.type = e, this.content = t, this.alias = a }; if (o.stringify = function (t, a, e) { if ("string" == typeof t) return t; if ("Array" === S.util.type(t)) return t.map(function (e) { return o.stringify(e, a, t) }).join(""); var n = { type: t.type, content: o.stringify(t.content, a, e), tag: "span", classes: ["token", t.type], attributes: {}, language: a, parent: e }; if ("comment" === n.type && (n.attributes.spellcheck = "true"), t.alias) { var i = "Array" === S.util.type(t.alias) ? t.alias : [t.alias]; Array.prototype.push.apply(n.classes, i) } S.hooks.run("wrap", n); var r = ""; for (var s in n.attributes) r += (r ? " " : "") + s + '="' + (n.attributes[s] || "") + '"'; return "<" + n.tag + ' class="' + n.classes.join(" ") + '" ' + r + ">" + n.content + "</" + n.tag + ">" }, !u.document) return u.addEventListener && u.addEventListener("message", function (e) { var t = JSON.parse(e.data), a = t.language, n = t.code, i = t.immediateClose; u.postMessage(S.highlight(n, S.languages[a], a)), i && u.close() }, !1), u.Prism }(); "undefined" != typeof module && module.exports && (module.exports = r), "undefined" != typeof global && (global.Prism = r), r.languages.markup = { comment: /<!--[\w\W]*?-->/, prolog: /<\?[\w\W]+?\?>/, doctype: /<!DOCTYPE[\w\W]+?>/, cdata: /<!\[CDATA\[[\w\W]*?]]>/i, tag: { pattern: /<\/?[^\s>\/=.]+(?:\s+[^\s>\/=]+(?:=(?:("|')(?:\\\1|\\?(?!\1)[\w\W])*\1|[^\s'">=]+))?)*\s*\/?>/i, inside: { tag: { pattern: /^<\/?[^\s>\/]+/i, inside: { punctuation: /^<\/?/, namespace: /^[^\s>\/:]+:/ } }, "attr-value": { pattern: /=(?:('|")[\w\W]*?(\1)|[^\s>]+)/i, inside: { punctuation: /[=>"']/ } }, punctuation: /\/?>/, "attr-name": { pattern: /[^\s>\/]+/, inside: { namespace: /^[^\s>\/:]+:/ } } } }, entity: /&#?[\da-z]{1,8};/i }, r.hooks.add("wrap", function (e) { "entity" === e.type && (e.attributes.title = e.content.replace(/&amp;/, "&")) }), r.languages.xml = r.languages.markup, r.languages.html = r.languages.markup, r.languages.mathml = r.languages.markup, r.languages.svg = r.languages.markup, r.languages.css = { comment: /\/\*[\w\W]*?\*\//, atrule: { pattern: /@[\w-]+?.*?(;|(?=\s*\{))/i, inside: { rule: /@[\w-]+/ } }, url: /url\((?:(["'])(\\(?:\r\n|[\w\W])|(?!\1)[^\\\r\n])*\1|.*?)\)/i, selector: /[^\{\}\s][^\{\};]*?(?=\s*\{)/, string: /("|')(\\(?:\r\n|[\w\W])|(?!\1)[^\\\r\n])*\1/, property: /(\b|\B)[\w-]+(?=\s*:)/i, important: /\B!important\b/i, "function": /[-a-z0-9]+(?=\()/i, punctuation: /[(){};:]/ }, r.languages.css.atrule.inside.rest = r.util.clone(r.languages.css), r.languages.markup && (r.languages.insertBefore("markup", "tag", { style: { pattern: /<style[\w\W]*?>[\w\W]*?<\/style>/i, inside: { tag: { pattern: /<style[\w\W]*?>|<\/style>/i, inside: r.languages.markup.tag.inside }, rest: r.languages.css }, alias: "language-css" } }), r.languages.insertBefore("inside", "attr-value", { "style-attr": { pattern: /\s*style=("|').*?\1/i, inside: { "attr-name": { pattern: /^\s*style/i, inside: r.languages.markup.tag.inside }, punctuation: /^\s*=\s*['"]|['"]\s*$/, "attr-value": { pattern: /.+/i, inside: r.languages.css } }, alias: "language-css" } }, r.languages.markup.tag)), r.languages.clike = { comment: [{ pattern: /(^|[^\\])\/\*[\w\W]*?\*\//, lookbehind: !0 }, { pattern: /(^|[^\\:])\/\/.*/, lookbehind: !0 }], string: /(["'])(\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/, "class-name": { pattern: /((?:\b(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/i, lookbehind: !0, inside: { punctuation: /(\.|\\)/ } }, keyword: /\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/, "boolean": /\b(true|false)\b/, "function": /[a-z0-9_]+(?=\()/i, number: /\b-?(?:0x[\da-f]+|\d*\.?\d+(?:e[+-]?\d+)?)\b/i, operator: /--?|\+\+?|!=?=?|<=?|>=?|==?=?|&&?|\|\|?|\?|\*|\/|~|\^|%/, punctuation: /[{}[\];(),.:]/ }, r.languages.javascript = r.languages.extend("clike", { keyword: /\b(as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|false|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|true|try|typeof|var|void|while|with|yield)\b/, number: /\b-?(0x[\dA-Fa-f]+|0b[01]+|0o[0-7]+|\d*\.?\d+([Ee][+-]?\d+)?|NaN|Infinity)\b/, "function": /[_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*(?=\()/i }), r.languages.insertBefore("javascript", "keyword", { regex: { pattern: /(^|[^/])\/(?!\/)(\[.+?]|\\.|[^/\\\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})]))/, lookbehind: !0 } }), r.languages.insertBefore("javascript", "class-name", { "template-string": { pattern: /`(?:\\`|\\?[^`])*`/, inside: { interpolation: { pattern: /\$\{[^}]+\}/, inside: { "interpolation-punctuation": { pattern: /^\$\{|\}$/, alias: "punctuation" }, rest: r.languages.javascript } }, string: /[\s\S]+/ } } }), r.languages.markup && r.languages.insertBefore("markup", "tag", { script: { pattern: /<script[\w\W]*?>[\w\W]*?<\/script>/i, inside: { tag: { pattern: /<script[\w\W]*?>|<\/script>/i, inside: r.languages.markup.tag.inside }, rest: r.languages.javascript }, alias: "language-javascript" } }), r.languages.js = r.languages.javascript, r.languages.c = r.languages.extend("clike", { keyword: /\b(asm|typeof|inline|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|union|unsigned|void|volatile|while)\b/, operator: /\-[>-]?|\+\+?|!=?|<<?=?|>>?=?|==?|&&?|\|?\||[~^%?*\/]/, number: /\b-?(?:0x[\da-f]+|\d*\.?\d+(?:e[+-]?\d+)?)[ful]*\b/i }), r.languages.insertBefore("c", "string", { macro: { pattern: /(^\s*)#\s*[a-z]+([^\r\n\\]|\\.|\\(?:\r\n?|\n))*/im, lookbehind: !0, alias: "property", inside: { string: { pattern: /(#\s*include\s*)(<.+?>|("|')(\\?.)+?\3)/, lookbehind: !0 } } } }), delete r.languages.c["class-name"], delete r.languages.c["boolean"], r.languages.csharp = r.languages.extend("clike", { keyword: /\b(abstract|as|async|await|base|bool|break|byte|case|catch|char|checked|class|const|continue|decimal|default|delegate|do|double|else|enum|event|explicit|extern|false|finally|fixed|float|for|foreach|goto|if|implicit|in|int|interface|internal|is|lock|long|namespace|new|null|object|operator|out|override|params|private|protected|public|readonly|ref|return|sbyte|sealed|short|sizeof|stackalloc|static|string|struct|switch|this|throw|true|try|typeof|uint|ulong|unchecked|unsafe|ushort|using|virtual|void|volatile|while|add|alias|ascending|async|await|descending|dynamic|from|get|global|group|into|join|let|orderby|partial|remove|select|set|value|var|where|yield)\b/, string: [/@("|')(\1\1|\\\1|\\?(?!\1)[\s\S])*\1/, /("|')(\\?.)*?\1/], number: /\b-?(0x[\da-f]+|\d*\.?\d+)\b/i }), r.languages.insertBefore("csharp", "keyword", { preprocessor: { pattern: /(^\s*)#.*/m, lookbehind: !0 } }), r.languages.cpp = r.languages.extend("c", { keyword: /\b(alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|class|compl|const|constexpr|const_cast|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|float|for|friend|goto|if|inline|int|long|mutable|namespace|new|noexcept|nullptr|operator|private|protected|public|register|reinterpret_cast|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|union|unsigned|using|virtual|void|volatile|wchar_t|while)\b/, "boolean": /\b(true|false)\b/, operator: /[-+]{1,2}|!=?|<{1,2}=?|>{1,2}=?|\->|:{1,2}|={1,2}|\^|~|%|&{1,2}|\|?\||\?|\*|\/|\b(and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\b/ }), r.languages.insertBefore("cpp", "keyword", { "class-name": { pattern: /(class\s+)[a-z0-9_]+/i, lookbehind: !0 } }), r.languages.java = r.languages.extend("clike", { keyword: /\b(abstract|continue|for|new|switch|assert|default|goto|package|synchronized|boolean|do|if|private|this|break|double|implements|protected|throw|byte|else|import|public|throws|case|enum|instanceof|return|transient|catch|extends|int|short|try|char|final|interface|static|void|class|finally|long|strictfp|volatile|const|float|native|super|while)\b/, number: /\b0b[01]+\b|\b0x[\da-f]*\.?[\da-fp\-]+\b|\b\d*\.?\d+(?:e[+-]?\d+)?[df]?\b/i, operator: { pattern: /(^|[^.])(?:\+[+=]?|-[-=]?|!=?|<<?=?|>>?>?=?|==?|&[&=]?|\|[|=]?|\*=?|\/=?|%=?|\^=?|[?:~])/m, lookbehind: !0 } }), r.languages.php = r.languages.extend("clike", { keyword: /\b(and|or|xor|array|as|break|case|cfunction|class|const|continue|declare|default|die|do|else|elseif|enddeclare|endfor|endforeach|endif|endswitch|endwhile|extends|for|foreach|function|include|include_once|global|if|new|return|static|switch|use|require|require_once|var|while|abstract|interface|public|implements|private|protected|parent|throw|null|echo|print|trait|namespace|final|yield|goto|instanceof|finally|try|catch)\b/i, constant: /\b[A-Z0-9_]{2,}\b/, comment: { pattern: /(^|[^\\])(?:\/\*[\w\W]*?\*\/|\/\/.*)/, lookbehind: !0 } }), r.languages.insertBefore("php", "class-name", { "shell-comment": { pattern: /(^|[^\\])#.*/, lookbehind: !0, alias: "comment" } }), r.languages.insertBefore("php", "keyword", { delimiter: /\?>|<\?(?:php)?/i, variable: /\$\w+\b/i, "package": { pattern: /(\\|namespace\s+|use\s+)[\w\\]+/, lookbehind: !0, inside: { punctuation: /\\/ } } }), r.languages.insertBefore("php", "operator", { property: { pattern: /(->)[\w]+/, lookbehind: !0 } }), r.languages.markup && (r.hooks.add("before-highlight", function (t) { "php" === t.language && (t.tokenStack = [], t.backupCode = t.code, t.code = t.code.replace(/(?:<\?php|<\?)[\w\W]*?(?:\?>)/gi, function (e) { return t.tokenStack.push(e), "{{{PHP" + t.tokenStack.length + "}}}" })) }), r.hooks.add("before-insert", function (e) { "php" === e.language && (e.code = e.backupCode, delete e.backupCode) }), r.hooks.add("after-highlight", function (e) { if ("php" === e.language) { for (var t = 0, a = void 0; a = e.tokenStack[t]; t++)e.highlightedCode = e.highlightedCode.replace("{{{PHP" + (t + 1) + "}}}", r.highlight(a, e.grammar, "php").replace(/\$/g, "$$$$")); e.element.innerHTML = e.highlightedCode } }), r.hooks.add("wrap", function (e) { "php" === e.language && "markup" === e.type && (e.content = e.content.replace(/(\{\{\{PHP[0-9]+\}\}\})/g, '<span class="token php">$1</span>')) }), r.languages.insertBefore("php", "comment", { markup: { pattern: /<[^?]\/?(.*?)>/, inside: r.languages.markup }, php: /\{\{\{PHP[0-9]+\}\}\}/ })), r.languages.python = { comment: { pattern: /(^|[^\\])#.*/, lookbehind: !0 }, string: /"""[\s\S]+?"""|'''[\s\S]+?'''|("|')(?:\\?.)*?\1/, "function": { pattern: /((?:^|\s)def[ \t]+)[a-zA-Z_][a-zA-Z0-9_]*(?=\()/g, lookbehind: !0 }, "class-name": { pattern: /(\bclass\s+)[a-z0-9_]+/i, lookbehind: !0 }, keyword: /\b(?:as|assert|async|await|break|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|pass|print|raise|return|try|while|with|yield)\b/, "boolean": /\b(?:True|False)\b/, number: /\b-?(?:0[bo])?(?:(?:\d|0x[\da-f])[\da-f]*\.?\d*|\.\d+)(?:e[+-]?\d+)?j?\b/i, operator: /[-+%=]=?|!=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]|\b(?:or|and|not)\b/, punctuation: /[{}[\];(),.:]/ }, function (e) { e.languages.ruby = e.languages.extend("clike", { comment: /#(?!\{[^\r\n]*?\}).*/, keyword: /\b(alias|and|BEGIN|begin|break|case|class|def|define_method|defined|do|each|else|elsif|END|end|ensure|false|for|if|in|module|new|next|nil|not|or|raise|redo|require|rescue|retry|return|self|super|then|throw|true|undef|unless|until|when|while|yield)\b/ }); var t = { pattern: /#\{[^}]+\}/, inside: { delimiter: { pattern: /^#\{|\}$/, alias: "tag" }, rest: e.util.clone(e.languages.ruby) } }; e.languages.insertBefore("ruby", "keyword", { regex: [{ pattern: /%r([^a-zA-Z0-9\s\{\(\[<])(?:[^\\]|\\[\s\S])*?\1[gim]{0,3}/, inside: { interpolation: t } }, { pattern: /%r\((?:[^()\\]|\\[\s\S])*\)[gim]{0,3}/, inside: { interpolation: t } }, { pattern: /%r\{(?:[^#{}\\]|#(?:\{[^}]+\})?|\\[\s\S])*\}[gim]{0,3}/, inside: { interpolation: t } }, { pattern: /%r\[(?:[^\[\]\\]|\\[\s\S])*\][gim]{0,3}/, inside: { interpolation: t } }, { pattern: /%r<(?:[^<>\\]|\\[\s\S])*>[gim]{0,3}/, inside: { interpolation: t } }, { pattern: /(^|[^/])\/(?!\/)(\[.+?]|\\.|[^/\r\n])+\/[gim]{0,3}(?=\s*($|[\r\n,.;})]))/, lookbehind: !0 }], variable: /[@$]+[a-zA-Z_][a-zA-Z_0-9]*(?:[?!]|\b)/, symbol: /:[a-zA-Z_][a-zA-Z_0-9]*(?:[?!]|\b)/ }), e.languages.insertBefore("ruby", "number", { builtin: /\b(Array|Bignum|Binding|Class|Continuation|Dir|Exception|FalseClass|File|Stat|File|Fixnum|Fload|Hash|Integer|IO|MatchData|Method|Module|NilClass|Numeric|Object|Proc|Range|Regexp|String|Struct|TMS|Symbol|ThreadGroup|Thread|Time|TrueClass)\b/, constant: /\b[A-Z][a-zA-Z_0-9]*(?:[?!]|\b)/ }), e.languages.ruby.string = [{ pattern: /%[qQiIwWxs]?([^a-zA-Z0-9\s\{\(\[<])(?:[^\\]|\\[\s\S])*?\1/, inside: { interpolation: t } }, { pattern: /%[qQiIwWxs]?\((?:[^()\\]|\\[\s\S])*\)/, inside: { interpolation: t } }, { pattern: /%[qQiIwWxs]?\{(?:[^#{}\\]|#(?:\{[^}]+\})?|\\[\s\S])*\}/, inside: { interpolation: t } }, { pattern: /%[qQiIwWxs]?\[(?:[^\[\]\\]|\\[\s\S])*\]/, inside: { interpolation: t } }, { pattern: /%[qQiIwWxs]?<(?:[^<>\\]|\\[\s\S])*>/, inside: { interpolation: t } }, { pattern: /("|')(#\{[^}]+\}|\\(?:\r?\n|\r)|\\?.)*?\1/, inside: { interpolation: t } }] }(r); var c = { isCodeSample: function (e) { return e && "PRE" === e.nodeName && -1 !== e.className.indexOf("language-") }, trimArg: function (a) { return function (e, t) { return a(t) } } }, g = function (e) { var t = e.selection.getNode(); return c.isCodeSample(t) ? t : null }, d = g, p = function (t, a, n) { t.undoManager.transact(function () { var e = g(t); n = i.DOM.encode(n), e ? (t.dom.setAttrib(e, "class", "language-" + a), e.innerHTML = n, r.highlightElement(e), t.selection.select(e)) : (t.insertContent('<pre id="__new" class="language-' + a + '">' + n + "</pre>"), t.selection.select(t.$("#__new").removeAttr("id")[0])) }) }, f = function (e) { var t = g(e); return t ? t.textContent : "" }, h = function (e) { var t = a(e); return t || [{ text: "HTML/XML", value: "markup" }, { text: "JavaScript", value: "javascript" }, { text: "CSS", value: "css" }, { text: "PHP", value: "php" }, { text: "Ruby", value: "ruby" }, { text: "Python", value: "python" }, { text: "Java", value: "java" }, { text: "C", value: "c" }, { text: "C#", value: "csharp" }, { text: "C++", value: "cpp" }] }, m = function (e) { var t, a = d(e); return a && (t = a.className.match(/language-(\w+)/)) ? t[1] : "" }, b = function (t) { var e = o(t), a = l(t), n = m(t), i = h(t), r = f(t); t.windowManager.open({ title: "Insert/Edit code sample", minWidth: e, minHeight: a, layout: "flex", direction: "column", align: "stretch", body: [{ type: "listbox", name: "language", label: "Language", maxWidth: 200, value: n, values: i }, { type: "textbox", name: "code", multiline: !0, spellcheck: !1, ariaLabel: "Code view", flex: 1, style: "direction: ltr; text-align: left", classes: "monospace", value: r, autofocus: !0 }], onSubmit: function (e) { p(t, e.data.language, e.data.code) } }) }, y = function (t) { t.addCommand("codesample", function () { var e = t.selection.getNode(); t.selection.isCollapsed() || c.isCodeSample(e) ? b(t) : t.formatter.toggle("code") }) }, v = function (a) { var i = a.$; a.on("PreProcess", function (e) { i("pre[contenteditable=false]", e.node).filter(c.trimArg(c.isCodeSample)).each(function (e, t) { var a = i(t), n = t.textContent; a.attr("class", i.trim(a.attr("class"))), a.removeAttr("contentEditable"), a.empty().append(i("<code></code>").each(function () { this.textContent = n })) }) }), a.on("SetContent", function () { var e = i("pre").filter(c.trimArg(c.isCodeSample)).filter(function (e, t) { return "false" !== t.contentEditable }); e.length && a.undoManager.transact(function () { e.each(function (e, t) { i(t).find("br").each(function (e, t) { t.parentNode.replaceChild(a.getDoc().createTextNode("\n"), t) }), t.contentEditable = !1, t.innerHTML = a.dom.encode(t.textContent), r.highlightElement(t), t.className = i.trim(t.className) }) }) }) }, k = function (e, t, a, n) { var i, r = s(e); e.inline && a.get() || !e.inline && n.get() || (e.inline ? a.set(!0) : n.set(!0), !1 !== r && (i = e.dom.create("link", { rel: "stylesheet", href: r || t + "/css/prism.css" }), e.getDoc().getElementsByTagName("head")[0].appendChild(i))) }, w = function (e) { e.addButton("codesample", { cmd: "codesample", title: "Insert/Edit code sample" }), e.addMenuItem("codesample", { cmd: "codesample", text: "Code sample", icon: "codesample" }) }, x = n(!1); e.add("codesample", function (t, e) { var a = n(!1); v(t), w(t), y(t), t.on("init", function () { k(t, e, x, a) }), t.on("dblclick", function (e) { c.isCodeSample(e.target) && b(t) }) }) }();
!function () { "use strict"; var e = tinymce.util.Tools.resolve("tinymce.PluginManager"), l = tinymce.util.Tools.resolve("tinymce.util.Color"), a = function (e, n) { e.find("#preview")[0].getEl().style.background = n }, o = function (e, n) { var i = l(n), t = i.toRgb(); e.fromJSON({ r: t.r, g: t.g, b: t.b, hex: i.toHex().substr(1) }), a(e, i.toHex()) }, t = function (e, n, i) { var t = e.windowManager.open({ title: "Color", items: { type: "container", layout: "flex", direction: "row", align: "stretch", padding: 5, spacing: 10, items: [{ type: "colorpicker", value: i, onchange: function () { var e = this.rgb(); t && (t.find("#r").value(e.r), t.find("#g").value(e.g), t.find("#b").value(e.b), t.find("#hex").value(this.value().substr(1)), a(t, this.value())) } }, { type: "form", padding: 0, labelGap: 5, defaults: { type: "textbox", size: 7, value: "0", flex: 1, spellcheck: !1, onchange: function () { var e, n, i = t.find("colorpicker")[0]; if (e = this.name(), n = this.value(), "hex" === e) return o(t, n = "#" + n), void i.value(n); n = { r: t.find("#r").value(), g: t.find("#g").value(), b: t.find("#b").value() }, i.value(n), o(t, n) } }, items: [{ name: "r", label: "R", autofocus: 1 }, { name: "g", label: "G" }, { name: "b", label: "B" }, { name: "hex", label: "#", value: "000000" }, { name: "preview", type: "container", border: 1 }] }] }, onSubmit: function () { n("#" + t.toJSON().hex) } }); o(t, i) }; e.add("colorpicker", function (i) { i.settings.color_picker_callback || (i.settings.color_picker_callback = function (e, n) { t(i, e, n) }) }) }();
!function () { "use strict"; var o = function (t) { var n = t, e = function () { return n }; return { get: e, set: function (t) { n = t }, clone: function () { return o(e()) } } }, t = tinymce.util.Tools.resolve("tinymce.PluginManager"), i = function (t) { return { isContextMenuVisible: function () { return t.get() } } }, r = function (t) { return t.settings.contextmenu_never_use_native }, u = function (t) { return t.getParam("contextmenu", "link openlink image inserttable | cell row column deletetable") }, l = tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"), s = function (t) { return l.DOM.select(t.settings.ui_container)[0] }, a = function (t, n) { return { x: t, y: n } }, f = function (t, n, e) { return a(t.x + n, t.y + e) }, m = function (t, n) { if (t && "static" !== l.DOM.getStyle(t, "position", !0)) { var e = l.DOM.getPos(t), o = e.x - t.scrollLeft, i = e.y - t.scrollTop; return f(n, -o, -i) } return f(n, 0, 0) }, c = function (t, n) { if (t.inline) return m(s(t), a((u = n).pageX, u.pageY)); var e, o, i, r, u, c = (e = t.getContentAreaContainer(), o = a((r = n).clientX, r.clientY), i = l.DOM.getPos(e), f(o, i.x, i.y)); return m(s(t), c) }, g = tinymce.util.Tools.resolve("tinymce.ui.Factory"), v = tinymce.util.Tools.resolve("tinymce.util.Tools"), y = function (t, n, e, o) { null === o.get() ? o.set(function (e, n) { var t, o, i = []; o = u(e), v.each(o.split(/[ ,]/), function (t) { var n = e.menuItems[t]; "|" === t && (n = { text: t }), n && (n.shortcut = "", i.push(n)) }); for (var r = 0; r < i.length; r++)"|" === i[r].text && (0 !== r && r !== i.length - 1 || i.splice(r, 1)); return (t = g.create("menu", { items: i, context: "contextmenu", classes: "contextmenu" })).uiContainer = s(e), t.renderTo(s(e)), t.on("hide", function (t) { t.control === this && n.set(!1) }), e.on("remove", function () { t.remove(), t = null }), t }(t, e)) : o.get().show(), o.get().moveTo(n.x, n.y), e.set(!0) }, x = function (e, o, i) { e.on("contextmenu", function (t) { var n; n = e, (!t.ctrlKey || r(n)) && (t.preventDefault(), y(e, c(e, t), o, i)) }) }; t.add("contextmenu", function (t) { var n = o(null), e = o(!1); return x(t, e, n), i(e) }) }();
!function () { "use strict"; var t = tinymce.util.Tools.resolve("tinymce.PluginManager"), c = tinymce.util.Tools.resolve("tinymce.util.Tools"), e = function (t, e) { var i, n = t.dom, o = t.selection.getSelectedBlocks(); o.length && (i = n.getAttrib(o[0], "dir"), c.each(o, function (t) { n.getParent(t.parentNode, '*[dir="' + e + '"]', n.getRoot()) || n.setAttrib(t, "dir", i !== e ? e : null) }), t.nodeChanged()) }, i = function (t) { t.addCommand("mceDirectionLTR", function () { e(t, "ltr") }), t.addCommand("mceDirectionRTL", function () { e(t, "rtl") }) }, n = function (e) { var i = []; return c.each("h1 h2 h3 h4 h5 h6 div p".split(" "), function (t) { i.push(t + "[dir=" + e + "]") }), i.join(",") }, o = function (t) { t.addButton("ltr", { title: "Left to right", cmd: "mceDirectionLTR", stateSelector: n("ltr") }), t.addButton("rtl", { title: "Right to left", cmd: "mceDirectionRTL", stateSelector: n("rtl") }) }; t.add("directionality", function (t) { i(t), o(t) }) }();
!function () { "use strict"; var t = tinymce.util.Tools.resolve("tinymce.PluginManager"), e = tinymce.util.Tools.resolve("tinymce.util.Tools"), n = [["cool", "cry", "embarassed", "foot-in-mouth"], ["frown", "innocent", "kiss", "laughing"], ["money-mouth", "sealed", "smile", "surprised"], ["tongue-out", "undecided", "wink", "yell"]], i = function (i) { var o; return o = '<table role="list" class="mce-grid">', e.each(n, function (t) { o += "<tr>", e.each(t, function (t) { var e = i + "/img/smiley-" + t + ".gif"; o += '<td><a href="#" data-mce-url="' + e + '" data-mce-alt="' + t + '" tabindex="-1" role="option" aria-label="' + t + '"><img src="' + e + '" style="width: 18px; height: 18px" role="presentation" /></a></td>' }), o += "</tr>" }), o += "</table>" }, o = function (a, t) { var e = i(t); a.addButton("emoticons", { type: "panelbutton", panel: { role: "application", autohide: !0, html: e, onclick: function (t) { var e, i, o, n = a.dom.getParent(t.target, "a"); n && (e = a, i = n.getAttribute("data-mce-url"), o = n.getAttribute("data-mce-alt"), e.insertContent(e.dom.createHTML("img", { src: i, alt: o })), this.hide()) } }, tooltip: "Emoticons" }) }; t.add("emoticons", function (t, e) { o(t, e) }) }();
!function () { "use strict"; var l = function (e) { var t = e, n = function () { return t }; return { get: n, set: function (e) { t = e }, clone: function () { return l(n()) } } }, e = tinymce.util.Tools.resolve("tinymce.PluginManager"), g = tinymce.util.Tools.resolve("tinymce.util.Tools"), t = tinymce.util.Tools.resolve("tinymce.html.DomParser"), f = tinymce.util.Tools.resolve("tinymce.html.Node"), m = tinymce.util.Tools.resolve("tinymce.html.Serializer"), h = function (e) { return e.getParam("fullpage_hide_in_source_view") }, r = function (e) { return e.getParam("fullpage_default_xml_pi") }, o = function (e) { return e.getParam("fullpage_default_encoding") }, a = function (e) { return e.getParam("fullpage_default_font_family") }, c = function (e) { return e.getParam("fullpage_default_font_size") }, s = function (e) { return e.getParam("fullpage_default_text_color") }, u = function (e) { return e.getParam("fullpage_default_title") }, d = function (e) { return e.getParam("fullpage_default_doctype", "<!DOCTYPE html>") }, p = function (e) { return t({ validate: !1, root_name: "#document" }).parse(e) }, y = p, v = function (e, t) { var n, l, i = p(t), r = {}; function o(e, t) { return e.attr(t) || "" } return r.fontface = a(e), r.fontsize = c(e), 7 === (n = i.firstChild).type && (r.xml_pi = !0, (l = /encoding="([^"]+)"/.exec(n.value)) && (r.docencoding = l[1])), (n = i.getAll("#doctype")[0]) && (r.doctype = "<!DOCTYPE" + n.value + ">"), (n = i.getAll("title")[0]) && n.firstChild && (r.title = n.firstChild.value), g.each(i.getAll("meta"), function (e) { var t, n = e.attr("name"), l = e.attr("http-equiv"); n ? r[n.toLowerCase()] = e.attr("content") : "Content-Type" === l && (t = /charset\s*=\s*(.*)\s*/gi.exec(e.attr("content"))) && (r.docencoding = t[1]) }), (n = i.getAll("html")[0]) && (r.langcode = o(n, "lang") || o(n, "xml:lang")), r.stylesheets = [], g.each(i.getAll("link"), function (e) { "stylesheet" === e.attr("rel") && r.stylesheets.push(e.attr("href")) }), (n = i.getAll("body")[0]) && (r.langdir = o(n, "dir"), r.style = o(n, "style"), r.visited_color = o(n, "vlink"), r.link_color = o(n, "link"), r.active_color = o(n, "alink")), r }, _ = function (e, r, t) { var o, n, l, a, i, c = e.dom; function s(e, t, n) { e.attr(t, n || undefined) } function u(e) { n.firstChild ? n.insert(e, n.firstChild) : n.append(e) } o = p(t), (n = o.getAll("head")[0]) || (a = o.getAll("html")[0], n = new f("head", 1), a.firstChild ? a.insert(n, a.firstChild, !0) : a.append(n)), a = o.firstChild, r.xml_pi ? (i = 'version="1.0"', r.docencoding && (i += ' encoding="' + r.docencoding + '"'), 7 !== a.type && (a = new f("xml", 7), o.insert(a, o.firstChild, !0)), a.value = i) : a && 7 === a.type && a.remove(), a = o.getAll("#doctype")[0], r.doctype ? (a || (a = new f("#doctype", 10), r.xml_pi ? o.insert(a, o.firstChild) : u(a)), a.value = r.doctype.substring(9, r.doctype.length - 1)) : a && a.remove(), a = null, g.each(o.getAll("meta"), function (e) { "Content-Type" === e.attr("http-equiv") && (a = e) }), r.docencoding ? (a || ((a = new f("meta", 1)).attr("http-equiv", "Content-Type"), a.shortEnded = !0, u(a)), a.attr("content", "text/html; charset=" + r.docencoding)) : a && a.remove(), a = o.getAll("title")[0], r.title ? (a ? a.empty() : u(a = new f("title", 1)), a.append(new f("#text", 3)).value = r.title) : a && a.remove(), g.each("keywords,description,author,copyright,robots".split(","), function (e) { var t, n, l = o.getAll("meta"), i = r[e]; for (t = 0; t < l.length; t++)if ((n = l[t]).attr("name") === e) return void (i ? n.attr("content", i) : n.remove()); i && ((a = new f("meta", 1)).attr("name", e), a.attr("content", i), a.shortEnded = !0, u(a)) }); var d = {}; return g.each(o.getAll("link"), function (e) { "stylesheet" === e.attr("rel") && (d[e.attr("href")] = e) }), g.each(r.stylesheets, function (e) { d[e] || ((a = new f("link", 1)).attr({ rel: "stylesheet", text: "text/css", href: e }), a.shortEnded = !0, u(a)), delete d[e] }), g.each(d, function (e) { e.remove() }), (a = o.getAll("body")[0]) && (s(a, "dir", r.langdir), s(a, "style", r.style), s(a, "vlink", r.visited_color), s(a, "link", r.link_color), s(a, "alink", r.active_color), c.setAttribs(e.getBody(), { style: r.style, dir: r.dir, vLink: r.visited_color, link: r.link_color, aLink: r.active_color })), (a = o.getAll("html")[0]) && (s(a, "lang", r.langcode), s(a, "xml:lang", r.langcode)), n.firstChild || n.remove(), (l = m({ validate: !1, indent: !0, apply_source_formatting: !0, indent_before: "head,html,body,meta,title,script,link,style", indent_after: "head,html,body,meta,title,script,link,style" }).serialize(o)).substring(0, l.indexOf("</body>")) }, n = function (n, l) { var i = v(n, l.get()); n.windowManager.open({ title: "Document properties", data: i, defaults: { type: "textbox", size: 40 }, body: [{ name: "title", label: "Title" }, { name: "keywords", label: "Keywords" }, { name: "description", label: "Description" }, { name: "robots", label: "Robots" }, { name: "author", label: "Author" }, { name: "docencoding", label: "Encoding" }], onSubmit: function (e) { var t = _(n, g.extend(i, e.data), l.get()); l.set(t) } }) }, i = function (e, t) { e.addCommand("mceFullPageProperties", function () { n(e, t) }) }, b = function (e, t) { return g.each(e, function (e) { t = t.replace(e, function (e) { return "\x3c!--mce:protected " + escape(e) + "--\x3e" }) }), t }, x = function (e) { return e.replace(/<!--mce:protected ([\s\S]*?)-->/g, function (e, t) { return unescape(t) }) }, k = g.each, C = function (e) { return e.replace(/<\/?[A-Z]+/g, function (e) { return e.toLowerCase() }) }, A = function (e) { var t, n = "", l = ""; if (r(e)) { var i = o(e); n += '<?xml version="1.0" encoding="' + (i || "ISO-8859-1") + '" ?>\n' } return n += d(e), n += "\n<html>\n<head>\n", (t = u(e)) && (n += "<title>" + t + "</title>\n"), (t = o(e)) && (n += '<meta http-equiv="Content-Type" content="text/html; charset=' + t + '" />\n'), (t = a(e)) && (l += "font-family: " + t + ";"), (t = c(e)) && (l += "font-size: " + t + ";"), (t = s(e)) && (l += "color: " + t + ";"), n += "</head>\n<body" + (l ? ' style="' + l + '"' : "") + ">\n" }, w = function (r, o, a) { r.on("BeforeSetContent", function (e) { !function (e, t, n, l) { var i, r, o, a, c, s = "", u = e.dom; if (!(l.selection || (o = b(e.settings.protect, l.content), "raw" === l.format && t.get() || l.source_view && h(e)))) { 0 !== o.length || l.source_view || (o = g.trim(t.get()) + "\n" + g.trim(o) + "\n" + g.trim(n.get())), -1 !== (i = (o = o.replace(/<(\/?)BODY/gi, "<$1body")).indexOf("<body")) ? (i = o.indexOf(">", i), t.set(C(o.substring(0, i + 1))), -1 === (r = o.indexOf("</body", i)) && (r = o.length), l.content = g.trim(o.substring(i + 1, r)), n.set(C(o.substring(r)))) : (t.set(A(e)), n.set("\n</body>\n</html>")), a = y(t.get()), k(a.getAll("style"), function (e) { e.firstChild && (s += e.firstChild.value) }), (c = a.getAll("body")[0]) && u.setAttribs(e.getBody(), { style: c.attr("style") || "", dir: c.attr("dir") || "", vLink: c.attr("vlink") || "", link: c.attr("link") || "", aLink: c.attr("alink") || "" }), u.remove("fullpage_styles"); var d = e.getDoc().getElementsByTagName("head")[0]; s && (u.add(d, "style", { id: "fullpage_styles" }, s), (c = u.get("fullpage_styles")).styleSheet && (c.styleSheet.cssText = s)); var f = {}; g.each(d.getElementsByTagName("link"), function (e) { "stylesheet" === e.rel && e.getAttribute("data-mce-fullpage") && (f[e.href] = e) }), g.each(a.getAll("link"), function (e) { var t = e.attr("href"); if (!t) return !0; f[t] || "stylesheet" !== e.attr("rel") || u.add(d, "link", { rel: "stylesheet", text: "text/css", href: t, "data-mce-fullpage": "1" }), delete f[t] }), g.each(f, function (e) { e.parentNode.removeChild(e) }) } }(r, o, a, e) }), r.on("GetContent", function (e) { var t, n, l, i; t = r, n = o.get(), l = a.get(), (i = e).selection || i.source_view && h(t) || (i.content = x(g.trim(n) + "\n" + g.trim(i.content) + "\n" + g.trim(l))) }) }, P = function (e) { e.addButton("fullpage", { title: "Document properties", cmd: "mceFullPageProperties" }), e.addMenuItem("fullpage", { text: "Document properties", cmd: "mceFullPageProperties", context: "file" }) }; e.add("fullpage", function (e) { var t = l(""), n = l(""); i(e, t), P(e), w(e, t, n) }) }();
!function () { "use strict"; var i = function (e) { var n = e, t = function () { return n }; return { get: t, set: function (e) { n = e }, clone: function () { return i(t()) } } }, e = tinymce.util.Tools.resolve("tinymce.PluginManager"), t = function (e) { return { isFullscreen: function () { return null !== e.get() } } }, n = tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"), m = function (e, n) { e.fire("FullscreenStateChanged", { state: n }) }, g = n.DOM, r = function (e, n) { var t, r, l, i, o, c, s = document.body, u = document.documentElement, d = n.get(), a = function () { var e, n, t, i; g.setStyle(l, "height", (t = window, i = document.body, i.offsetWidth && (e = i.offsetWidth, n = i.offsetHeight), t.innerWidth && t.innerHeight && (e = t.innerWidth, n = t.innerHeight), { w: e, h: n }).h - (r.clientHeight - l.clientHeight)) }, h = function () { g.unbind(window, "resize", a) }; if (t = (r = e.getContainer()).style, i = (l = e.getContentAreaContainer().firstChild).style, d) i.width = d.iframeWidth, i.height = d.iframeHeight, d.containerWidth && (t.width = d.containerWidth), d.containerHeight && (t.height = d.containerHeight), g.removeClass(s, "mce-fullscreen"), g.removeClass(u, "mce-fullscreen"), g.removeClass(r, "mce-fullscreen"), o = d.scrollPos, window.scrollTo(o.x, o.y), g.unbind(window, "resize", d.resizeHandler), e.off("remove", d.removeHandler), n.set(null), m(e, !1); else { var f = { scrollPos: (c = g.getViewPort(), { x: c.x, y: c.y }), containerWidth: t.width, containerHeight: t.height, iframeWidth: i.width, iframeHeight: i.height, resizeHandler: a, removeHandler: h }; i.width = i.height = "100%", t.width = t.height = "", g.addClass(s, "mce-fullscreen"), g.addClass(u, "mce-fullscreen"), g.addClass(r, "mce-fullscreen"), g.bind(window, "resize", a), e.on("remove", h), a(), n.set(f), m(e, !0) } }, l = function (e, n) { e.addCommand("mceFullScreen", function () { r(e, n) }) }, o = function (t) { return function (e) { var n = e.control; t.on("FullscreenStateChanged", function (e) { n.active(e.state) }) } }, c = function (e) { e.addMenuItem("fullscreen", { text: "Fullscreen", shortcut: "Ctrl+Shift+F", selectable: !0, cmd: "mceFullScreen", onPostRender: o(e), context: "view" }), e.addButton("fullscreen", { active: !1, tooltip: "Fullscreen", cmd: "mceFullScreen", onPostRender: o(e) }) }; e.add("fullscreen", function (e) { var n = i(null); return e.settings.inline || (l(e, n), c(e), e.addShortcut("Ctrl+Shift+F", "", "mceFullScreen")), t(n) }) }();
!function () { "use strict"; var e, t, n, r, o, a, i = tinymce.util.Tools.resolve("tinymce.PluginManager"), u = function (e) { return function () { return e } }, c = { noop: function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t] }, noarg: function (n) { return function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; return n() } }, compose: function (n, r) { return function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; return n(r.apply(null, arguments)) } }, constant: u, identity: function (e) { return e }, tripleEquals: function (e, t) { return e === t }, curry: function (a) { for (var e = [], t = 1; t < arguments.length; t++)e[t - 1] = arguments[t]; for (var i = new Array(arguments.length - 1), n = 1; n < arguments.length; n++)i[n - 1] = arguments[n]; return function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; for (var n = new Array(arguments.length), r = 0; r < n.length; r++)n[r] = arguments[r]; var o = i.concat(n); return a.apply(null, o) } }, not: function (n) { return function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; return !n.apply(null, arguments) } }, die: function (e) { return function () { throw new Error(e) } }, apply: function (e) { return e() }, call: function (e) { e() }, never: u(!1), always: u(!0) }, l = c.never, s = c.always, f = function () { return m }, m = (r = { fold: function (e, t) { return e() }, is: l, isSome: l, isNone: s, getOr: n = function (e) { return e }, getOrThunk: t = function (e) { return e() }, getOrDie: function (e) { throw new Error(e || "error: getOrDie called on none.") }, or: n, orThunk: t, map: f, ap: f, each: function () { }, bind: f, flatten: f, exists: l, forall: s, filter: f, equals: e = function (e) { return e.isNone() }, equals_: e, toArray: function () { return [] }, toString: c.constant("none()") }, Object.freeze && Object.freeze(r), r), p = function (n) { var e = function () { return n }, t = function () { return o }, r = function (e) { return e(n) }, o = { fold: function (e, t) { return t(n) }, is: function (e) { return n === e }, isSome: s, isNone: l, getOr: e, getOrThunk: e, getOrDie: e, or: t, orThunk: t, map: function (e) { return p(e(n)) }, ap: function (e) { return e.fold(f, function (e) { return p(e(n)) }) }, each: function (e) { e(n) }, bind: r, flatten: e, exists: r, forall: r, filter: function (e) { return e(n) ? o : m }, equals: function (e) { return e.is(n) }, equals_: function (e, t) { return e.fold(l, function (e) { return t(n, e) }) }, toArray: function () { return [n] }, toString: function () { return "some(" + n + ")" } }; return o }, y = { some: p, none: f, from: function (e) { return null === e || e === undefined ? m : p(e) } }, d = function (t) { return function (e) { return function (e) { if (null === e) return "null"; var t = typeof e; return "object" === t && Array.prototype.isPrototypeOf(e) ? "array" : "object" === t && String.prototype.isPrototypeOf(e) ? "string" : t }(e) === t } }, h = { isString: d("string"), isObject: d("object"), isArray: d("array"), isNull: d("null"), isBoolean: d("boolean"), isUndefined: d("undefined"), isFunction: d("function"), isNumber: d("number") }, g = (o = Array.prototype.indexOf) === undefined ? function (e, t) { return x(e, t) } : function (e, t) { return o.call(e, t) }, k = function (e, t) { return -1 < g(e, t) }, v = function (e, t) { for (var n = e.length, r = new Array(n), o = 0; o < n; o++) { var a = e[o]; r[o] = t(a, o, e) } return r }, b = function (e, t) { for (var n = [], r = 0, o = e.length; r < o; r++) { var a = e[r]; t(a, r, e) && n.push(a) } return n }, x = function (e, t) { for (var n = 0, r = e.length; n < r; ++n)if (e[n] === t) return n; return -1 }, w = (Array.prototype.push, Array.prototype.slice, h.isFunction(Array.from) && Array.from, v), A = b, C = function (e, t) { for (var n = 0, r = e.length; n < r; n++) { var o = e[n]; if (t(o, n, e)) return y.some(o) } return y.none() }, S = k, P = tinymce.util.Tools.resolve("tinymce.util.I18n"), T = tinymce.util.Tools.resolve("tinymce.Env"), O = T.mac ? "\u2318" : "Ctrl", _ = T.mac ? "Ctrl + Alt" : "Shift + Alt", F = { shortcuts: [{ shortcut: O + " + B", action: "Bold" }, { shortcut: O + " + I", action: "Italic" }, { shortcut: O + " + U", action: "Underline" }, { shortcut: O + " + A", action: "Select all" }, { shortcut: O + " + Y or " + O + " + Shift + Z", action: "Redo" }, { shortcut: O + " + Z", action: "Undo" }, { shortcut: _ + " + 1", action: "Header 1" }, { shortcut: _ + " + 2", action: "Header 2" }, { shortcut: _ + " + 3", action: "Header 3" }, { shortcut: _ + " + 4", action: "Header 4" }, { shortcut: _ + " + 5", action: "Header 5" }, { shortcut: _ + " + 6", action: "Header 6" }, { shortcut: _ + " + 7", action: "Paragraph" }, { shortcut: _ + " + 8", action: "Div" }, { shortcut: _ + " + 9", action: "Address" }, { shortcut: "Alt + F9", action: "Focus to menubar" }, { shortcut: "Alt + F10", action: "Focus to toolbar" }, { shortcut: "Alt + F11", action: "Focus to element path" }, { shortcut: "Ctrl + Shift + P > Ctrl + Shift + P", action: "Focus to contextual toolbar" }, { shortcut: O + " + K", action: "Insert link (if link plugin activated)" }, { shortcut: O + " + S", action: "Save (if save plugin activated)" }, { shortcut: O + " + F", action: "Find (if searchreplace plugin activated)" }] }, H = function () { var e = w(F.shortcuts, function (e) { return '<tr data-mce-tabstop="1" tabindex="-1" aria-label="Action: ' + (t = e).action + ", Shortcut: " + t.shortcut.replace(/Ctrl/g, "Control") + '"><td>' + P.translate(e.action) + "</td><td>" + e.shortcut + "</td></tr>"; var t }).join(""); return { title: "Handy Shortcuts", type: "container", style: "overflow-y: auto; overflow-x: hidden; max-height: 250px", items: [{ type: "container", html: '<div><table class="mce-table-striped"><thead><th>' + P.translate("Action") + "</th><th>" + P.translate("Shortcut") + "</th></thead>" + e + "</table></div>" }] } }, M = (a = Object.keys) === undefined ? function (e) { var t = []; for (var n in e) e.hasOwnProperty(n) && t.push(n); return t } : a, E = function (e, t) { for (var n = M(e), r = 0, o = n.length; r < o; r++) { var a = n[r]; t(e[a], a, e) } }, j = function (r, o) { var a = {}; return E(r, function (e, t) { var n = o(e, t, r); a[n.k] = n.v }), a }, I = function (e, n) { var r = []; return E(e, function (e, t) { r.push(n(e, t)) }), r }, B = function (e) { return I(e, function (e) { return e }) }, L = { bifilter: function (e, n) { var r = {}, o = {}; return E(e, function (e, t) { (n(e, t) ? r : o)[t] = e }), { t: r, f: o } }, each: E, map: function (e, r) { return j(e, function (e, t, n) { return { k: t, v: r(e, t, n) } }) }, mapToArray: I, tupleMap: j, find: function (e, t) { for (var n = M(e), r = 0, o = n.length; r < o; r++) { var a = n[r], i = e[a]; if (t(i, a, e)) return y.some(i) } return y.none() }, keys: M, values: B, size: function (e) { return B(e).length } }, N = [{ key: "advlist", name: "Advanced List" }, { key: "anchor", name: "Anchor" }, { key: "autolink", name: "Autolink" }, { key: "autoresize", name: "Autoresize" }, { key: "autosave", name: "Autosave" }, { key: "bbcode", name: "BBCode" }, { key: "charmap", name: "Character Map" }, { key: "code", name: "Code" }, { key: "codesample", name: "Code Sample" }, { key: "colorpicker", name: "Color Picker" }, { key: "compat3x", name: "3.x Compatibility" }, { key: "contextmenu", name: "Context Menu" }, { key: "directionality", name: "Directionality" }, { key: "emoticons", name: "Emoticons" }, { key: "fullpage", name: "Full Page" }, { key: "fullscreen", name: "Full Screen" }, { key: "help", name: "Help" }, { key: "hr", name: "Horizontal Rule" }, { key: "image", name: "Image" }, { key: "imagetools", name: "Image Tools" }, { key: "importcss", name: "Import CSS" }, { key: "insertdatetime", name: "Insert Date/Time" }, { key: "legacyoutput", name: "Legacy Output" }, { key: "link", name: "Link" }, { key: "lists", name: "Lists" }, { key: "media", name: "Media" }, { key: "nonbreaking", name: "Nonbreaking" }, { key: "noneditable", name: "Noneditable" }, { key: "pagebreak", name: "Page Break" }, { key: "paste", name: "Paste" }, { key: "preview", name: "Preview" }, { key: "print", name: "Print" }, { key: "save", name: "Save" }, { key: "searchreplace", name: "Search and Replace" }, { key: "spellchecker", name: "Spell Checker" }, { key: "tabfocus", name: "Tab Focus" }, { key: "table", name: "Table" }, { key: "template", name: "Template" }, { key: "textcolor", name: "Text Color" }, { key: "textpattern", name: "Text Pattern" }, { key: "toc", name: "Table of Contents" }, { key: "visualblocks", name: "Visual Blocks" }, { key: "visualchars", name: "Visual Characters" }, { key: "wordcount", name: "Word Count" }], z = c.curry(function (e, o) { return e.replace(/\${([^{}]*)}/g, function (e, t) { var n, r = o[t]; return "string" == (n = typeof r) || "number" === n ? r : e }) }, '<a href="${url}" target="_blank" rel="noopener">${name}</a>'), D = function (r) { var e, t, n = (e = r, t = L.keys(e.plugins), e.settings.forced_plugins === undefined ? t : A(t, c.not(c.curry(S, e.settings.forced_plugins)))), o = w(n, function (e) { return "<li>" + (t = r, n = e, C(N, function (e) { return e.key === n }).fold(function () { var e = t.plugins[n].getMetadata; return "function" == typeof e ? z(e()) : n }, function (e) { return z({ name: e.name, url: "https://www.tinymce.com/docs/plugins/" + e.key }) })) + "</li>"; var t, n }), a = o.length, i = o.join(""); return "<p><b>" + P.translate(["Plugins installed ({0}):", a]) + "</b></p><ul>" + i + "</ul>" }, q = function (e) { return { title: "Plugins", type: "container", style: "overflow-y: auto; overflow-x: hidden;", layout: "flex", padding: 10, spacing: 10, items: [(t = e, { type: "container", html: '<div style="overflow-y: auto; overflow-x: hidden; max-height: 230px; height: 230px;" data-mce-tabstop="1" tabindex="-1">' + D(t) + "</div>", flex: 1 }), { type: "container", html: '<div style="padding: 10px; background: #e3e7f4; height: 100%;" data-mce-tabstop="1" tabindex="-1"><p><b>' + P.translate("Premium plugins:") + '</b></p><ul><li>PowerPaste</li><li>Spell Checker Pro</li><li>Accessibility Checker</li><li>Advanced Code Editor</li><li>Enhanced Media Embed</li><li>Link Checker</li></ul><br /><p style="float: right;"><a href="https://www.tinymce.com/pricing/?utm_campaign=editor_referral&utm_medium=help_dialog&utm_source=tinymce" target="_blank">' + P.translate("Learn more...") + "</a></p></div>", flex: 1 }] }; var t }, R = tinymce.util.Tools.resolve("tinymce.EditorManager"), U = function () { var e, t, n = '<a href="https://www.tinymce.com/docs/changelog/?utm_campaign=editor_referral&utm_medium=help_dialog&utm_source=tinymce" target="_blank">TinyMCE ' + (e = R.majorVersion, t = R.minorVersion, 0 === e.indexOf("@") ? "X.X.X" : e + "." + t) + "</a>"; return [{ type: "label", html: P.translate(["You are using {0}", n]) }, { type: "spacer", flex: 1 }, { text: "Close", onclick: function () { this.parent().parent().close() } }] }, V = function (e, t) { return function () { e.windowManager.open({ title: "Help", bodyType: "tabpanel", layout: "flex", body: [H(), q(e)], buttons: U(), onPostRender: function () { this.getEl("title").innerHTML = '<img src="' + t + '/img/logo.png" alt="TinyMCE Logo" style="display: inline-block; width: 200px; height: 50px">' } }) } }, X = function (e, t) { e.addCommand("mceHelp", V(e, t)) }, $ = function (e, t) { e.addButton("help", { icon: "help", onclick: V(e, t) }), e.addMenuItem("help", { text: "Help", icon: "help", context: "help", onclick: V(e, t) }) }; i.add("help", function (e, t) { $(e, t), X(e, t), e.shortcuts.add("Alt+0", "Open help dialog", "mceHelp") }) }();
!function () { "use strict"; var n = tinymce.util.Tools.resolve("tinymce.PluginManager"), t = function (n) { n.addCommand("InsertHorizontalRule", function () { n.execCommand("mceInsertContent", !1, "<hr />") }) }, o = function (n) { n.addButton("hr", { icon: "hr", tooltip: "Horizontal line", cmd: "InsertHorizontalRule" }), n.addMenuItem("hr", { icon: "hr", text: "Horizontal line", cmd: "InsertHorizontalRule", context: "insert" }) }; n.add("hr", function (n) { t(n), o(n) }) }();
!function () { "use strict"; var e = tinymce.util.Tools.resolve("tinymce.PluginManager"), d = { hasDimensions: function (e) { return !1 !== e.settings.image_dimensions }, hasAdvTab: function (e) { return !0 === e.settings.image_advtab }, getPrependUrl: function (e) { return e.getParam("image_prepend_url", "") }, getClassList: function (e) { return e.getParam("image_class_list") }, hasDescription: function (e) { return !1 !== e.settings.image_description }, hasImageTitle: function (e) { return !0 === e.settings.image_title }, hasImageCaption: function (e) { return !0 === e.settings.image_caption }, getImageList: function (e) { return e.getParam("image_list", !1) }, hasUploadUrl: function (e) { return e.getParam("images_upload_url", !1) }, hasUploadHandler: function (e) { return e.getParam("images_upload_handler", !1) }, getUploadUrl: function (e) { return e.getParam("images_upload_url") }, getUploadHandler: function (e) { return e.getParam("images_upload_handler") }, getUploadBasePath: function (e) { return e.getParam("images_upload_base_path") }, getUploadCredentials: function (e) { return e.getParam("images_upload_credentials") } }, a = "undefined" != typeof window ? window : Function("return this;")(), r = function (e, t) { for (var n = t !== undefined && null !== t ? t : a, r = 0; r < e.length && n !== undefined && null !== n; ++r)n = n[e[r]]; return n }, i = function (e, t) { var n = e.split("."); return r(n, t) }, t = { getOrDie: function (e, t) { var n = i(e, t); if (n === undefined || null === n) throw e + " not available on this browser"; return n } }; function o() { return new (t.getOrDie("FileReader")) } var n = tinymce.util.Tools.resolve("tinymce.util.Promise"), f = tinymce.util.Tools.resolve("tinymce.util.Tools"), l = tinymce.util.Tools.resolve("tinymce.util.XHR"), u = function (e, t) { return Math.max(parseInt(e, 10), parseInt(t, 10)) }, g = { getImageSize: function (e, n) { var r = document.createElement("img"); function t(e, t) { r.parentNode && r.parentNode.removeChild(r), n({ width: e, height: t }) } r.onload = function () { t(u(r.width, r.clientWidth), u(r.height, r.clientHeight)) }, r.onerror = function () { t(0, 0) }; var a = r.style; a.visibility = "hidden", a.position = "fixed", a.bottom = a.left = "0px", a.width = a.height = "auto", document.body.appendChild(r), r.src = e }, buildListItems: function (e, a, t) { return function n(e, r) { return r = r || [], f.each(e, function (e) { var t = { text: e.text || e.title }; e.menu ? t.menu = n(e.menu) : (t.value = e.value, a(t)), r.push(t) }), r }(e, t || []) }, removePixelSuffix: function (e) { return e && (e = e.replace(/px$/, "")), e }, addPixelSuffix: function (e) { return 0 < e.length && /^[0-9]+$/.test(e) && (e += "px"), e }, mergeMargins: function (e) { if (e.margin) { var t = e.margin.split(" "); switch (t.length) { case 1: e["margin-top"] = e["margin-top"] || t[0], e["margin-right"] = e["margin-right"] || t[0], e["margin-bottom"] = e["margin-bottom"] || t[0], e["margin-left"] = e["margin-left"] || t[0]; break; case 2: e["margin-top"] = e["margin-top"] || t[0], e["margin-right"] = e["margin-right"] || t[1], e["margin-bottom"] = e["margin-bottom"] || t[0], e["margin-left"] = e["margin-left"] || t[1]; break; case 3: e["margin-top"] = e["margin-top"] || t[0], e["margin-right"] = e["margin-right"] || t[1], e["margin-bottom"] = e["margin-bottom"] || t[2], e["margin-left"] = e["margin-left"] || t[1]; break; case 4: e["margin-top"] = e["margin-top"] || t[0], e["margin-right"] = e["margin-right"] || t[1], e["margin-bottom"] = e["margin-bottom"] || t[2], e["margin-left"] = e["margin-left"] || t[3] }delete e.margin } return e }, createImageList: function (e, t) { var n = d.getImageList(e); "string" == typeof n ? l.send({ url: n, success: function (e) { t(JSON.parse(e)) } }) : "function" == typeof n ? n(t) : t(n) }, waitLoadImage: function (e, t, n) { function r() { n.onload = n.onerror = null, e.selection && (e.selection.select(n), e.nodeChanged()) } n.onload = function () { t.width || t.height || !d.hasDimensions(e) || e.dom.setAttribs(n, { width: n.clientWidth, height: n.clientHeight }), r() }, n.onerror = r }, blobToDataUri: function (r) { return new n(function (e, t) { var n = new o; n.onload = function () { e(n.result) }, n.onerror = function () { t(o.error.message) }, n.readAsDataURL(r) }) } }, s = tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"), c = function (t) { return function (e) { return function (e) { if (null === e) return "null"; var t = typeof e; return "object" === t && Array.prototype.isPrototypeOf(e) ? "array" : "object" === t && String.prototype.isPrototypeOf(e) ? "string" : t }(e) === t } }, m = { isString: c("string"), isObject: c("object"), isArray: c("array"), isNull: c("null"), isBoolean: c("boolean"), isUndefined: c("undefined"), isFunction: c("function"), isNumber: c("number") }, p = function (o) { return function () { for (var e = new Array(arguments.length), t = 0; t < e.length; t++)e[t] = arguments[t]; if (0 === e.length) throw new Error("Can't merge zero objects"); for (var n = {}, r = 0; r < e.length; r++) { var a = e[r]; for (var i in a) a.hasOwnProperty(i) && (n[i] = o(n[i], a[i])) } return n } }, h = p(function (e, t) { return m.isObject(e) && m.isObject(t) ? h(e, t) : t }), v = p(function (e, t) { return t }), b = { deepMerge: h, merge: v }, y = s.DOM, x = function (e) { return e.style.marginLeft && e.style.marginRight && e.style.marginLeft === e.style.marginRight ? g.removePixelSuffix(e.style.marginLeft) : "" }, w = function (e) { return e.style.marginTop && e.style.marginBottom && e.style.marginTop === e.style.marginBottom ? g.removePixelSuffix(e.style.marginTop) : "" }, S = function (e) { return e.style.borderWidth ? g.removePixelSuffix(e.style.borderWidth) : "" }, U = function (e, t) { return e.hasAttribute(t) ? e.getAttribute(t) : "" }, C = function (e, t) { return e.style[t] ? e.style[t] : "" }, T = function (e) { return null !== e.parentNode && "FIGURE" === e.parentNode.nodeName }, P = function (e, t, n) { e.setAttribute(t, n) }, I = function (e) { var t, n, r, a; T(e) ? (a = (r = e).parentNode, y.insertAfter(r, a), y.remove(a)) : (t = e, n = y.create("figure", { "class": "image" }), y.insertAfter(n, t), n.appendChild(t), n.appendChild(y.create("figcaption", { contentEditable: !0 }, "Caption")), n.contentEditable = "false") }, N = function (e, t) { var n = e.getAttribute("style"), r = t(null !== n ? n : ""); 0 < r.length ? (e.setAttribute("style", r), e.setAttribute("data-mce-style", r)) : e.removeAttribute("style") }, A = function (e, r) { return function (e, t, n) { e.style[t] ? (e.style[t] = g.addPixelSuffix(n), N(e, r)) : P(e, t, n) } }, L = function (e, t) { return e.style[t] ? g.removePixelSuffix(e.style[t]) : U(e, t) }, _ = function (e, t) { var n = g.addPixelSuffix(t); e.style.marginLeft = n, e.style.marginRight = n }, O = function (e, t) { var n = g.addPixelSuffix(t); e.style.marginTop = n, e.style.marginBottom = n }, R = function (e, t) { var n = g.addPixelSuffix(t); e.style.borderWidth = n }, D = function (e, t) { e.style.borderStyle = t }, k = function (e) { return "FIGURE" === e.nodeName }, z = function (e, t) { var n = document.createElement("img"); return P(n, "style", t.style), (x(n) || "" !== t.hspace) && _(n, t.hspace), (w(n) || "" !== t.vspace) && O(n, t.vspace), (S(n) || "" !== t.border) && R(n, t.border), (C(n, "borderStyle") || "" !== t.borderStyle) && D(n, t.borderStyle), e(n.getAttribute("style")) }, M = function (e, t) { return { src: U(t, "src"), alt: U(t, "alt"), title: U(t, "title"), width: L(t, "width"), height: L(t, "height"), "class": U(t, "class"), style: e(U(t, "style")), caption: T(t), hspace: x(t), vspace: w(t), border: S(t), borderStyle: C(t, "borderStyle") } }, E = function (e, t, n, r, a) { n[r] !== t[r] && a(e, r, n[r]) }, H = function (r, a) { return function (e, t, n) { r(e, n), N(e, a) } }, j = function (e, t, n) { var r = M(e, n); E(n, r, t, "caption", function (e, t, n) { return I(e) }), E(n, r, t, "src", P), E(n, r, t, "alt", P), E(n, r, t, "title", P), E(n, r, t, "width", A(0, e)), E(n, r, t, "height", A(0, e)), E(n, r, t, "class", P), E(n, r, t, "style", H(function (e, t) { return P(e, "style", t) }, e)), E(n, r, t, "hspace", H(_, e)), E(n, r, t, "vspace", H(O, e)), E(n, r, t, "border", H(R, e)), E(n, r, t, "borderStyle", H(D, e)) }, B = function (e, t) { var n = e.dom.styles.parse(t), r = g.mergeMargins(n), a = e.dom.styles.parse(e.dom.styles.serialize(r)); return e.dom.styles.serialize(a) }, F = function (e) { var t = e.selection.getNode(), n = e.dom.getParent(t, "figure.image"); return n ? e.dom.select("img", n)[0] : t && ("IMG" !== t.nodeName || t.getAttribute("data-mce-object") || t.getAttribute("data-mce-placeholder")) ? null : t }, W = function (t, e) { var n = t.dom, r = n.getParent(e.parentNode, function (e) { return t.schema.getTextBlockElements()[e.nodeName] }); return r ? n.split(r, e) : e }, G = function (t) { var e = F(t); return e ? M(function (e) { return B(t, e) }, e) : { src: "", alt: "", title: "", width: "", height: "", "class": "", style: "", caption: !1, hspace: "", vspace: "", border: "", borderStyle: "" } }, J = function (t, e) { var n = function (e, t) { var n = document.createElement("img"); if (j(e, b.merge(t, { caption: !1 }), n), P(n, "alt", t.alt), t.caption) { var r = y.create("figure", { "class": "image" }); return r.appendChild(n), r.appendChild(y.create("figcaption", { contentEditable: !0 }, "Caption")), r.contentEditable = "false", r } return n }(function (e) { return B(t, e) }, e); t.dom.setAttrib(n, "data-mce-id", "__mcenew"), t.focus(), t.selection.setContent(n.outerHTML); var r = t.dom.select('*[data-mce-id="__mcenew"]')[0]; if (t.dom.setAttrib(r, "data-mce-id", null), k(r)) { var a = W(t, r); t.selection.select(a) } else t.selection.select(r) }, V = function (e, t) { var n = F(e); n ? t.src ? function (t, e) { var n, r = F(t); if (j(function (e) { return B(t, e) }, e, r), n = r, t.dom.setAttrib(n, "src", n.getAttribute("src")), k(r.parentNode)) { var a = r.parentNode; W(t, a), t.selection.select(r.parentNode) } else t.selection.select(r), g.waitLoadImage(t, e, r) }(e, t) : function (e, t) { if (t) { var n = e.dom.is(t.parentNode, "figure.image") ? t.parentNode : t; e.dom.remove(n), e.focus(), e.nodeChanged(), e.dom.isEmpty(e.getBody()) && (e.setContent(""), e.selection.setCursorLocation()) } }(e, n) : t.src && J(e, t) }, $ = function (n, r) { r.find("#style").each(function (e) { var t = z(function (e) { return B(n, e) }, b.merge({ src: "", alt: "", title: "", width: "", height: "", "class": "", style: "", caption: !1, hspace: "", vspace: "", border: "", borderStyle: "" }, r.toJSON())); e.value(t) }) }, X = { makeTab: function (t) { return { title: "Advanced", type: "form", pack: "start", items: [{ label: "Style", name: "style", type: "textbox", onchange: (i = t, function (e) { var t = i.dom, n = e.control.rootControl; if (d.hasAdvTab(i)) { var r = n.toJSON(), a = t.parseStyle(r.style); n.find("#vspace").value(""), n.find("#hspace").value(""), ((a = g.mergeMargins(a))["margin-top"] && a["margin-bottom"] || a["margin-right"] && a["margin-left"]) && (a["margin-top"] === a["margin-bottom"] ? n.find("#vspace").value(g.removePixelSuffix(a["margin-top"])) : n.find("#vspace").value(""), a["margin-right"] === a["margin-left"] ? n.find("#hspace").value(g.removePixelSuffix(a["margin-right"])) : n.find("#hspace").value("")), a["border-width"] ? n.find("#border").value(g.removePixelSuffix(a["border-width"])) : n.find("#border").value(""), a["border-style"] ? n.find("#borderStyle").value(a["border-style"]) : n.find("#borderStyle").value(""), n.find("#style").value(t.serializeStyle(t.parseStyle(t.serializeStyle(a)))) } }) }, { type: "form", layout: "grid", packV: "start", columns: 2, padding: 0, defaults: { type: "textbox", maxWidth: 50, onchange: function (e) { $(t, e.control.rootControl) } }, items: [{ label: "Vertical space", name: "vspace" }, { label: "Border width", name: "border" }, { label: "Horizontal space", name: "hspace" }, { label: "Border style", type: "listbox", name: "borderStyle", width: 90, maxWidth: 90, onselect: function (e) { $(t, e.control.rootControl) }, values: [{ text: "Select...", value: "" }, { text: "Solid", value: "solid" }, { text: "Dotted", value: "dotted" }, { text: "Dashed", value: "dashed" }, { text: "Double", value: "double" }, { text: "Groove", value: "groove" }, { text: "Ridge", value: "ridge" }, { text: "Inset", value: "inset" }, { text: "Outset", value: "outset" }, { text: "None", value: "none" }, { text: "Hidden", value: "hidden" }] }] }] }; var i } }, q = function (e, t) { e.state.set("oldVal", e.value()), t.state.set("oldVal", t.value()) }, K = function (e, t) { var n = e.find("#width")[0], r = e.find("#height")[0], a = e.find("#constrain")[0]; n && r && a && t(n, r, a.checked()) }, Q = function (e, t, n) { var r = e.state.get("oldVal"), a = t.state.get("oldVal"), i = e.value(), o = t.value(); n && r && a && i && o && (i !== r ? (o = Math.round(i / r * o), isNaN(o) || t.value(o)) : (i = Math.round(o / a * i), isNaN(i) || e.value(i))), q(e, t) }, Y = function (e) { K(e, Q) }, Z = { createUi: function () { var e = function (e) { Y(e.control.rootControl) }; return { type: "container", label: "Dimensions", layout: "flex", align: "center", spacing: 5, items: [{ name: "width", type: "textbox", maxLength: 5, size: 5, onchange: e, ariaLabel: "Width" }, { type: "label", text: "x" }, { name: "height", type: "textbox", maxLength: 5, size: 5, onchange: e, ariaLabel: "Height" }, { name: "constrain", type: "checkbox", checked: !0, text: "Constrain proportions" }] } }, syncSize: function (e) { K(e, q) }, updateSize: Y }, ee = function (e) { e.meta = e.control.rootControl.toJSON() }, te = function (c, e) { var t = [{ name: "src", type: "filepicker", filetype: "image", label: "Source", autofocus: !0, onchange: function (e) { var t, n, r, a, i, o, l, u, s; n = c, o = (t = e).meta || {}, l = t.control, u = l.rootControl, (s = u.find("#image-list")[0]) && s.value(n.convertURL(l.value(), "src")), f.each(o, function (e, t) { u.find("#" + t).value(e) }), o.width || o.height || (r = n.convertURL(l.value(), "src"), a = d.getPrependUrl(n), i = new RegExp("^(?:[a-z]+:)?//", "i"), a && !i.test(r) && r.substring(0, a.length) !== a && (r = a + r), l.value(r), g.getImageSize(n.documentBaseURI.toAbsolute(l.value()), function (e) { e.width && e.height && d.hasDimensions(n) && (u.find("#width").value(e.width), u.find("#height").value(e.height), Z.syncSize(u)) })) }, onbeforecall: ee }, e]; return d.hasDescription(c) && t.push({ name: "alt", type: "textbox", label: "Image description" }), d.hasImageTitle(c) && t.push({ name: "title", type: "textbox", label: "Image Title" }), d.hasDimensions(c) && t.push(Z.createUi()), d.getClassList(c) && t.push({ name: "class", type: "listbox", label: "Class", values: g.buildListItems(d.getClassList(c), function (e) { e.value && (e.textStyle = function () { return c.formatter.getCssText({ inline: "img", classes: [e.value] }) }) }) }), d.hasImageCaption(c) && t.push({ name: "caption", type: "checkbox", label: "Caption" }), t }, ne = { makeTab: function (e, t) { return { title: "General", type: "form", items: te(e, t) } }, getGeneralItems: te }, re = function () { return t.getOrDie("URL") }, ae = function (e) { return re().createObjectURL(e) }, ie = function (e) { re().revokeObjectURL(e) }, oe = tinymce.util.Tools.resolve("tinymce.ui.Factory"); function le() { return new (t.getOrDie("XMLHttpRequest")) } var ue = function () { }, se = function (e, t) { return e ? e.replace(/\/$/, "") + "/" + t.replace(/^\//, "") : t }; function ce(o) { var t = function (e, t, n, r) { var a, i; (a = new le).open("POST", o.url), a.withCredentials = o.credentials, a.upload.onprogress = function (e) { r(e.loaded / e.total * 100) }, a.onerror = function () { n("Image upload failed due to a XHR Transport error. Code: " + a.status) }, a.onload = function () { var e; a.status < 200 || 300 <= a.status ? n("HTTP Error: " + a.status) : (e = JSON.parse(a.responseText)) && "string" == typeof e.location ? t(se(o.basePath, e.location)) : n("Invalid JSON: " + a.responseText) }, (i = new FormData).append("file", e.blob(), e.filename()), a.send(i) }; return o = f.extend({ credentials: !1, handler: t }, o), { upload: function (e) { return o.url || o.handler !== t ? (r = e, a = o.handler, new n(function (e, t) { try { a(r, e, t, ue) } catch (n) { t(n.message) } })) : n.reject("Upload url missing from the settings."); var r, a } } } var de = function (u) { return function (e) { var t = oe.get("Throbber"), n = e.control.rootControl, r = new t(n.getEl()), a = e.control.value(), i = ae(a), o = ce({ url: d.getUploadUrl(u), basePath: d.getUploadBasePath(u), credentials: d.getUploadCredentials(u), handler: d.getUploadHandler(u) }), l = function () { r.hide(), ie(i) }; return r.show(), g.blobToDataUri(a).then(function (e) { var t = u.editorUpload.blobCache.create({ blob: a, blobUri: i, name: a.name ? a.name.replace(/\.[^\.]+$/, "") : null, base64: e.split(",")[1] }); return o.upload(t).then(function (e) { var t = n.find("#src"); return t.value(e), n.find("tabpanel")[0].activateTab(0), t.fire("change"), l(), e }) })["catch"](function (e) { u.windowManager.alert(e), l() }) } }, fe = ".jpg,.jpeg,.png,.gif", ge = { makeTab: function (e) { return { title: "Upload", type: "form", layout: "flex", direction: "column", align: "stretch", padding: "20 20 20 20", items: [{ type: "container", layout: "flex", direction: "column", align: "center", spacing: 10, items: [{ text: "Browse for an image", type: "browsebutton", accept: fe, onchange: de(e) }, { text: "OR", type: "label" }] }, { text: "Drop an image here", type: "dropzone", accept: fe, height: 100, onchange: de(e) }] } } }, me = function (e) { return function () { return e } }, pe = { noop: function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t] }, noarg: function (n) { return function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; return n() } }, compose: function (n, r) { return function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; return n(r.apply(null, arguments)) } }, constant: me, identity: function (e) { return e }, tripleEquals: function (e, t) { return e === t }, curry: function (i) { for (var e = [], t = 1; t < arguments.length; t++)e[t - 1] = arguments[t]; for (var o = new Array(arguments.length - 1), n = 1; n < arguments.length; n++)o[n - 1] = arguments[n]; return function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; for (var n = new Array(arguments.length), r = 0; r < n.length; r++)n[r] = arguments[r]; var a = o.concat(n); return i.apply(null, a) } }, not: function (n) { return function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; return !n.apply(null, arguments) } }, die: function (e) { return function () { throw new Error(e) } }, apply: function (e) { return e() }, call: function (e) { e() }, never: me(!1), always: me(!0) }, he = function (t, e) { var n = e.control.getRoot(); Z.updateSize(n), t.undoManager.transact(function () { var e = b.merge(G(t), n.toJSON()); V(t, e) }), t.editorUpload.uploadImagesAuto() }; function ve(i) { function e(e) { var n, t, r = G(i); if (e && (t = { type: "listbox", label: "Image list", name: "image-list", values: g.buildListItems(e, function (e) { e.value = i.convertURL(e.value || e.url, "src") }, [{ text: "None", value: "" }]), value: r.src && i.convertURL(r.src, "src"), onselect: function (e) { var t = n.find("#alt"); (!t.value() || e.lastControl && t.value() === e.lastControl.text()) && t.value(e.control.text()), n.find("#src").value(e.control.value()).fire("change") }, onPostRender: function () { t = this } }), d.hasAdvTab(i) || d.hasUploadUrl(i) || d.hasUploadHandler(i)) { var a = [ne.makeTab(i, t)]; d.hasAdvTab(i) && a.push(X.makeTab(i)), (d.hasUploadUrl(i) || d.hasUploadHandler(i)) && a.push(ge.makeTab(i)), n = i.windowManager.open({ title: "Insert/edit image", data: r, bodyType: "tabpanel", body: a, onSubmit: pe.curry(he, i) }) } else n = i.windowManager.open({ title: "Insert/edit image", data: r, body: ne.getGeneralItems(i, t), onSubmit: pe.curry(he, i) }); Z.syncSize(n) } return { open: function () { g.createImageList(i, e) } } } var be = function (e) { e.addCommand("mceImage", ve(e).open) }, ye = function (i) { return function (e) { for (var t, n, r = e.length, a = function (e) { e.attr("contenteditable", i ? "true" : null) }; r--;)t = e[r], (n = t.attr("class")) && /\bimage\b/.test(n) && (t.attr("contenteditable", i ? "false" : null), f.each(t.getAll("figcaption"), a)) } }, xe = function (e) { e.on("preInit", function () { e.parser.addNodeFilter("figure", ye(!0)), e.serializer.addNodeFilter("figure", ye(!1)) }) }, we = function (e) { e.addButton("image", { icon: "image", tooltip: "Insert/edit image", onclick: ve(e).open, stateSelector: "img:not([data-mce-object],[data-mce-placeholder]),figure.image" }), e.addMenuItem("image", { icon: "image", text: "Image", onclick: ve(e).open, context: "insert", prependToContext: !0 }) }; e.add("image", function (e) { xe(e), we(e), be(e) }) }();
!function () { "use strict"; var r = function (t) { var e = t, n = function () { return e }; return { get: n, set: function (t) { e = t }, clone: function () { return r(n()) } } }, t = tinymce.util.Tools.resolve("tinymce.PluginManager"), Y = tinymce.util.Tools.resolve("tinymce.util.Tools"); function n(t, e) { return i(document.createElement("canvas"), t, e) } function o(t) { return t.getContext("2d") } function i(t, e, n) { return t.width = e, t.height = n, t } var a, u, c, l, h = { create: n, clone: function (t) { var e; return o(e = n(t.width, t.height)).drawImage(t, 0, 0), e }, resize: i, get2dContext: o, get3dContext: function (t) { var e = null; try { e = t.getContext("webgl") || t.getContext("experimental-webgl") } catch (n) { } return e || (e = null), e } }, p = { getWidth: function (t) { return t.naturalWidth || t.width }, getHeight: function (t) { return t.naturalHeight || t.height } }, g = window.Promise ? window.Promise : function () { var t = function (t) { if ("object" != typeof this) throw new TypeError("Promises must be constructed via new"); if ("function" != typeof t) throw new TypeError("not a function"); this._state = null, this._value = null, this._deferreds = [], l(t, r(o, this), r(a, this)) }, e = t.immediateFn || "function" == typeof setImmediate && setImmediate || function (t) { setTimeout(t, 1) }; function r(t, e) { return function () { t.apply(e, arguments) } } var n = Array.isArray || function (t) { return "[object Array]" === Object.prototype.toString.call(t) }; function i(r) { var o = this; null !== this._state ? e(function () { var t = o._state ? r.onFulfilled : r.onRejected; if (null !== t) { var e; try { e = t(o._value) } catch (n) { return void r.reject(n) } r.resolve(e) } else (o._state ? r.resolve : r.reject)(o._value) }) : this._deferreds.push(r) } function o(t) { try { if (t === this) throw new TypeError("A promise cannot be resolved with itself."); if (t && ("object" == typeof t || "function" == typeof t)) { var e = t.then; if ("function" == typeof e) return void l(r(e, t), r(o, this), r(a, this)) } this._state = !0, this._value = t, u.call(this) } catch (n) { a.call(this, n) } } function a(t) { this._state = !1, this._value = t, u.call(this) } function u() { for (var t = 0, e = this._deferreds.length; t < e; t++)i.call(this, this._deferreds[t]); this._deferreds = null } function c(t, e, n, r) { this.onFulfilled = "function" == typeof t ? t : null, this.onRejected = "function" == typeof e ? e : null, this.resolve = n, this.reject = r } function l(t, e, n) { var r = !1; try { t(function (t) { r || (r = !0, e(t)) }, function (t) { r || (r = !0, n(t)) }) } catch (o) { if (r) return; r = !0, n(o) } } return t.prototype["catch"] = function (t) { return this.then(null, t) }, t.prototype.then = function (n, r) { var o = this; return new t(function (t, e) { i.call(o, new c(n, r, t, e)) }) }, t.all = function () { var c = Array.prototype.slice.call(1 === arguments.length && n(arguments[0]) ? arguments[0] : arguments); return new t(function (o, i) { if (0 === c.length) return o([]); var a = c.length; function u(e, t) { try { if (t && ("object" == typeof t || "function" == typeof t)) { var n = t.then; if ("function" == typeof n) return void n.call(t, function (t) { u(e, t) }, i) } c[e] = t, 0 == --a && o(c) } catch (r) { i(r) } } for (var t = 0; t < c.length; t++)u(t, c[t]) }) }, t.resolve = function (e) { return e && "object" == typeof e && e.constructor === t ? e : new t(function (t) { t(e) }) }, t.reject = function (n) { return new t(function (t, e) { e(n) }) }, t.race = function (o) { return new t(function (t, e) { for (var n = 0, r = o.length; n < r; n++)o[n].then(t, e) }) }, t }(), s = function (t) { return function () { return t } }, f = { noop: function () { for (var t = [], e = 0; e < arguments.length; e++)t[e] = arguments[e] }, noarg: function (n) { return function () { for (var t = [], e = 0; e < arguments.length; e++)t[e] = arguments[e]; return n() } }, compose: function (n, r) { return function () { for (var t = [], e = 0; e < arguments.length; e++)t[e] = arguments[e]; return n(r.apply(null, arguments)) } }, constant: s, identity: function (t) { return t }, tripleEquals: function (t, e) { return t === e }, curry: function (i) { for (var t = [], e = 1; e < arguments.length; e++)t[e - 1] = arguments[e]; for (var a = new Array(arguments.length - 1), n = 1; n < arguments.length; n++)a[n - 1] = arguments[n]; return function () { for (var t = [], e = 0; e < arguments.length; e++)t[e] = arguments[e]; for (var n = new Array(arguments.length), r = 0; r < n.length; r++)n[r] = arguments[r]; var o = a.concat(n); return i.apply(null, o) } }, not: function (n) { return function () { for (var t = [], e = 0; e < arguments.length; e++)t[e] = arguments[e]; return !n.apply(null, arguments) } }, die: function (t) { return function () { throw new Error(t) } }, apply: function (t) { return t() }, call: function (t) { t() }, never: s(!1), always: s(!0) }, d = f.never, m = f.always, v = function () { return y }, y = (l = { fold: function (t, e) { return t() }, is: d, isSome: d, isNone: m, getOr: c = function (t) { return t }, getOrThunk: u = function (t) { return t() }, getOrDie: function (t) { throw new Error(t || "error: getOrDie called on none.") }, or: c, orThunk: u, map: v, ap: v, each: function () { }, bind: v, flatten: v, exists: d, forall: m, filter: v, equals: a = function (t) { return t.isNone() }, equals_: a, toArray: function () { return [] }, toString: f.constant("none()") }, Object.freeze && Object.freeze(l), l), b = function (n) { var t = function () { return n }, e = function () { return o }, r = function (t) { return t(n) }, o = { fold: function (t, e) { return e(n) }, is: function (t) { return n === t }, isSome: m, isNone: d, getOr: t, getOrThunk: t, getOrDie: t, or: e, orThunk: e, map: function (t) { return b(t(n)) }, ap: function (t) { return t.fold(v, function (t) { return b(t(n)) }) }, each: function (t) { t(n) }, bind: r, flatten: t, exists: r, forall: r, filter: function (t) { return t(n) ? o : y }, equals: function (t) { return t.is(n) }, equals_: function (t, e) { return t.fold(d, function (t) { return e(n, t) }) }, toArray: function () { return [n] }, toString: function () { return "some(" + n + ")" } }; return o }, w = { some: b, none: v, from: function (t) { return null === t || t === undefined ? y : b(t) } }, x = "undefined" != typeof window ? window : Function("return this;")(), R = function (t, e) { for (var n = e !== undefined && null !== e ? e : x, r = 0; r < t.length && n !== undefined && null !== n; ++r)n = n[t[r]]; return n }, I = function (t, e) { var n = t.split("."); return R(n, e) }, T = { getOrDie: function (t, e) { var n = I(t, e); if (n === undefined || null === n) throw t + " not available on this browser"; return n } }; function k() { return new (T.getOrDie("FileReader")) } var C = { atob: function (t) { return T.getOrDie("atob")(t) }, requestAnimationFrame: function (t) { T.getOrDie("requestAnimationFrame")(t) } }; function B(u) { return new g(function (t, e) { var n = URL.createObjectURL(u), r = new Image, o = function () { r.removeEventListener("load", i), r.removeEventListener("error", a) }; function i() { o(), t(r) } function a() { o(), e("Unable to load data of type " + u.type + ": " + n) } r.addEventListener("load", i), r.addEventListener("error", a), r.src = n, r.complete && i() }) } function U(r) { return new g(function (t, n) { var e = new XMLHttpRequest; e.open("GET", r, !0), e.responseType = "blob", e.onload = function () { 200 == this.status && t(this.response) }, e.onerror = function () { var t, e = this; n(0 === this.status ? ((t = new Error("No access to download image")).code = 18, t.name = "SecurityError", t) : new Error("Error " + e.status + " downloading image")) }, e.send() }) } function A(t) { var e = t.split(","), n = /data:([^;]+)/.exec(e[0]); if (!n) return w.none(); for (var r, o, i, a = n[1], u = e[1], c = C.atob(u), l = c.length, s = Math.ceil(l / 1024), f = new Array(s), d = 0; d < s; ++d) { for (var h = 1024 * d, p = Math.min(h + 1024, l), g = new Array(p - h), m = h, v = 0; m < p; ++v, ++m)g[v] = c[m].charCodeAt(0); f[d] = (r = g, new (T.getOrDie("Uint8Array"))(r)) } return w.some((o = f, i = { type: a }, new (T.getOrDie("Blob"))(o, i))) } function j(n) { return new g(function (t, e) { A(n).fold(function () { e("uri is not base64: " + n) }, t) }) } function M(n) { return new g(function (t) { var e = new k; e.onloadend = function () { t(e.result) }, e.readAsDataURL(n) }) } var E = { blobToImage: B, imageToBlob: function (t) { var e = t.src; return 0 === e.indexOf("data:") ? j(e) : U(e) }, blobToArrayBuffer: function (n) { return new g(function (t) { var e = new k; e.onloadend = function () { t(e.result) }, e.readAsArrayBuffer(n) }) }, blobToDataUri: M, blobToBase64: function (t) { return M(t).then(function (t) { return t.split(",")[1] }) }, dataUriToBlobSync: A, canvasToBlob: function (t, n, r) { return n = n || "image/png", HTMLCanvasElement.prototype.toBlob ? new g(function (e) { t.toBlob(function (t) { e(t) }, n, r) }) : j(t.toDataURL(n, r)) }, canvasToDataURL: function (t, e, n) { return e = e || "image/png", t.then(function (t) { return t.toDataURL(e, n) }) }, blobToCanvas: function (t) { return B(t).then(function (t) { var e, n; return e = t, URL.revokeObjectURL(e.src), n = h.create(p.getWidth(t), p.getHeight(t)), h.get2dContext(n).drawImage(t, 0, 0), n }) }, uriToBlob: function (t) { return 0 === t.indexOf("blob:") ? U(t) : 0 === t.indexOf("data:") ? j(t) : null } }, O = function (t) { return E.blobToImage(t) }, z = function (t) { return E.imageToBlob(t) }; function D(t, e, n) { var r = e.type; function o(e, n) { return t.then(function (t) { return E.canvasToDataURL(t, e, n) }) } return { getType: f.constant(r), toBlob: function () { return g.resolve(e) }, toDataURL: function () { return n }, toBase64: function () { return n.split(",")[1] }, toAdjustedBlob: function (e, n) { return t.then(function (t) { return E.canvasToBlob(t, e, n) }) }, toAdjustedDataURL: o, toAdjustedBase64: function (t, e) { return o(t, e).then(function (t) { return t.split(",")[1] }) }, toCanvas: function () { return t.then(h.clone) } } } function S(e) { return E.blobToDataUri(e).then(function (t) { return D(E.blobToCanvas(e), e, t) }) } var _ = { fromBlob: S, fromCanvas: function (e, t) { return E.canvasToBlob(e, t).then(function (t) { return D(g.resolve(e), t, e.toDataURL()) }) }, fromImage: function (t) { return E.imageToBlob(t).then(function (t) { return S(t) }) }, fromBlobAndUrlSync: function (t, e) { return D(E.blobToCanvas(t), t, e) } }; function H(t, e, n) { return n < (t = parseFloat(t)) ? t = n : t < e && (t = e), t } var L = [0, .01, .02, .04, .05, .06, .07, .08, .1, .11, .12, .14, .15, .16, .17, .18, .2, .21, .22, .24, .25, .27, .28, .3, .32, .34, .36, .38, .4, .42, .44, .46, .48, .5, .53, .56, .59, .62, .65, .68, .71, .74, .77, .8, .83, .86, .89, .92, .95, .98, 1, 1.06, 1.12, 1.18, 1.24, 1.3, 1.36, 1.42, 1.48, 1.54, 1.6, 1.66, 1.72, 1.78, 1.84, 1.9, 1.96, 2, 2.12, 2.25, 2.37, 2.5, 2.62, 2.75, 2.87, 3, 3.2, 3.4, 3.6, 3.8, 4, 4.3, 4.7, 4.9, 5, 5.5, 6, 6.5, 6.8, 7, 7.3, 7.5, 7.8, 8, 8.4, 8.7, 9, 9.4, 9.6, 9.8, 10]; function F(t, e) { var n, r, o, i, a = [], u = new Array(10); for (n = 0; n < 5; n++) { for (r = 0; r < 5; r++)a[r] = e[r + 5 * n]; for (r = 0; r < 5; r++) { for (o = i = 0; o < 5; o++)i += t[r + 5 * o] * a[o]; u[r + 5 * n] = i } } return u } function P(t, n) { return n = H(n, 0, 1), t.map(function (t, e) { return e % 6 == 0 ? t = 1 - (1 - t) * n : t *= n, H(t, 0, 1) }) } var W = { identity: function () { return [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1] }, adjust: P, multiply: F, adjustContrast: function (t, e) { var n; return e = H(e, -1, 1), F(t, [(n = (e *= 100) < 0 ? 127 + e / 100 * 127 : 127 * (n = 0 == (n = e % 1) ? L[e] : L[Math.floor(e)] * (1 - n) + L[Math.floor(e) + 1] * n) + 127) / 127, 0, 0, 0, .5 * (127 - n), 0, n / 127, 0, 0, .5 * (127 - n), 0, 0, n / 127, 0, .5 * (127 - n), 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]) }, adjustBrightness: function (t, e) { return F(t, [1, 0, 0, 0, e = H(255 * e, -255, 255), 0, 1, 0, 0, e, 0, 0, 1, 0, e, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]) }, adjustSaturation: function (t, e) { var n; return F(t, [.3086 * (1 - (n = 1 + (0 < (e = H(e, -1, 1)) ? 3 * e : e))) + n, .6094 * (1 - n), .082 * (1 - n), 0, 0, .3086 * (1 - n), .6094 * (1 - n) + n, .082 * (1 - n), 0, 0, .3086 * (1 - n), .6094 * (1 - n), .082 * (1 - n) + n, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]) }, adjustHue: function (t, e) { var n, r, o, i, a; return e = H(e, -180, 180) / 180 * Math.PI, F(t, [(o = .213) + .787 * (n = Math.cos(e)) + (r = Math.sin(e)) * -o, (i = .715) + n * -i + r * -i, (a = .072) + n * -a + .928 * r, 0, 0, o + n * -o + .143 * r, i + n * (1 - i) + .14 * r, a + n * -a + -.283 * r, 0, 0, o + n * -o + -.787 * r, i + n * -i + r * i, a + .928 * n + r * a, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]) }, adjustColors: function (t, e, n, r) { return F(t, [e = H(e, 0, 2), 0, 0, 0, 0, 0, n = H(n, 0, 2), 0, 0, 0, 0, 0, r = H(r, 0, 2), 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1]) }, adjustSepia: function (t, e) { return F(t, P([.393, .769, .189, 0, 0, .349, .686, .168, 0, 0, .272, .534, .131, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1], e = H(e, 0, 1))) }, adjustGrayscale: function (t, e) { return F(t, P([.33, .34, .33, 0, 0, .33, .34, .33, 0, 0, .33, .34, .33, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1], e = H(e, 0, 1))) } }; function q(a, u) { return a.toCanvas().then(function (t) { return e = t, n = a.getType(), r = u, i = h.get2dContext(e), o = function (t, e) { var n, r, o, i, a, u = t.data, c = e[0], l = e[1], s = e[2], f = e[3], d = e[4], h = e[5], p = e[6], g = e[7], m = e[8], v = e[9], y = e[10], b = e[11], w = e[12], x = e[13], R = e[14], I = e[15], T = e[16], k = e[17], C = e[18], B = e[19]; for (a = 0; a < u.length; a += 4)n = u[a], r = u[a + 1], o = u[a + 2], i = u[a + 3], u[a] = n * c + r * l + o * s + i * f + d, u[a + 1] = n * h + r * p + o * g + i * m + v, u[a + 2] = n * y + r * b + o * w + i * x + R, u[a + 3] = n * I + r * T + o * k + i * C + B; return t }(i.getImageData(0, 0, e.width, e.height), r), i.putImageData(o, 0, 0), _.fromCanvas(e, n); var e, n, r, o, i }) } function V(u, c) { return u.toCanvas().then(function (t) { return e = t, n = u.getType(), r = c, a = h.get2dContext(e), o = a.getImageData(0, 0, e.width, e.height), i = a.getImageData(0, 0, e.width, e.height), i = function (t, e, n) { var r, o, i, a, u, c, l, s, f, d, h, p, g, m, v, y, b; function w(t, e, n) { return n < t ? t = n : t < e && (t = e), t } for (i = Math.round(Math.sqrt(n.length)), a = Math.floor(i / 2), r = t.data, o = e.data, y = t.width, b = t.height, c = 0; c < b; c++)for (u = 0; u < y; u++) { for (l = s = f = 0, h = 0; h < i; h++)for (d = 0; d < i; d++)p = w(u + d - a, 0, y - 1), g = w(c + h - a, 0, b - 1), m = 4 * (g * y + p), v = n[h * i + d], l += r[m] * v, s += r[m + 1] * v, f += r[m + 2] * v; o[m = 4 * (c * y + u)] = w(l, 0, 255), o[m + 1] = w(s, 0, 255), o[m + 2] = w(f, 0, 255) } return e }(o, i, r), a.putImageData(i, 0, 0), _.fromCanvas(e, n); var e, n, r, o, i, a }) } function N(u) { return function (e, n) { return e.toCanvas().then(function (t) { return function (t, e, n) { var r, o, i = h.get2dContext(t), a = new Array(256); for (o = 0; o < a.length; o++)a[o] = u(o, n); return r = function (t, e) { var n, r = t.data; for (n = 0; n < r.length; n += 4)r[n] = e[r[n]], r[n + 1] = e[r[n + 1]], r[n + 2] = e[r[n + 2]]; return t }(i.getImageData(0, 0, t.width, t.height), a), i.putImageData(r, 0, 0), _.fromCanvas(t, e) }(t, e.getType(), n) }) } } function $(n) { return function (t, e) { return q(t, n(W.identity(), e)) } } function X(e) { return function (t) { return V(t, e) } } var G, J = { invert: (G = [-1, 0, 0, 0, 255, 0, -1, 0, 0, 255, 0, 0, -1, 0, 255, 0, 0, 0, 1, 0], function (t) { return q(t, G) }), brightness: $(W.adjustBrightness), hue: $(W.adjustHue), saturate: $(W.adjustSaturation), contrast: $(W.adjustContrast), grayscale: $(W.adjustGrayscale), sepia: $(W.adjustSepia), colorize: function (t, e, n, r) { return q(t, W.adjustColors(W.identity(), e, n, r)) }, sharpen: X([0, -1, 0, -1, 5, -1, 0, -1, 0]), emboss: X([-2, -1, 0, -1, 1, 1, 0, 1, 2]), gamma: N(function (t, e) { return 255 * Math.pow(t / 255, 1 - e) }), exposure: N(function (t, e) { return 255 * (1 - Math.exp(-t / 255 * e)) }), colorFilter: q, convoluteFilter: V }, K = { scale: function e(t, n, r) { var o = p.getWidth(t), i = p.getHeight(t), a = n / o, u = r / i, c = !1; (a < .5 || 2 < a) && (a = a < .5 ? .5 : 2, c = !0), (u < .5 || 2 < u) && (u = u < .5 ? .5 : 2, c = !0); var l, s, f, d = (l = t, s = a, f = u, new g(function (t) { var e = p.getWidth(l), n = p.getHeight(l), r = Math.floor(e * s), o = Math.floor(n * f), i = h.create(r, o), a = h.get2dContext(i); a.drawImage(l, 0, 0, e, n, 0, 0, r, o), t(i) })); return c ? d.then(function (t) { return e(t, n, r) }) : d } }, Z = { rotate: function (c, l) { return c.toCanvas().then(function (t) { return e = t, n = c.getType(), r = l, o = h.create(e.width, e.height), i = h.get2dContext(o), 90 != (r = r < (u = a = 0) ? 360 + r : r) && 270 != r || h.resize(o, o.height, o.width), 90 != r && 180 != r || (a = o.width), 270 != r && 180 != r || (u = o.height), i.translate(a, u), i.rotate(r * Math.PI / 180), i.drawImage(e, 0, 0), _.fromCanvas(o, n); var e, n, r, o, i, a, u }) }, flip: function (a, u) { return a.toCanvas().then(function (t) { return e = t, n = a.getType(), r = u, o = h.create(e.width, e.height), i = h.get2dContext(o), "v" == r ? (i.scale(1, -1), i.drawImage(e, 0, -o.height)) : (i.scale(-1, 1), i.drawImage(e, -o.width, 0)), _.fromCanvas(o, n); var e, n, r, o, i }) }, crop: function (c, l, s, f, d) { return c.toCanvas().then(function (t) { return e = t, n = c.getType(), r = l, o = s, i = f, a = d, u = h.create(i, a), h.get2dContext(u).drawImage(e, -r, -o), _.fromCanvas(u, n); var e, n, r, o, i, a, u }) }, resize: function (e, n, r) { return e.toCanvas().then(function (t) { return K.scale(t, n, r).then(function (t) { return _.fromCanvas(t, e.getType()) }) }) } }, Q = { invert: function (t) { return J.invert(t) }, sharpen: function (t) { return J.sharpen(t) }, emboss: function (t) { return J.emboss(t) }, brightness: function (t, e) { return J.brightness(t, e) }, hue: function (t, e) { return J.hue(t, e) }, saturate: function (t, e) { return J.saturate(t, e) }, contrast: function (t, e) { return J.contrast(t, e) }, grayscale: function (t, e) { return J.grayscale(t, e) }, sepia: function (t, e) { return J.sepia(t, e) }, colorize: function (t, e, n, r) { return J.colorize(t, e, n, r) }, gamma: function (t, e) { return J.gamma(t, e) }, exposure: function (t, e) { return J.exposure(t, e) }, flip: function (t, e) { return Z.flip(t, e) }, crop: function (t, e, n, r, o) { return Z.crop(t, e, n, r, o) }, resize: function (t, e, n) { return Z.resize(t, e, n) }, rotate: function (t, e) { return Z.rotate(t, e) } }, tt = function (t) { return t.toBlob() }, et = { blobToImageResult: function (t) { return _.fromBlob(t) }, fromBlobAndUrlSync: function (t, e) { return _.fromBlobAndUrlSync(t, e) }, imageToImageResult: function (t) { return _.fromImage(t) }, imageResultToBlob: function (t, e, n) { return e === undefined && n === undefined ? tt(t) : t.toAdjustedBlob(e, n) }, imageResultToOriginalBlob: tt, imageResultToDataURL: function (t) { return t.toDataURL() } }, nt = function () { return T.getOrDie("URL") }, rt = { createObjectURL: function (t) { return nt().createObjectURL(t) }, revokeObjectURL: function (t) { nt().revokeObjectURL(t) } }, ot = tinymce.util.Tools.resolve("tinymce.util.Delay"), it = tinymce.util.Tools.resolve("tinymce.util.Promise"), at = tinymce.util.Tools.resolve("tinymce.util.URI"), ut = tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"), ct = tinymce.util.Tools.resolve("tinymce.ui.Factory"), lt = tinymce.util.Tools.resolve("tinymce.geom.Rect"), st = function (n) { return new it(function (t) { var e = function () { n.removeEventListener("load", e), t(n) }; n.complete ? t(n) : n.addEventListener("load", e) }) }, ft = tinymce.util.Tools.resolve("tinymce.dom.DomQuery"), dt = tinymce.util.Tools.resolve("tinymce.util.Observable"), ht = tinymce.util.Tools.resolve("tinymce.util.VK"), pt = 0, gt = { create: function (t) { return new (ct.get("Control").extend({ Defaults: { classes: "imagepanel" }, selection: function (t) { return arguments.length ? (this.state.set("rect", t), this) : this.state.get("rect") }, imageSize: function () { var t = this.state.get("viewRect"); return { w: t.w, h: t.h } }, toggleCropRect: function (t) { this.state.set("cropEnabled", t) }, imageSrc: function (t) { var o = this, i = new Image; i.src = t, st(i).then(function () { var t, e, n = o.state.get("viewRect"); if ((e = o.$el.find("img"))[0]) e.replaceWith(i); else { var r = document.createElement("div"); r.className = "mce-imagepanel-bg", o.getEl().appendChild(r), o.getEl().appendChild(i) } t = { x: 0, y: 0, w: i.naturalWidth, h: i.naturalHeight }, o.state.set("viewRect", t), o.state.set("rect", lt.inflate(t, -20, -20)), n && n.w === t.w && n.h === t.h || o.zoomFit(), o.repaintImage(), o.fire("load") }) }, zoom: function (t) { return arguments.length ? (this.state.set("zoom", t), this) : this.state.get("zoom") }, postRender: function () { return this.imageSrc(this.settings.imageSrc), this._super() }, zoomFit: function () { var t, e, n, r, o, i; t = this.$el.find("img"), e = this.getEl().clientWidth, n = this.getEl().clientHeight, r = t[0].naturalWidth, o = t[0].naturalHeight, 1 <= (i = Math.min((e - 10) / r, (n - 10) / o)) && (i = 1), this.zoom(i) }, repaintImage: function () { var t, e, n, r, o, i, a, u, c, l, s; s = this.getEl(), c = this.zoom(), l = this.state.get("rect"), a = this.$el.find("img"), u = this.$el.find(".mce-imagepanel-bg"), o = s.offsetWidth, i = s.offsetHeight, n = a[0].naturalWidth * c, r = a[0].naturalHeight * c, t = Math.max(0, o / 2 - n / 2), e = Math.max(0, i / 2 - r / 2), a.css({ left: t, top: e, width: n, height: r }), u.css({ left: t, top: e, width: n, height: r }), this.cropRect && (this.cropRect.setRect({ x: l.x * c + t, y: l.y * c + e, w: l.w * c, h: l.h * c }), this.cropRect.setClampRect({ x: t, y: e, w: n, h: r }), this.cropRect.setViewPortRect({ x: 0, y: 0, w: o, h: i })) }, bindStates: function () { var r = this; function n(t) { r.cropRect = function (l, n, s, r, o) { var f, a, t, i, e = "mce-", u = e + "crid-" + pt++; function d(t, e) { return { x: e.x - t.x, y: e.y - t.y, w: e.w, h: e.h } } function c(t, e, n, r) { var o, i, a, u, c; o = e.x, i = e.y, a = e.w, u = e.h, o += n * t.deltaX, i += r * t.deltaY, (a += n * t.deltaW) < 20 && (a = 20), (u += r * t.deltaH) < 20 && (u = 20), c = l = lt.clamp({ x: o, y: i, w: a, h: u }, s, "move" === t.name), c = d(s, c), f.fire("updateRect", { rect: c }), g(c) } function h(e) { function t(t, e) { e.h < 0 && (e.h = 0), e.w < 0 && (e.w = 0), ft("#" + u + "-" + t, r).css({ left: e.x, top: e.y, width: e.w, height: e.h }) } Y.each(a, function (t) { ft("#" + u + "-" + t.name, r).css({ left: e.w * t.xMul + e.x, top: e.h * t.yMul + e.y }) }), t("top", { x: n.x, y: n.y, w: n.w, h: e.y - n.y }), t("right", { x: e.x + e.w, y: e.y, w: n.w - e.x - e.w + n.x, h: e.h }), t("bottom", { x: n.x, y: e.y + e.h, w: n.w, h: n.h - e.y - e.h + n.y }), t("left", { x: n.x, y: e.y, w: e.x - n.x, h: e.h }), t("move", e) } function p(t) { h(l = t) } function g(t) { var e, n; p((e = s, { x: (n = t).x + e.x, y: n.y + e.y, w: n.w, h: n.h })) } return a = [{ name: "move", xMul: 0, yMul: 0, deltaX: 1, deltaY: 1, deltaW: 0, deltaH: 0, label: "Crop Mask" }, { name: "nw", xMul: 0, yMul: 0, deltaX: 1, deltaY: 1, deltaW: -1, deltaH: -1, label: "Top Left Crop Handle" }, { name: "ne", xMul: 1, yMul: 0, deltaX: 0, deltaY: 1, deltaW: 1, deltaH: -1, label: "Top Right Crop Handle" }, { name: "sw", xMul: 0, yMul: 1, deltaX: 1, deltaY: 0, deltaW: -1, deltaH: 1, label: "Bottom Left Crop Handle" }, { name: "se", xMul: 1, yMul: 1, deltaX: 0, deltaY: 0, deltaW: 1, deltaH: 1, label: "Bottom Right Crop Handle" }], i = ["top", "right", "bottom", "left"], ft('<div id="' + u + '" class="' + e + 'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(r), Y.each(i, function (t) { ft("#" + u, r).append('<div id="' + u + "-" + t + '"class="' + e + 'croprect-block" style="display: none" data-mce-bogus="all">') }), Y.each(a, function (t) { ft("#" + u, r).append('<div id="' + u + "-" + t.name + '" class="' + e + "croprect-handle " + e + "croprect-handle-" + t.name + '"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="' + t.label + '" aria-grabbed="false">') }), t = Y.map(a, function (e) { var n; return new (ct.get("DragHelper"))(u, { document: r.ownerDocument, handle: u + "-" + e.name, start: function () { n = l }, drag: function (t) { c(e, n, t.deltaX, t.deltaY) } }) }), h(l), ft(r).on("focusin focusout", function (t) { ft(t.target).attr("aria-grabbed", "focus" === t.type) }), ft(r).on("keydown", function (e) { var i; function t(t, e, n, r, o) { t.stopPropagation(), t.preventDefault(), c(i, n, r, o) } switch (Y.each(a, function (t) { if (e.target.id === u + "-" + t.name) return i = t, !1 }), e.keyCode) { case ht.LEFT: t(e, 0, l, -10, 0); break; case ht.RIGHT: t(e, 0, l, 10, 0); break; case ht.UP: t(e, 0, l, 0, -10); break; case ht.DOWN: t(e, 0, l, 0, 10); break; case ht.ENTER: case ht.SPACEBAR: e.preventDefault(), o() } }), f = Y.extend({ toggleVisibility: function (t) { var e; e = Y.map(a, function (t) { return "#" + u + "-" + t.name }).concat(Y.map(i, function (t) { return "#" + u + "-" + t })).join(","), t ? ft(e, r).show() : ft(e, r).hide() }, setClampRect: function (t) { s = t, h(l) }, setRect: p, getInnerRect: function () { return d(s, l) }, setInnerRect: g, setViewPortRect: function (t) { n = t, h(l) }, destroy: function () { Y.each(t, function (t) { t.destroy() }), t = [] } }, dt) }(t, r.state.get("viewRect"), r.state.get("viewRect"), r.getEl(), function () { r.fire("crop") }), r.cropRect.on("updateRect", function (t) { var e = t.rect, n = r.zoom(); e = { x: Math.round(e.x / n), y: Math.round(e.y / n), w: Math.round(e.w / n), h: Math.round(e.h / n) }, r.state.set("rect", e) }), r.on("remove", r.cropRect.destroy) } r.state.on("change:cropEnabled", function (t) { r.cropRect.toggleVisibility(t.value), r.repaintImage() }), r.state.on("change:zoom", function () { r.repaintImage() }), r.state.on("change:rect", function (t) { var e = t.value; r.cropRect || n(e), r.cropRect.setRect(e) }) } }))(t) } }; function mt(t) { return { blob: t, url: rt.createObjectURL(t) } } function vt(t) { t && rt.revokeObjectURL(t.url) } function yt(t) { Y.each(t, vt) } function bt(i, a, t, e) { var u, n, r, c, o, l, s, f, d, h, p, g, m, v, y, b, w, x, R, I, T, k, C, B, U, A, j, M = function () { var n = [], r = -1; function t() { return 0 < r } function e() { return -1 !== r && r < n.length - 1 } return { data: n, add: function (t) { var e; return e = n.splice(++r), n.push(t), { state: t, removed: e } }, undo: function () { if (t()) return n[--r] }, redo: function () { if (e()) return n[++r] }, canUndo: t, canRedo: e } }(), E = function (t) { return i.rtl ? t.reverse() : t }; function O(t) { var e, n, r, o; e = u.find("#w")[0], n = u.find("#h")[0], r = parseInt(e.value(), 10), o = parseInt(n.value(), 10), u.find("#constrain")[0].checked() && B && U && r && o && ("w" === t.control.settings.name ? (o = Math.round(r * A), n.value(o)) : (r = Math.round(o * j), e.value(r))), B = r, U = o } function z(t) { return Math.round(100 * t) + "%" } function D() { u.find("#undo").disabled(!M.canUndo()), u.find("#redo").disabled(!M.canRedo()), u.statusbar.find("#save").disabled(!M.canUndo()) } function S() { u.find("#undo").disabled(!0), u.find("#redo").disabled(!0) } function _(t) { t && f.imageSrc(t.url) } function H(e) { return function () { var t = Y.grep(C, function (t) { return t.settings.name !== e }); Y.each(t, function (t) { t.hide() }), e.show(), e.focus() } } function L(t) { _(c = mt(t)) } function F(t) { _(a = mt(t)), yt(M.add(a).removed), D() } function P() { var e = f.selection(); et.blobToImageResult(a.blob).then(function (t) { Q.crop(t, e.x, e.y, e.w, e.h).then($).then(function (t) { F(t), q() }) }) } var W = function (e) { var n = [].slice.call(arguments, 1); return function () { var t = c || a; et.blobToImageResult(t.blob).then(function (t) { e.apply(this, [t].concat(n)).then($).then(L) }) } }; function q() { _(a), vt(c), H(n)(), D() } function V() { c ? (F(c.blob), q()) : function t(e, n) { c ? n() : setTimeout(function () { 0 < e-- ? t(e, n) : i.windowManager.alert("Error: failed to apply image operation.") }, 10) }(100, V) } function N(t) { return ct.create("Form", { layout: "flex", direction: "row", labelGap: 5, border: "0 0 1 0", align: "center", pack: "center", padding: "0 10 0 10", spacing: 5, flex: 0, minHeight: 60, defaults: { classes: "imagetool", type: "button" }, items: t }) } var $ = function (t) { return t.toBlob() }; function X(t, e) { return N(E([{ text: "Back", onclick: q }, { type: "spacer", flex: 1 }, { text: "Apply", subtype: "primary", onclick: V }])).hide().on("show", function () { S(), et.blobToImageResult(a.blob).then(function (t) { return e(t) }).then($).then(function (t) { var e = mt(t); _(e), vt(c), c = e }) }) } function G(t, n, e, r, o) { return N(E([{ text: "Back", onclick: q }, { type: "spacer", flex: 1 }, { type: "slider", flex: 1, ondragend: function (t) { var e; e = t.value, et.blobToImageResult(a.blob).then(function (t) { return n(t, e) }).then($).then(function (t) { var e = mt(t); _(e), vt(c), c = e }) }, minValue: i.rtl ? o : r, maxValue: i.rtl ? r : o, value: e, previewFilter: z }, { type: "spacer", flex: 1 }, { text: "Apply", subtype: "primary", onclick: V }])).hide().on("show", function () { this.find("slider").value(e), S() }) } o = N(E([{ text: "Back", onclick: q }, { type: "spacer", flex: 1 }, { text: "Apply", subtype: "primary", onclick: P }])).hide().on("show hide", function (t) { f.toggleCropRect("show" === t.type) }).on("show", S), l = N(E([{ text: "Back", onclick: q }, { type: "spacer", flex: 1 }, { type: "textbox", name: "w", label: "Width", size: 4, onkeyup: O }, { type: "textbox", name: "h", label: "Height", size: 4, onkeyup: O }, { type: "checkbox", name: "constrain", text: "Constrain proportions", checked: !0, onchange: function (t) { !0 === t.control.value() && (A = U / B, j = B / U) } }, { type: "spacer", flex: 1 }, { text: "Apply", subtype: "primary", onclick: "submit" }])).hide().on("submit", function (t) { var e = parseInt(u.find("#w").value(), 10), n = parseInt(u.find("#h").value(), 10); t.preventDefault(), function (e) { for (var t = [], n = 1; n < arguments.length; n++)t[n - 1] = arguments[n]; var r = [].slice.call(arguments, 1); return function () { et.blobToImageResult(a.blob).then(function (t) { e.apply(this, [t].concat(r)).then($).then(F) }) } }(Q.resize, e, n)(), q() }).on("show", S), s = N(E([{ text: "Back", onclick: q }, { type: "spacer", flex: 1 }, { icon: "fliph", tooltip: "Flip horizontally", onclick: W(Q.flip, "h") }, { icon: "flipv", tooltip: "Flip vertically", onclick: W(Q.flip, "v") }, { icon: "rotateleft", tooltip: "Rotate counterclockwise", onclick: W(Q.rotate, -90) }, { icon: "rotateright", tooltip: "Rotate clockwise", onclick: W(Q.rotate, 90) }, { type: "spacer", flex: 1 }, { text: "Apply", subtype: "primary", onclick: V }])).hide().on("show", S), p = X(0, Q.invert), R = X(0, Q.sharpen), I = X(0, Q.emboss), g = G(0, Q.brightness, 0, -1, 1), m = G(0, Q.hue, 180, 0, 360), v = G(0, Q.saturate, 0, -1, 1), y = G(0, Q.contrast, 0, -1, 1), b = G(0, Q.grayscale, 0, 0, 1), w = G(0, Q.sepia, 0, 0, 1), x = function (t, o) { function e() { var e, n, r; e = u.find("#r")[0].value(), n = u.find("#g")[0].value(), r = u.find("#b")[0].value(), et.blobToImageResult(a.blob).then(function (t) { return o(t, e, n, r) }).then($).then(function (t) { var e = mt(t); _(e), vt(c), c = e }) } var n = i.rtl ? 2 : 0, r = i.rtl ? 0 : 2; return N(E([{ text: "Back", onclick: q }, { type: "spacer", flex: 1 }, { type: "slider", label: "R", name: "r", minValue: n, value: 1, maxValue: r, ondragend: e, previewFilter: z }, { type: "slider", label: "G", name: "g", minValue: n, value: 1, maxValue: r, ondragend: e, previewFilter: z }, { type: "slider", label: "B", name: "b", minValue: n, value: 1, maxValue: r, ondragend: e, previewFilter: z }, { type: "spacer", flex: 1 }, { text: "Apply", subtype: "primary", onclick: V }])).hide().on("show", function () { u.find("#r,#g,#b").value(1), S() }) }(0, Q.colorize), T = G(0, Q.gamma, 0, -1, 1), k = G(0, Q.exposure, 1, 0, 2), r = N(E([{ text: "Back", onclick: q }, { type: "spacer", flex: 1 }, { text: "hue", icon: "hue", onclick: H(m) }, { text: "saturate", icon: "saturate", onclick: H(v) }, { text: "sepia", icon: "sepia", onclick: H(w) }, { text: "emboss", icon: "emboss", onclick: H(I) }, { text: "exposure", icon: "exposure", onclick: H(k) }, { type: "spacer", flex: 1 }])).hide(), n = N(E([{ tooltip: "Crop", icon: "crop", onclick: H(o) }, { tooltip: "Resize", icon: "resize2", onclick: H(l) }, { tooltip: "Orientation", icon: "orientation", onclick: H(s) }, { tooltip: "Brightness", icon: "sun", onclick: H(g) }, { tooltip: "Sharpen", icon: "sharpen", onclick: H(R) }, { tooltip: "Contrast", icon: "contrast", onclick: H(y) }, { tooltip: "Color levels", icon: "drop", onclick: H(x) }, { tooltip: "Gamma", icon: "gamma", onclick: H(T) }, { tooltip: "Invert", icon: "invert", onclick: H(p) }])), f = gt.create({ flex: 1, imageSrc: a.url }), d = ct.create("Container", { layout: "flex", direction: "column", pack: "start", border: "0 1 0 0", padding: 5, spacing: 5, items: [{ type: "button", icon: "undo", tooltip: "Undo", name: "undo", onclick: function () { _(a = M.undo()), D() } }, { type: "button", icon: "redo", tooltip: "Redo", name: "redo", onclick: function () { _(a = M.redo()), D() } }, { type: "button", icon: "zoomin", tooltip: "Zoom in", onclick: function () { var t = f.zoom(); t < 2 && (t += .1), f.zoom(t) } }, { type: "button", icon: "zoomout", tooltip: "Zoom out", onclick: function () { var t = f.zoom(); .1 < t && (t -= .1), f.zoom(t) } }] }), h = ct.create("Container", { type: "container", layout: "flex", direction: "row", align: "stretch", flex: 1, items: E([d, f]) }), C = [n, o, l, s, r, p, g, m, v, y, b, w, x, R, I, T, k], (u = i.windowManager.open({ layout: "flex", direction: "column", align: "stretch", minWidth: Math.min(ut.DOM.getViewPort().w, 800), minHeight: Math.min(ut.DOM.getViewPort().h, 650), title: "Edit image", items: C.concat([h]), buttons: E([{ text: "Save", name: "save", subtype: "primary", onclick: function () { t(a.blob), u.close() } }, { text: "Cancel", onclick: "close" }]) })).on("close", function () { e(), yt(M.data), c = M = null }), M.add(a), D(), f.on("load", function () { B = f.imageSize().w, U = f.imageSize().h, A = U / B, j = B / U, u.find("#w").value(B), u.find("#h").value(U) }), f.on("crop", P) } var wt = { edit: function (r, t) { return new it(function (e, n) { return t.toBlob().then(function (t) { bt(r, mt(t), e, n) }) }) } }, xt = { getImageSize: function (t) { var e, n; function r(t) { return /^[0-9\.]+px$/.test(t) } return e = t.style.width, n = t.style.height, e || n ? r(e) && r(n) ? { w: parseInt(e, 10), h: parseInt(n, 10) } : null : (e = t.width, n = t.height, e && n ? { w: parseInt(e, 10), h: parseInt(n, 10) } : null) }, setImageSize: function (t, e) { var n, r; e && (n = t.style.width, r = t.style.height, (n || r) && (t.style.width = e.w + "px", t.style.height = e.h + "px", t.removeAttribute("data-mce-style")), n = t.width, r = t.height, (n || r) && (t.setAttribute("width", e.w), t.setAttribute("height", e.h))) }, getNaturalImageSize: function (t) { return { w: t.naturalWidth, h: t.naturalHeight } } }, Rt = function (e) { return function (t) { return function (t) { if (null === t) return "null"; var e = typeof t; return "object" === e && Array.prototype.isPrototypeOf(t) ? "array" : "object" === e && String.prototype.isPrototypeOf(t) ? "string" : e }(t) === e } }, It = { isString: Rt("string"), isObject: Rt("object"), isArray: Rt("array"), isNull: Rt("null"), isBoolean: Rt("boolean"), isUndefined: Rt("undefined"), isFunction: Rt("function"), isNumber: Rt("number") }, Tt = (Array.prototype.indexOf, undefined, Array.prototype.push, Array.prototype.slice, It.isFunction(Array.from) && Array.from, function (t, e) { for (var n = 0, r = t.length; n < r; n++) { var o = t[n]; if (e(o, n, t)) return w.some(o) } return w.none() }); function kt() { return new (T.getOrDie("XMLHttpRequest")) } var Ct = function (t) { return null !== t && t !== undefined }, Bt = { traverse: function (t, e) { var n; return n = e.reduce(function (t, e) { return Ct(t) ? t[e] : undefined }, t), Ct(n) ? n : null }, readBlob: function (e) { return new it(function (n) { var t = new k; t.onload = function (t) { var e = t.target; n(e.result) }, t.readAsText(e) }) }, requestUrlAsBlob: function (e, r, o) { return new it(function (t) { var n; (n = new kt).onreadystatechange = function () { 4 === n.readyState && t({ status: n.status, blob: this.response }) }, n.open("GET", e, !0), n.withCredentials = o, Y.each(r, function (t, e) { n.setRequestHeader(e, t) }), n.responseType = "blob", n.send() }) }, parseJson: function (t) { var e; try { e = JSON.parse(t) } catch (n) { } return e } }, Ut = [{ code: 404, message: "Could not find Image Proxy" }, { code: 403, message: "Rejected request" }, { code: 0, message: "Incorrect Image Proxy URL" }], At = [{ type: "key_missing", message: "The request did not include an api key." }, { type: "key_not_found", message: "The provided api key could not be found." }, { type: "domain_not_trusted", message: "The api key is not valid for the request origins." }], jt = function (e) { return "ImageProxy HTTP error: " + Tt(Ut, function (t) { return e === t.code }).fold(f.constant("Unknown ImageProxy error"), function (t) { return t.message }) }, Mt = function (t) { var e = jt(t); return it.reject(e) }, Et = function (e) { return Tt(At, function (t) { return t.type === e }).fold(f.constant("Unknown service error"), function (t) { return t.message }) }, Ot = function (t, e) { return Bt.readBlob(e).then(function (t) { var e, n, r, o = (e = t, n = Bt.parseJson(e), "ImageProxy Service error: " + ((r = Bt.traverse(n, ["error", "type"])) ? Et(r) : "Invalid JSON in service error message")); return it.reject(o) }) }, zt = { handleServiceErrorResponse: function (t, e) { return 400 === (n = t) || 403 === n || 500 === n ? Ot(0, e) : Mt(t); var n }, handleHttpError: Mt, getHttpErrorMsg: jt, getServiceErrorMsg: Et }, Dt = function (t, e) { var n, r, o, i = { "Content-Type": "application/json;charset=UTF-8", "tiny-api-key": e }; return Bt.requestUrlAsBlob((n = t, r = e, o = -1 === n.indexOf("?") ? "?" : "&", /[?&]apiKey=/.test(n) || !r ? n : n + o + "apiKey=" + encodeURIComponent(r)), i, !1).then(function (t) { return t.status < 200 || 300 <= t.status ? zt.handleServiceErrorResponse(t.status, t.blob) : it.resolve(t.blob) }) }, St = function (t, e, n) { return e ? Dt(t, e) : (r = t, o = n, Bt.requestUrlAsBlob(r, {}, o).then(function (t) { return t.status < 200 || 300 <= t.status ? zt.handleHttpError(t.status) : it.resolve(t.blob) })); var r, o }, _t = 0, Ht = function (t, e) { t.notificationManager.open({ text: e, type: "error" }) }, Lt = function (t) { return t.selection.getNode() }, Ft = function (t, e) { var n = e.src; return 0 === n.indexOf("data:") || 0 === n.indexOf("blob:") || new at(n).host === t.documentBaseURI.host }, Pt = function (t, e) { return -1 !== Y.inArray(t.getParam("imagetools_cors_hosts", [], "string[]"), new at(e.src).host) }, Wt = function (t, e) { var n, r, o, i, a = e.src; return Pt(t, e) ? St(e.src, null, (r = t, o = e, -1 !== Y.inArray(r.getParam("imagetools_credentials_hosts", [], "string[]"), new at(o.src).host))) : Ft(t, e) ? z(e) : (a = t.getParam("imagetools_proxy"), a += (-1 === a.indexOf("?") ? "?" : "&") + "url=" + encodeURIComponent(e.src), n = (i = t).getParam("api_key", i.getParam("imagetools_api_key", "", "string"), "string"), St(a, n, !1)) }, qt = function (t) { var e; return (e = t.editorUpload.blobCache.getByUri(Lt(t).src)) ? it.resolve(e.blob()) : Wt(t, Lt(t)) }, Vt = function (t, e) { var n = ot.setEditorTimeout(t, function () { t.editorUpload.uploadImagesAuto() }, t.getParam("images_upload_timeout", 3e4, "number")); e.set(n) }, Nt = function (t) { clearTimeout(t.get()) }, $t = function (c, l, s, f, d) { return l.toBlob().then(function (t) { var e, n, r, o, i, a, u; return r = c.editorUpload.blobCache, e = (i = Lt(c)).src, c.getParam("images_reuse_filename", !1, "boolean") && ((o = r.getByUri(e)) ? (e = o.uri(), n = o.name()) : (a = c, n = (u = e.match(/\/([^\/\?]+)?\.(?:jpeg|jpg|png|gif)(?:\?|$)/i)) ? a.dom.encode(u[1]) : null)), o = r.create({ id: "imagetools" + _t++, blob: t, base64: l.toBase64(), uri: e, name: n }), r.add(o), c.undoManager.transact(function () { c.$(i).on("load", function t() { c.$(i).off("load", t), c.nodeChanged(), s ? c.editorUpload.uploadImagesAuto() : (Nt(f), Vt(c, f)) }), d && c.$(i).attr({ width: d.w, height: d.h }), c.$(i).attr({ src: o.blobUri() }).removeAttr("data-mce-src") }), o }) }, Xt = function (e, n, t, r) { return function () { return e._scanForImages().then(f.curry(qt, e)).then(et.blobToImageResult).then(t).then(function (t) { return $t(e, t, !1, n, r) }, function (t) { Ht(e, t) }) } }, Gt = { rotate: function (n, r, o) { return function () { var t = xt.getImageSize(Lt(n)), e = t ? { w: t.h, h: t.w } : null; return Xt(n, r, function (t) { return Q.rotate(t, o) }, e)() } }, flip: function (t, e, n) { return function () { return Xt(t, e, function (t) { return Q.flip(t, n) })() } }, editImageDialog: function (e, r) { return function () { var o = Lt(e), i = xt.getNaturalImageSize(o), n = function (r) { return new it(function (n) { O(r).then(function (t) { var e = xt.getNaturalImageSize(t); i.w === e.w && i.h === e.h || xt.getImageSize(o) && xt.setImageSize(o, e), rt.revokeObjectURL(t.src), n(r) }) }) }; qt(e).then(et.blobToImageResult).then(f.curry(function (e, t) { return wt.edit(e, t).then(n).then(et.blobToImageResult).then(function (t) { return $t(e, t, !0, r) }, function () { }) }, e), function (t) { Ht(e, t) }) } }, isEditableImage: function (t, e) { return t.dom.is(e, "img:not([data-mce-object],[data-mce-placeholder])") && (Ft(t, e) || Pt(t, e) || t.settings.imagetools_proxy) }, cancelTimedUpload: Nt }, Yt = function (n, t) { Y.each({ mceImageRotateLeft: Gt.rotate(n, t, -90), mceImageRotateRight: Gt.rotate(n, t, 90), mceImageFlipVertical: Gt.flip(n, t, "v"), mceImageFlipHorizontal: Gt.flip(n, t, "h"), mceEditImage: Gt.editImageDialog(n, t) }, function (t, e) { n.addCommand(e, t) }) }, Jt = function (n, r, o) { n.on("NodeChange", function (t) { var e = o.get(); e && e.src !== t.element.src && (Gt.cancelTimedUpload(r), n.editorUpload.uploadImagesAuto(), o.set(null)), Gt.isEditableImage(n, t.element) && o.set(t.element) }) }, Kt = function (t) { t.addButton("rotateleft", { title: "Rotate counterclockwise", cmd: "mceImageRotateLeft" }), t.addButton("rotateright", { title: "Rotate clockwise", cmd: "mceImageRotateRight" }), t.addButton("flipv", { title: "Flip vertically", cmd: "mceImageFlipVertical" }), t.addButton("fliph", { title: "Flip horizontally", cmd: "mceImageFlipHorizontal" }), t.addButton("editimage", { title: "Edit image", cmd: "mceEditImage" }), t.addButton("imageoptions", { title: "Image options", icon: "options", cmd: "mceImage" }) }, Zt = function (t) { t.addContextToolbar(f.curry(Gt.isEditableImage, t), t.getParam("imagetools_toolbar", "rotateleft rotateright | flipv fliph | crop editimage imageoptions")) }; t.add("imagetools", function (t) { var e = r(0), n = r(null); Yt(t, e), Kt(t), Zt(t), Jt(t, e, n) }) }();
!function () { "use strict"; var e = tinymce.util.Tools.resolve("tinymce.PluginManager"), d = tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"), i = tinymce.util.Tools.resolve("tinymce.EditorManager"), n = tinymce.util.Tools.resolve("tinymce.Env"), y = tinymce.util.Tools.resolve("tinymce.util.Tools"), s = function (e) { return e.getParam("importcss_merge_classes") }, r = function (e) { return e.getParam("importcss_exclusive") }, _ = function (e) { return e.getParam("importcss_selector_converter") }, u = function (e) { return e.getParam("importcss_selector_filter") }, l = function (e) { return e.getParam("importcss_groups") }, a = function (e) { return e.getParam("importcss_append") }, f = function (e) { return e.getParam("importcss_file_filter") }, m = function (e) { var t = n.cacheSuffix; return "string" == typeof e && (e = e.replace("?" + t, "").replace("&" + t, "")), e }, g = function (e, t) { var n = e.settings, r = !1 !== n.skin && (n.skin || "lightgray"); return !!r && t === (n.skin_url ? e.documentBaseURI.toAbsolute(n.skin_url) : i.baseURL + "/skins/" + r) + "/content" + (e.inline ? ".inline" : "") + ".min.css" }, x = function (t) { return "string" == typeof t ? function (e) { return -1 !== e.indexOf(t) } : t instanceof RegExp ? function (e) { return t.test(e) } : t }, T = function (o, e, s) { var u = [], n = {}; y.each(o.contentCSS, function (e) { n[e] = !0 }), s || (s = function (e, t) { return t || n[e] }); try { y.each(e.styleSheets, function (e) { !function t(e, n) { var r, i = e.href; if ((i = m(i)) && s(i, n) && !g(o, i)) { y.each(e.imports, function (e) { t(e, !0) }); try { r = e.cssRules || e.rules } catch (c) { } y.each(r, function (e) { e.styleSheet ? t(e.styleSheet, !0) : e.selectorText && y.each(e.selectorText.split(","), function (e) { u.push(y.trim(e)) }) }) } }(e) }) } catch (t) { } return u }, k = function (e, t) { var n, r = /^(?:([a-z0-9\-_]+))?(\.[a-z0-9_\-\.]+)$/i.exec(t); if (r) { var i = r[1], c = r[2].substr(1).split(".").join(" "), o = y.makeMap("a,img"); return r[1] ? (n = { title: t }, e.schema.getTextBlockElements()[i] ? n.block = i : e.schema.getBlockElements()[i] || o[i.toLowerCase()] ? n.selector = i : n.inline = i) : r[2] && (n = { inline: "span", title: t.substr(1), classes: c }), !1 !== s(e) ? n.classes = c : n.attributes = { "class": c }, n } }, P = function (e, t) { return null === t || !1 !== r(e) }, c = k, t = function (h) { h.on("renderFormatsMenu", function (e) { var t, p = {}, c = x(u(h)), v = e.control, o = (t = l(h), y.map(t, function (e) { return y.extend({}, e, { original: e, selectors: {}, filter: x(e.filter), item: { text: e.title, menu: [] } }) })), s = function (e, t) { if (f = e, g = p, !(P(h, m = t) ? f in g : f in m.selectors)) { u = e, a = p, P(h, l = t) ? a[u] = !0 : l.selectors[u] = !0; var n = (c = (i = h).plugins.importcss, o = e, ((s = t) && s.selector_converter ? s.selector_converter : _(i) ? _(i) : function () { return k(i, o) }).call(c, o, s)); if (n) { var r = n.name || d.DOM.uniqueId(); return h.formatter.register(r, n), y.extend({}, v.settings.itemDefaults, { text: n.title, format: r }) } } var i, c, o, s, u, l, a, f, m, g; return null }; a(h) || v.items().remove(), y.each(T(h, e.doc || h.getDoc(), x(f(h))), function (n) { if (-1 === n.indexOf(".mce-") && (!c || c(n))) { var e = (r = o, i = n, y.grep(r, function (e) { return !e.filter || e.filter(i) })); if (0 < e.length) y.each(e, function (e) { var t = s(n, e); t && e.item.menu.push(t) }); else { var t = s(n, null); t && v.add(t) } } var r, i }), y.each(o, function (e) { 0 < e.item.menu.length && v.add(e.item) }), e.control.renderNew() }) }, o = function (t) { return { convertSelectorToFormat: function (e) { return c(t, e) } } }; e.add("importcss", function (e) { return t(e), o(e) }) }();
!function () { "use strict"; var r = function (e) { var t = e, n = function () { return t }; return { get: n, set: function (e) { t = e }, clone: function () { return r(n()) } } }, e = tinymce.util.Tools.resolve("tinymce.PluginManager"), n = function (e) { return e.getParam("insertdatetime_timeformat", e.translate("%H:%M:%S")) }, a = function (e) { return e.getParam("insertdatetime_formats", ["%H:%M:%S", "%Y-%m-%d", "%I:%M:%S %p", "%D"]) }, t = function (e) { return e.getParam("insertdatetime_dateformat", e.translate("%Y-%m-%d")) }, i = n, o = a, u = function (e) { var t = a(e); return 0 < t.length ? t[0] : n(e) }, m = function (e) { return e.getParam("insertdatetime_element", !1) }, c = "Sun Mon Tue Wed Thu Fri Sat Sun".split(" "), l = "Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "), s = "Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "), d = "January February March April May June July August September October November December".split(" "), p = function (e, t) { if ((e = "" + e).length < t) for (var n = 0; n < t - e.length; n++)e = "0" + e; return e }, f = function (e, t, n) { return n = n || new Date, t = (t = (t = (t = (t = (t = (t = (t = (t = (t = (t = (t = (t = (t = (t = (t = t.replace("%D", "%m/%d/%Y")).replace("%r", "%I:%M:%S %p")).replace("%Y", "" + n.getFullYear())).replace("%y", "" + n.getYear())).replace("%m", p(n.getMonth() + 1, 2))).replace("%d", p(n.getDate(), 2))).replace("%H", "" + p(n.getHours(), 2))).replace("%M", "" + p(n.getMinutes(), 2))).replace("%S", "" + p(n.getSeconds(), 2))).replace("%I", "" + ((n.getHours() + 11) % 12 + 1))).replace("%p", n.getHours() < 12 ? "AM" : "PM")).replace("%B", "" + e.translate(d[n.getMonth()]))).replace("%b", "" + e.translate(s[n.getMonth()]))).replace("%A", "" + e.translate(l[n.getDay()]))).replace("%a", "" + e.translate(c[n.getDay()]))).replace("%%", "%") }, g = function (e, t) { if (m(e)) { var n = f(e, t), r = void 0; r = /%[HMSIp]/.test(t) ? f(e, "%Y-%m-%dT%H:%M") : f(e, "%Y-%m-%d"); var a = e.dom.getParent(e.selection.getStart(), "time"); a ? (o = a, u = r, c = n, l = (i = e).dom.create("time", { datetime: u }, c), o.parentNode.insertBefore(l, o), i.dom.remove(o), i.selection.select(l, !0), i.selection.collapse(!1)) : e.insertContent('<time datetime="' + r + '">' + n + "</time>") } else e.insertContent(f(e, t)); var i, o, u, c, l }, y = f, M = function (e) { e.addCommand("mceInsertDate", function () { g(e, t(e)) }), e.addCommand("mceInsertTime", function () { g(e, i(e)) }) }, v = tinymce.util.Tools.resolve("tinymce.util.Tools"), S = function (t, n) { var r, a, e, i = (a = n, e = o(r = t), v.map(e, function (e) { return { text: y(r, e), onclick: function () { a.set(e), g(r, e) } } })); t.addButton("insertdatetime", { type: "splitbutton", title: "Insert date/time", menu: i, onclick: function () { var e = n.get(); g(t, e || u(t)) } }), t.addMenuItem("insertdatetime", { icon: "date", text: "Date/time", menu: i, context: "insert" }) }; e.add("insertdatetime", function (e) { var t = r(null); M(e), S(e, t) }) }();
!function () { "use strict"; var e = tinymce.util.Tools.resolve("tinymce.PluginManager"), o = tinymce.util.Tools.resolve("tinymce.util.Tools"), t = function (a) { a.settings.inline_styles = !1, a.on("init", function () { var e, t, n, i; e = a, t = "p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li,table,img", n = o.explode(e.settings.font_size_style_values), i = e.schema, e.formatter.register({ alignleft: { selector: t, attributes: { align: "left" } }, aligncenter: { selector: t, attributes: { align: "center" } }, alignright: { selector: t, attributes: { align: "right" } }, alignjustify: { selector: t, attributes: { align: "justify" } }, bold: [{ inline: "b", remove: "all" }, { inline: "strong", remove: "all" }, { inline: "span", styles: { fontWeight: "bold" } }], italic: [{ inline: "i", remove: "all" }, { inline: "em", remove: "all" }, { inline: "span", styles: { fontStyle: "italic" } }], underline: [{ inline: "u", remove: "all" }, { inline: "span", styles: { textDecoration: "underline" }, exact: !0 }], strikethrough: [{ inline: "strike", remove: "all" }, { inline: "span", styles: { textDecoration: "line-through" }, exact: !0 }], fontname: { inline: "font", attributes: { face: "%value" } }, fontsize: { inline: "font", attributes: { size: function (e) { return o.inArray(n, e.value) + 1 } } }, forecolor: { inline: "font", attributes: { color: "%value" } }, hilitecolor: { inline: "font", styles: { backgroundColor: "%value" } } }), o.each("b,i,u,strike".split(","), function (e) { i.addValidElements(e + "[*]") }), i.getElementRule("font") || i.addValidElements("font[face|size|color|style]"), o.each(t.split(","), function (e) { var t = i.getElementRule(e); t && (t.attributes.align || (t.attributes.align = {}, t.attributesOrder.push("align"))) }) }) }, n = function (i) { i.addButton("fontsizeselect", function () { var o = [], e = i.settings.fontsizeFormats || "8pt=1 10pt=2 12pt=3 14pt=4 18pt=5 24pt=6 36pt=7"; return i.$.each(e.split(" "), function (e, t) { var n = t, i = t, a = t.split("="); 1 < a.length && (n = a[0], i = a[1]), o.push({ text: n, value: i }) }), { type: "listbox", text: "Font Sizes", tooltip: "Font Sizes", values: o, fixedWidth: !0, onPostRender: function () { var t = this; i.on("NodeChange", function () { var e; (e = i.dom.getParent(i.selection.getNode(), "font")) ? t.value(e.size) : t.value("") }) }, onclick: function (e) { e.control.settings.value && i.execCommand("FontSize", !1, e.control.settings.value) } } }), i.addButton("fontselect", function () { var n = [], e = function (e) { for (var t = (e = e.replace(/;$/, "").split(";")).length; t--;)e[t] = e[t].split("="); return e }(i.settings.font_formats || "Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats"); return i.$.each(e, function (e, t) { n.push({ text: { raw: t[0] }, value: t[1], textStyle: -1 === t[1].indexOf("dings") ? "font-family:" + t[1] : "" }) }), { type: "listbox", text: "Font Family", tooltip: "Font Family", values: n, fixedWidth: !0, onPostRender: function () { var t = this; i.on("NodeChange", function () { var e; (e = i.dom.getParent(i.selection.getNode(), "font")) ? t.value(e.face) : t.value("") }) }, onselect: function (e) { e.control.settings.value && i.execCommand("FontName", !1, e.control.settings.value) } } }) }; e.add("legacyoutput", function (e) { t(e), n(e) }) }();
!function () { "use strict"; var t = tinymce.util.Tools.resolve("tinymce.PluginManager"), n = tinymce.util.Tools.resolve("tinymce.util.VK"), e = function (t) { return t.target_list }, o = function (t) { return t.rel_list }, i = function (t) { return t.link_class_list }, p = function (t) { return "boolean" == typeof t.link_assume_external_targets && t.link_assume_external_targets }, a = function (t) { return "boolean" == typeof t.link_context_toolbar && t.link_context_toolbar }, r = function (t) { return t.link_list }, k = function (t) { return "string" == typeof t.default_link_target }, y = function (t) { return t.default_link_target }, b = e, _ = function (t, e) { t.settings.target_list = e }, w = function (t) { return !1 !== e(t) }, T = o, C = function (t) { return o(t) !== undefined }, M = i, O = function (t) { return i(t) !== undefined }, R = function (t) { return !1 !== t.link_title }, N = function (t) { return "boolean" == typeof t.allow_unsafe_link_target && t.allow_unsafe_link_target }, l = tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"), u = tinymce.util.Tools.resolve("tinymce.Env"), c = function (t) { if (!u.ie || 10 < u.ie) { var e = document.createElement("a"); e.target = "_blank", e.href = t, e.rel = "noreferrer noopener"; var n = document.createEvent("MouseEvents"); n.initMouseEvent("click", !0, !0, window, 0, 0, 0, 0, 0, !1, !1, !1, !1, 0, null), r = e, a = n, document.body.appendChild(r), r.dispatchEvent(a), document.body.removeChild(r) } else { var o = window.open("", "_blank"); if (o) { o.opener = null; var i = o.document; i.open(), i.write('<meta http-equiv="refresh" content="0; url=' + l.DOM.encode(t) + '">'), i.close() } } var r, a }, A = tinymce.util.Tools.resolve("tinymce.util.Tools"), s = function (t, e) { var n, o, i = ["noopener"], r = t ? t.split(/\s+/) : [], a = function (t) { return t.filter(function (t) { return -1 === A.inArray(i, t) }) }; return (r = e ? (n = a(n = r)).length ? n.concat(i) : i : a(r)).length ? (o = r, A.trim(o.sort().join(" "))) : null }, f = function (t, e) { return e = e || t.selection.getNode(), m(e) ? t.dom.select("a[href]", e)[0] : t.dom.getParent(e, "a[href]") }, d = function (t) { return t && "A" === t.nodeName && t.href }, m = function (t) { return t && "FIGURE" === t.nodeName && /\bimage\b/i.test(t.className) }, v = function (t, e) { var n, o; (o = t.dom.select("img", e)[0]) && (n = t.dom.getParents(o, "a[href]", e)[0]) && (n.parentNode.insertBefore(o, n), t.dom.remove(n)) }, g = function (t, e, n) { var o, i; (i = t.dom.select("img", e)[0]) && (o = t.dom.create("a", n), i.parentNode.insertBefore(o, i), o.appendChild(i)) }, L = function (i, r) { return function (o) { i.undoManager.transact(function () { var t = i.selection.getNode(), e = f(i, t), n = { href: o.href, target: o.target ? o.target : null, rel: o.rel ? o.rel : null, "class": o["class"] ? o["class"] : null, title: o.title ? o.title : null }; C(i.settings) || !1 !== N(i.settings) || (n.rel = s(n.rel, "_blank" === n.target)), o.href === r.href && (r.attach(), r = {}), e ? (i.focus(), o.hasOwnProperty("text") && ("innerText" in e ? e.innerText = o.text : e.textContent = o.text), i.dom.setAttribs(e, n), i.selection.select(e), i.undoManager.add()) : m(t) ? g(i, t, n) : o.hasOwnProperty("text") ? i.insertContent(i.dom.createHTML("a", n, i.dom.encode(o.text))) : i.execCommand("mceInsertLink", !1, n) }) } }, P = function (e) { return function () { e.undoManager.transact(function () { var t = e.selection.getNode(); m(t) ? v(e, t) : e.execCommand("unlink") }) } }, h = d, x = function (t) { return 0 < A.grep(t, d).length }, E = function (t) { return !(/</.test(t) && (!/^<a [^>]+>[^<]+<\/a>$/.test(t) || -1 === t.indexOf("href="))) }, S = f, I = function (t, e) { var n = e ? e.innerText || e.textContent : t.getContent({ format: "text" }); return n.replace(/\uFEFF/g, "") }, K = s, U = tinymce.util.Tools.resolve("tinymce.util.Delay"), D = tinymce.util.Tools.resolve("tinymce.util.XHR"), B = {}, F = function (t, o, e) { var i = function (t, n) { return n = n || [], A.each(t, function (t) { var e = { text: t.text || t.title }; t.menu ? e.menu = i(t.menu) : (e.value = t.value, o && o(e)), n.push(e) }), n }; return i(t, e || []) }, q = function (e, t, n) { var o = e.selection.getRng(); U.setEditorTimeout(e, function () { e.windowManager.confirm(t, function (t) { e.selection.setRng(o), n(t) }) }) }, V = function (a, t) { var e, l, o, u, n, i, r, c, s, f, d, m = {}, v = a.selection, g = a.dom, h = function (t) { var e = o.find("#text"); (!e.value() || t.lastControl && e.value() === t.lastControl.text()) && e.value(t.control.text()), o.find("#href").value(t.control.value()) }, x = function () { l || !u || m.text || this.parent().parent().find("#text")[0].value(this.value()) }; u = E(v.getContent()), e = S(a), m.text = l = I(a.selection, e), m.href = e ? g.getAttrib(e, "href") : "", e ? m.target = g.getAttrib(e, "target") : k(a.settings) && (m.target = y(a.settings)), (d = g.getAttrib(e, "rel")) && (m.rel = d), (d = g.getAttrib(e, "class")) && (m["class"] = d), (d = g.getAttrib(e, "title")) && (m.title = d), u && (n = { name: "text", type: "textbox", size: 40, label: "Text to display", onchange: function () { m.text = this.value() } }), t && (i = { type: "listbox", label: "Link list", values: F(t, function (t) { t.value = a.convertURL(t.value || t.url, "href") }, [{ text: "None", value: "" }]), onselect: h, value: a.convertURL(m.href, "href"), onPostRender: function () { i = this } }), w(a.settings) && (b(a.settings) === undefined && _(a, [{ text: "None", value: "" }, { text: "New window", value: "_blank" }]), c = { name: "target", type: "listbox", label: "Target", values: F(b(a.settings)) }), C(a.settings) && (r = { name: "rel", type: "listbox", label: "Rel", values: F(T(a.settings), function (t) { !1 === N(a.settings) && (t.value = K(t.value, "_blank" === m.target)) }) }), O(a.settings) && (s = { name: "class", type: "listbox", label: "Class", values: F(M(a.settings), function (t) { t.value && (t.textStyle = function () { return a.formatter.getCssText({ inline: "a", classes: [t.value] }) }) }) }), R(a.settings) && (f = { name: "title", type: "textbox", label: "Title", value: m.title }), o = a.windowManager.open({ title: "Insert link", data: m, body: [{ name: "href", type: "filepicker", filetype: "file", size: 40, autofocus: !0, label: "Url", onchange: function (t) { var e = t.meta || {}; i && i.value(a.convertURL(this.value(), "href")), A.each(t.meta, function (t, e) { var n = o.find("#" + e); "text" === e ? 0 === l.length && (n.value(t), m.text = t) : n.value(t) }), e.attach && (B = { href: this.value(), attach: e.attach }), e.text || x.call(this) }, onkeyup: x, onpaste: x, onbeforecall: function (t) { t.meta = o.toJSON() } }, n, f, function (n) { var o = []; if (A.each(a.dom.select("a:not([href])"), function (t) { var e = t.name || t.id; e && o.push({ text: e, value: "#" + e, selected: -1 !== n.indexOf("#" + e) }) }), o.length) return o.unshift({ text: "None", value: "" }), { name: "anchor", type: "listbox", label: "Anchors", values: o, onselect: h } }(m.href), i, r, c, s], onSubmit: function (t) { var e = p(a.settings), n = L(a, B), o = P(a), i = A.extend({}, m, t.data), r = i.href; r ? (u && i.text !== l || delete i.text, 0 < r.indexOf("@") && -1 === r.indexOf("//") && -1 === r.indexOf("mailto:") ? q(a, "The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?", function (t) { t && (i.href = "mailto:" + r), n(i) }) : !0 === e && !/^\w+:/i.test(r) || !1 === e && /^\s*www[\.|\d\.]/i.test(r) ? q(a, "The URL you entered seems to be an external link. Do you want to add the required http:// prefix?", function (t) { t && (i.href = "http://" + r), n(i) }) : n(i)) : o() } }) }, z = function (t) { var e, n, o; n = V, "string" == typeof (o = r((e = t).settings)) ? D.send({ url: o, success: function (t) { n(e, JSON.parse(t)) } }) : "function" == typeof o ? o(function (t) { n(e, t) }) : n(e, o) }, H = function (t, e) { return t.dom.getParent(e, "a[href]") }, J = function (t) { return H(t, t.selection.getStart()) }, $ = function (t, e) { if (e) { var n = (i = e).getAttribute("data-mce-href") || i.getAttribute("href"); if (/^#/.test(n)) { var o = t.$(n); o.length && t.selection.scrollIntoView(o[0], !0) } else c(e.href) } var i }, j = function (t) { return function () { z(t) } }, G = function (t) { return function () { $(t, J(t)) } }, X = function (r) { return function (t) { var e, n, o, i; return !!(a(r.settings) && (!(i = r.plugins.contextmenu) || !i.isContextMenuVisible()) && h(t) && 3 === (o = (n = (e = r.selection).getRng()).startContainer).nodeType && e.isCollapsed() && 0 < n.startOffset && n.startOffset < o.data.length) } }, Q = function (o) { o.on("click", function (t) { var e = H(o, t.target); e && n.metaKeyPressed(t) && (t.preventDefault(), $(o, e)) }), o.on("keydown", function (t) { var e, n = J(o); n && 13 === t.keyCode && !0 === (e = t).altKey && !1 === e.shiftKey && !1 === e.ctrlKey && !1 === e.metaKey && (t.preventDefault(), $(o, n)) }) }, W = function (n) { return function () { var e = this; n.on("nodechange", function (t) { e.active(!n.readonly && !!S(n, t.element)) }) } }, Y = function (n) { return function () { var e = this, t = function (t) { x(t.parents) ? e.show() : e.hide() }; x(n.dom.getParents(n.selection.getStart())) || e.hide(), n.on("nodechange", t), e.on("remove", function () { n.off("nodechange", t) }) } }, Z = function (t) { t.addCommand("mceLink", j(t)) }, tt = function (t) { t.addShortcut("Meta+K", "", j(t)) }, et = function (t) { t.addButton("link", { active: !1, icon: "link", tooltip: "Insert/edit link", onclick: j(t), onpostrender: W(t) }), t.addButton("unlink", { active: !1, icon: "unlink", tooltip: "Remove link", onclick: P(t), onpostrender: W(t) }), t.addContextToolbar && t.addButton("openlink", { icon: "newtab", tooltip: "Open link", onclick: G(t) }) }, nt = function (t) { t.addMenuItem("openlink", { text: "Open link", icon: "newtab", onclick: G(t), onPostRender: Y(t), prependToContext: !0 }), t.addMenuItem("link", { icon: "link", text: "Link", shortcut: "Meta+K", onclick: j(t), stateSelector: "a[href]", context: "insert", prependToContext: !0 }), t.addMenuItem("unlink", { icon: "unlink", text: "Remove link", onclick: P(t), stateSelector: "a[href]" }) }, ot = function (t) { t.addContextToolbar && t.addContextToolbar(X(t), "openlink | link unlink") }; t.add("link", function (t) { et(t), nt(t), ot(t), Q(t), Z(t), tt(t) }) }();
!function () { "use strict"; var e = tinymce.util.Tools.resolve("tinymce.PluginManager"), d = tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"), l = tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"), n = tinymce.util.Tools.resolve("tinymce.util.VK"), p = tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager"), v = tinymce.util.Tools.resolve("tinymce.util.Tools"), t = tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"), o = function (e) { return e && "BR" === e.nodeName }, r = function (e) { return e && 3 === e.nodeType }, h = function (e) { return e && /^(OL|UL|DL)$/.test(e.nodeName) }, i = function (e) { return e && /^(LI|DT|DD)$/.test(e.nodeName) }, a = function (e) { return e && /^(TH|TD)$/.test(e.nodeName) }, C = o, s = function (e) { return e.parentNode.firstChild === e }, c = function (e) { return e.parentNode.lastChild === e }, y = function (e, t) { return t && !!e.schema.getTextBlockElements()[t.nodeName] }, f = function (e, t) { return e && e.nodeName in t }, u = function (e, t) { return !!o(t) && !(!e.isBlock(t.nextSibling) || o(t.previousSibling)) }, m = function (e, t, n) { var o = e.isEmpty(t); return !(n && 0 < e.select("span[data-mce-type=bookmark]", t).length) && o }, g = function (e, t) { return e.isChildOf(t, e.getRoot()) }, N = function (e, t) { var n = d.getNode(e, t); return i(e) && r(n) ? { container: n, offset: t >= e.childNodes.length ? n.data.length : 0 } : { container: e, offset: t } }, L = function (e) { var t = e.cloneRange(), n = N(e.startContainer, e.startOffset); t.setStart(n.container, n.offset); var o = N(e.endContainer, e.endOffset); return t.setEnd(o.container, o.offset), t }, S = t.DOM, b = function (r) { var i = {}, e = function (e) { var t, n, o; n = r[e ? "startContainer" : "endContainer"], o = r[e ? "startOffset" : "endOffset"], 1 === n.nodeType && (t = S.create("span", { "data-mce-type": "bookmark" }), n.hasChildNodes() ? (o = Math.min(o, n.childNodes.length - 1), e ? n.insertBefore(t, n.childNodes[o]) : S.insertAfter(t, n.childNodes[o])) : n.appendChild(t), n = t, o = 0), i[e ? "startContainer" : "endContainer"] = n, i[e ? "startOffset" : "endOffset"] = o }; return e(!0), r.collapsed || e(), i }, D = function (r) { function e(e) { var t, n, o; t = o = r[e ? "startContainer" : "endContainer"], n = r[e ? "startOffset" : "endOffset"], t && (1 === t.nodeType && (n = function (e) { for (var t = e.parentNode.firstChild, n = 0; t;) { if (t === e) return n; 1 === t.nodeType && "bookmark" === t.getAttribute("data-mce-type") || n++ , t = t.nextSibling } return -1 }(t), t = t.parentNode, S.remove(o), !t.hasChildNodes() && S.isBlock(t) && t.appendChild(S.create("br"))), r[e ? "startContainer" : "endContainer"] = t, r[e ? "startOffset" : "endOffset"] = n) } e(!0), e(); var t = S.createRng(); return t.setStart(r.startContainer, r.startOffset), r.endContainer && t.setEnd(r.endContainer, r.endOffset), L(t) }, k = t.DOM, T = function (e, t) { var n, o = t.parentNode; "LI" === o.nodeName && o.firstChild === t && ((n = o.previousSibling) && "LI" === n.nodeName ? (n.appendChild(t), m(e, o) && k.remove(o)) : k.setStyle(o, "listStyleType", "none")), h(o) && (n = o.previousSibling) && "LI" === n.nodeName && n.appendChild(t) }, I = function (t, e) { v.each(v.grep(t.select("ol,ul", e)), function (e) { T(t, e) }) }, B = tinymce.util.Tools.resolve("tinymce.dom.DomQuery"), R = function (e) { var t = e.selection.getStart(!0); return e.dom.getParent(t, "OL,UL,DL", O(e, t)) }, O = function (e, t) { var n = e.dom.getParents(t, "TD,TH"); return 0 < n.length ? n[0] : e.getBody() }, E = { getParentList: R, getSelectedSubLists: function (e) { var t, n, o, r = R(e), i = e.selection.getSelectedBlocks(); return o = i, (n = r) && 1 === o.length && o[0] === n ? (t = r, v.grep(t.querySelectorAll("ol,ul,dl"), function (e) { return h(e) })) : v.grep(i, function (e) { return h(e) && r !== e }) }, getSelectedListItems: function (e) { var n, t, o, r = e.selection.getSelectedBlocks(); return v.grep((n = e, t = r, o = v.map(t, function (e) { var t = n.dom.getParent(e, "li,dd,dt", O(n, e)); return t || e }), B.unique(o)), function (e) { return i(e) }) }, getClosestListRootElm: O }, A = tinymce.util.Tools.resolve("tinymce.Env"), P = t.DOM, x = function (e, t, n) { var o, r, i, a = P.createFragment(), s = e.schema.getBlockElements(); if (e.settings.forced_root_block && (n = n || e.settings.forced_root_block), n && ((r = P.create(n)).tagName === e.settings.forced_root_block && P.setAttribs(r, e.settings.forced_root_block_attrs), f(t.firstChild, s) || a.appendChild(r)), t) for (; o = t.firstChild;) { var d = o.nodeName; i || "SPAN" === d && "bookmark" === o.getAttribute("data-mce-type") || (i = !0), f(o, s) ? (a.appendChild(o), r = null) : n ? (r || (r = P.create(n), a.appendChild(r)), r.appendChild(o)) : a.appendChild(o) } return e.settings.forced_root_block ? i || A.ie && !(10 < A.ie) || r.appendChild(P.create("br", { "data-mce-bogus": "1" })) : a.appendChild(P.create("br")), a }, _ = t.DOM, M = function (e, t, n, o) { var r, i, a, s, d; for (a = _.select('span[data-mce-type="bookmark"]', t), o = o || x(e, n), (r = _.createRng()).setStartAfter(n), r.setEndAfter(t), s = (i = r.extractContents()).firstChild; s; s = s.firstChild)if ("LI" === s.nodeName && e.dom.isEmpty(s)) { _.remove(s); break } e.dom.isEmpty(i) || _.insertAfter(i, t), _.insertAfter(o, t), m(e.dom, n.parentNode) && (d = n.parentNode, v.each(a, function (e) { d.parentNode.insertBefore(e, n.parentNode) }), _.remove(d)), _.remove(n), m(e.dom, t) && _.remove(t) }, U = t.DOM, H = function (e, t) { m(e, t) && U.remove(t) }, $ = function (e, t) { var n, o, r = t.parentNode; return r ? (n = r.parentNode, r === e.getBody() || ("DD" === t.nodeName ? U.rename(t, "DT") : s(t) && c(t) ? "LI" === n.nodeName ? (U.insertAfter(t, n), H(e.dom, n), U.remove(r)) : h(n) ? U.remove(r, !0) : (n.insertBefore(x(e, t), r), U.remove(r)) : s(t) ? "LI" === n.nodeName ? (U.insertAfter(t, n), t.appendChild(r), H(e.dom, n)) : h(n) ? n.insertBefore(t, r) : (n.insertBefore(x(e, t), r), U.remove(t)) : c(t) ? "LI" === n.nodeName ? U.insertAfter(t, n) : h(n) ? U.insertAfter(t, r) : (U.insertAfter(x(e, t), r), U.remove(t)) : ("LI" === n.nodeName ? (r = n, o = x(e, t, "LI")) : o = h(n) ? x(e, t, "LI") : x(e, t), M(e, r, t, o), I(e.dom, r.parentNode)))) : H(e.dom, t), !0 }, w = $, K = function (e) { var t = E.getSelectedListItems(e); if (t.length) { var n = b(e.selection.getRng()), o = void 0, r = void 0, i = E.getClosestListRootElm(e, e.selection.getStart(!0)); for (o = t.length; o--;)for (var a = t[o].parentNode; a && a !== i;) { for (r = t.length; r--;)if (t[r] === a) { t.splice(o, 1); break } a = a.parentNode } for (o = 0; o < t.length && ($(e, t[o]) || 0 !== o); o++); return e.selection.setRng(D(n)), e.nodeChanged(), !0 } }, Q = function (n, e) { v.each(e, function (e, t) { n.setAttribute(t, e) }) }, W = function (e, t, n) { var o, r, i, a, s, d, l; o = e, r = t, a = (i = n)["list-style-type"] ? i["list-style-type"] : null, o.setStyle(r, "list-style-type", a), s = e, Q(d = t, (l = n)["list-attributes"]), v.each(s.select("li", d), function (e) { Q(e, l["list-item-attributes"]) }) }, j = function (e, t, n, o) { var r, i; for (r = t[n ? "startContainer" : "endContainer"], i = t[n ? "startOffset" : "endOffset"], 1 === r.nodeType && (r = r.childNodes[Math.min(i, r.childNodes.length - 1)] || r), !n && C(r.nextSibling) && (r = r.nextSibling); r.parentNode !== o;) { if (y(e, r)) return r; if (/^(TD|TH)$/.test(r.parentNode.nodeName)) return r; r = r.parentNode } return r }, q = function (c, f, u) { void 0 === u && (u = {}); var e, t = c.selection.getRng(!0), m = "LI", n = E.getClosestListRootElm(c, c.selection.getStart(!0)), g = c.dom; "false" !== g.getContentEditable(c.selection.getNode()) && ("DL" === (f = f.toUpperCase()) && (m = "DT"), e = b(t), v.each(function (n, e, o) { for (var r, i = [], a = n.dom, t = j(n, e, !0, o), s = j(n, e, !1, o), d = [], l = t; l && (d.push(l), l !== s); l = l.nextSibling); return v.each(d, function (e) { if (y(n, e)) return i.push(e), void (r = null); if (a.isBlock(e) || C(e)) return C(e) && a.remove(e), void (r = null); var t = e.nextSibling; p.isBookmarkNode(e) && (y(n, t) || !t && e.parentNode === o) ? r = null : (r || (r = a.create("p"), e.parentNode.insertBefore(r, e), i.push(r)), r.appendChild(e)) }), i }(c, t, n), function (e) { var t, n, o, r, i, a, s, d, l; (n = e.previousSibling) && h(n) && n.nodeName === f && (o = n, r = u, i = g.getStyle(o, "list-style-type"), a = r ? r["list-style-type"] : "", i === (a = null === a ? "" : a)) ? (t = n, e = g.rename(e, m), n.appendChild(e)) : (t = g.create(f), e.parentNode.insertBefore(t, e), t.appendChild(e), e = g.rename(e, m)), s = g, d = e, l = ["margin", "margin-right", "margin-bottom", "margin-left", "margin-top", "padding", "padding-right", "padding-bottom", "padding-left", "padding-top"], v.each(l, function (e) { return s.setStyle(d, ((t = {})[e] = "", t)); var t }), W(g, t, u), z(c.dom, t) }), c.selection.setRng(D(e))) }, F = function (o) { var e = b(o.selection.getRng(!0)), r = E.getClosestListRootElm(o, o.selection.getStart(!0)), t = E.getSelectedListItems(o), n = v.grep(t, function (e) { return o.dom.isEmpty(e) }); t = v.grep(t, function (e) { return !o.dom.isEmpty(e) }), v.each(n, function (e) { m(o.dom, e) && w(o, e) }), v.each(t, function (e) { var t, n; if (e.parentNode !== o.getBody()) { for (t = e; t && t !== r; t = t.parentNode)h(t) && (n = t); M(o, n, e), I(o.dom, n.parentNode) } }), o.selection.setRng(D(e)) }, V = function (e, t, n) { return d = n, (s = t) && d && h(s) && s.nodeName === d.nodeName && (i = t, a = n, (r = e).getStyle(i, "list-style-type", !0) === r.getStyle(a, "list-style-type", !0)) && (o = n, t.className === o.className); var o, r, i, a, s, d }, z = function (e, t) { var n, o; if (n = t.nextSibling, V(e, t, n)) { for (; o = n.firstChild;)t.appendChild(o); e.remove(n) } if (n = t.previousSibling, V(e, t, n)) { for (; o = n.lastChild;)t.insertBefore(o, t.firstChild); e.remove(n) } }, G = function (t, e, n, o, r) { if (e.nodeName !== o || J(r)) { var i = b(t.selection.getRng(!0)); v.each([e].concat(n), function (e) { !function (e, t, n, o) { if (t.nodeName !== n) { var r = e.rename(t, n); W(e, r, o) } else W(e, t, o) }(t.dom, e, o, r) }), t.selection.setRng(D(i)) } else F(t) }, J = function (e) { return "list-style-type" in e }, X = { toggleList: function (e, t, n) { var o = E.getParentList(e), r = E.getSelectedSubLists(e); n = n || {}, o && 0 < r.length ? G(e, o, r, t, n) : function (e, t, n, o) { if (t !== e.getBody()) if (t) if (t.nodeName !== n || J(o)) { var r = b(e.selection.getRng(!0)); W(e.dom, t, o), z(e.dom, e.dom.rename(t, n)), e.selection.setRng(D(r)) } else F(e); else q(e, n, o) }(e, o, t, n) }, removeList: F, mergeWithAdjacentLists: z }, Y = function (e, t, n, o) { var r, i, a = t.startContainer, s = t.startOffset; if (3 === a.nodeType && (n ? s < a.data.length : 0 < s)) return a; for (r = e.schema.getNonEmptyElements(), 1 === a.nodeType && (a = d.getNode(a, s)), i = new l(a, o), n && u(e.dom, a) && i.next(); a = i[n ? "next" : "prev2"]();) { if ("LI" === a.nodeName && !a.hasChildNodes()) return a; if (r[a.nodeName]) return a; if (3 === a.nodeType && 0 < a.data.length) return a } }, Z = function (e, t) { var n = t.childNodes; return 1 === n.length && !h(n[0]) && e.isBlock(n[0]) }, ee = function (e, t, n) { var o, r, i, a; if (r = Z(e, n) ? n.firstChild : n, Z(i = e, a = t) && i.remove(a.firstChild, !0), !m(e, t, !0)) for (; o = t.firstChild;)r.appendChild(o) }, te = function (e, t, n) { var o, r, i = t.parentNode; g(e, t) && g(e, n) && (h(n.lastChild) && (r = n.lastChild), i === n.lastChild && C(i.previousSibling) && e.remove(i.previousSibling), (o = n.lastChild) && C(o) && t.hasChildNodes() && e.remove(o), m(e, n, !0) && e.$(n).empty(), ee(e, t, n), r && n.appendChild(r), e.remove(t), m(e, i) && i !== e.getRoot() && e.remove(i)) }, ne = function (e, t, n, o) { var r, i, a, s = e.dom; if (s.isEmpty(o)) i = n, a = o, (r = e).dom.$(a).empty(), te(r.dom, i, a), r.selection.setCursorLocation(a); else { var d = b(t); te(s, n, o), e.selection.setRng(D(d)) } }, oe = function (e, t) { var n, o, r, i = e.dom, a = e.selection, s = a.getStart(), d = E.getClosestListRootElm(e, s), l = i.getParent(a.getStart(), "LI", d); if (l) { if ((n = l.parentNode) === e.getBody() && m(i, n)) return !0; if (o = L(a.getRng(!0)), (r = i.getParent(Y(e, o, t, d), "LI", d)) && r !== l) return t ? ne(e, o, r, l) : function (e, t, n, o) { var r = b(t); te(e.dom, n, o); var i = D(r); e.selection.setRng(i) }(e, o, l, r), !0; if (!r && !t && X.removeList(e)) return !0 } return !1 }, re = function (e, t) { return oe(e, t) || function (r, i) { var a = r.dom, e = r.selection.getStart(), s = E.getClosestListRootElm(r, e), d = a.getParent(e, a.isBlock, s); if (d && a.isEmpty(d)) { var t = L(r.selection.getRng(!0)), l = a.getParent(Y(r, t, i, s), "LI", s); if (l) return r.undoManager.transact(function () { var e, t, n, o; t = d, n = s, o = (e = a).getParent(t.parentNode, e.isBlock, n), e.remove(t), o && e.isEmpty(o) && e.remove(o), X.mergeWithAdjacentLists(a, l.parentNode), r.selection.select(l, !0), r.selection.collapse(i) }), !0 } return !1 }(e, t) }, ie = function (e, t) { return e.selection.isCollapsed() ? re(e, t) : (o = (n = e).selection.getStart(), r = E.getClosestListRootElm(n, o), !!(n.dom.getParent(o, "LI,DT,DD", r) || 0 < E.getSelectedListItems(n).length) && (n.undoManager.transact(function () { n.execCommand("Delete"), I(n.dom, n.getBody()) }), !0)); var n, o, r }, ae = function (t) { t.on("keydown", function (e) { e.keyCode === n.BACKSPACE ? ie(t, !1) && e.preventDefault() : e.keyCode === n.DELETE && ie(t, !0) && e.preventDefault() }) }, se = ie, de = function (t) { return { backspaceDelete: function (e) { se(t, e) } } }, le = t.DOM, ce = function (e, t) { var n; if (h(e)) { for (; n = e.firstChild;)t.appendChild(n); le.remove(e) } }, fe = function (e) { var t, n, o, r, i = E.getSelectedListItems(e); if (i.length) { for (var a = b(e.selection.getRng(!0)), s = 0; s < i.length && (t = i[s], r = o = n = void 0, ("DT" === t.nodeName ? (le.rename(t, "DD"), 1) : (n = t.previousSibling) && h(n) ? (n.appendChild(t), 1) : n && "LI" === n.nodeName && h(n.lastChild) ? (n.lastChild.appendChild(t), ce(t.lastChild, n.lastChild), 1) : (n = t.nextSibling) && h(n) ? (n.insertBefore(t, n.firstChild), 1) : (n = t.previousSibling) && "LI" === n.nodeName && (o = le.create(t.parentNode.nodeName), (r = le.getStyle(t.parentNode, "listStyleType")) && le.setStyle(o, "listStyleType", r), n.appendChild(o), o.appendChild(t), ce(t.lastChild, o), 1)) || 0 !== s); s++); return e.selection.setRng(D(a)), e.nodeChanged(), !0 } }, ue = function (t, n) { return function () { var e = t.dom.getParent(t.selection.getStart(), "UL,OL,DL"); return e && e.nodeName === n } }, me = function (o) { o.on("BeforeExecCommand", function (e) { var t, n = e.command.toLowerCase(); if ("indent" === n ? fe(o) && (t = !0) : "outdent" === n && K(o) && (t = !0), t) return o.fire("ExecCommand", { command: e.command }), e.preventDefault(), !0 }), o.addCommand("InsertUnorderedList", function (e, t) { X.toggleList(o, "UL", t) }), o.addCommand("InsertOrderedList", function (e, t) { X.toggleList(o, "OL", t) }), o.addCommand("InsertDefinitionList", function (e, t) { X.toggleList(o, "DL", t) }), o.addQueryStateHandler("InsertUnorderedList", ue(o, "UL")), o.addQueryStateHandler("InsertOrderedList", ue(o, "OL")), o.addQueryStateHandler("InsertDefinitionList", ue(o, "DL")) }, ge = function (e) { return e.getParam("lists_indent_on_tab", !0) }, pe = function (e) { var t; ge(e) && (t = e).on("keydown", function (e) { e.keyCode !== n.TAB || n.metaKeyPressed(e) || t.dom.getParent(t.selection.getStart(), "LI,DT,DD") && (e.preventDefault(), e.shiftKey ? K(t) : fe(t)) }), ae(e) }, ve = function (t, i) { return function (e) { var r = e.control; t.on("NodeChange", function (e) { var t = function (e, t) { for (var n = 0; n < e.length; n++)if (t(e[n])) return n; return -1 }(e.parents, a), n = -1 !== t ? e.parents.slice(0, t) : e.parents, o = v.grep(n, h); r.active(0 < o.length && o[0].nodeName === i) }) } }, he = function (e) { var t, n, o, r; n = "advlist", o = (t = e).settings.plugins ? t.settings.plugins : "", -1 === v.inArray(o.split(/[ ,]/), n) && (e.addButton("numlist", { active: !1, title: "Numbered list", cmd: "InsertOrderedList", onPostRender: ve(e, "OL") }), e.addButton("bullist", { active: !1, title: "Bullet list", cmd: "InsertUnorderedList", onPostRender: ve(e, "UL") })), e.addButton("indent", { icon: "indent", title: "Increase indent", cmd: "Indent", onPostRender: (r = e, function (e) { var n = e.control; r.on("nodechange", function () { var e = E.getSelectedListItems(r), t = 0 < e.length && s(e[0]); n.disabled(t) }) }) }) }; e.add("lists", function (e) { return pe(e), he(e), me(e), de(e) }) }();
!function () { "use strict"; var e = tinymce.util.Tools.resolve("tinymce.PluginManager"), o = tinymce.util.Tools.resolve("tinymce.Env"), v = tinymce.util.Tools.resolve("tinymce.util.Tools"), w = function (e) { return e.getParam("media_scripts") }, b = function (e) { return e.getParam("audio_template_callback") }, y = function (e) { return e.getParam("video_template_callback") }, n = function (e) { return e.getParam("media_live_embeds", !0) }, t = function (e) { return e.getParam("media_filter_html", !0) }, s = function (e) { return e.getParam("media_url_resolver") }, m = function (e) { return e.getParam("media_alt_source", !0) }, d = function (e) { return e.getParam("media_poster", !0) }, h = function (e) { return e.getParam("media_dimensions", !0) }, p = tinymce.util.Tools.resolve("tinymce.html.SaxParser"), r = tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"), x = function (e, t) { if (e) for (var r = 0; r < e.length; r++)if (-1 !== t.indexOf(e[r].filter)) return e[r] }, i = function (t) { return function (e) { return e ? e.style[t].replace(/px$/, "") : "" } }, a = function (i) { return function (e, t) { var r; e && (e.style[i] = /^[0-9.]+$/.test(r = t) ? r + "px" : r) } }, f = { getMaxWidth: i("maxWidth"), getMaxHeight: i("maxHeight"), setMaxWidth: a("maxWidth"), setMaxHeight: a("maxHeight") }, u = r.DOM, l = function (e) { return u.getAttrib(e, "data-ephox-embed-iri") }, j = function (e, t) { return c = t, s = u.createFragment(c), "" !== l(s.firstChild) ? (o = t, n = u.createFragment(o).firstChild, { type: "ephox-embed-iri", source1: l(n), source2: "", poster: "", width: f.getMaxWidth(n), height: f.getMaxHeight(n) }) : (i = e, r = t, p({ validate: (a = {}, !1), allow_conditional_comments: !0, special: "script,noscript", start: function (e, t) { if (a.source1 || "param" !== e || (a.source1 = t.map.movie), "iframe" !== e && "object" !== e && "embed" !== e && "video" !== e && "audio" !== e || (a.type || (a.type = e), a = v.extend(t.map, a)), "script" === e) { var r = x(i, t.map.src); if (!r) return; a = { type: "script", source1: t.map.src, width: r.width, height: r.height } } "source" === e && (a.source1 ? a.source2 || (a.source2 = t.map.src) : a.source1 = t.map.src), "img" !== e || a.poster || (a.poster = t.map.src) } }).parse(r), a.source1 = a.source1 || a.src || a.data, a.source2 = a.source2 || "", a.poster = a.poster || "", a); var i, r, a, o, n, c, s }, g = tinymce.util.Tools.resolve("tinymce.util.Promise"), M = function (e) { var t = { mp3: "audio/mpeg", wav: "audio/wav", mp4: "video/mp4", webm: "video/webm", ogg: "video/ogg", swf: "application/x-shockwave-flash" }[e.toLowerCase().split(".").pop()]; return t || "" }, _ = tinymce.util.Tools.resolve("tinymce.html.Writer"), C = tinymce.util.Tools.resolve("tinymce.html.Schema"), S = r.DOM, F = function (e, t) { var r, i, a, o; for (r in t) if (a = "" + t[r], e.map[r]) for (i = e.length; i--;)(o = e[i]).name === r && (a ? (e.map[r] = a, o.value = a) : (delete e.map[r], e.splice(i, 1))); else a && (e.push({ name: r, value: a }), e.map[r] = a) }, k = function (e, t) { var r, i, a = S.createFragment(e).firstChild; return f.setMaxWidth(a, t.width), f.setMaxHeight(a, t.height), r = a.outerHTML, i = _(), p(i).parse(r), i.getContent() }, A = function (e, t, r) { return u = e, l = S.createFragment(u), "" !== S.getAttrib(l.firstChild, "data-ephox-embed-iri") ? k(e, t) : (i = e, a = t, o = r, c = _(), p({ validate: !1, allow_conditional_comments: !(s = 0), special: "script,noscript", comment: function (e) { c.comment(e) }, cdata: function (e) { c.cdata(e) }, text: function (e, t) { c.text(e, t) }, start: function (e, t, r) { switch (e) { case "video": case "object": case "embed": case "img": case "iframe": a.height !== undefined && a.width !== undefined && F(t, { width: a.width, height: a.height }) }if (o) switch (e) { case "video": F(t, { poster: a.poster, src: "" }), a.source2 && F(t, { src: "" }); break; case "iframe": F(t, { src: a.source1 }); break; case "source": if (++s <= 2 && (F(t, { src: a["source" + s], type: a["source" + s + "mime"] }), !a["source" + s])) return; break; case "img": if (!a.poster) return; n = !0 }c.start(e, t, r) }, end: function (e) { if ("video" === e && o) for (var t = 1; t <= 2; t++)if (a["source" + t]) { var r = []; r.map = {}, s < t && (F(r, { src: a["source" + t], type: a["source" + t + "mime"] }), c.start("source", r, !0)) } if (a.poster && "object" === e && o && !n) { var i = []; i.map = {}, F(i, { src: a.poster, width: a.width, height: a.height }), c.start("img", i, !0) } c.end(e) } }, C({})).parse(i), c.getContent()); var i, a, o, n, c, s, u, l }, N = [{ regex: /youtu\.be\/([\w\-_\?&=.]+)/i, type: "iframe", w: 560, h: 314, url: "//www.youtube.com/embed/$1", allowFullscreen: !0 }, { regex: /youtube\.com(.+)v=([^&]+)(&([a-z0-9&=\-_]+))?/i, type: "iframe", w: 560, h: 314, url: "//www.youtube.com/embed/$2?$4", allowFullscreen: !0 }, { regex: /youtube.com\/embed\/([a-z0-9\?&=\-_]+)/i, type: "iframe", w: 560, h: 314, url: "//www.youtube.com/embed/$1", allowFullscreen: !0 }, { regex: /vimeo\.com\/([0-9]+)/, type: "iframe", w: 425, h: 350, url: "//player.vimeo.com/video/$1?title=0&byline=0&portrait=0&color=8dc7dc", allowFullscreen: !0 }, { regex: /vimeo\.com\/(.*)\/([0-9]+)/, type: "iframe", w: 425, h: 350, url: "//player.vimeo.com/video/$2?title=0&amp;byline=0", allowFullscreen: !0 }, { regex: /maps\.google\.([a-z]{2,3})\/maps\/(.+)msid=(.+)/, type: "iframe", w: 425, h: 350, url: '//maps.google.com/maps/ms?msid=$2&output=embed"', allowFullscreen: !1 }, { regex: /dailymotion\.com\/video\/([^_]+)/, type: "iframe", w: 480, h: 270, url: "//www.dailymotion.com/embed/video/$1", allowFullscreen: !0 }, { regex: /dai\.ly\/([^_]+)/, type: "iframe", w: 480, h: 270, url: "//www.dailymotion.com/embed/video/$1", allowFullscreen: !0 }], c = function (r, e) { var i = v.extend({}, e); if (!i.source1 && (v.extend(i, j(w(r), i.embed)), !i.source1)) return ""; i.source2 || (i.source2 = ""), i.poster || (i.poster = ""), i.source1 = r.convertURL(i.source1, "source"), i.source2 = r.convertURL(i.source2, "source"), i.source1mime = M(i.source1), i.source2mime = M(i.source2), i.poster = r.convertURL(i.poster, "poster"); var t, a, o = (t = i.source1, 0 < (a = N.filter(function (e) { return e.regex.test(t) })).length ? v.extend({}, a[0], { url: function (e, t) { for (var r = e.regex.exec(t), i = e.url, a = function (e) { i = i.replace("$" + e, function () { return r[e] ? r[e] : "" }) }, o = 0; o < r.length; o++)a(o); return i.replace(/\?$/, "") }(a[0], t) }) : null); if (o && (i.source1 = o.url, i.type = o.type, i.allowFullscreen = o.allowFullscreen, i.width = i.width || o.w, i.height = i.height || o.h), i.embed) return A(i.embed, i, !0); var n = x(w(r), i.source1); n && (i.type = "script", i.width = n.width, i.height = n.height); var c, s, u, l, m, d, h, p, f = b(r), g = y(r); return i.width = i.width || 300, i.height = i.height || 150, v.each(i, function (e, t) { i[t] = r.dom.encode(e) }), "iframe" === i.type ? (p = (h = i).allowFullscreen ? ' allowFullscreen="1"' : "", '<iframe src="' + h.source1 + '" width="' + h.width + '" height="' + h.height + '"' + p + "></iframe>") : "application/x-shockwave-flash" === i.source1mime ? (d = '<object data="' + (m = i).source1 + '" width="' + m.width + '" height="' + m.height + '" type="application/x-shockwave-flash">', m.poster && (d += '<img src="' + m.poster + '" width="' + m.width + '" height="' + m.height + '" />'), d += "</object>") : -1 !== i.source1mime.indexOf("audio") ? (u = i, (l = f) ? l(u) : '<audio controls="controls" src="' + u.source1 + '">' + (u.source2 ? '\n<source src="' + u.source2 + '"' + (u.source2mime ? ' type="' + u.source2mime + '"' : "") + " />\n" : "") + "</audio>") : "script" === i.type ? '<script src="' + i.source1 + '"><\/script>' : (c = i, (s = g) ? s(c) : '<video width="' + c.width + '" height="' + c.height + '"' + (c.poster ? ' poster="' + c.poster + '"' : "") + ' controls="controls">\n<source src="' + c.source1 + '"' + (c.source1mime ? ' type="' + c.source1mime + '"' : "") + " />\n" + (c.source2 ? '<source src="' + c.source2 + '"' + (c.source2mime ? ' type="' + c.source2mime + '"' : "") + " />\n" : "") + "</video>") }, O = {}, P = function (t) { return function (e) { return c(t, e) } }, T = function (e, t) { var r, i, a, o, n, c = s(e); return c ? (a = t, o = P(e), n = c, new g(function (t, e) { var r = function (e) { return e.html && (O[a.source1] = e), t({ url: a.source1, html: e.html ? e.html : o(a) }) }; O[a.source1] ? r(O[a.source1]) : n({ url: a.source1 }, r, e) })) : (r = t, i = P(e), new g(function (e) { e({ html: i(r), url: r.source1 }) })) }, $ = function (e) { return O.hasOwnProperty(e) }, z = function (e, t) { e.state.set("oldVal", e.value()), t.state.set("oldVal", t.value()) }, L = function (e, t) { var r = e.find("#width")[0], i = e.find("#height")[0], a = e.find("#constrain")[0]; r && i && a && t(r, i, a.checked()) }, H = function (e, t, r) { var i = e.state.get("oldVal"), a = t.state.get("oldVal"), o = e.value(), n = t.value(); r && i && a && o && n && (o !== i ? (n = Math.round(o / i * n), isNaN(n) || t.value(n)) : (o = Math.round(n / a * o), isNaN(o) || e.value(o))), z(e, t) }, W = function (e) { L(e, H) }, J = function (e) { var t = function () { e(function (e) { W(e) }) }; return { type: "container", label: "Dimensions", layout: "flex", align: "center", spacing: 5, items: [{ name: "width", type: "textbox", maxLength: 5, size: 5, onchange: t, ariaLabel: "Width" }, { type: "label", text: "x" }, { name: "height", type: "textbox", maxLength: 5, size: 5, onchange: t, ariaLabel: "Height" }, { name: "constrain", type: "checkbox", checked: !0, text: "Constrain proportions" }] } }, R = function (e) { L(e, z) }, D = W, E = o.ie && o.ie <= 8 ? "onChange" : "onInput", I = function (r) { return function (e) { var t = e && e.msg ? "Media embed handler error: " + e.msg : "Media embed handler threw unknown error."; r.notificationManager.open({ type: "error", text: t }) } }, U = function (a, o) { return function (e) { var t = e.html, r = a.find("#embed")[0], i = v.extend(j(w(o), t), { source1: e.url }); a.fromJSON(i), r && (r.value(t), D(a)) } }, V = function (e, t) { var r = e.dom.select("img[data-mce-object]"); e.insertContent(t), function (e, t) { var r, i, a = e.dom.select("img[data-mce-object]"); for (r = 0; r < t.length; r++)for (i = a.length - 1; 0 <= i; i--)t[r] === a[i] && a.splice(i, 1); e.selection.select(a[0]) }(e, r), e.nodeChanged() }, B = function (i) { var a, t, e, r, o, n = [{ name: "source1", type: "filepicker", filetype: "media", size: 40, autofocus: !0, label: "Source", onpaste: function () { setTimeout(function () { T(i, a.toJSON()).then(U(a, i))["catch"](I(i)) }, 1) }, onchange: function (e) { var r, t; T(i, a.toJSON()).then(U(a, i))["catch"](I(i)), r = a, t = e.meta, v.each(t, function (e, t) { r.find("#" + t).value(e) }) }, onbeforecall: function (e) { e.meta = a.toJSON() } }], c = []; if (m(i) && c.push({ name: "source2", type: "filepicker", filetype: "media", size: 40, label: "Alternative source" }), d(i) && c.push({ name: "poster", type: "filepicker", filetype: "image", size: 40, label: "Poster" }), h(i)) { var s = J(function (e) { e(a), t = a.toJSON(), a.find("#embed").value(A(t.embed, t)) }); n.push(s) } r = (e = i).selection.getNode(), o = r.getAttribute("data-ephox-embed-iri"), t = o ? { source1: o, "data-ephox-embed-iri": o, width: f.getMaxWidth(r), height: f.getMaxHeight(r) } : r.getAttribute("data-mce-object") ? j(w(e), e.serializer.serialize(r, { selection: !0 })) : {}; var u = { id: "mcemediasource", type: "textbox", flex: 1, name: "embed", value: function (e) { var t = e.selection.getNode(); if (t.getAttribute("data-mce-object") || t.getAttribute("data-ephox-embed-iri")) return e.selection.getContent() }(i), multiline: !0, rows: 5, label: "Source" }; u[E] = function () { t = v.extend({}, j(w(i), this.value())), this.parent().parent().fromJSON(t) }; var l = [{ title: "General", type: "form", items: n }, { title: "Embed", type: "container", layout: "flex", direction: "column", align: "stretch", padding: 10, spacing: 10, items: [{ type: "label", text: "Paste your embed code below:", forId: "mcemediasource" }, u] }]; 0 < c.length && l.push({ title: "Advanced", type: "form", items: c }), a = i.windowManager.open({ title: "Insert/edit media", data: t, bodyType: "tabpanel", body: l, onSubmit: function () { var t, e; D(a), t = i, (e = a.toJSON()).embed = A(e.embed, e), e.embed && $(e.source1) ? V(t, e.embed) : T(t, e).then(function (e) { V(t, e.html) })["catch"](I(t)) } }), R(a) }, G = function (e) { return { showDialog: function () { B(e) } } }, q = function (e) { e.addCommand("mceMedia", function () { B(e) }) }, K = tinymce.util.Tools.resolve("tinymce.html.Node"), Q = function (a, e) { if (!1 === t(a)) return e; var o, n = _(); return p({ validate: !1, allow_conditional_comments: !1, special: "script,noscript", comment: function (e) { n.comment(e) }, cdata: function (e) { n.cdata(e) }, text: function (e, t) { n.text(e, t) }, start: function (e, t, r) { if (o = !0, "script" !== e && "noscript" !== e) { for (var i = 0; i < t.length; i++) { if (0 === t[i].name.indexOf("on")) return; "style" === t[i].name && (t[i].value = a.dom.serializeStyle(a.dom.parseStyle(t[i].value), e)) } n.start(e, t, r), o = !1 } }, end: function (e) { o || n.end(e) } }, C({})).parse(e), n.getContent() }, X = function (e, t) { var r, i = t.name; return (r = new K("img", 1)).shortEnded = !0, Z(e, t, r), r.attr({ width: t.attr("width") || "300", height: t.attr("height") || ("audio" === i ? "30" : "150"), style: t.attr("style"), src: o.transparentSrc, "data-mce-object": i, "class": "mce-object mce-object-" + i }), r }, Y = function (e, t) { var r, i, a, o = t.name; return (r = new K("span", 1)).attr({ contentEditable: "false", style: t.attr("style"), "data-mce-object": o, "class": "mce-preview-object mce-object-" + o }), Z(e, t, r), (i = new K(o, 1)).attr({ src: t.attr("src"), allowfullscreen: t.attr("allowfullscreen"), style: t.attr("style"), "class": t.attr("class"), width: t.attr("width"), height: t.attr("height"), frameborder: "0" }), (a = new K("span", 1)).attr("class", "mce-shim"), r.append(i), r.append(a), r }, Z = function (e, t, r) { var i, a, o, n, c; for (n = (o = t.attributes).length; n--;)i = o[n].name, a = o[n].value, "width" !== i && "height" !== i && "style" !== i && ("data" !== i && "src" !== i || (a = e.convertURL(a, i)), r.attr("data-mce-p-" + i, a)); (c = t.firstChild && t.firstChild.value) && (r.attr("data-mce-html", escape(Q(e, c))), r.firstChild = null) }, ee = function (e) { for (; e = e.parent;)if (e.attr("data-ephox-embed-iri")) return !0; return !1 }, te = function (a) { return function (e) { for (var t, r, i = e.length; i--;)(t = e[i]).parent && (t.parent.attr("data-mce-object") || ("script" !== t.name || (r = x(w(a), t.attr("src")))) && (r && (r.width && t.attr("width", r.width.toString()), r.height && t.attr("height", r.height.toString())), "iframe" === t.name && n(a) && o.ceFalse ? ee(t) || t.replace(Y(a, t)) : ee(t) || t.replace(X(a, t)))) } }, re = function (d) { d.on("preInit", function () { var t = d.schema.getSpecialElements(); v.each("video audio iframe object".split(" "), function (e) { t[e] = new RegExp("</" + e + "[^>]*>", "gi") }); var r = d.schema.getBoolAttrs(); v.each("webkitallowfullscreen mozallowfullscreen allowfullscreen".split(" "), function (e) { r[e] = {} }), d.parser.addNodeFilter("iframe,video,audio,object,embed,script", te(d)), d.serializer.addAttributeFilter("data-mce-object", function (e, t) { for (var r, i, a, o, n, c, s, u, l = e.length; l--;)if ((r = e[l]).parent) { for (s = r.attr(t), i = new K(s, 1), "audio" !== s && "script" !== s && ((u = r.attr("class")) && -1 !== u.indexOf("mce-preview-object") ? i.attr({ width: r.firstChild.attr("width"), height: r.firstChild.attr("height") }) : i.attr({ width: r.attr("width"), height: r.attr("height") })), i.attr({ style: r.attr("style") }), a = (o = r.attributes).length; a--;) { var m = o[a].name; 0 === m.indexOf("data-mce-p-") && i.attr(m.substr(11), o[a].value) } "script" === s && i.attr("type", "text/javascript"), (n = r.attr("data-mce-html")) && ((c = new K("#text", 3)).raw = !0, c.value = Q(d, unescape(n)), i.append(c)), r.replace(i) } }) }), d.on("setContent", function () { d.$("span.mce-preview-object").each(function (e, t) { var r = d.$(t); 0 === r.find("span.mce-shim", t).length && r.append('<span class="mce-shim"></span>') }) }) }, ie = function (e) { e.on("ResolveName", function (e) { var t; 1 === e.target.nodeType && (t = e.target.getAttribute("data-mce-object")) && (e.name = t) }) }, ae = function (t) { t.on("click keyup", function () { var e = t.selection.getNode(); e && t.dom.hasClass(e, "mce-preview-object") && t.dom.getAttrib(e, "data-mce-selected") && e.setAttribute("data-mce-selected", "2") }), t.on("ObjectSelected", function (e) { var t = e.target.getAttribute("data-mce-object"); "audio" !== t && "script" !== t || e.preventDefault() }), t.on("objectResized", function (e) { var t, r = e.target; r.getAttribute("data-mce-object") && (t = r.getAttribute("data-mce-html")) && (t = unescape(t), r.setAttribute("data-mce-html", escape(A(t, { width: e.width, height: e.height })))) }) }, oe = function (e) { e.addButton("media", { tooltip: "Insert/edit media", cmd: "mceMedia", stateSelector: ["img[data-mce-object]", "span[data-mce-object]", "div[data-ephox-embed-iri]"] }), e.addMenuItem("media", { icon: "media", text: "Media", cmd: "mceMedia", context: "insert", prependToContext: !0 }) }; e.add("media", function (e) { return q(e), oe(e), ie(e), re(e), ae(e), G(e) }) }();
!function () { "use strict"; var n = tinymce.util.Tools.resolve("tinymce.PluginManager"), i = function (n, e) { var t, i = (t = n).plugins.visualchars && t.plugins.visualchars.isEnabled() ? '<span class="mce-nbsp">&nbsp;</span>' : "&nbsp;"; n.insertContent(function (n, e) { for (var t = "", i = 0; i < e; i++)t += n; return t }(i, e)), n.dom.setAttrib(n.dom.select("span.mce-nbsp"), "data-mce-bogus", "1") }, e = function (n) { n.addCommand("mceNonBreaking", function () { i(n, 1) }) }, o = tinymce.util.Tools.resolve("tinymce.util.VK"), a = function (n) { var e = n.getParam("nonbreaking_force_tab", 0); return "boolean" == typeof e ? !0 === e ? 3 : 0 : e }, t = function (e) { var t = a(e); 0 < t && e.on("keydown", function (n) { if (n.keyCode === o.TAB && !n.isDefaultPrevented()) { if (n.shiftKey) return; n.preventDefault(), n.stopImmediatePropagation(), i(e, t) } }) }, r = function (n) { n.addButton("nonbreaking", { title: "Nonbreaking space", cmd: "mceNonBreaking" }), n.addMenuItem("nonbreaking", { icon: "nonbreaking", text: "Nonbreaking space", cmd: "mceNonBreaking", context: "insert" }) }; n.add("nonbreaking", function (n) { e(n), r(n), t(n) }) }();
!function () { "use strict"; var t = tinymce.util.Tools.resolve("tinymce.PluginManager"), c = tinymce.util.Tools.resolve("tinymce.util.Tools"), l = function (t) { return t.getParam("noneditable_noneditable_class", "mceNonEditable") }, u = function (t) { return t.getParam("noneditable_editable_class", "mceEditable") }, f = function (t) { var n = t.getParam("noneditable_regexp", []); return n && n.constructor === RegExp ? [n] : n }, s = function (n) { return function (t) { return -1 !== (" " + t.attr("class") + " ").indexOf(n) } }, d = function (i, o, c) { return function (t) { var n = arguments, e = n[n.length - 2], r = 0 < e ? o.charAt(e - 1) : ""; if ('"' === r) return t; if (">" === r) { var a = o.lastIndexOf("<", e); if (-1 !== a && -1 !== o.substring(a, e).indexOf('contenteditable="false"')) return t } return '<span class="' + c + '" data-mce-content="' + i.dom.encode(n[0]) + '">' + i.dom.encode("string" == typeof n[1] ? n[1] : n[0]) + "</span>" } }, n = function (n) { var t, e, r = "contenteditable"; t = " " + c.trim(u(n)) + " ", e = " " + c.trim(l(n)) + " "; var a = s(t), i = s(e), o = f(n); n.on("PreInit", function () { 0 < o.length && n.on("BeforeSetContent", function (t) { !function (t, n, e) { var r = n.length, a = e.content; if ("raw" !== e.format) { for (; r--;)a = a.replace(n[r], d(t, a, l(t))); e.content = a } }(n, o, t) }), n.parser.addAttributeFilter("class", function (t) { for (var n, e = t.length; e--;)n = t[e], a(n) ? n.attr(r, "true") : i(n) && n.attr(r, "false") }), n.serializer.addAttributeFilter(r, function (t) { for (var n, e = t.length; e--;)n = t[e], (a(n) || i(n)) && (0 < o.length && n.attr("data-mce-content") ? (n.name = "#text", n.type = 3, n.raw = !0, n.value = n.attr("data-mce-content")) : n.attr(r, null)) }) }) }; t.add("noneditable", function (t) { n(t) }) }();
!function () { "use strict"; var e = tinymce.util.Tools.resolve("tinymce.PluginManager"), a = tinymce.util.Tools.resolve("tinymce.Env"), n = function (e) { return e.getParam("pagebreak_separator", "\x3c!-- pagebreak --\x3e") }, i = function (e) { return e.getParam("pagebreak_split_block", !1) }, t = function () { return "mce-pagebreak" }, r = function () { return '<img src="' + a.transparentSrc + '" class="mce-pagebreak" data-mce-resize="false" data-mce-placeholder />' }, c = function (c) { var o = n(c), a = new RegExp(o.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g, function (e) { return "\\" + e }), "gi"); c.on("BeforeSetContent", function (e) { e.content = e.content.replace(a, r()) }), c.on("PreInit", function () { c.serializer.addNodeFilter("img", function (e) { for (var a, n, t = e.length; t--;)if ((n = (a = e[t]).attr("class")) && -1 !== n.indexOf("mce-pagebreak")) { var r = a.parent; if (c.schema.getBlockElements()[r.name] && i(c)) { r.type = 3, r.value = o, r.raw = !0, a.remove(); continue } a.type = 3, a.value = o, a.raw = !0 } }) }) }, o = r, g = t, u = function (e) { e.addCommand("mcePageBreak", function () { e.settings.pagebreak_split_block ? e.insertContent("<p>" + o() + "</p>") : e.insertContent(o()) }) }, m = function (a) { a.on("ResolveName", function (e) { "IMG" === e.target.nodeName && a.dom.hasClass(e.target, g()) && (e.name = "pagebreak") }) }, s = function (e) { e.addButton("pagebreak", { title: "Page break", cmd: "mcePageBreak" }), e.addMenuItem("pagebreak", { text: "Page break", icon: "pagebreak", cmd: "mcePageBreak", context: "insert" }) }; e.add("pagebreak", function (e) { u(e), s(e), c(e), m(e) }) }();
!function () { "use strict"; var o = function (e) { var t = e, n = function () { return t }; return { get: n, set: function (e) { t = e }, clone: function () { return o(n()) } } }, t = tinymce.util.Tools.resolve("tinymce.PluginManager"), s = function (e) { return !(!/(^|[ ,])powerpaste([, ]|$)/.test(e.settings.plugins) || !t.get("powerpaste") || ("undefined" != typeof window.console && window.console.log && window.console.log("PowerPaste is incompatible with Paste plugin! Remove 'paste' from the 'plugins' option."), 0)) }, l = function (e, t) { return { clipboard: e, quirks: t } }, f = function (e, t, n, r) { return e.fire("PastePreProcess", { content: t, internal: n, wordContent: r }) }, d = function (e, t, n, r) { return e.fire("PastePostProcess", { node: t, internal: n, wordContent: r }) }, u = function (e, t) { return e.fire("PastePlainTextToggle", { state: t }) }, n = function (e, t) { return e.fire("paste", { ieFake: t }) }, m = { shouldPlainTextInform: function (e) { return e.getParam("paste_plaintext_inform", !0) }, shouldBlockDrop: function (e) { return e.getParam("paste_block_drop", !1) }, shouldPasteDataImages: function (e) { return e.getParam("paste_data_images", !1) }, shouldFilterDrop: function (e) { return e.getParam("paste_filter_drop", !0) }, getPreProcess: function (e) { return e.getParam("paste_preprocess") }, getPostProcess: function (e) { return e.getParam("paste_postprocess") }, getWebkitStyles: function (e) { return e.getParam("paste_webkit_styles") }, shouldRemoveWebKitStyles: function (e) { return e.getParam("paste_remove_styles_if_webkit", !0) }, shouldMergeFormats: function (e) { return e.getParam("paste_merge_formats", !0) }, isSmartPasteEnabled: function (e) { return e.getParam("smart_paste", !0) }, isPasteAsTextEnabled: function (e) { return e.getParam("paste_as_text", !1) }, getRetainStyleProps: function (e) { return e.getParam("paste_retain_style_properties") }, getWordValidElements: function (e) { return e.getParam("paste_word_valid_elements", "-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody") }, shouldConvertWordFakeLists: function (e) { return e.getParam("paste_convert_word_fake_lists", !0) }, shouldUseDefaultFilters: function (e) { return e.getParam("paste_enable_default_filters", !0) } }, r = function (e, t, n) { var r, a, i; "text" === t.pasteFormat.get() ? (t.pasteFormat.set("html"), u(e, !1)) : (t.pasteFormat.set("text"), u(e, !0), i = e, !1 === n.get() && m.shouldPlainTextInform(i) && (a = "Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off.", (r = e).notificationManager.open({ text: r.translate(a), type: "info" }), n.set(!0))), e.focus() }, c = function (e, n, t) { e.addCommand("mceTogglePlainTextPaste", function () { r(e, n, t) }), e.addCommand("mceInsertClipboardContent", function (e, t) { t.content && n.pasteHtml(t.content, t.internal), t.text && n.pasteText(t.text) }) }, v = tinymce.util.Tools.resolve("tinymce.Env"), h = tinymce.util.Tools.resolve("tinymce.util.Delay"), y = tinymce.util.Tools.resolve("tinymce.util.Tools"), a = tinymce.util.Tools.resolve("tinymce.util.VK"), e = "x-tinymce/html", i = "\x3c!-- " + e + " --\x3e", b = { mark: function (e) { return i + e }, unmark: function (e) { return e.replace(i, "") }, isMarked: function (e) { return -1 !== e.indexOf(i) }, internalHtmlMime: function () { return e } }, g = tinymce.util.Tools.resolve("tinymce.html.Entities"), p = function (e) { return e.replace(/\r?\n/g, "<br>") }, x = function (e, t, n) { var r = e.split(/\n\n/), a = function (e, t) { var n, r = [], a = "<" + e; if ("object" == typeof t) { for (n in t) t.hasOwnProperty(n) && r.push(n + '="' + g.encodeAllRaw(t[n]) + '"'); r.length && (a += " " + r.join(" ")) } return a + ">" }(t, n), i = "</" + t + ">", o = y.map(r, function (e) { return e.split(/\n/).join("<br />") }); return 1 === o.length ? o[0] : y.map(o, function (e) { return a + e + i }).join("") }, P = { isPlainText: function (e) { return !/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(e) }, convert: function (e, t, n) { return t ? x(e, t, n) : p(e) }, toBRs: p, toBlockElements: x }, w = tinymce.util.Tools.resolve("tinymce.html.DomParser"), T = tinymce.util.Tools.resolve("tinymce.html.Node"), _ = tinymce.util.Tools.resolve("tinymce.html.Schema"), C = tinymce.util.Tools.resolve("tinymce.html.Serializer"); function D(t, e) { return y.each(e, function (e) { t = e.constructor === RegExp ? t.replace(e, "") : t.replace(e[0], e[1]) }), t } var k = { filter: D, innerText: function (t) { var n = _(), r = w({}, n), a = "", i = n.getShortEndedElements(), o = y.makeMap("script noscript style textarea video audio iframe object", " "), s = n.getBlockElements(); return t = D(t, [/<!\[[^\]]+\]>/g]), function e(t) { var n = t.name, r = t; if ("br" !== n) if (i[n] && (a += " "), o[n]) a += " "; else { if (3 === t.type && (a += t.value), !t.shortEnded && (t = t.firstChild)) for (; e(t), t = t.next;); s[n] && r.next && (a += "\n", "p" === n && (a += "\n")) } else a += "\n" }(r.parse(t)), a }, trimHtml: function (e) { return e = D(e, [/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi, /<!--StartFragment-->|<!--EndFragment-->/g, [/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g, function (e, t, n) { return t || n ? "\xa0" : " " }], /<br class="Apple-interchange-newline">/g, /<br>$/i]) }, createIdGenerator: function (e) { var t = 0; return function () { return e + t++ } }, isMsEdge: function () { return -1 !== navigator.userAgent.indexOf(" Edge/") } }; function R(t) { var n, e; return e = [/^[IVXLMCD]{1,2}\.[ \u00a0]/, /^[ivxlmcd]{1,2}\.[ \u00a0]/, /^[a-z]{1,2}[\.\)][ \u00a0]/, /^[A-Z]{1,2}[\.\)][ \u00a0]/, /^[0-9]+\.[ \u00a0]/, /^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/, /^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/], t = t.replace(/^[\u00a0 ]+/, ""), y.each(e, function (e) { if (e.test(t)) return !(n = !0) }), n } function E(e) { var i, o, s = 1; function n(e) { var t = ""; if (3 === e.type) return e.value; if (e = e.firstChild) for (; t += n(e), e = e.next;); return t } function l(e, t) { if (3 === e.type && t.test(e.value)) return e.value = e.value.replace(t, ""), !1; if (e = e.firstChild) do { if (!l(e, t)) return !1 } while (e = e.next); return !0 } function t(t, n, r) { var a = t._listLevel || s; a !== s && (a < s ? i && (i = i.parent.parent) : (o = i, i = null)), i && i.name === n ? i.append(t) : (o = o || i, i = new T(n, 1), 1 < r && i.attr("start", "" + r), t.wrap(i)), t.name = "li", s < a && o && o.lastChild.append(i), s = a, function e(t) { if (t._listIgnore) t.remove(); else if (t = t.firstChild) for (; e(t), t = t.next;); }(t), l(t, /^\u00a0+/), l(t, /^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/), l(t, /^\u00a0+/) } for (var r = [], a = e.firstChild; null != a;)if (r.push(a), null !== (a = a.walk())) for (; void 0 !== a && a.parent !== e;)a = a.walk(); for (var u = 0; u < r.length; u++)if ("p" === (e = r[u]).name && e.firstChild) { var c = n(e); if (/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(c)) { t(e, "ul"); continue } if (R(c)) { var f = /([0-9]+)\./.exec(c), d = 1; f && (d = parseInt(f[1], 10)), t(e, "ol", d); continue } if (e._listLevel) { t(e, "ul", 1); continue } i = null } else o = i, i = null } function M(n, r, a, i) { var o, s = {}, e = n.dom.parseStyle(i); return y.each(e, function (e, t) { switch (t) { case "mso-list": (o = /\w+ \w+([0-9]+)/i.exec(i)) && (a._listLevel = parseInt(o[1], 10)), /Ignore/i.test(e) && a.firstChild && (a._listIgnore = !0, a.firstChild._listIgnore = !0); break; case "horiz-align": t = "text-align"; break; case "vert-align": t = "vertical-align"; break; case "font-color": case "mso-foreground": t = "color"; break; case "mso-background": case "mso-highlight": t = "background"; break; case "font-weight": case "font-style": return void ("normal" !== e && (s[t] = e)); case "mso-element": if (/^(comment|comment-list)$/i.test(e)) return void a.remove() }0 !== t.indexOf("mso-comment") ? 0 !== t.indexOf("mso-") && ("all" === m.getRetainStyleProps(n) || r && r[t]) && (s[t] = e) : a.remove() }), /(bold)/i.test(s["font-weight"]) && (delete s["font-weight"], a.wrap(new T("b", 1))), /(italic)/i.test(s["font-style"]) && (delete s["font-style"], a.wrap(new T("i", 1))), (s = n.dom.serializeStyle(s, a.name)) || null } var S = { preProcess: function (e, t) { return m.shouldUseDefaultFilters(e) ? function (r, e) { var t, a; (t = m.getRetainStyleProps(r)) && (a = y.makeMap(t.split(/[, ]/))), e = k.filter(e, [/<br class="?Apple-interchange-newline"?>/gi, /<b[^>]+id="?docs-internal-[^>]*>/gi, /<!--[\s\S]+?-->/gi, /<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi, [/<(\/?)s>/gi, "<$1strike>"], [/&nbsp;/gi, "\xa0"], [/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi, function (e, t) { return 0 < t.length ? t.replace(/./, " ").slice(Math.floor(t.length / 2)).split("").join("\xa0") : "" }]]); var n = m.getWordValidElements(r), i = _({ valid_elements: n, valid_children: "-li[p]" }); y.each(i.elements, function (e) { e.attributes["class"] || (e.attributes["class"] = {}, e.attributesOrder.push("class")), e.attributes.style || (e.attributes.style = {}, e.attributesOrder.push("style")) }); var o = w({}, i); o.addAttributeFilter("style", function (e) { for (var t, n = e.length; n--;)(t = e[n]).attr("style", M(r, a, t, t.attr("style"))), "span" === t.name && t.parent && !t.attributes.length && t.unwrap() }), o.addAttributeFilter("class", function (e) { for (var t, n, r = e.length; r--;)n = (t = e[r]).attr("class"), /^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(n) && t.remove(), t.attr("class", null) }), o.addNodeFilter("del", function (e) { for (var t = e.length; t--;)e[t].remove() }), o.addNodeFilter("a", function (e) { for (var t, n, r, a = e.length; a--;)if (n = (t = e[a]).attr("href"), r = t.attr("name"), n && -1 !== n.indexOf("#_msocom_")) t.remove(); else if (n && 0 === n.indexOf("file://") && (n = n.split("#")[1]) && (n = "#" + n), n || r) { if (r && !/^_?(?:toc|edn|ftn)/i.test(r)) { t.unwrap(); continue } t.attr({ href: n, name: r }) } else t.unwrap() }); var s = o.parse(e); return m.shouldConvertWordFakeLists(r) && E(s), e = C({ validate: r.settings.validate }, i).serialize(s) }(e, t) : t }, isWordContent: function (e) { return /<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(e) || /class="OutlineElement/.test(e) || /id="?docs\-internal\-guid\-/.test(e) } }, F = function (e, t) { return { content: e, cancelled: t } }, I = function (e, t, n, r) { var a, i, o, s, l, u, c = f(e, t, n, r); return e.hasEventListeners("PastePostProcess") && !c.isDefaultPrevented() ? (a = e, i = c.content, o = n, s = r, l = a.dom.create("div", { style: "display:none" }, i), u = d(a, l, o, s), F(u.node.innerHTML, u.isDefaultPrevented())) : F(c.content, c.isDefaultPrevented()) }, O = function (e, t, n) { var r = S.isWordContent(t), a = r ? S.preProcess(e, t) : t; return I(e, a, n, r) }, A = function (e, t) { return e.insertContent(t, { merge: m.shouldMergeFormats(e), paste: !0 }), !0 }, B = function (e) { return /^https?:\/\/[\w\?\-\/+=.&%@~#]+$/i.test(e) }, H = function (e) { return B(e) && /.(gif|jpe?g|png)$/.test(e) }, N = function (e, t, n) { return !(!1 !== e.selection.isCollapsed() || !B(t) || (a = t, i = n, (r = e).undoManager.extra(function () { i(r, a) }, function () { r.execCommand("mceInsertLink", !1, a) }), 0)); var r, a, i }, L = function (e, t, n) { return !!H(t) && (a = t, i = n, (r = e).undoManager.extra(function () { i(r, a) }, function () { r.insertContent('<img src="' + a + '">') }), !0); var r, a, i }, $ = function (e, t) { var n, r; !1 === m.isSmartPasteEnabled(e) ? A(e, t) : (n = e, r = t, y.each([N, L, A], function (e) { return !0 !== e(n, r, A) })) }, W = function (e, t, n) { var r = n || b.isMarked(t), a = O(e, b.unmark(t), r); !1 === a.cancelled && $(e, a.content) }, j = function (e, t) { t = e.dom.encode(t).replace(/\r\n/g, "\n"), t = P.convert(t, e.settings.forced_root_block, e.settings.forced_root_block_attrs), W(e, t, !1) }, V = function (e) { var t = {}; if (e) { if (e.getData) { var n = e.getData("Text"); n && 0 < n.length && -1 === n.indexOf("data:text/mce-internal,") && (t["text/plain"] = n) } if (e.types) for (var r = 0; r < e.types.length; r++) { var a = e.types[r]; try { t[a] = e.getData(a) } catch (i) { t[a] = "" } } } return t }, z = function (e, t) { return t in e && 0 < e[t].length }, K = function (e) { return z(e, "text/html") || z(e, "text/plain") }, U = function (e, t, n, r) { var a = k.createIdGenerator("mceclip"); t && (e.selection.setRng(t), t = null); var i, o, s, l, u, c, f, d = n.result, m = -1 !== (o = (i = d).indexOf(",")) ? i.substr(o + 1) : null, g = a(), p = e.settings.images_reuse_filename && r.name ? (s = e, l = r.name, (u = l.match(/([\s\S]+?)\.(?:jpeg|jpg|png|gif)$/i)) ? s.dom.encode(u[1]) : null) : g, v = new Image; if (v.src = d, c = e.settings, f = v, !c.images_dataimg_filter || c.images_dataimg_filter(f)) { var h, y = e.editorUpload.blobCache, b = void 0; (h = y.findFirst(function (e) { return e.base64() === m })) ? b = h : (b = y.create(g, r, m, p), y.add(b)), W(e, '<img src="' + b.blobUri() + '">', !1) } else W(e, '<img src="' + d + '">', !1) }, G = function (o, s, l) { var e = "paste" === s.type ? s.clipboardData : s.dataTransfer; function t(e) { var t, n, r, a = !1; if (e) for (t = 0; t < e.length; t++)if (n = e[t], /^image\/(jpeg|png|gif|bmp)$/.test(n.type)) { var i = n.getAsFile ? n.getAsFile() : n; (r = new window.FileReader).onload = U.bind(null, o, l, r, i), r.readAsDataURL(i), s.preventDefault(), a = !0 } return a } if (o.settings.paste_data_images && e) return t(e.items) || t(e.files) }, X = function (e) { return a.metaKeyPressed(e) && 86 === e.keyCode || e.shiftKey && 45 === e.keyCode }, q = function (c, f, d) { var m, g = 0; function p(e, t, n, r) { var a, i; z(e, "text/html") ? a = e["text/html"] : (a = f.getHtml(), r = r || b.isMarked(a), f.isDefaultContent(a) && (n = !0)), a = k.trimHtml(a), f.remove(), i = !1 === r && P.isPlainText(a), a.length && !i || (n = !0), n && (a = z(e, "text/plain") && i ? e["text/plain"] : k.innerText(a)), f.isDefaultContent(a) ? t || c.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents.") : n ? j(c, a) : W(c, a, r) } c.on("keydown", function (e) { function t(e) { X(e) && !e.isDefaultPrevented() && f.remove() } if (X(e) && !e.isDefaultPrevented()) { if ((m = e.shiftKey && 86 === e.keyCode) && v.webkit && -1 !== navigator.userAgent.indexOf("Version/")) return; if (e.stopImmediatePropagation(), g = (new Date).getTime(), v.ie && m) return e.preventDefault(), void n(c, !0); f.remove(), f.create(), c.once("keyup", t), c.once("paste", function () { c.off("keyup", t) }) } }), c.on("paste", function (e) { var t, n, r, a = (new Date).getTime(), i = (t = c, n = V(e.clipboardData || t.getDoc().dataTransfer), k.isMsEdge() ? y.extend(n, { "text/html": "" }) : n), o = (new Date).getTime() - a, s = (new Date).getTime() - g - o < 1e3, l = "text" === d.get() || m, u = z(i, b.internalHtmlMime()); m = !1, e.isDefaultPrevented() || (r = e.clipboardData, -1 !== navigator.userAgent.indexOf("Android") && r && r.items && 0 === r.items.length) ? f.remove() : K(i) || !G(c, e, f.getLastRng() || c.selection.getRng()) ? (s || e.preventDefault(), !v.ie || s && !e.ieFake || z(i, "text/html") || (f.create(), c.dom.bind(f.getEl(), "paste", function (e) { e.stopPropagation() }), c.getDoc().execCommand("Paste", !1, null), i["text/html"] = f.getHtml()), z(i, "text/html") ? (e.preventDefault(), u || (u = b.isMarked(i["text/html"])), p(i, s, l, u)) : h.setEditorTimeout(c, function () { p(i, s, l, u) }, 0)) : f.remove() }) }, Y = function (e) { return e.dom.get("mcepastebin") }, Z = function (e, t) { return t === e }, J = function (r) { var e = o(null), a = "%MCEPASTEBIN%"; return { create: function () { return function (e, t, n) { var r, a, i = e.dom, o = e.getBody(), s = e.dom.getViewPort(e.getWin()).y, l = 20; t.set(e.selection.getRng()); var u = t.get(); if (e.inline && (a = e.selection.getScrollContainer()) && 0 < a.scrollTop && (s = a.scrollTop), u.getClientRects) { var c = function (e) { var t, n, r, a = e.startContainer; if ((t = e.getClientRects()).length) return t[0]; if (e.collapsed && 1 === a.nodeType) { for (r = a.childNodes[u.startOffset]; r && 3 === r.nodeType && !r.data.length;)r = r.nextSibling; if (r) return "BR" === r.tagName && (n = i.doc.createTextNode("\ufeff"), r.parentNode.insertBefore(n, r), (e = i.createRng()).setStartBefore(n), e.setEndAfter(n), t = e.getClientRects(), i.remove(n)), t.length ? t[0] : void 0 } }(u); if (c) l = s + (c.top - i.getPos(o).y); else { l = s; var f = u.startContainer; f && (3 === f.nodeType && f.parentNode !== o && (f = f.parentNode), 1 === f.nodeType && (l = i.getPos(f, a || o).y)) } } r = e.dom.add(e.getBody(), "div", { id: "mcepastebin", contentEditable: !0, "data-mce-bogus": "all", style: "position: absolute; top: " + l + "px; width: 10px; height: 10px; overflow: hidden; opacity: 0" }, n), (v.ie || v.gecko) && i.setStyle(r, "left", "rtl" === i.getStyle(o, "direction", !0) ? 65535 : -65535), i.bind(r, "beforedeactivate focusin focusout", function (e) { e.stopPropagation() }), r.focus(), e.selection.select(r, !0) }(r, e, a) }, remove: function () { return function (e, t) { if (Y(e)) { for (var n = void 0, r = t.get(); n = e.dom.get("mcepastebin");)e.dom.remove(n), e.dom.unbind(n); r && e.selection.setRng(r) } t.set(null) }(r, e) }, getEl: function () { return Y(r) }, getHtml: function () { return function (n) { var t, e, r, a, i, o = function (e, t) { e.appendChild(t), n.dom.remove(t, !0) }; for (e = y.grep(n.getBody().childNodes, function (e) { return "mcepastebin" === e.id }), t = e.shift(), y.each(e, function (e) { o(t, e) }), r = (a = n.dom.select("div[id=mcepastebin]", t)).length - 1; 0 <= r; r--)i = n.dom.create("div"), t.insertBefore(i, a[r]), o(i, a[r]); return t ? t.innerHTML : "" }(r) }, getLastRng: function () { return e.get() }, isDefault: function () { return e = a, n = Y(r), (t = n) && "mcepastebin" === t.id && Z(e, n.innerHTML); var e, t, n }, isDefaultContent: function (e) { return Z(a, e) } } }, Q = function (n, e) { var t = J(n); return n.on("preInit", function () { return q(o = n, t, e), void o.parser.addNodeFilter("img", function (e, t, n) { var r, a = function (e) { e.attr("data-mce-object") || s === v.transparentSrc || e.remove() }; if (!o.settings.paste_data_images && (r = n).data && !0 === r.data.paste) for (var i = e.length; i--;)(s = e[i].attributes.map.src) && (0 === s.indexOf("webkit-fake-url") ? a(e[i]) : o.settings.allow_html_data_urls || 0 !== s.indexOf("data:") || a(e[i])) }); var o, s }), { pasteFormat: e, pasteHtml: function (e, t) { return W(n, e, t) }, pasteText: function (e) { return j(n, e) }, pasteImageData: function (e, t) { return G(n, e, t) }, getDataTransferItems: V, hasHtmlOrText: K, hasContentType: z } }, ee = function () { }, te = function (e, t, n) { if (r = e, !1 !== v.iOS || r === undefined || "function" != typeof r.setData || !0 === k.isMsEdge()) return !1; try { return e.clearData(), e.setData("text/html", t), e.setData("text/plain", n), e.setData(b.internalHtmlMime(), t), !0 } catch (a) { return !1 } var r }, ne = function (e, t, n, r) { te(e.clipboardData, t.html, t.text) ? (e.preventDefault(), r()) : n(t.html, r) }, re = function (s) { return function (e, t) { var n = b.mark(e), r = s.dom.create("div", { contenteditable: "false", "data-mce-bogus": "all" }), a = s.dom.create("div", { contenteditable: "true" }, n); s.dom.setStyles(r, { position: "fixed", top: "0", left: "-3000px", width: "1000px", overflow: "hidden" }), r.appendChild(a), s.dom.add(s.getBody(), r); var i = s.selection.getRng(); a.focus(); var o = s.dom.createRng(); o.selectNodeContents(a), s.selection.setRng(o), setTimeout(function () { s.selection.setRng(i), r.parentNode.removeChild(r), t() }, 0) } }, ae = function (e) { return { html: e.selection.getContent({ contextual: !0 }), text: e.selection.getContent({ format: "text" }) } }, ie = function (e) { var t, n; e.on("cut", (t = e, function (e) { !1 === t.selection.isCollapsed() && ne(e, ae(t), re(t), function () { setTimeout(function () { t.execCommand("Delete") }, 0) }) })), e.on("copy", (n = e, function (e) { !1 === n.selection.isCollapsed() && ne(e, ae(n), re(n), ee) })) }, oe = tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"), se = function (e, t) { return oe.getCaretRangeFromPoint(t.clientX, t.clientY, e.getDoc()) }, le = function (e, t) { e.focus(), e.selection.setRng(t) }, ue = function (o, s, l) { m.shouldBlockDrop(o) && o.on("dragend dragover draggesture dragdrop drop drag", function (e) { e.preventDefault(), e.stopPropagation() }), m.shouldPasteDataImages(o) || o.on("drop", function (e) { var t = e.dataTransfer; t && t.files && 0 < t.files.length && e.preventDefault() }), o.on("drop", function (e) { var t, n; if (n = se(o, e), !e.isDefaultPrevented() && !l.get()) { t = s.getDataTransferItems(e.dataTransfer); var r, a = s.hasContentType(t, b.internalHtmlMime()); if ((s.hasHtmlOrText(t) && (!(r = t["text/plain"]) || 0 !== r.indexOf("file://")) || !s.pasteImageData(e, n)) && n && m.shouldFilterDrop(o)) { var i = t["mce-internal"] || t["text/html"] || t["text/plain"]; i && (e.preventDefault(), h.setEditorTimeout(o, function () { o.undoManager.transact(function () { t["mce-internal"] && o.execCommand("Delete"), le(o, n), i = k.trimHtml(i), t["text/html"] ? s.pasteHtml(i, a) : s.pasteText(i) }) })) } } }), o.on("dragstart", function (e) { l.set(!0) }), o.on("dragover dragend", function (e) { m.shouldPasteDataImages(o) && !1 === l.get() && (e.preventDefault(), le(o, se(o, e))), "dragend" === e.type && l.set(!1) }) }, ce = function (e) { var t = e.plugins.paste, n = m.getPreProcess(e); n && e.on("PastePreProcess", function (e) { n.call(t, t, e) }); var r = m.getPostProcess(e); r && e.on("PastePostProcess", function (e) { r.call(t, t, e) }) }; function fe(t, n) { t.on("PastePreProcess", function (e) { e.content = n(t, e.content, e.internal, e.wordContent) }) } function de(e, t) { if (!S.isWordContent(t)) return t; var n = []; y.each(e.schema.getBlockElements(), function (e, t) { n.push(t) }); var r = new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?(" + n.join("|") + ")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*", "g"); return t = k.filter(t, [[r, "$1"]]), t = k.filter(t, [[/<br><br>/g, "<BR><BR>"], [/<br>/g, " "], [/<BR><BR>/g, "<br>"]]) } function me(e, t, n, r) { if (r || n) return t; var u, a = m.getWebkitStyles(e); if (!1 === m.shouldRemoveWebKitStyles(e) || "all" === a) return t; if (a && (u = a.split(/[, ]/)), u) { var c = e.dom, f = e.selection.getNode(); t = t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi, function (e, t, n, r) { var a = c.parseStyle(c.decode(n)), i = {}; if ("none" === u) return t + r; for (var o = 0; o < u.length; o++) { var s = a[u[o]], l = c.getStyle(f, u[o], !0); /color/.test(u[o]) && (s = c.toHex(s), l = c.toHex(l)), l !== s && (i[u[o]] = s) } return (i = c.serializeStyle(i, "span")) ? t + ' style="' + i + '"' + r : t + r }) } else t = t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi, "$1$3"); return t = t.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi, function (e, t, n, r) { return t + ' style="' + n + '"' + r }) } function ge(n, e) { n.$("a", e).find("font,u").each(function (e, t) { n.dom.remove(t, !0) }) } var pe = function (e) { var t, n; v.webkit && fe(e, me), v.ie && (fe(e, de), n = ge, (t = e).on("PastePostProcess", function (e) { n(t, e.node) })) }, ve = function (e) { return function () { return e } }, he = (ve(!1), ve(!0), function (i) { for (var e = [], t = 1; t < arguments.length; t++)e[t - 1] = arguments[t]; for (var o = new Array(arguments.length - 1), n = 1; n < arguments.length; n++)o[n - 1] = arguments[n]; return function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; for (var n = new Array(arguments.length), r = 0; r < n.length; r++)n[r] = arguments[r]; var a = o.concat(n); return i.apply(null, a) } }), ye = function (e, t, n) { var r = n.control; r.active("text" === t.pasteFormat.get()), e.on("PastePlainTextToggle", function (e) { r.active(e.state) }) }, be = function (e, t) { var n = he(ye, e, t); e.addButton("pastetext", { active: !1, icon: "pastetext", tooltip: "Paste as text", cmd: "mceTogglePlainTextPaste", onPostRender: n }), e.addMenuItem("pastetext", { text: "Paste as text", selectable: !0, active: t.pasteFormat, cmd: "mceTogglePlainTextPaste", onPostRender: n }) }; t.add("paste", function (e) { if (!1 === s(e)) { var t = o(!1), n = o(!1), r = o(m.isPasteAsTextEnabled(e) ? "text" : "html"), a = Q(e, r), i = pe(e); return be(e, a), c(e, a, t), ce(e), ie(e), ue(e, a, n), l(a, i) } }) }();
!function () { "use strict"; var e = tinymce.util.Tools.resolve("tinymce.PluginManager"), r = tinymce.util.Tools.resolve("tinymce.Env"), c = function (e) { return parseInt(e.getParam("plugin_preview_width", "650"), 10) }, a = function (e) { return parseInt(e.getParam("plugin_preview_height", "500"), 10) }, s = function (e) { return e.getParam("content_style", "") }, d = tinymce.util.Tools.resolve("tinymce.util.Tools"), l = function (t) { var n = "", i = t.dom.encode, e = s(t); n += '<base href="' + i(t.documentBaseURI.getURI()) + '">', e && (n += '<style type="text/css">' + e + "</style>"), d.each(t.contentCSS, function (e) { n += '<link type="text/css" rel="stylesheet" href="' + i(t.documentBaseURI.toAbsolute(e)) + '">' }); var o = t.settings.body_id || "tinymce"; -1 !== o.indexOf("=") && (o = (o = t.getParam("body_id", "", "hash"))[t.id] || o); var r = t.settings.body_class || ""; -1 !== r.indexOf("=") && (r = (r = t.getParam("body_class", "", "hash"))[t.id] || ""); var c = t.settings.directionality ? ' dir="' + t.settings.directionality + '"' : ""; return "<!DOCTYPE html><html><head>" + n + '</head><body id="' + i(o) + '" class="mce-content-body ' + i(r) + '"' + i(c) + ">" + t.getContent() + '<script>document.addEventListener && document.addEventListener("click", function(e) {for (var elm = e.target; elm; elm = elm.parentNode) {if (elm.nodeName === "A") {e.preventDefault();}}}, false);<\/script> </body></html>' }, m = function (e, t, n) { var i = l(e); if (n) t.src = "data:text/html;charset=utf-8," + encodeURIComponent(i); else { var o = t.contentWindow.document; o.open(), o.write(i), o.close() } }, t = function (n) { var i = !r.ie, e = '<iframe src="" frameborder="0"' + (i ? ' sandbox="allow-scripts"' : "") + "></iframe>", t = c(n), o = a(n); n.windowManager.open({ title: "Preview", width: t, height: o, html: e, buttons: { text: "Close", onclick: function (e) { e.control.parent().parent().close() } }, onPostRender: function (e) { var t = e.control.getEl("body").firstChild; m(n, t, i) } }) }, n = function (e) { e.addCommand("mcePreview", function () { t(e) }) }, i = function (e) { e.addButton("preview", { title: "Preview", cmd: "mcePreview" }), e.addMenuItem("preview", { text: "Preview", cmd: "mcePreview", context: "view" }) }; e.add("preview", function (e) { n(e), i(e) }) }();
!function () { "use strict"; var t = tinymce.util.Tools.resolve("tinymce.PluginManager"), n = function (t) { t.addCommand("mcePrint", function () { t.getWin().print() }) }, i = function (t) { t.addButton("print", { title: "Print", cmd: "mcePrint" }), t.addMenuItem("print", { text: "Print", cmd: "mcePrint", icon: "print" }) }; t.add("print", function (t) { n(t), i(t), t.addShortcut("Meta+P", "", "mcePrint") }) }();
!function () { "use strict"; var n = tinymce.util.Tools.resolve("tinymce.PluginManager"), t = tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"), a = tinymce.util.Tools.resolve("tinymce.util.Tools"), o = function (n) { return n.getParam("save_enablewhendirty", !0) }, c = function (n) { return !!n.getParam("save_onsavecallback") }, i = function (n) { return !!n.getParam("save_oncancelcallback") }, r = function (n, e) { n.notificationManager.open({ text: n.translate(e), type: "error" }) }, e = function (n) { var e; if (e = t.DOM.getParent(n.id, "form"), !o(n) || n.isDirty()) { if (n.save(), c(n)) return n.execCallback("save_onsavecallback", n), void n.nodeChanged(); e ? (n.setDirty(!1), e.onsubmit && !e.onsubmit() || ("function" == typeof e.submit ? e.submit() : r(n, "Error: Form submit field collision.")), n.nodeChanged()) : r(n, "Error: No form element found.") } }, l = function (n) { var e = a.trim(n.startContent); i(n) ? n.execCallback("save_oncancelcallback", n) : (n.setContent(e), n.undoManager.clear(), n.nodeChanged()) }, d = function (n) { n.addCommand("mceSave", function () { e(n) }), n.addCommand("mceCancel", function () { l(n) }) }, s = function (t) { return function (n) { var e = n.control; t.on("nodeChange dirty", function () { e.disabled(o(t) && !t.isDirty()) }) } }, u = function (n) { n.addButton("save", { icon: "save", text: "Save", cmd: "mceSave", disabled: !0, onPostRender: s(n) }), n.addButton("cancel", { text: "Cancel", icon: !1, cmd: "mceCancel", disabled: !0, onPostRender: s(n) }), n.addShortcut("Meta+S", "", "mceSave") }; n.add("save", function (n) { u(n), d(n) }) }();
!function () { "use strict"; var r = function (e) { var t = e, n = function () { return t }; return { get: n, set: function (e) { t = e }, clone: function () { return r(n()) } } }, e = tinymce.util.Tools.resolve("tinymce.PluginManager"), p = tinymce.util.Tools.resolve("tinymce.util.Tools"); function h(e) { return e && 1 === e.nodeType && "false" === e.contentEditable } var u = { findAndReplaceDOMText: function (t, n, r, a, i) { var o, d, v, f, p, g, c = [], l = 0; function s(e, t) { if (t = t || 0, !e[0]) throw new Error("findAndReplaceDOMText cannot handle zero-length matches"); var n = e.index; if (0 < t) { var r = e[t]; if (!r) throw new Error("Invalid capture group"); n += e[0].indexOf(r), e[0] = r } return [n, n + e[0].length, [e[0]]] } if (v = n.ownerDocument, f = i.getBlockElements(), p = i.getWhiteSpaceElements(), g = i.getShortEndedElements(), d = function e(t) { var n; if (3 === t.nodeType) return t.data; if (p[t.nodeName] && !f[t.nodeName]) return ""; if (n = "", h(t)) return "\n"; if ((f[t.nodeName] || g[t.nodeName]) && (n += "\n"), t = t.firstChild) for (; n += e(t), t = t.nextSibling;); return n }(n)) { if (t.global) for (; o = t.exec(d);)c.push(s(o, a)); else o = d.match(t), c.push(s(o, a)); return c.length && (l = c.length, function (e, t, n) { var r, a, i, o, d = [], c = 0, l = e, s = t.shift(), u = 0; e: for (; ;) { if ((f[l.nodeName] || g[l.nodeName] || h(l)) && c++ , 3 === l.nodeType && (!a && l.length + c >= s[1] ? (a = l, o = s[1] - c) : r && d.push(l), !r && l.length + c > s[0] && (r = l, i = s[0] - c), c += l.length), r && a) { if (l = n({ startNode: r, startNodeIndex: i, endNode: a, endNodeIndex: o, innerNodes: d, match: s[2], matchIndex: u }), c -= a.length - o, a = r = null, d = [], u++ , !(s = t.shift())) break } else if (p[l.nodeName] && !f[l.nodeName] || !l.firstChild) { if (l.nextSibling) { l = l.nextSibling; continue } } else if (!h(l)) { l = l.firstChild; continue } for (; ;) { if (l.nextSibling) { l = l.nextSibling; break } if (l.parentNode === e) break e; l = l.parentNode } } }(n, c, function (e) { var m; if ("function" != typeof e) { var r = e.nodeType ? e : v.createElement(e); m = function (e, t) { var n = r.cloneNode(!1); return n.setAttribute("data-mce-index", t), e && n.appendChild(v.createTextNode(e)), n } } else m = e; return function (e) { var t, n, r, a = e.startNode, i = e.endNode, o = e.matchIndex; if (a === i) { var d = a; r = d.parentNode, 0 < e.startNodeIndex && (t = v.createTextNode(d.data.substring(0, e.startNodeIndex)), r.insertBefore(t, d)); var c = m(e.match[0], o); return r.insertBefore(c, d), e.endNodeIndex < d.length && (n = v.createTextNode(d.data.substring(e.endNodeIndex)), r.insertBefore(n, d)), d.parentNode.removeChild(d), c } t = v.createTextNode(a.data.substring(0, e.startNodeIndex)), n = v.createTextNode(i.data.substring(e.endNodeIndex)); for (var l = m(a.data.substring(e.startNodeIndex), o), s = [], u = 0, f = e.innerNodes.length; u < f; ++u) { var p = e.innerNodes[u], g = m(p.data, o); p.parentNode.replaceChild(g, p), s.push(g) } var h = m(i.data.substring(0, e.endNodeIndex), o); return (r = a.parentNode).insertBefore(t, a), r.insertBefore(l, a), r.removeChild(a), (r = i.parentNode).insertBefore(h, i), r.insertBefore(n, i), r.removeChild(i), h } }(r))), l } } }, g = function (e) { var t = e.getAttribute("data-mce-index"); return "number" == typeof t ? "" + t : t }, m = function (e) { var t = e.parentNode; e.firstChild && t.insertBefore(e.firstChild, e), e.parentNode.removeChild(e) }, o = function (e, t) { var n, r = []; if ((n = p.toArray(e.getBody().getElementsByTagName("span"))).length) for (var a = 0; a < n.length; a++) { var i = g(n[a]); null !== i && i.length && i === t.toString() && r.push(n[a]) } return r }, f = function (e, t, n) { var r = t.get(), a = e.dom; (n = !1 !== n) ? r++ : r-- , a.removeClass(o(e, t.get()), "mce-match-marker-selected"); var i = o(e, r); return i.length ? (a.addClass(o(e, r), "mce-match-marker-selected"), e.selection.scrollIntoView(i[0]), r) : -1 }, v = function (e, t) { var n = t.parentNode; e.remove(t), e.isEmpty(n) && e.remove(n) }, x = function (e, t) { var n = f(e, t, !0); -1 !== n && t.set(n) }, b = function (e, t) { var n = f(e, t, !1); -1 !== n && t.set(n) }, N = function (e) { var t = g(e); return null !== t && 0 < t.length }, y = function (e, t, n) { var r, a, i, o; for (a = p.toArray(e.getBody().getElementsByTagName("span")), r = 0; r < a.length; r++) { var d = g(a[r]); null !== d && d.length && (d === t.get().toString() && (i || (i = a[r].firstChild), o = a[r].firstChild), m(a[r])) } if (i && o) { var c = e.dom.createRng(); return c.setStart(i, 0), c.setEnd(o, o.data.length), !1 !== n && e.selection.setRng(c), c } }, k = function (e, t) { return 0 < o(e, t.get() + 1).length }, C = function (e, t) { return 0 < o(e, t.get() - 1).length }, T = { done: y, find: function (e, t, n, r, a) { n = (n = n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&")).replace(/\s/g, "\\s"), n = a ? "\\b" + n + "\\b" : n; var i, o, d, c, l, s = (i = e, o = t, d = new RegExp(n, r ? "g" : "gi"), (l = i.dom.create("span", { "data-mce-bogus": 1 })).className = "mce-match-marker", c = i.getBody(), y(i, o, !1), u.findAndReplaceDOMText(d, c, l, !1, i.schema)); return s && (t.set(-1), t.set(f(e, t, !0))), s }, next: x, prev: b, replace: function (e, t, n, r, a) { var i, o, d, c, l, s, u = t.get(); for (r = !1 !== r, d = e.getBody(), o = p.grep(p.toArray(d.getElementsByTagName("span")), N), i = 0; i < o.length; i++) { var f = g(o[i]); if (c = l = parseInt(f, 10), a || c === t.get()) { for (n.length ? (o[i].firstChild.nodeValue = n, m(o[i])) : v(e.dom, o[i]); o[++i];) { if ((c = parseInt(g(o[i]), 10)) !== l) { i--; break } v(e.dom, o[i]) } r && u-- } else l > t.get() && o[i].setAttribute("data-mce-index", l - 1) } return t.set(u), r ? (s = k(e, t), x(e, t)) : (s = C(e, t), b(e, t)), !a && s }, hasNext: k, hasPrev: C }, n = function (r, a) { return { done: function (e) { return T.done(r, a, e) }, find: function (e, t, n) { return T.find(r, a, e, t, n) }, next: function () { return T.next(r, a) }, prev: function () { return T.prev(r, a) }, replace: function (e, t, n) { return T.replace(r, a, e, t, n) } } }, a = function (i, o) { var e, d = {}; function c() { s.statusbar.find("#next").disabled(!1 === T.hasNext(i, o)), s.statusbar.find("#prev").disabled(!1 === T.hasPrev(i, o)) } function l() { i.windowManager.alert("Could not find the specified string.", function () { s.find("#find")[0].focus() }) } i.undoManager.add(), e = p.trim(i.selection.getContent({ format: "text" })); var s = i.windowManager.open({ layout: "flex", pack: "center", align: "center", onClose: function () { i.focus(), T.done(i, o), i.undoManager.add() }, onSubmit: function (e) { var t, n, r, a; return e.preventDefault(), n = s.find("#case").checked(), a = s.find("#words").checked(), (r = s.find("#find").value()).length ? d.text === r && d.caseState === n && d.wholeWord === a ? T.hasNext(i, o) ? (T.next(i, o), void c()) : void l() : ((t = T.find(i, o, r, n, a)) || l(), s.statusbar.items().slice(1).disabled(0 === t), c(), void (d = { text: r, caseState: n, wholeWord: a })) : (T.done(i, o, !1), void s.statusbar.items().slice(1).disabled(!0)) }, buttons: [{ text: "Find", subtype: "primary", onclick: function () { s.submit() } }, { text: "Replace", disabled: !0, onclick: function () { T.replace(i, o, s.find("#replace").value()) || (s.statusbar.items().slice(1).disabled(!0), o.set(-1), d = {}) } }, { text: "Replace all", disabled: !0, onclick: function () { T.replace(i, o, s.find("#replace").value(), !0, !0), s.statusbar.items().slice(1).disabled(!0), d = {} } }, { type: "spacer", flex: 1 }, { text: "Prev", name: "prev", disabled: !0, onclick: function () { T.prev(i, o), c() } }, { text: "Next", name: "next", disabled: !0, onclick: function () { T.next(i, o), c() } }], title: "Find and replace", items: { type: "form", padding: 20, labelGap: 30, spacing: 10, items: [{ type: "textbox", name: "find", size: 40, label: "Find", value: e }, { type: "textbox", name: "replace", size: 40, label: "Replace with" }, { type: "checkbox", name: "case", text: "Match case", label: " " }, { type: "checkbox", name: "words", text: "Whole words", label: " " }] } }) }, i = function (e, t) { e.addCommand("SearchReplace", function () { a(e, t) }) }, d = function (e, t) { return function () { a(e, t) } }, c = function (e, t) { e.addMenuItem("searchreplace", { text: "Find and replace", shortcut: "Meta+F", onclick: d(e, t), separator: "before", context: "edit" }), e.addButton("searchreplace", { tooltip: "Find and replace", onclick: d(e, t) }), e.shortcuts.add("Meta+F", "", d(e, t)) }; e.add("searchreplace", function (e) { var t = r(-1); return i(e, t), c(e, t), n(e, t) }) }();
!function () { "use strict"; var c = function (e) { var t = e, n = function () { return t }; return { get: n, set: function (e) { t = e }, clone: function () { return c(n()) } } }, t = tinymce.util.Tools.resolve("tinymce.PluginManager"), a = function (e) { return !(!/(^|[ ,])tinymcespellchecker([, ]|$)/.test(e.settings.plugins) || !t.get("tinymcespellchecker") || ("undefined" != typeof window.console && window.console.log && window.console.log("Spell Checker Pro is incompatible with Spell Checker plugin! Remove 'spellchecker' from the 'plugins' option."), 0)) }, h = function (e) { return e.getParam("spellchecker_languages", "English=en,Danish=da,Dutch=nl,Finnish=fi,French=fr_FR,German=de,Italian=it,Polish=pl,Portuguese=pt_BR,Spanish=es,Swedish=sv") }, l = function (e) { var t = e.getParam("language", "en"); return e.getParam("spellchecker_language", t) }, d = function (e) { return e.getParam("spellchecker_rpc_url") }, f = function (e) { return e.getParam("spellchecker_callback") }, s = function (e) { var t = new RegExp('[^\\s!"#$%&()*+,-./:;<=>?@[\\]^_{|}`\xa7\xa9\xab\xae\xb1\xb6\xb7\xb8\xbb\xbc\xbd\xbe\xbf\xd7\xf7\xa4\u201d\u201c\u201e\xa0\u2002\u2003\u2009]+', "g"); return e.getParam("spellchecker_wordchar_pattern", t) }, g = tinymce.util.Tools.resolve("tinymce.util.Tools"), m = tinymce.util.Tools.resolve("tinymce.util.URI"), p = tinymce.util.Tools.resolve("tinymce.util.XHR"), u = function (e) { return e.fire("SpellcheckStart") }, r = function (e) { return e.fire("SpellcheckEnd") }; function v(e) { return e && 1 === e.nodeType && "false" === e.contentEditable } var x, o = function (c, r) { var n, o, f, h, g, i = [], x = r.dom; function a(e, t) { if (!e[0]) throw new Error("findAndReplaceDOMText cannot handle zero-length matches"); return { start: e.index, end: e.index + e[0].length, text: e[0], data: t } } function l(e) { var t = c.getElementsByTagName("*"), n = []; e = "number" == typeof e ? "" + e : null; for (var r = 0; r < t.length; r++) { var o = t[r], i = o.getAttribute("data-mce-index"); null !== i && i.length && -1 !== o.className.indexOf("mce-spellchecker-word") && (i !== e && null !== e || n.push(o)) } return n } function s(e) { for (var t = i.length; t--;)if (i[t] === e) return t; return -1 } function t(e) { for (var t = 0, n = i.length; t < n && !1 !== e(i[t], t); t++); return this } function u(e) { var t, n, r = l(e ? s(e) : null); for (t = r.length; t--;)(n = r[t]).parentNode.insertBefore(n.firstChild, n), n.parentNode.removeChild(n); return this } function d(e) { var t = l(s(e)), n = r.dom.createRng(); return n.setStartBefore(t[0]), n.setEndAfter(t[t.length - 1]), n } return f = r.schema.getBlockElements(), h = r.schema.getWhiteSpaceElements(), g = r.schema.getShortEndedElements(), { text: o = function e(t) { var n; if (3 === t.nodeType) return t.data; if (h[t.nodeName] && !f[t.nodeName]) return ""; if (v(t)) return "\n"; if (n = "", (f[t.nodeName] || g[t.nodeName]) && (n += "\n"), t = t.firstChild) for (; n += e(t), t = t.nextSibling;); return n }(c), matches: i, each: t, filter: function (n) { var r = []; return t(function (e, t) { n(e, t) && r.push(e) }), i = r, this }, reset: function () { return i.splice(0, i.length), u(), this }, matchFromElement: function (e) { return i[e.getAttribute("data-mce-index")] }, elementFromMatch: function (e) { return l(s(e))[0] }, find: function (e, t) { if (o && e.global) for (; n = e.exec(o);)i.push(a(n, t)); return this }, add: function (e, t, n) { return i.push({ start: e, end: e + t, text: o.substr(e, t), data: n }), this }, wrap: function (e) { return i.length && function (e, t, n) { var r, o, i, c, a, l = [], s = 0, u = e, d = 0; (t = t.slice(0)).sort(function (e, t) { return e.start - t.start }), a = t.shift(); e: for (; ;) { if ((f[u.nodeName] || g[u.nodeName] || v(u)) && s++ , 3 === u.nodeType && (!o && u.length + s >= a.end ? (o = u, c = a.end - s) : r && l.push(u), !r && u.length + s > a.start && (r = u, i = a.start - s), s += u.length), r && o) { if (u = n({ startNode: r, startNodeIndex: i, endNode: o, endNodeIndex: c, innerNodes: l, match: a.text, matchIndex: d }), s -= o.length - c, o = r = null, l = [], d++ , !(a = t.shift())) break } else if (h[u.nodeName] && !f[u.nodeName] || !u.firstChild) { if (u.nextSibling) { u = u.nextSibling; continue } } else if (!v(u)) { u = u.firstChild; continue } for (; ;) { if (u.nextSibling) { u = u.nextSibling; break } if (u.parentNode === e) break e; u = u.parentNode } } }(c, i, function (o) { function v(e, t) { var n = i[t]; n.stencil || (n.stencil = o(n)); var r = n.stencil.cloneNode(!1); return r.setAttribute("data-mce-index", t), e && r.appendChild(x.doc.createTextNode(e)), r } return function (e) { var t, n, r, o = e.startNode, i = e.endNode, c = e.matchIndex, a = x.doc; if (o === i) { var l = o; r = l.parentNode, 0 < e.startNodeIndex && (t = a.createTextNode(l.data.substring(0, e.startNodeIndex)), r.insertBefore(t, l)); var s = v(e.match, c); return r.insertBefore(s, l), e.endNodeIndex < l.length && (n = a.createTextNode(l.data.substring(e.endNodeIndex)), r.insertBefore(n, l)), l.parentNode.removeChild(l), s } t = a.createTextNode(o.data.substring(0, e.startNodeIndex)), n = a.createTextNode(i.data.substring(e.endNodeIndex)); for (var u = v(o.data.substring(e.startNodeIndex), c), d = [], f = 0, h = e.innerNodes.length; f < h; ++f) { var g = e.innerNodes[f], m = v(g.data, c); g.parentNode.replaceChild(m, g), d.push(m) } var p = v(i.data.substring(0, e.endNodeIndex), c); return (r = o.parentNode).insertBefore(t, o), r.insertBefore(u, o), r.removeChild(o), (r = i.parentNode).insertBefore(p, i), r.insertBefore(n, i), r.removeChild(i), p } }(e)), this }, unwrap: u, replace: function (e, t) { var n = d(e); return n.deleteContents(), 0 < t.length && n.insertNode(r.dom.doc.createTextNode(t)), n }, rangeFromMatch: d, indexOf: s } }, N = function (e, t) { if (!t.get()) { var n = o(e.getBody(), e); t.set(n) } return t.get() }, k = function (e, t, n, r, o, i, c) { var a, l, s, u = f(e); (u || (a = e, l = t, s = n, function (e, t, n, r) { var o = { method: e, lang: s.get() }, i = ""; o["addToDictionary" === e ? "word" : "text"] = t, g.each(o, function (e, t) { i && (i += "&"), i += t + "=" + encodeURIComponent(e) }), p.send({ url: new m(l).toAbsolute(d(a)), type: "post", content_type: "application/x-www-form-urlencoded", data: i, success: function (e) { if (e = JSON.parse(e)) e.error ? r(e.error) : n(e); else { var t = a.translate("Server response wasn't proper JSON."); r(t) } }, error: function () { var e = a.translate("The spelling service was not found: (") + d(a) + a.translate(")"); r(e) } }) })).call(e.plugins.spellchecker, r, o, i, c) }, y = function (e, t, n) { e.dom.select("span.mce-spellchecker-word").length || S(e, t, n) }, S = function (e, t, n) { if (N(e, n).reset(), n.set(null), t.get()) return t.set(!1), r(e), !0 }, w = function (e) { var t = e.getAttribute("data-mce-index"); return "number" == typeof t ? "" + t : t }, b = function (t, e, n, r, o) { var i, c; if ("string" != typeof o && o.words ? (c = !!o.dictionary, i = o.words) : i = o, t.setProgressState(!1), function (e) { for (var t in e) return !1; return !0 }(i)) { var a = t.translate("No misspellings found."); return t.notificationManager.open({ text: a, type: "info" }), void e.set(!1) } r.set({ suggestions: i, hasDictionarySupport: c }), N(t, n).find(s(t)).filter(function (e) { return !!i[e.text] }).wrap(function (e) { return t.dom.create("span", { "class": "mce-spellchecker-word", "data-mce-bogus": 1, "data-mce-word": e.text }) }), e.set(!0), u(t) }, T = { spellcheck: function (t, e, n, r, o, i) { S(t, n, r) || (t.setProgressState(!0), k(t, e, i, "spellcheck", N(t, r).text, function (e) { b(t, n, r, o, e) }, function (e) { t.notificationManager.open({ text: e, type: "error" }), t.setProgressState(!1), S(t, n, r) }), t.focus()) }, checkIfFinished: y, addToDictionary: function (t, e, n, r, o, i, c) { t.setProgressState(!0), k(t, e, o, "addToDictionary", i, function () { t.setProgressState(!1), t.dom.remove(c, !0), y(t, n, r) }, function (e) { t.notificationManager.open({ text: e, type: "error" }), t.setProgressState(!1) }) }, ignoreWord: function (t, e, n, r, o, i) { t.selection.collapse(), i ? g.each(t.dom.select("span.mce-spellchecker-word"), function (e) { e.getAttribute("data-mce-word") === r && t.dom.remove(e, !0) }) : t.dom.remove(o, !0), y(t, e, n) }, findSpansByIndex: function (e, t) { var n, r = []; if ((n = g.toArray(e.getBody().getElementsByTagName("span"))).length) for (var o = 0; o < n.length; o++) { var i = w(n[o]); null !== i && i.length && i === t.toString() && r.push(n[o]) } return r }, getElmIndex: w, markErrors: b }, I = function (t, n, r, o, e, i) { return { getTextMatcher: function () { return o.get() }, getWordCharPattern: function () { return s(t) }, markErrors: function (e) { T.markErrors(t, n, o, r, e) }, getLanguage: function () { return e.get() } } }, E = function (e, t, n, r, o, i) { e.addCommand("mceSpellCheck", function () { T.spellcheck(e, t, n, r, o, i) }) }, P = function (n, e, r, t, o, i) { var c, a, l, s, u = (l = n, c = g.map(h(l).split(","), function (e) { return { name: (e = e.split("="))[0], value: e[1] } }), a = [], g.each(c, function (e) { a.push({ selectable: !0, text: e.name, data: e.value }) }), a), d = function () { T.spellcheck(n, e, r, t, i, o) }, f = { tooltip: "Spellcheck", onclick: d, onPostRender: function (e) { var t = e.control; n.on("SpellcheckStart SpellcheckEnd", function () { t.active(r.get()) }) } }; 1 < u.length && (f.type = "splitbutton", f.menu = u, f.onshow = (s = o, function (e) { var t = s.get(); e.control.items().each(function (e) { e.active(e.settings.data === t) }) }), f.onselect = function (e) { o.set(e.control.settings.data) }), n.addButton("spellchecker", f), n.addMenuItem("spellchecker", { text: "Spellcheck", context: "tools", onclick: d, selectable: !0, onPostRender: function () { var e = this; e.active(r.get()), n.on("SpellcheckStart SpellcheckEnd", function () { e.active(r.get()) }) } }) }, B = tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"), C = tinymce.util.Tools.resolve("tinymce.ui.Factory"), D = function (o, i, c, a, l, s) { o.on("click", function (e) { var t = e.target; if ("mce-spellchecker-word" === t.className) { e.preventDefault(); var n = T.findSpansByIndex(o, T.getElmIndex(t)); if (0 < n.length) { var r = o.dom.createRng(); r.setStartBefore(n[0]), r.setEndAfter(n[n.length - 1]), o.selection.setRng(r), function (t, e, n, r, o, i, c, a) { var l = [], s = n.get().suggestions[c]; g.each(s, function (e) { l.push({ text: e, onclick: function () { t.insertContent(t.dom.encode(e)), t.dom.remove(a), T.checkIfFinished(t, r, o) } }) }), l.push({ text: "-" }), n.get().hasDictionarySupport && l.push({ text: "Add to Dictionary", onclick: function () { T.addToDictionary(t, e, r, o, i, c, a) } }), l.push.apply(l, [{ text: "Ignore", onclick: function () { T.ignoreWord(t, r, o, c, a) } }, { text: "Ignore all", onclick: function () { T.ignoreWord(t, r, o, c, a, !0) } }]), (x = C.create("menu", { items: l, context: "contextmenu", onautohide: function (e) { -1 !== e.target.className.indexOf("spellchecker") && e.preventDefault() }, onhide: function () { x.remove(), x = null } })).renderTo(document.body); var u = B.DOM.getPos(t.getContentAreaContainer()), d = t.dom.getPos(a[0]), f = t.dom.getRoot(); "BODY" === f.nodeName ? (d.x -= f.ownerDocument.documentElement.scrollLeft || f.scrollLeft, d.y -= f.ownerDocument.documentElement.scrollTop || f.scrollTop) : (d.x -= f.scrollLeft, d.y -= f.scrollTop), u.x += d.x, u.y += d.y, x.moveTo(u.x, u.y + a[0].offsetHeight) }(o, i, c, a, l, s, t.getAttribute("data-mce-word"), n) } } }) }; t.add("spellchecker", function (e, t) { if (!1 === a(e)) { var n = c(!1), r = c(l(e)), o = c(null), i = c(null); return P(e, t, n, o, r, i), D(e, t, i, n, o, r), E(e, t, n, o, i, r), I(e, n, i, o, r, t) } }) }();
!function () { "use strict"; var e = tinymce.util.Tools.resolve("tinymce.PluginManager"), t = tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"), c = tinymce.util.Tools.resolve("tinymce.EditorManager"), s = tinymce.util.Tools.resolve("tinymce.Env"), a = tinymce.util.Tools.resolve("tinymce.util.Delay"), y = tinymce.util.Tools.resolve("tinymce.util.Tools"), f = tinymce.util.Tools.resolve("tinymce.util.VK"), d = { getTabFocus: function (e) { return e.getParam("tab_focus", e.getParam("tabfocus_elements", ":prev,:next")) } }, m = t.DOM, n = function (e) { e.keyCode !== f.TAB || e.ctrlKey || e.altKey || e.metaKey || e.preventDefault() }, i = function (r) { function e(n) { var i, o, e, l; if (!(n.keyCode !== f.TAB || n.ctrlKey || n.altKey || n.metaKey || n.isDefaultPrevented()) && (1 === (e = y.explode(d.getTabFocus(r))).length && (e[1] = e[0], e[0] = ":prev"), o = n.shiftKey ? ":prev" === e[0] ? u(-1) : m.get(e[0]) : ":next" === e[1] ? u(1) : m.get(e[1]))) { var t = c.get(o.id || o.name); o.id && t ? t.focus() : a.setTimeout(function () { s.webkit || window.focus(), o.focus() }, 10), n.preventDefault() } function u(e) { function t(t) { return /INPUT|TEXTAREA|BUTTON/.test(t.tagName) && c.get(n.id) && -1 !== t.tabIndex && function e(t) { return "BODY" === t.nodeName || "hidden" !== t.type && "none" !== t.style.display && "hidden" !== t.style.visibility && e(t.parentNode) }(t) } if (o = m.select(":input:enabled,*[tabindex]:not(iframe)"), y.each(o, function (e, t) { if (e.id === r.id) return i = t, !1 }), 0 < e) { for (l = i + 1; l < o.length; l++)if (t(o[l])) return o[l] } else for (l = i - 1; 0 <= l; l--)if (t(o[l])) return o[l]; return null } } r.on("init", function () { r.inline && m.setAttrib(r.getBody(), "tabIndex", null), r.on("keyup", n), s.gecko ? r.on("keypress keydown", e) : r.on("keydown", e) }) }; e.add("tabfocus", function (e) { i(e) }) }();
!function () { "use strict"; var e, t, n, r, o, i, u = tinymce.util.Tools.resolve("tinymce.PluginManager"), a = function (e) { return function () { return e } }, y = { noop: function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t] }, noarg: function (n) { return function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; return n() } }, compose: function (n, r) { return function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; return n(r.apply(null, arguments)) } }, constant: a, identity: function (e) { return e }, tripleEquals: function (e, t) { return e === t }, curry: function (i) { for (var e = [], t = 1; t < arguments.length; t++)e[t - 1] = arguments[t]; for (var u = new Array(arguments.length - 1), n = 1; n < arguments.length; n++)u[n - 1] = arguments[n]; return function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; for (var n = new Array(arguments.length), r = 0; r < n.length; r++)n[r] = arguments[r]; var o = u.concat(n); return i.apply(null, o) } }, not: function (n) { return function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; return !n.apply(null, arguments) } }, die: function (e) { return function () { throw new Error(e) } }, apply: function (e) { return e() }, call: function (e) { e() }, never: a(!1), always: a(!0) }, c = y.never, l = y.always, s = function () { return f }, f = (r = { fold: function (e, t) { return e() }, is: c, isSome: c, isNone: l, getOr: n = function (e) { return e }, getOrThunk: t = function (e) { return e() }, getOrDie: function (e) { throw new Error(e || "error: getOrDie called on none.") }, or: n, orThunk: t, map: s, ap: s, each: function () { }, bind: s, flatten: s, exists: c, forall: l, filter: s, equals: e = function (e) { return e.isNone() }, equals_: e, toArray: function () { return [] }, toString: y.constant("none()") }, Object.freeze && Object.freeze(r), r), d = function (n) { var e = function () { return n }, t = function () { return o }, r = function (e) { return e(n) }, o = { fold: function (e, t) { return t(n) }, is: function (e) { return n === e }, isSome: l, isNone: c, getOr: e, getOrThunk: e, getOrDie: e, or: t, orThunk: t, map: function (e) { return d(e(n)) }, ap: function (e) { return e.fold(s, function (e) { return d(e(n)) }) }, each: function (e) { e(n) }, bind: r, flatten: e, exists: r, forall: r, filter: function (e) { return e(n) ? o : f }, equals: function (e) { return e.is(n) }, equals_: function (e, t) { return e.fold(c, function (e) { return t(n, e) }) }, toArray: function () { return [n] }, toString: function () { return "some(" + n + ")" } }; return o }, x = { some: d, none: s, from: function (e) { return null === e || e === undefined ? f : d(e) } }, m = function (t) { return function (e) { return function (e) { if (null === e) return "null"; var t = typeof e; return "object" === t && Array.prototype.isPrototypeOf(e) ? "array" : "object" === t && String.prototype.isPrototypeOf(e) ? "string" : t }(e) === t } }, g = { isString: m("string"), isObject: m("object"), isArray: m("array"), isNull: m("null"), isBoolean: m("boolean"), isUndefined: m("undefined"), isFunction: m("function"), isNumber: m("number") }, p = (o = Array.prototype.indexOf) === undefined ? function (e, t) { return R(e, t) } : function (e, t) { return o.call(e, t) }, h = function (e, t) { return -1 < p(e, t) }, v = function (e, t) { for (var n = e.length, r = new Array(n), o = 0; o < n; o++) { var i = e[o]; r[o] = t(i, o, e) } return r }, b = function (e, t) { for (var n = 0, r = e.length; n < r; n++)t(e[n], n, e) }, w = function (e, t) { for (var n = e.length - 1; 0 <= n; n--)t(e[n], n, e) }, S = function (e, t) { for (var n = [], r = 0, o = e.length; r < o; r++) { var i = e[r]; t(i, r, e) && n.push(i) } return n }, C = function (e, t) { for (var n = 0, r = e.length; n < r; n++)if (t(e[n], n, e)) return x.some(n); return x.none() }, R = function (e, t) { for (var n = 0, r = e.length; n < r; ++n)if (e[n] === t) return n; return -1 }, T = Array.prototype.push, A = function (e) { for (var t = [], n = 0, r = e.length; n < r; ++n) { if (!Array.prototype.isPrototypeOf(e[n])) throw new Error("Arr.flatten item " + n + " was not an array, input: " + e); T.apply(t, e[n]) } return t }, D = function (e, t) { for (var n = 0, r = e.length; n < r; ++n)if (!0 !== t(e[n], n, e)) return !1; return !0 }, k = Array.prototype.slice, N = g.isFunction(Array.from) ? Array.from : function (e) { return k.call(e) }, E = { map: v, each: b, eachr: w, partition: function (e, t) { for (var n = [], r = [], o = 0, i = e.length; o < i; o++) { var u = e[o]; (t(u, o, e) ? n : r).push(u) } return { pass: n, fail: r } }, filter: S, groupBy: function (e, t) { if (0 === e.length) return []; for (var n = t(e[0]), r = [], o = [], i = 0, u = e.length; i < u; i++) { var a = e[i], c = t(a); c !== n && (r.push(o), o = []), n = c, o.push(a) } return 0 !== o.length && r.push(o), r }, indexOf: function (e, t) { var n = p(e, t); return -1 === n ? x.none() : x.some(n) }, foldr: function (e, t, n) { return w(e, function (e) { n = t(n, e) }), n }, foldl: function (e, t, n) { return b(e, function (e) { n = t(n, e) }), n }, find: function (e, t) { for (var n = 0, r = e.length; n < r; n++) { var o = e[n]; if (t(o, n, e)) return x.some(o) } return x.none() }, findIndex: C, flatten: A, bind: function (e, t) { var n = v(e, t); return A(n) }, forall: D, exists: function (e, t) { return C(e, t).isSome() }, contains: h, equal: function (e, n) { return e.length === n.length && D(e, function (e, t) { return e === n[t] }) }, reverse: function (e) { var t = k.call(e, 0); return t.reverse(), t }, chunk: function (e, t) { for (var n = [], r = 0; r < e.length; r += t) { var o = e.slice(r, r + t); n.push(o) } return n }, difference: function (e, t) { return S(e, function (e) { return !h(t, e) }) }, mapToObject: function (e, t) { for (var n = {}, r = 0, o = e.length; r < o; r++) { var i = e[r]; n[String(i)] = t(i, r) } return n }, pure: function (e) { return [e] }, sort: function (e, t) { var n = k.call(e, 0); return n.sort(t), n }, range: function (e, t) { for (var n = [], r = 0; r < e; r++)n.push(t(r)); return n }, head: function (e) { return 0 === e.length ? x.none() : x.some(e[0]) }, last: function (e) { return 0 === e.length ? x.none() : x.some(e[e.length - 1]) }, from: N }, O = (i = Object.keys) === undefined ? function (e) { var t = []; for (var n in e) e.hasOwnProperty(n) && t.push(n); return t } : i, B = function (e, t) { for (var n = O(e), r = 0, o = n.length; r < o; r++) { var i = n[r]; t(e[i], i, e) } }, P = function (r, o) { var i = {}; return B(r, function (e, t) { var n = o(e, t, r); i[n.k] = n.v }), i }, I = function (e, n) { var r = []; return B(e, function (e, t) { r.push(n(e, t)) }), r }, W = function (e) { return I(e, function (e) { return e }) }, M = { bifilter: function (e, n) { var r = {}, o = {}; return B(e, function (e, t) { (n(e, t) ? r : o)[t] = e }), { t: r, f: o } }, each: B, map: function (e, r) { return P(e, function (e, t, n) { return { k: t, v: r(e, t, n) } }) }, mapToArray: I, tupleMap: P, find: function (e, t) { for (var n = O(e), r = 0, o = n.length; r < o; r++) { var i = n[r], u = e[i]; if (t(u, i, e)) return x.some(u) } return x.none() }, keys: O, values: W, size: function (e) { return W(e).length } }, L = function (e) { return e.slice(0).sort() }, q = { sort: L, reqMessage: function (e, t) { throw new Error("All required keys (" + L(e).join(", ") + ") were not specified. Specified keys were: " + L(t).join(", ") + ".") }, unsuppMessage: function (e) { throw new Error("Unsupported keys for object: " + L(e).join(", ")) }, validateStrArr: function (t, e) { if (!g.isArray(e)) throw new Error("The " + t + " fields must be an array. Was: " + e + "."); E.each(e, function (e) { if (!g.isString(e)) throw new Error("The value " + e + " in the " + t + " fields was not a string.") }) }, invalidTypeMessage: function (e, t) { throw new Error("All values need to be of type: " + t + ". Keys (" + L(e).join(", ") + ") were not.") }, checkDupes: function (e) { var n = L(e); E.find(n, function (e, t) { return t < n.length - 1 && e === n[t + 1] }).each(function (e) { throw new Error("The field: " + e + " occurs more than once in the combined fields: [" + n.join(", ") + "].") }) } }, F = { immutable: function () { for (var t = [], e = 0; e < arguments.length; e++)t[e] = arguments[e]; return function () { for (var n = [], e = 0; e < arguments.length; e++)n[e] = arguments[e]; if (t.length !== n.length) throw new Error('Wrong number of arguments to struct. Expected "[' + t.length + ']", got ' + n.length + " arguments"); var r = {}; return E.each(t, function (e, t) { r[e] = y.constant(n[t]) }), r } }, immutableBag: function (o, i) { var u = o.concat(i); if (0 === u.length) throw new Error("You must specify at least one required or optional field."); return q.validateStrArr("required", o), q.validateStrArr("optional", i), q.checkDupes(u), function (t) { var n = M.keys(t); E.forall(o, function (e) { return E.contains(n, e) }) || q.reqMessage(o, n); var e = E.filter(n, function (e) { return !E.contains(u, e) }); 0 < e.length && q.unsuppMessage(e); var r = {}; return E.each(o, function (e) { r[e] = y.constant(t[e]) }), E.each(i, function (e) { r[e] = y.constant(Object.prototype.hasOwnProperty.call(t, e) ? x.some(t[e]) : x.none()) }), r } } }, j = F.immutable("width", "height"), z = F.immutable("rows", "columns"), _ = F.immutable("row", "column"), H = F.immutable("x", "y"), V = F.immutable("element", "rowspan", "colspan"), U = F.immutable("element", "rowspan", "colspan", "isNew"), G = { dimensions: j, grid: z, address: _, coords: H, extended: F.immutable("element", "rowspan", "colspan", "row", "column"), detail: V, detailnew: U, rowdata: F.immutable("element", "cells", "section"), elementnew: F.immutable("element", "isNew"), rowdatanew: F.immutable("element", "cells", "section", "isNew"), rowcells: F.immutable("cells", "section"), rowdetails: F.immutable("details", "section"), bounds: F.immutable("startRow", "startCol", "finishRow", "finishCol") }, X = function (e) { if (null === e || e === undefined) throw new Error("Node cannot be null or undefined"); return { dom: y.constant(e) } }, Y = { fromHtml: function (e, t) { var n = (t || document).createElement("div"); if (n.innerHTML = e, !n.hasChildNodes() || 1 < n.childNodes.length) throw console.error("HTML does not have a single root node", e), "HTML must have a single root node"; return X(n.childNodes[0]) }, fromTag: function (e, t) { var n = (t || document).createElement(e); return X(n) }, fromText: function (e, t) { var n = (t || document).createTextNode(e); return X(n) }, fromDom: X, fromPoint: function (e, t, n) { return x.from(e.dom().elementFromPoint(t, n)).map(X) } }, K = 8, $ = 9, J = 1, Q = 3, Z = J, ee = $, te = function (e) { return e.nodeType !== Z && e.nodeType !== ee || 0 === e.childElementCount }, ne = { all: function (e, t) { var n = t === undefined ? document : t.dom(); return te(n) ? [] : E.map(n.querySelectorAll(e), Y.fromDom) }, is: function (e, t) { var n = e.dom(); if (n.nodeType !== Z) return !1; if (n.matches !== undefined) return n.matches(t); if (n.msMatchesSelector !== undefined) return n.msMatchesSelector(t); if (n.webkitMatchesSelector !== undefined) return n.webkitMatchesSelector(t); if (n.mozMatchesSelector !== undefined) return n.mozMatchesSelector(t); throw new Error("Browser lacks native selectors") }, one: function (e, t) { var n = t === undefined ? document : t.dom(); return te(n) ? x.none() : x.from(n.querySelector(e)).map(Y.fromDom) } }, re = function (e, t) { for (var n = [], r = function (e) { return n.push(e), t(e) }, o = t(e); (o = o.bind(r)).isSome();); return n }, oe = "undefined" != typeof window ? window : Function("return this;")(), ie = function (e, t) { for (var n = t !== undefined && null !== t ? t : oe, r = 0; r < e.length && n !== undefined && null !== n; ++r)n = n[e[r]]; return n }, ue = function (e, t) { var n = e.split("."); return ie(n, t) }, ae = function (e, t) { var n = ue(e, t); if (n === undefined || null === n) throw e + " not available on this browser"; return n }, ce = function () { return ae("Node") }, le = function (e, t, n) { return 0 != (e.compareDocumentPosition(t) & n) }, se = function (e, t) { return le(e, t, ce().DOCUMENT_POSITION_CONTAINED_BY) }, fe = function (e) { var t, n = !1; return function () { return n || (n = !0, t = e.apply(null, arguments)), t } }, de = function (e, t) { var n = function (e, t) { for (var n = 0; n < e.length; n++) { var r = e[n]; if (r.test(t)) return r } return undefined }(e, t); if (!n) return { major: 0, minor: 0 }; var r = function (e) { return Number(t.replace(n, "$" + e)) }; return ge(r(1), r(2)) }, me = function () { return ge(0, 0) }, ge = function (e, t) { return { major: e, minor: t } }, pe = { nu: ge, detect: function (e, t) { var n = String(t).toLowerCase(); return 0 === e.length ? me() : de(e, n) }, unknown: me }, he = "Firefox", ve = function (e, t) { return function () { return t === e } }, be = function (e) { var t = e.current; return { current: t, version: e.version, isEdge: ve("Edge", t), isChrome: ve("Chrome", t), isIE: ve("IE", t), isOpera: ve("Opera", t), isFirefox: ve(he, t), isSafari: ve("Safari", t) } }, we = { unknown: function () { return be({ current: undefined, version: pe.unknown() }) }, nu: be, edge: y.constant("Edge"), chrome: y.constant("Chrome"), ie: y.constant("IE"), opera: y.constant("Opera"), firefox: y.constant(he), safari: y.constant("Safari") }, ye = "Windows", xe = "Android", Se = "Solaris", Ce = "FreeBSD", Re = function (e, t) { return function () { return t === e } }, Te = function (e) { var t = e.current; return { current: t, version: e.version, isWindows: Re(ye, t), isiOS: Re("iOS", t), isAndroid: Re(xe, t), isOSX: Re("OSX", t), isLinux: Re("Linux", t), isSolaris: Re(Se, t), isFreeBSD: Re(Ce, t) } }, Ae = { unknown: function () { return Te({ current: undefined, version: pe.unknown() }) }, nu: Te, windows: y.constant(ye), ios: y.constant("iOS"), android: y.constant(xe), linux: y.constant("Linux"), osx: y.constant("OSX"), solaris: y.constant(Se), freebsd: y.constant(Ce) }, De = function (e, t) { var n = String(t).toLowerCase(); return E.find(e, function (e) { return e.search(n) }) }, ke = function (e, n) { return De(e, n).map(function (e) { var t = pe.detect(e.versionRegexes, n); return { current: e.name, version: t } }) }, Ne = function (e, n) { return De(e, n).map(function (e) { var t = pe.detect(e.versionRegexes, n); return { current: e.name, version: t } }) }, Ee = function (e, t) { return t + e }, Oe = function (e, t) { return e + t }, Be = function (e, t) { return e.substring(t) }, Pe = function (e, t) { return e.substring(0, e.length - t) }, Ie = function (e) { return "" === e ? x.none() : x.some(e.substr(0, 1)) }, We = function (e) { return "" === e ? x.none() : x.some(e.substring(1)) }, Me = function (e, t, n) { return "" === t || !(e.length < t.length) && e.substr(n, n + t.length) === t }, Le = function (e, t) { return Me(e, t, 0) }, qe = function (e, t) { return Me(e, t, e.length - t.length) }, Fe = { supplant: function (e, o) { return e.replace(/\${([^{}]*)}/g, function (e, t) { var n, r = o[t]; return "string" == (n = typeof r) || "number" === n ? r : e }) }, startsWith: Le, removeLeading: function (e, t) { return Le(e, t) ? Be(e, t.length) : e }, removeTrailing: function (e, t) { return qe(e, t) ? Pe(e, t.length) : e }, ensureLeading: function (e, t) { return Le(e, t) ? e : Ee(e, t) }, ensureTrailing: function (e, t) { return qe(e, t) ? e : Oe(e, t) }, endsWith: qe, contains: function (e, t) { return -1 !== e.indexOf(t) }, trim: function (e) { return e.replace(/^\s+|\s+$/g, "") }, lTrim: function (e) { return e.replace(/^\s+/g, "") }, rTrim: function (e) { return e.replace(/\s+$/g, "") }, capitalize: function (e) { return Ie(e).bind(function (t) { return We(e).map(function (e) { return t.toUpperCase() + e }) }).getOr(e) } }, je = /.*?version\/\ ?([0-9]+)\.([0-9]+).*/, ze = function (t) { return function (e) { return Fe.contains(e, t) } }, _e = [{ name: "Edge", versionRegexes: [/.*?edge\/ ?([0-9]+)\.([0-9]+)$/], search: function (e) { return Fe.contains(e, "edge/") && Fe.contains(e, "chrome") && Fe.contains(e, "safari") && Fe.contains(e, "applewebkit") } }, { name: "Chrome", versionRegexes: [/.*?chrome\/([0-9]+)\.([0-9]+).*/, je], search: function (e) { return Fe.contains(e, "chrome") && !Fe.contains(e, "chromeframe") } }, { name: "IE", versionRegexes: [/.*?msie\ ?([0-9]+)\.([0-9]+).*/, /.*?rv:([0-9]+)\.([0-9]+).*/], search: function (e) { return Fe.contains(e, "msie") || Fe.contains(e, "trident") } }, { name: "Opera", versionRegexes: [je, /.*?opera\/([0-9]+)\.([0-9]+).*/], search: ze("opera") }, { name: "Firefox", versionRegexes: [/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/], search: ze("firefox") }, { name: "Safari", versionRegexes: [je, /.*?cpu os ([0-9]+)_([0-9]+).*/], search: function (e) { return (Fe.contains(e, "safari") || Fe.contains(e, "mobile/")) && Fe.contains(e, "applewebkit") } }], He = [{ name: "Windows", search: ze("win"), versionRegexes: [/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/] }, { name: "iOS", search: function (e) { return Fe.contains(e, "iphone") || Fe.contains(e, "ipad") }, versionRegexes: [/.*?version\/\ ?([0-9]+)\.([0-9]+).*/, /.*cpu os ([0-9]+)_([0-9]+).*/, /.*cpu iphone os ([0-9]+)_([0-9]+).*/] }, { name: "Android", search: ze("android"), versionRegexes: [/.*?android\ ?([0-9]+)\.([0-9]+).*/] }, { name: "OSX", search: ze("os x"), versionRegexes: [/.*?os\ x\ ?([0-9]+)_([0-9]+).*/] }, { name: "Linux", search: ze("linux"), versionRegexes: [] }, { name: "Solaris", search: ze("sunos"), versionRegexes: [] }, { name: "FreeBSD", search: ze("freebsd"), versionRegexes: [] }], Ve = { browsers: y.constant(_e), oses: y.constant(He) }, Ue = function (e) { var t, n, r, o, i, u, a, c, l, s, f, d = Ve.browsers(), m = Ve.oses(), g = ke(d, e).fold(we.unknown, we.nu), p = Ne(m, e).fold(Ae.unknown, Ae.nu); return { browser: g, os: p, deviceType: (n = g, r = e, o = (t = p).isiOS() && !0 === /ipad/i.test(r), i = t.isiOS() && !o, u = t.isAndroid() && 3 === t.version.major, a = t.isAndroid() && 4 === t.version.major, c = o || u || a && !0 === /mobile/i.test(r), l = t.isiOS() || t.isAndroid(), s = l && !c, f = n.isSafari() && t.isiOS() && !1 === /safari/i.test(r), { isiPad: y.constant(o), isiPhone: y.constant(i), isTablet: y.constant(c), isPhone: y.constant(s), isTouch: y.constant(l), isAndroid: t.isAndroid, isiOS: t.isiOS, isWebView: y.constant(f) }) } }, Ge = { detect: fe(function () { var e = navigator.userAgent; return Ue(e) }) }, Xe = function (e, t) { return e.dom() === t.dom() }, Ye = Ge.detect().browser.isIE() ? function (e, t) { return se(e.dom(), t.dom()) } : function (e, t) { var n = e.dom(), r = t.dom(); return n !== r && n.contains(r) }, Ke = { eq: Xe, isEqualNode: function (e, t) { return e.dom().isEqualNode(t.dom()) }, member: function (e, t) { return E.exists(t, y.curry(Xe, e)) }, contains: Ye, is: ne.is }, $e = function (e) { return Y.fromDom(e.dom().ownerDocument) }, Je = function (e) { var t = e.dom(); return x.from(t.parentNode).map(Y.fromDom) }, Qe = function (e) { var t = e.dom(); return x.from(t.previousSibling).map(Y.fromDom) }, Ze = function (e) { var t = e.dom(); return x.from(t.nextSibling).map(Y.fromDom) }, et = function (e) { var t = e.dom(); return E.map(t.childNodes, Y.fromDom) }, tt = function (e, t) { var n = e.dom().childNodes; return x.from(n[t]).map(Y.fromDom) }, nt = F.immutable("element", "offset"), rt = { owner: $e, defaultView: function (e) { var t = e.dom().ownerDocument.defaultView; return Y.fromDom(t) }, documentElement: function (e) { var t = $e(e); return Y.fromDom(t.dom().documentElement) }, parent: Je, findIndex: function (n) { return Je(n).bind(function (e) { var t = et(e); return E.findIndex(t, function (e) { return Ke.eq(n, e) }) }) }, parents: function (e, t) { for (var n = g.isFunction(t) ? t : y.constant(!1), r = e.dom(), o = []; null !== r.parentNode && r.parentNode !== undefined;) { var i = r.parentNode, u = Y.fromDom(i); if (o.push(u), !0 === n(u)) break; r = i } return o }, siblings: function (t) { return Je(t).map(et).map(function (e) { return E.filter(e, function (e) { return !Ke.eq(t, e) }) }).getOr([]) }, prevSibling: Qe, offsetParent: function (e) { var t = e.dom(); return x.from(t.offsetParent).map(Y.fromDom) }, prevSiblings: function (e) { return E.reverse(re(e, Qe)) }, nextSibling: Ze, nextSiblings: function (e) { return re(e, Ze) }, children: et, child: tt, firstChild: function (e) { return tt(e, 0) }, lastChild: function (e) { return tt(e, e.dom().childNodes.length - 1) }, childNodesCount: function (e) { return e.dom().childNodes.length }, hasChildNodes: function (e) { return e.dom().hasChildNodes() }, leaf: function (e, t) { var n = et(e); return 0 < n.length && t < n.length ? nt(n[t], 0) : nt(e, t) } }, ot = function (e, t, n) { return E.bind(rt.children(e), function (e) { return ne.is(e, t) ? n(e) ? [e] : [] : ot(e, t, n) }) }, it = { firstLayer: function (e, t) { return ot(e, t, y.constant(!0)) }, filterFirstLayer: ot }, ut = function (e) { return e.dom().nodeName.toLowerCase() }, at = function (e) { return e.dom().nodeType }, ct = function (t) { return function (e) { return at(e) === t } }, lt = ct(J), st = ct(Q), ft = ct($), dt = { name: ut, type: at, value: function (e) { return e.dom().nodeValue }, isElement: lt, isText: st, isDocument: ft, isComment: function (e) { return at(e) === K || "#comment" === ut(e) } }, mt = function (e, t, n) { if (!(g.isString(n) || g.isBoolean(n) || g.isNumber(n))) throw console.error("Invalid call to Attr.set. Key ", t, ":: Value ", n, ":: Element ", e), new Error("Attribute value was not simple"); e.setAttribute(t, n + "") }, gt = function (e, t, n) { mt(e.dom(), t, n) }, pt = function (e, t) { var n = e.dom().getAttribute(t); return null === n ? undefined : n }, ht = function (e, t) { var n = e.dom(); return !(!n || !n.hasAttribute) && n.hasAttribute(t) }, vt = { clone: function (e) { return E.foldl(e.dom().attributes, function (e, t) { return e[t.name] = t.value, e }, {}) }, set: gt, setAll: function (e, t) { var n = e.dom(); M.each(t, function (e, t) { mt(n, t, e) }) }, get: pt, has: ht, remove: function (e, t) { e.dom().removeAttribute(t) }, hasNone: function (e) { var t = e.dom().attributes; return t === undefined || null === t || 0 === t.length }, transfer: function (o, i, e) { dt.isElement(o) && dt.isElement(i) && E.each(e, function (e) { var t, n, r; n = i, ht(t = o, r = e) && !ht(n, r) && gt(n, r, pt(t, r)) }) } }, bt = fe(function () { return wt(Y.fromDom(document)) }), wt = function (e) { var t = e.dom().body; if (null === t || t === undefined) throw "Body is not available yet"; return Y.fromDom(t) }, yt = { body: bt, getBody: wt, inBody: function (e) { var t = dt.isText(e) ? e.dom().parentNode : e.dom(); return t !== undefined && null !== t && t.ownerDocument.body.contains(t) } }, xt = function (e, t) { var n = []; return E.each(rt.children(e), function (e) { t(e) && (n = n.concat([e])), n = n.concat(xt(e, t)) }), n }, St = { all: function (e) { return xt(yt.body(), e) }, ancestors: function (e, t, n) { return E.filter(rt.parents(e, n), t) }, siblings: function (e, t) { return E.filter(rt.siblings(e), t) }, children: function (e, t) { return E.filter(rt.children(e), t) }, descendants: xt }, Ct = { all: function (e) { return ne.all(e) }, ancestors: function (e, t, n) { return St.ancestors(e, function (e) { return ne.is(e, t) }, n) }, siblings: function (e, t) { return St.siblings(e, function (e) { return ne.is(e, t) }) }, children: function (e, t) { return St.children(e, function (e) { return ne.is(e, t) }) }, descendants: function (e, t) { return ne.all(t, e) } }; function Rt(e, t, n, r, o) { return e(n, r) ? x.some(n) : g.isFunction(o) && o(n) ? x.none() : t(n, r, o) } var Tt, At, Dt, kt, Nt, Et = function (e, t, n) { for (var r = e.dom(), o = g.isFunction(n) ? n : y.constant(!1); r.parentNode;) { r = r.parentNode; var i = Y.fromDom(r); if (t(i)) return x.some(i); if (o(i)) break } return x.none() }, Ot = function (e, t) { return E.find(e.dom().childNodes, y.compose(t, Y.fromDom)).map(Y.fromDom) }, Bt = function (e, r) { var o = function (e) { for (var t = 0; t < e.childNodes.length; t++) { if (r(Y.fromDom(e.childNodes[t]))) return x.some(Y.fromDom(e.childNodes[t])); var n = o(e.childNodes[t]); if (n.isSome()) return n } return x.none() }; return o(e.dom()) }, Pt = { first: function (e) { return Bt(yt.body(), e) }, ancestor: Et, closest: function (e, t, n) { return Rt(function (e) { return t(e) }, Et, e, t, n) }, sibling: function (t, n) { var e = t.dom(); return e.parentNode ? Ot(Y.fromDom(e.parentNode), function (e) { return !Ke.eq(t, e) && n(e) }) : x.none() }, child: Ot, descendant: Bt }, It = function (e, t, n) { return Pt.ancestor(e, function (e) { return ne.is(e, t) }, n) }, Wt = { first: function (e) { return ne.one(e) }, ancestor: It, sibling: function (e, t) { return Pt.sibling(e, function (e) { return ne.is(e, t) }) }, child: function (e, t) { return Pt.child(e, function (e) { return ne.is(e, t) }) }, descendant: function (e, t) { return ne.one(t, e) }, closest: function (e, t, n) { return Rt(ne.is, It, e, t, n) } }, Mt = function (e, t, n) { var r = n !== undefined ? n : y.constant(!1); return r(t) ? x.none() : E.contains(e, dt.name(t)) ? x.some(t) : Wt.ancestor(t, e.join(","), function (e) { return ne.is(e, "table") || r(e) }) }, Lt = function (t, e) { return rt.parent(e).map(function (e) { return Ct.children(e, t) }) }, qt = y.curry(Lt, "th,td"), Ft = y.curry(Lt, "tr"), jt = function (e, t) { return parseInt(vt.get(e, t), 10) }, zt = { cell: function (e, t) { return Mt(["td", "th"], e, t) }, firstCell: function (e) { return Wt.descendant(e, "th,td") }, cells: function (e) { return it.firstLayer(e, "th,td") }, neighbourCells: qt, table: function (e, t) { return Wt.closest(e, "table", t) }, row: function (e, t) { return Mt(["tr"], e, t) }, rows: function (e) { return it.firstLayer(e, "tr") }, notCell: function (e, t) { return Mt(["caption", "tr", "tbody", "tfoot", "thead"], e, t) }, neighbourRows: Ft, attr: jt, grid: function (e, t, n) { var r = jt(e, t), o = jt(e, n); return G.grid(r, o) } }, _t = function (e) { var t = zt.rows(e); return E.map(t, function (e) { var t = e, n = rt.parent(t).bind(function (e) { var t = dt.name(e); return "tfoot" === t || "thead" === t || "tbody" === t ? t : "tbody" }), r = E.map(zt.cells(e), function (e) { var t = vt.has(e, "rowspan") ? parseInt(vt.get(e, "rowspan"), 10) : 1, n = vt.has(e, "colspan") ? parseInt(vt.get(e, "colspan"), 10) : 1; return G.detail(e, t, n) }); return G.rowdata(t, r, n) }) }, Ht = function (e, n) { return E.map(e, function (e) { var t = E.map(zt.cells(e), function (e) { var t = vt.has(e, "rowspan") ? parseInt(vt.get(e, "rowspan"), 10) : 1, n = vt.has(e, "colspan") ? parseInt(vt.get(e, "colspan"), 10) : 1; return G.detail(e, t, n) }); return G.rowdata(e, t, n.section()) }) }, Vt = function (e, t) { return e + "," + t }, Ut = function (e, t) { var n = E.bind(e.all(), function (e) { return e.cells() }); return E.filter(n, t) }, Gt = { generate: function (e) { var s = {}, t = [], n = e.length, f = 0; E.each(e, function (e, c) { var l = []; E.each(e.cells(), function (e, t) { for (var n = 0; s[Vt(c, n)] !== undefined;)n++; for (var r = G.extended(e.element(), e.rowspan(), e.colspan(), c, n), o = 0; o < e.colspan(); o++)for (var i = 0; i < e.rowspan(); i++) { var u = n + o, a = Vt(c + i, u); s[a] = r, f = Math.max(f, u + 1) } l.push(r) }), t.push(G.rowdata(e.element(), l, e.section())) }); var r = G.grid(n, f); return { grid: y.constant(r), access: y.constant(s), all: y.constant(t) } }, getAt: function (e, t, n) { var r = e.access()[Vt(t, n)]; return r !== undefined ? x.some(r) : x.none() }, findItem: function (e, t, n) { var r = Ut(e, function (e) { return n(t, e.element()) }); return 0 < r.length ? x.some(r[0]) : x.none() }, filterItems: Ut, justCells: function (e) { var t = E.map(e.all(), function (e) { return e.cells() }); return E.flatten(t) } }, Xt = { isSupported: function (e) { return e.style !== undefined } }, Yt = function (e, t, n) { if (!g.isString(n)) throw console.error("Invalid call to CSS.set. Property ", t, ":: Value ", n, ":: Element ", e), new Error("CSS value must be a string: " + n); Xt.isSupported(e) && e.style.setProperty(t, n) }, Kt = function (e, t) { Xt.isSupported(e) && e.style.removeProperty(t) }, $t = function (e, t, n) { var r = e.dom(); Yt(r, t, n) }, Jt = function (e, t) { return Xt.isSupported(e) ? e.style.getPropertyValue(t) : "" }, Qt = function (e, t) { var n = e.dom(), r = Jt(n, t); return x.from(r).filter(function (e) { return 0 < e.length }) }, Zt = { copy: function (e, t) { var n = e.dom(), r = t.dom(); Xt.isSupported(n) && Xt.isSupported(r) && (r.style.cssText = n.style.cssText) }, set: $t, preserve: function (e, t) { var n = vt.get(e, "style"), r = t(e); return (n === undefined ? vt.remove : vt.set)(e, "style", n), r }, setAll: function (e, t) { var n = e.dom(); M.each(t, function (e, t) { Yt(n, t, e) }) }, setOptions: function (e, t) { var n = e.dom(); M.each(t, function (e, t) { e.fold(function () { Kt(n, t) }, function (e) { Yt(n, t, e) }) }) }, remove: function (e, t) { var n = e.dom(); Kt(n, t), vt.has(e, "style") && "" === Fe.trim(vt.get(e, "style")) && vt.remove(e, "style") }, get: function (e, t) { var n = e.dom(), r = window.getComputedStyle(n).getPropertyValue(t), o = "" !== r || yt.inBody(e) ? r : Jt(n, t); return null === o ? undefined : o }, getRaw: Qt, getAllRaw: function (e) { var t = {}, n = e.dom(); if (Xt.isSupported(n)) for (var r = 0; r < n.style.length; r++) { var o = n.style.item(r); t[o] = n.style[o] } return t }, isValidValue: function (e, t, n) { var r = Y.fromTag(e); return $t(r, t, n), Qt(r, t).isSome() }, reflow: function (e) { return e.dom().offsetWidth }, transfer: function (r, o, e) { dt.isElement(r) && dt.isElement(o) && E.each(e, function (e) { var t, n; t = o, Qt(r, n = e).each(function (e) { Qt(t, n).isNone() && $t(t, n, e) }) }) } }, en = function (t, n) { rt.parent(t).each(function (e) { e.dom().insertBefore(n.dom(), t.dom()) }) }, tn = function (e, t) { e.dom().appendChild(t.dom()) }, nn = { before: en, after: function (e, t) { rt.nextSibling(e).fold(function () { rt.parent(e).each(function (e) { tn(e, t) }) }, function (e) { en(e, t) }) }, prepend: function (t, n) { rt.firstChild(t).fold(function () { tn(t, n) }, function (e) { t.dom().insertBefore(n.dom(), e.dom()) }) }, append: tn, appendAt: function (e, t, n) { rt.child(e, n).fold(function () { tn(e, t) }, function (e) { en(e, t) }) }, wrap: function (e, t) { en(e, t), tn(t, e) } }, rn = { before: function (t, e) { E.each(e, function (e) { nn.before(t, e) }) }, after: function (r, o) { E.each(o, function (e, t) { var n = 0 === t ? r : o[t - 1]; nn.after(n, e) }) }, prepend: function (t, e) { E.each(e.slice().reverse(), function (e) { nn.prepend(t, e) }) }, append: function (t, e) { E.each(e, function (e) { nn.append(t, e) }) } }, on = function (e) { var t = e.dom(); null !== t.parentNode && t.parentNode.removeChild(t) }, un = { empty: function (e) { e.dom().textContent = "", E.each(rt.children(e), function (e) { on(e) }) }, remove: on, unwrap: function (e) { var t = rt.children(e); 0 < t.length && rn.before(e, t), on(e) } }, an = F.immutable("minRow", "minCol", "maxRow", "maxCol"), cn = function (e, t) { var n, i, r, u, a, c, l, o, s, f, d = function (e) { return ne.is(e.element(), t) }, m = _t(e), g = Gt.generate(m), p = (i = d, r = (n = g).grid().columns(), u = n.grid().rows(), a = r, l = c = 0, M.each(n.access(), function (e) { if (i(e)) { var t = e.row(), n = t + e.rowspan() - 1, r = e.column(), o = r + e.colspan() - 1; t < u ? u = t : c < n && (c = n), r < a ? a = r : l < o && (l = o) } }), an(u, a, c, l)), h = "th:not(" + t + "),td:not(" + t + ")", v = it.filterFirstLayer(e, "th,td", function (e) { return ne.is(e, h) }); return E.each(v, un.remove), function (e, t, n, r) { for (var o, i, u, a = t.grid().columns(), c = t.grid().rows(), l = 0; l < c; l++)for (var s = !1, f = 0; f < a; f++)l < n.minRow() || l > n.maxRow() || f < n.minCol() || f > n.maxCol() || (Gt.getAt(t, l, f).filter(r).isNone() ? (o = s, i = e[l].element(), u = Y.fromTag("td"), nn.append(u, Y.fromTag("br")), (o ? nn.append : nn.prepend)(i, u)) : s = !0) }(m, g, p, d), o = e, s = p, f = E.filter(it.firstLayer(o, "tr"), function (e) { return 0 === e.dom().childElementCount }), E.each(f, un.remove), s.minCol() !== s.maxCol() && s.minRow() !== s.maxRow() || E.each(it.firstLayer(o, "th,td"), function (e) { vt.remove(e, "rowspan"), vt.remove(e, "colspan") }), vt.remove(o, "width"), vt.remove(o, "height"), Zt.remove(o, "width"), Zt.remove(o, "height"), e }, ln = function (e, t) { return Y.fromDom(e.dom().cloneNode(t)) }, sn = function (e) { return ln(e, !0) }, fn = function (e, t) { var n = Y.fromTag(t), r = vt.clone(e); return vt.setAll(n, r), n }, dn = function (e) { return ln(e, !1) }, mn = sn, gn = function (e, t) { var n = fn(e, t), r = rt.children(sn(e)); return rn.append(n, r), n }, pn = (Tt = dt.isText, At = "text", Dt = function (e) { return Tt(e) ? x.from(e.dom().nodeValue) : x.none() }, kt = Ge.detect().browser, { get: function (e) { if (!Tt(e)) throw new Error("Can only get " + At + " value of a " + At + " node"); return Nt(e).getOr("") }, getOption: Nt = kt.isIE() && 10 === kt.version.major ? function (e) { try { return Dt(e) } catch (t) { return x.none() } } : Dt, set: function (e, t) { if (!Tt(e)) throw new Error("Can only set raw " + At + " value of a " + At + " node"); e.dom().nodeValue = t } }), hn = { get: function (e) { return pn.get(e) }, getOption: function (e) { return pn.getOption(e) }, set: function (e, t) { pn.set(e, t) } }, vn = function (e) { return "img" === dt.name(e) ? 1 : hn.getOption(e).fold(function () { return rt.children(e).length }, function (e) { return e.length }) }, bn = ["img", "br"], wn = vn, yn = function (e) { var t; return t = e, hn.getOption(t).filter(function (e) { return 0 !== e.trim().length || -1 < e.indexOf("\xa0") }).isSome() || E.contains(bn, dt.name(e)) }, xn = function (e, i) { var u = function (e) { for (var t = rt.children(e), n = t.length - 1; 0 <= n; n--) { var r = t[n]; if (i(r)) return x.some(r); var o = u(r); if (o.isSome()) return o } return x.none() }; return u(e) }, Sn = { first: function (e) { return Pt.descendant(e, yn) }, last: function (e) { return xn(e, yn) } }, Cn = function () { var e = Y.fromTag("td"); return nn.append(e, Y.fromTag("br")), e }, Rn = function (e, t, n) { var r = gn(e, t); return M.each(n, function (e, t) { null === e ? vt.remove(r, t) : vt.set(r, t, e) }), r }, Tn = function (e) { return e }, An = function (e) { return function () { return Y.fromTag("tr", e.dom()) } }, Dn = function (c, e, l) { return { row: An(e), cell: function (e) { var r, o, i, t = rt.owner(e.element()), n = Y.fromTag(dt.name(e.element()), t.dom()), u = l.getOr(["strong", "em", "b", "i", "span", "font", "h1", "h2", "h3", "h4", "h5", "h6", "p", "div"]), a = 0 < u.length ? (r = e.element(), o = n, i = u, Sn.first(r).map(function (e) { var t = i.join(","), n = Ct.ancestors(e, t, function (e) { return Ke.eq(e, r) }); return E.foldr(n, function (e, t) { var n = dn(t); return nn.append(e, n), n }, o) }).getOr(o)) : n; return nn.append(a, Y.fromTag("br")), Zt.copy(e.element(), n), Zt.remove(n, "height"), 1 !== e.colspan() && Zt.remove(e.element(), "width"), c(e.element(), n), n }, replace: Rn, gap: Cn } }, kn = function (e) { return { row: An(e), cell: Cn, replace: Tn, gap: Cn } }, Nn = function (e, t) { var n = (t || document).createElement("div"); return n.innerHTML = e, rt.children(Y.fromDom(n)) }, En = ["body", "p", "div", "article", "aside", "figcaption", "figure", "footer", "header", "nav", "section", "ol", "ul", "li", "table", "thead", "tbody", "tfoot", "caption", "tr", "td", "th", "h1", "h2", "h3", "h4", "h5", "h6", "blockquote", "pre", "address"]; function On() { return { up: y.constant({ selector: Wt.ancestor, closest: Wt.closest, predicate: Pt.ancestor, all: rt.parents }), down: y.constant({ selector: Ct.descendants, predicate: St.descendants }), styles: y.constant({ get: Zt.get, getRaw: Zt.getRaw, set: Zt.set, remove: Zt.remove }), attrs: y.constant({ get: vt.get, set: vt.set, remove: vt.remove, copyTo: function (e, t) { var n = vt.clone(e); vt.setAll(t, n) } }), insert: y.constant({ before: nn.before, after: nn.after, afterAll: rn.after, append: nn.append, appendAll: rn.append, prepend: nn.prepend, wrap: nn.wrap }), remove: y.constant({ unwrap: un.unwrap, remove: un.remove }), create: y.constant({ nu: Y.fromTag, clone: function (e) { return Y.fromDom(e.dom().cloneNode(!1)) }, text: Y.fromText }), query: y.constant({ comparePosition: function (e, t) { return e.dom().compareDocumentPosition(t.dom()) }, prevSibling: rt.prevSibling, nextSibling: rt.nextSibling }), property: y.constant({ children: rt.children, name: dt.name, parent: rt.parent, isText: dt.isText, isComment: dt.isComment, isElement: dt.isElement, getText: hn.get, setText: hn.set, isBoundary: function (e) { return !!dt.isElement(e) && ("body" === dt.name(e) || E.contains(En, dt.name(e))) }, isEmptyTag: function (e) { return !!dt.isElement(e) && E.contains(["br", "img", "hr", "input"], dt.name(e)) } }), eq: Ke.eq, is: Ke.is } } F.immutable("left", "right"); var Bn = function (r, o, e, t) { var n = o(r, e); return E.foldr(t, function (e, t) { var n = o(r, t); return Pn(r, e, n) }, n) }, Pn = function (t, e, n) { return e.bind(function (e) { return n.filter(y.curry(t.eq, e)) }) }, In = function (e, t, n) { return 0 < n.length ? Bn(e, t, (r = n)[0], r.slice(1)) : x.none(); var r }, Wn = function (e, t) { return y.curry(e.eq, t) }, Mn = function (t, e, n, r) { var o = r !== undefined ? r : y.constant(!1), i = [e].concat(t.up().all(e)), u = [n].concat(t.up().all(n)), a = function (t) { return E.findIndex(t, o).fold(function () { return t }, function (e) { return t.slice(0, e + 1) }) }, c = a(i), l = a(u), s = E.find(c, function (e) { return E.exists(l, Wn(t, e)) }); return { firstpath: y.constant(c), secondpath: y.constant(l), shared: y.constant(s) } }, Ln = Mn, qn = function (e, t, n) { return In(e, t, n) }, Fn = function (e, t, n, r) { return Ln(e, t, n, r) }, jn = On(), zn = function (n, e) { return qn(jn, function (e, t) { return n(t) }, e) }, _n = function (e, t, n) { return Fn(jn, e, t, n) }, Hn = function (e, t) { return t.column() >= e.startCol() && t.column() + t.colspan() - 1 <= e.finishCol() && t.row() >= e.startRow() && t.row() + t.rowspan() - 1 <= e.finishRow() }, Vn = function (e, t) { var n = t.column(), r = t.column() + t.colspan() - 1, o = t.row(), i = t.row() + t.rowspan() - 1; return n <= e.finishCol() && r >= e.startCol() && o <= e.finishRow() && i >= e.startRow() }, Un = function (e, t) { for (var n = !0, r = y.curry(Hn, t), o = t.startRow(); o <= t.finishRow(); o++)for (var i = t.startCol(); i <= t.finishCol(); i++)n = n && Gt.getAt(e, o, i).exists(r); return n ? x.some(t) : x.none() }, Gn = function (e, t, n) { var r = Gt.findItem(e, t, Ke.eq), o = Gt.findItem(e, n, Ke.eq); return r.bind(function (r) { return o.map(function (e) { return t = r, n = e, G.bounds(Math.min(t.row(), n.row()), Math.min(t.column(), n.column()), Math.max(t.row() + t.rowspan() - 1, n.row() + n.rowspan() - 1), Math.max(t.column() + t.colspan() - 1, n.column() + n.colspan() - 1)); var t, n }) }) }, Xn = Gn, Yn = function (t, e, n) { return Gn(t, e, n).bind(function (e) { return Un(t, e) }) }, Kn = function (r, e, o, i) { return Gt.findItem(r, e, Ke.eq).bind(function (e) { var t = 0 < o ? e.row() + e.rowspan() - 1 : e.row(), n = 0 < i ? e.column() + e.colspan() - 1 : e.column(); return Gt.getAt(r, t + o, n + i).map(function (e) { return e.element() }) }) }, $n = function (n, e, t) { return Xn(n, e, t).map(function (e) { var t = Gt.filterItems(n, y.curry(Vn, e)); return E.map(t, function (e) { return e.element() }) }) }, Jn = function (e, t) { return Gt.findItem(e, t, function (e, t) { return Ke.contains(t, e) }).bind(function (e) { return e.element() }) }, Qn = function (e) { var t = _t(e); return Gt.generate(t) }, Zn = function (n, r, o) { return zt.table(n).bind(function (e) { var t = Qn(e); return Kn(t, n, r, o) }) }, er = function (e, t, n) { var r = Qn(e); return $n(r, t, n) }, tr = function (e, t, n, r, o) { var i = Qn(e), u = Ke.eq(e, n) ? t : Jn(i, t), a = Ke.eq(e, o) ? r : Jn(i, r); return $n(i, u, a) }, nr = function (e, t, n) { var r = Qn(e); return Yn(r, t, n) }, rr = function (e, t) { return Wt.ancestor(e, "table") }, or = F.immutableBag(["boxes", "start", "finish"], []), ir = function (a, c, r) { var l = function (t) { return function (e) { return r(e) || Ke.eq(e, t) } }; return Ke.eq(a, c) ? x.some(or({ boxes: x.some([a]), start: a, finish: c })) : rr(a).bind(function (u) { return rr(c).bind(function (i) { if (Ke.eq(u, i)) return x.some(or({ boxes: er(u, a, c), start: a, finish: c })); if (Ke.contains(u, i)) { var e = 0 < (t = Ct.ancestors(c, "td,th", l(u))).length ? t[t.length - 1] : c; return x.some(or({ boxes: tr(u, a, u, c, i), start: a, finish: e })) } if (Ke.contains(i, u)) { var t, n = 0 < (t = Ct.ancestors(a, "td,th", l(i))).length ? t[t.length - 1] : a; return x.some(or({ boxes: tr(i, a, u, c, i), start: a, finish: n })) } return _n(a, c).shared().bind(function (e) { return Wt.closest(e, "table", r).bind(function (e) { var t = Ct.ancestors(c, "td,th", l(e)), n = 0 < t.length ? t[t.length - 1] : c, r = Ct.ancestors(a, "td,th", l(e)), o = 0 < r.length ? r[r.length - 1] : a; return x.some(or({ boxes: tr(e, a, u, c, i), start: o, finish: n })) }) }) }) }) }, ur = { identify: ir, retrieve: function (e, t) { var n = Ct.descendants(e, t); return 0 < n.length ? x.some(n) : x.none() }, shiftSelection: function (e, t, n, r, o) { return (i = e, u = o, E.find(i, function (e) { return ne.is(e, u) })).bind(function (e) { return Zn(e, t, n).bind(function (e) { return t = e, n = r, Wt.ancestor(t, "table").bind(function (e) { return Wt.descendant(e, n).bind(function (e) { return ir(e, t).bind(function (t) { return t.boxes().map(function (e) { return { boxes: y.constant(e), start: y.constant(t.start()), finish: y.constant(t.finish()) } }) }) }) }); var t, n }) }); var i, u }, getEdges: function (e, t, r) { return Wt.descendant(e, t).bind(function (n) { return Wt.descendant(e, r).bind(function (t) { return zn(rr, [n, t]).map(function (e) { return { first: y.constant(n), last: y.constant(t), table: y.constant(e) } }) }) }) } }, ar = function (e, t) { return ur.retrieve(e, t) }, cr = function (o, e, t) { return ur.getEdges(o, e, t).bind(function (n) { var e = function (e) { return Ke.eq(o, e) }, t = Wt.ancestor(n.first(), "thead,tfoot,tbody,table", e), r = Wt.ancestor(n.last(), "thead,tfoot,tbody,table", e); return t.bind(function (t) { return r.bind(function (e) { return Ke.eq(t, e) ? nr(n.table(), n.first(), n.last()) : x.none() }) }) }) }, lr = "data-mce-selected", sr = "data-mce-first-selected", fr = "data-mce-last-selected", dr = { selected: y.constant(lr), selectedSelector: y.constant("td[data-mce-selected],th[data-mce-selected]"), attributeSelector: y.constant("[data-mce-selected]"), firstSelected: y.constant(sr), firstSelectedSelector: y.constant("td[data-mce-first-selected],th[data-mce-first-selected]"), lastSelected: y.constant(fr), lastSelectedSelector: y.constant("td[data-mce-last-selected],th[data-mce-last-selected]") }, mr = function (u) { if (!g.isArray(u)) throw new Error("cases must be an array"); if (0 === u.length) throw new Error("there must be at least one case"); var a = [], n = {}; return E.each(u, function (e, r) { var t = M.keys(e); if (1 !== t.length) throw new Error("one and only one name per case"); var o = t[0], i = e[o]; if (n[o] !== undefined) throw new Error("duplicate key detected:" + o); if ("cata" === o) throw new Error("cannot have a case named cata (sorry)"); if (!g.isArray(i)) throw new Error("case arguments must be an array"); a.push(o), n[o] = function () { var e = arguments.length; if (e !== i.length) throw new Error("Wrong number of arguments to case " + o + ". Expected " + i.length + " (" + i + "), got " + e); for (var n = new Array(e), t = 0; t < n.length; t++)n[t] = arguments[t]; return { fold: function () { if (arguments.length !== u.length) throw new Error("Wrong number of arguments to fold. Expected " + u.length + ", got " + arguments.length); return arguments[r].apply(null, n) }, match: function (e) { var t = M.keys(e); if (a.length !== t.length) throw new Error("Wrong number of arguments to match. Expected: " + a.join(",") + "\nActual: " + t.join(",")); if (!E.forall(a, function (e) { return E.contains(t, e) })) throw new Error("Not all branches were specified when using match. Specified: " + t.join(", ") + "\nRequired: " + a.join(", ")); return e[o].apply(null, n) }, log: function (e) { console.log(e, { constructors: a, constructor: o, params: n }) } } } }), n }, gr = mr([{ none: [] }, { multiple: ["elements"] }, { single: ["selection"] }]), pr = { cata: function (e, t, n, r) { return e.fold(t, n, r) }, none: gr.none, multiple: gr.multiple, single: gr.single }, hr = function (e, t) { return pr.cata(t.get(), y.constant([]), y.identity, y.constant([e])) }, vr = function (n, e) { return pr.cata(e.get(), x.none, function (t, e) { return 0 === t.length ? x.none() : cr(n, dr.firstSelectedSelector(), dr.lastSelectedSelector()).bind(function (e) { return 1 < t.length ? x.some({ bounds: y.constant(e), cells: y.constant(t) }) : x.none() }) }, x.none) }, br = function (e, t) { var n = hr(e, t); return 0 < n.length && E.forall(n, function (e) { return vt.has(e, "rowspan") && 1 < parseInt(vt.get(e, "rowspan"), 10) || vt.has(e, "colspan") && 1 < parseInt(vt.get(e, "colspan"), 10) }) ? x.some(n) : x.none() }, wr = hr, yr = function (e) { return { element: y.constant(e), mergable: x.none, unmergable: x.none, selection: y.constant([e]) } }, xr = F.immutable("element", "clipboard", "generators"), Sr = { noMenu: yr, forMenu: function (e, t, n) { return { element: y.constant(n), mergable: y.constant(vr(t, e)), unmergable: y.constant(br(n, e)), selection: y.constant(wr(n, e)) } }, notCell: function (e) { return yr(e) }, paste: xr, pasteRows: function (e, t, n, r, o) { return { element: y.constant(n), mergable: x.none, unmergable: x.none, selection: y.constant(wr(n, e)), clipboard: y.constant(r), generators: y.constant(o) } } }, Cr = { registerEvents: function (a, e, c, l) { a.on("BeforeGetContent", function (n) { !0 === n.selection && pr.cata(e.get(), y.noop, function (e) { var t; n.preventDefault(), (t = e, zt.table(t[0]).map(mn).map(function (e) { return [cn(e, dr.attributeSelector())] })).each(function (e) { n.content = E.map(e, function (e) { return t = e, a.selection.serializer.serialize(t.dom(), {}); var t }).join("") }) }, y.noop) }), a.on("BeforeSetContent", function (u) { !0 === u.selection && !0 === u.paste && x.from(a.dom.getParent(a.selection.getStart(), "th,td")).each(function (e) { var i = Y.fromDom(e); zt.table(i).bind(function (t) { var e = E.filter(Nn(u.content), function (e) { return "meta" !== dt.name(e) }); if (1 === e.length && "table" === dt.name(e[0])) { u.preventDefault(); var n = Y.fromDom(a.getDoc()), r = kn(n), o = Sr.paste(i, e[0], r); c.pasteCells(t, o).each(function (e) { a.selection.setRng(e), a.focus(), l.clear(t) }) } }) }) }) } }; function Rr(r, o) { var e = function (e) { var t = o(e); if (t <= 0 || null === t) { var n = Zt.get(e, r); return parseFloat(n) || 0 } return t }, i = function (o, e) { return E.foldl(e, function (e, t) { var n = Zt.get(o, t), r = n === undefined ? 0 : parseInt(n, 10); return isNaN(r) ? e : e + r }, 0) }; return { set: function (e, t) { if (!g.isNumber(t) && !t.match(/^[0-9]+$/)) throw r + ".set accepts only positive integer values. Value was " + t; var n = e.dom(); Xt.isSupported(n) && (n.style[r] = t + "px") }, get: e, getOuter: e, aggregate: i, max: function (e, t, n) { var r = i(e, n); return r < t ? t - r : 0 } } } var Tr = Rr("height", function (e) { return yt.inBody(e) ? e.dom().getBoundingClientRect().height : e.dom().offsetHeight }), Ar = function (e) { return Tr.get(e) }, Dr = function (e) { return Tr.getOuter(e) }, kr = Rr("width", function (e) { return e.dom().offsetWidth }), Nr = function (e) { return kr.get(e) }, Er = function (e) { return kr.getOuter(e) }, Or = Ge.detect(), Br = function (e, t, n) { return r = Zt.get(e, t), o = n, i = parseFloat(r), isNaN(i) ? o : i; var r, o, i }, Pr = function (e) { return Or.browser.isIE() || Or.browser.isEdge() ? (n = Br(t = e, "padding-top", 0), r = Br(t, "padding-bottom", 0), o = Br(t, "border-top-width", 0), i = Br(t, "border-bottom-width", 0), u = t.dom().getBoundingClientRect().height, "border-box" === Zt.get(t, "box-sizing") ? u : u - n - r - (o + i)) : Br(e, "height", Ar(e)); var t, n, r, o, i, u }, Ir = /(\d+(\.\d+)?)(\w|%)*/, Wr = /(\d+(\.\d+)?)%/, Mr = /(\d+(\.\d+)?)px|em/, Lr = function (e, t) { Zt.set(e, "height", t + "px") }, qr = function (e, t, n, r) { var o, i, u, a, c, l = parseInt(e, 10); return Fe.endsWith(e, "%") && "table" !== dt.name(t) ? (o = t, i = l, u = n, a = r, c = zt.table(o).map(function (e) { var t = u(e); return Math.floor(i / 100 * t) }).getOr(i), a(o, c), c) : l }, Fr = function (e) { var t, n = (t = e, Zt.getRaw(t, "height").getOrThunk(function () { return Pr(t) + "px" })); return n ? qr(n, e, Ar, Lr) : Ar(e) }, jr = function (e, t) { return vt.has(e, t) ? parseInt(vt.get(e, t), 10) : 1 }, zr = function (e) { return Zt.getRaw(e, "width").fold(function () { return x.from(vt.get(e, "width")) }, function (e) { return x.some(e) }) }, _r = function (e, t) { return e / t.pixelWidth() * 100 }, Hr = { percentageBasedSizeRegex: y.constant(Wr), pixelBasedSizeRegex: y.constant(Mr), setPixelWidth: function (e, t) { Zt.set(e, "width", t + "px") }, setPercentageWidth: function (e, t) { Zt.set(e, "width", t + "%") }, setHeight: Lr, getPixelWidth: function (t, n) { return zr(t).fold(function () { var e = Nr(t); return parseInt(e, 10) }, function (e) { return function (e, t, n) { if (Mr.test(t)) { var r = Mr.exec(t); return parseInt(r[1], 10) } if (Wr.test(t)) { var o = Wr.exec(t), i = parseFloat(o[1]); return i / 100 * n.pixelWidth() } var u = Nr(e); return parseInt(u, 10) }(t, e, n) }) }, getPercentageWidth: function (n, r) { return zr(n).fold(function () { var e = Nr(n), t = parseInt(e, 10); return _r(t, r) }, function (e) { return function (e, t, n) { if (Wr.test(t)) { var r = Wr.exec(t); return parseFloat(r[1]) } var o = Nr(e), i = parseInt(o, 10); return _r(i, n) }(n, e, r) }) }, getGenericWidth: function (e) { return zr(e).bind(function (e) { if (Ir.test(e)) { var t = Ir.exec(e); return x.some({ width: y.constant(t[1]), unit: y.constant(t[3]) }) } return x.none() }) }, setGenericWidth: function (e, t, n) { Zt.set(e, "width", t + n) }, getHeight: function (e) { return n = "rowspan", Fr(t = e) / jr(t, n); var t, n }, getRawWidth: zr }, Vr = function (n, r) { Hr.getGenericWidth(n).each(function (e) { var t = e.width() / 2; Hr.setGenericWidth(n, t, e.unit()), Hr.setGenericWidth(r, t, e.unit()) }) }, Ur = function (e, t) { var n = t || Y.fromDom(document.documentElement); return Pt.ancestor(e, y.curry(Ke.eq, n)).isSome() }, Gr = function (e) { var t = e.dom(); return t === t.window ? e : dt.isDocument(e) ? t.defaultView || t.parentWindow : null }, Xr = function (n, r) { return { left: y.constant(n), top: y.constant(r), translate: function (e, t) { return Xr(n + e, r + t) } } }, Yr = function (e, t) { return e !== undefined ? e : t !== undefined ? t : 0 }, Kr = function (e) { var t, n = e.dom(), r = n.ownerDocument, o = r.body, i = Y.fromDom(r.documentElement); return o === n ? Xr(o.offsetLeft, o.offsetTop) : Ur(e, i) ? (t = n.getBoundingClientRect(), Xr(t.left, t.top)) : Xr(0, 0) }, $r = function (e) { var t = e.dom().ownerDocument, n = t.body, r = Gr(Y.fromDom(t)), o = t.documentElement, i = Yr(r.pageYOffset, o.scrollTop), u = Yr(r.pageXOffset, o.scrollLeft), a = Yr(o.clientTop, n.clientTop), c = Yr(o.clientLeft, n.clientLeft); return Kr(e).translate(u - c, i - a) }, Jr = F.immutable("row", "y"), Qr = F.immutable("col", "x"), Zr = function (e) { return $r(e).left() + Er(e) }, eo = function (e) { return $r(e).left() }, to = function (e, t) { return Qr(e, eo(t)) }, no = function (e, t) { return Qr(e, Zr(t)) }, ro = function (e) { return $r(e).top() }, oo = function (n, t, r) { if (0 === r.length) return []; var e = E.map(r.slice(1), function (e, t) { return e.map(function (e) { return n(t, e) }) }), o = r[r.length - 1].map(function (e) { return t(r.length - 1, e) }); return e.concat([o]) }, io = { delta: y.identity, positions: y.curry(oo, function (e, t) { return Jr(e, ro(t)) }, function (e, t) { return Jr(e, ro(t) + Dr(t)) }), edge: ro }, uo = { delta: y.identity, edge: eo, positions: y.curry(oo, to, no) }, ao = { height: io, rtl: { delta: function (e, t) { return -e }, edge: Zr, positions: y.curry(oo, no, to) }, ltr: uo }, co = { ltr: ao.ltr, rtl: ao.rtl }; function lo(t) { var n = function (e) { return t(e).isRtl() ? co.rtl : co.ltr }; return { delta: function (e, t) { return n(t).delta(e, t) }, edge: function (e) { return n(e).edge(e) }, positions: function (e, t) { return n(t).positions(e, t) } } } var so = function (e) { var t = _t(e); return Gt.generate(t).grid() }, fo = function (e) { var t = e, n = function () { return t }; return { get: n, set: function (e) { t = e }, clone: function () { return fo(n()) } } }, mo = function (e, t) { return go(e, t, { validate: g.isFunction, label: "function" }) }, go = function (r, o, i) { if (0 === o.length) throw new Error("You must specify at least one required field."); return q.validateStrArr("required", o), q.checkDupes(o), function (t) { var n = M.keys(t); E.forall(o, function (e) { return E.contains(n, e) }) || q.reqMessage(o, n), r(o, n); var e = E.filter(o, function (e) { return !i.validate(t[e], e) }); return 0 < e.length && q.invalidTypeMessage(e, i.label), t } }, po = y.noop, ho = { exactly: y.curry(mo, function (t, e) { var n = E.filter(e, function (e) { return !E.contains(t, e) }); 0 < n.length && q.unsuppMessage(n) }), ensure: y.curry(mo, po), ensureWith: y.curry(go, po) }, vo = function (e) { var t = vt.has(e, "colspan") ? parseInt(vt.get(e, "colspan"), 10) : 1, n = vt.has(e, "rowspan") ? parseInt(vt.get(e, "rowspan"), 10) : 1; return { element: y.constant(e), colspan: y.constant(t), rowspan: y.constant(n) } }, bo = ho.exactly(["cell", "row", "replace", "gap"]), wo = function (r, e) { bo(r); var n = fo(x.none()), o = e !== undefined ? e : vo, i = function (e) { var t, n = o(e); return t = n, r.cell(t) }, u = function (e) { var t = i(e); return n.get().isNone() && n.set(x.some(t)), a = x.some({ item: e, replacement: t }), t }, a = x.none(); return { getOrInit: function (t, n) { return a.fold(function () { return u(t) }, function (e) { return n(t, e.item) ? e.replacement : u(t) }) }, cursor: n.get } }, yo = function (o, a) { return function (n) { var r = fo(x.none()); bo(n); var i = [], u = function (e) { var t = n.replace(e, a, { scope: o }); return i.push({ item: e, sub: t }), r.get().isNone() && r.set(x.some(t)), t }; return { replaceOrInit: function (t, n) { return (r = t, o = n, E.find(i, function (e) { return o(e.item, r) })).fold(function () { return u(t) }, function (e) { return n(t, e.item) ? e.sub : u(t) }); var r, o }, cursor: r.get } } }, xo = function (n) { bo(n); var e = fo(x.none()); return { combine: function (t) { return e.get().isNone() && e.set(x.some(t)), function () { var e = n.cell({ element: y.constant(t), colspan: y.constant(1), rowspan: y.constant(1) }); return Zt.remove(e, "width"), Zt.remove(t, "width"), e } }, cursor: e.get } }, So = ["body", "p", "div", "article", "aside", "figcaption", "figure", "footer", "header", "nav", "section", "ol", "ul", "table", "thead", "tfoot", "tbody", "caption", "tr", "td", "th", "h1", "h2", "h3", "h4", "h5", "h6", "blockquote", "pre", "address"], Co = function (e, t) { var n = e.property().name(t); return E.contains(So, n) }, Ro = function (e, t) { return E.contains(["br", "img", "hr", "input"], e.property().name(t)) }, To = Co, Ao = function (e, t) { var n = e.property().name(t); return E.contains(["ol", "ul"], n) }, Do = Ro, ko = On(), No = function (e) { return To(ko, e) }, Eo = function (e) { return Ao(ko, e) }, Oo = function (e) { return Do(ko, e) }, Bo = function (e) { var t, i = function (e) { return "br" === dt.name(e) }, r = function (o) { return Sn.last(o).bind(function (n) { var e, r = (e = n, rt.nextSibling(e).map(function (e) { return !!No(e) || (Oo(e) ? "img" !== dt.name(e) : void 0) }).getOr(!1)); return rt.parent(n).map(function (e) { return !0 === r || (t = e, "li" === dt.name(t) || Pt.ancestor(t, Eo).isSome()) || i(n) || No(e) && !Ke.eq(o, e) ? [] : [Y.fromTag("br")]; var t }) }).getOr([]) }, n = 0 === (t = E.bind(e, function (e) { var t, n = rt.children(e); return t = n, E.forall(t, function (e) { return i(e) || dt.isText(e) && 0 === hn.get(e).trim().length }) ? [] : n.concat(r(e)) })).length ? [Y.fromTag("br")] : t; un.empty(e[0]), rn.append(e[0], n) }, Po = function (u) { return function () { for (var e = new Array(arguments.length), t = 0; t < e.length; t++)e[t] = arguments[t]; if (0 === e.length) throw new Error("Can't merge zero objects"); for (var n = {}, r = 0; r < e.length; r++) { var o = e[r]; for (var i in o) o.hasOwnProperty(i) && (n[i] = u(n[i], o[i])) } return n } }, Io = Po(function (e, t) { return g.isObject(e) && g.isObject(t) ? Io(e, t) : t }), Wo = Po(function (e, t) { return t }), Mo = { deepMerge: Io, merge: Wo }, Lo = function (e) { for (var t = [], n = function (e) { t.push(e) }, r = 0; r < e.length; r++)e[r].each(n); return t }, qo = function (e, t) { for (var n = 0; n < e.length; n++) { var r = t(e[n], n); if (r.isSome()) return r } return x.none() }, Fo = function (e, t) { return G.rowcells(t, e.section()) }, jo = function (e, t) { return e.cells()[t] }, zo = { addCell: function (e, t, n) { var r = e.cells(), o = r.slice(0, t), i = r.slice(t), u = o.concat([n]).concat(i); return Fo(e, u) }, setCells: Fo, mutateCell: function (e, t, n) { e.cells()[t] = n }, getCell: jo, getCellElement: function (e, t) { return jo(e, t).element() }, mapCells: function (e, t) { var n = e.cells(), r = E.map(n, t); return G.rowcells(r, e.section()) }, cellLength: function (e) { return e.cells().length } }, _o = function (e, t) { if (0 === e.length) return 0; var n = e[0]; return E.findIndex(e, function (e) { return !t(n.element(), e.element()) }).fold(function () { return e.length }, function (e) { return e }) }, Ho = function (e, t, n, r) { var o, i, u, a, c = (o = e, i = t, o[i]).cells().slice(n), l = _o(c, r), s = (u = e, a = n, E.map(u, function (e) { return zo.getCell(e, a) })).slice(t), f = _o(s, r); return { colspan: y.constant(l), rowspan: y.constant(f) } }, Vo = function (o, i) { var u = E.map(o, function (e, t) { return E.map(e.cells(), function (e, t) { return !1 }) }); return E.map(o, function (e, r) { var t = E.bind(e.cells(), function (e, t) { if (!1 === u[r][t]) { var n = Ho(o, r, t, i); return function (e, t, n, r) { for (var o = e; o < e + n; o++)for (var i = t; i < t + r; i++)u[o][i] = !0 }(r, t, n.rowspan(), n.colspan()), [G.detailnew(e.element(), n.rowspan(), n.colspan(), e.isNew())] } return [] }); return G.rowdetails(t, e.section()) }) }, Uo = function (e, t, n) { for (var r = [], o = 0; o < e.grid().rows(); o++) { for (var i = [], u = 0; u < e.grid().columns(); u++) { var a = Gt.getAt(e, o, u).map(function (e) { return G.elementnew(e.element(), n) }).getOrThunk(function () { return G.elementnew(t.gap(), !0) }); i.push(a) } var c = G.rowcells(i, e.all()[o].section()); r.push(c) } return r }, Go = function (e, t, n, r) { n === r ? vt.remove(e, t) : vt.set(e, t, n) }, Xo = function (o, e) { var i = [], u = [], t = function (e, t) { var n; 0 < e.length ? function (e, t) { var n = Wt.child(o, t).getOrThunk(function () { var e = Y.fromTag(t, rt.owner(o).dom()); return nn.append(o, e), e }); un.empty(n); var r = E.map(e, function (e) { e.isNew() && i.push(e.element()); var t = e.element(); return un.empty(t), E.each(e.cells(), function (e) { e.isNew() && u.push(e.element()), Go(e.element(), "colspan", e.colspan(), 1), Go(e.element(), "rowspan", e.rowspan(), 1), nn.append(t, e.element()) }), t }); rn.append(n, r) }(e, t) : (n = t, Wt.child(o, n).bind(un.remove)) }, n = [], r = [], a = []; return E.each(e, function (e) { switch (e.section()) { case "thead": n.push(e); break; case "tbody": r.push(e); break; case "tfoot": a.push(e) } }), t(n, "thead"), t(r, "tbody"), t(a, "tfoot"), { newRows: y.constant(i), newCells: y.constant(u) } }, Yo = function (e) { return E.map(e, function (e) { var n = dn(e.element()); return E.each(e.cells(), function (e) { var t = mn(e.element()); Go(t, "colspan", e.colspan(), 1), Go(t, "rowspan", e.rowspan(), 1), nn.append(n, t) }), n }) }, Ko = function (e, t) { for (var n = [], r = 0; r < e; r++)n.push(t(r)); return n }, $o = function (e, t) { for (var n = [], r = e; r < t; r++)n.push(r); return n }, Jo = function (t, n) { if (n < 0 || n >= t.length - 1) return x.none(); var e = t[n].fold(function () { var e = E.reverse(t.slice(0, n)); return qo(e, function (e, t) { return e.map(function (e) { return { value: e, delta: t + 1 } }) }) }, function (e) { return x.some({ value: e, delta: 0 }) }), r = t[n + 1].fold(function () { var e = t.slice(n + 1); return qo(e, function (e, t) { return e.map(function (e) { return { value: e, delta: t + 1 } }) }) }, function (e) { return x.some({ value: e, delta: 1 }) }); return e.bind(function (n) { return r.map(function (e) { var t = e.delta + n.delta; return Math.abs(e.value - n.value) / t }) }) }, Qo = function (e, t, n) { var r = e(); return E.find(r, t).orThunk(function () { return x.from(r[0]).orThunk(n) }).map(function (e) { return e.element() }) }, Zo = function (n) { var e = n.grid(), t = $o(0, e.columns()), r = $o(0, e.rows()); return E.map(t, function (t) { return Qo(function () { return E.bind(r, function (e) { return Gt.getAt(n, e, t).filter(function (e) { return e.column() === t }).fold(y.constant([]), function (e) { return [e] }) }) }, function (e) { return 1 === e.colspan() }, function () { return Gt.getAt(n, 0, t) }) }) }, ei = function (n) { var e = n.grid(), t = $o(0, e.rows()), r = $o(0, e.columns()); return E.map(t, function (t) { return Qo(function () { return E.bind(r, function (e) { return Gt.getAt(n, t, e).filter(function (e) { return e.row() === t }).fold(y.constant([]), function (e) { return [e] }) }) }, function (e) { return 1 === e.rowspan() }, function () { return Gt.getAt(n, t, 0) }) }) }, ti = function (e, t, n, r, o) { var i = Y.fromTag("div"); return Zt.setAll(i, { position: "absolute", left: t - r / 2 + "px", top: n + "px", height: o + "px", width: r + "px" }), vt.setAll(i, { "data-column": e, role: "presentation" }), i }, ni = function (e, t, n, r, o) { var i = Y.fromTag("div"); return Zt.setAll(i, { position: "absolute", left: t + "px", top: n - o / 2 + "px", height: o + "px", width: r + "px" }), vt.setAll(i, { "data-row": e, role: "presentation" }), i }, ri = function (e) { var t = e.replace(/\./g, "-"); return { resolve: function (e) { return t + "-" + e } } }, oi = { resolve: ri("ephox-snooker").resolve }, ii = function (e, t) { var n = vt.get(e, t); return n === undefined || "" === n ? [] : n.split(" ") }, ui = ii, ai = function (e, t, n) { var r = ii(e, t).concat([n]); vt.set(e, t, r.join(" ")) }, ci = function (e, t, n) { var r = E.filter(ii(e, t), function (e) { return e !== n }); 0 < r.length ? vt.set(e, t, r.join(" ")) : vt.remove(e, t) }, li = function (e) { return ui(e, "class") }, si = function (e, t) { return ai(e, "class", t) }, fi = function (e, t) { return ci(e, "class", t) }, di = li, mi = si, gi = fi, pi = function (e, t) { E.contains(li(e), t) ? fi(e, t) : si(e, t) }, hi = function (e) { return e.dom().classList !== undefined }, vi = function (e, t) { return hi(e) && e.dom().classList.contains(t) }, bi = { add: function (e, t) { hi(e) ? e.dom().classList.add(t) : mi(e, t) }, remove: function (e, t) { var n; hi(e) ? e.dom().classList.remove(t) : gi(e, t), 0 === (hi(n = e) ? n.dom().classList : di(n)).length && vt.remove(n, "class") }, toggle: function (e, t) { return hi(e) ? e.dom().classList.toggle(t) : pi(e, t) }, toggler: function (e, t) { var n, r, o, i, u, a, c = hi(e), l = e.dom().classList; return n = function () { c ? l.remove(t) : gi(e, t) }, r = function () { c ? l.add(t) : mi(e, t) }, o = vi(e, t), i = o || !1, { on: u = function () { r(), i = !0 }, off: a = function () { n(), i = !1 }, toggle: function () { (i ? a : u)() }, isOn: function () { return i } } }, has: vi }, wi = oi.resolve("resizer-bar"), yi = oi.resolve("resizer-rows"), xi = oi.resolve("resizer-cols"), Si = function (e) { var t = Ct.descendants(e.parent(), "." + wi); E.each(t, un.remove) }, Ci = function (n, e, r) { var o = n.origin(); E.each(e, function (e, t) { e.each(function (e) { var t = r(o, e); bi.add(t, wi), nn.append(n.parent(), t) }) }) }, Ri = function (e, t, n, r, o, i) { var u, a, c, l, s = $r(t), f = 0 < n.length ? o.positions(n, t) : []; u = e, a = f, c = s, l = Er(t), Ci(u, a, function (e, t) { var n = ni(t.row(), c.left() - e.left(), t.y() - e.top(), l, 7); return bi.add(n, yi), n }); var d, m, g, p, h = 0 < r.length ? i.positions(r, t) : []; d = e, m = h, g = s, p = Dr(t), Ci(d, m, function (e, t) { var n = ti(t.col(), t.x() - e.left(), g.top() - e.top(), 7, p); return bi.add(n, xi), n }) }, Ti = function (e, t) { var n = Ct.descendants(e.parent(), "." + wi); E.each(n, t) }, Ai = { refresh: function (e, t, n, r) { Si(e); var o = _t(t), i = Gt.generate(o), u = ei(i), a = Zo(i); Ri(e, t, u, a, n, r) }, hide: function (e) { Ti(e, function (e) { Zt.set(e, "display", "none") }) }, show: function (e) { Ti(e, function (e) { Zt.set(e, "display", "block") }) }, destroy: Si, isRowBar: function (e) { return bi.has(e, yi) }, isColBar: function (e) { return bi.has(e, xi) } }, Di = function (e, r) { return E.map(e, function (e) { var t, n = (t = e.details(), qo(t, function (e) { return rt.parent(e.element()).map(function (e) { var t = rt.parent(e).isNone(); return G.elementnew(e, t) }) }).getOrThunk(function () { return G.elementnew(r.row(), !0) })); return G.rowdatanew(n.element(), e.details(), e.section(), n.isNew()) }) }, ki = function (e, t) { var n = Vo(e, Ke.eq); return Di(n, t) }, Ni = function (e, t) { var n = E.flatten(E.map(e.all(), function (e) { return e.cells() })); return E.find(n, function (e) { return Ke.eq(t, e.element()) }) }, Ei = function (a, c, l, s, f) { return function (n, r, e, o, i) { var t = _t(r), u = Gt.generate(t); return c(u, e).map(function (e) { var t = Uo(u, o, !1), n = a(t, e, Ke.eq, f(o)), r = ki(n.grid(), o); return { grid: y.constant(r), cursor: n.cursor } }).fold(function () { return x.none() }, function (e) { var t = Xo(r, e.grid()); return l(r, e.grid(), i), s(r), Ai.refresh(n, r, ao.height, i), x.some({ cursor: e.cursor, newRows: t.newRows, newCells: t.newCells }) }) } }, Oi = ki, Bi = function (t, e) { return zt.cell(e.element()).bind(function (e) { return Ni(t, e) }) }, Pi = function (t, e) { var n = E.map(e.selection(), function (e) { return zt.cell(e).bind(function (e) { return Ni(t, e) }) }), r = Lo(n); return 0 < r.length ? x.some(r) : x.none() }, Ii = function (t, n) { return zt.cell(n.element()).bind(function (e) { return Ni(t, e).map(function (e) { return Mo.merge(e, { generators: n.generators, clipboard: n.clipboard }) }) }) }, Wi = function (t, e) { var n = E.map(e.selection(), function (e) { return zt.cell(e).bind(function (e) { return Ni(t, e) }) }), r = Lo(n); return 0 < r.length ? x.some(Mo.merge({ cells: r }, { generators: e.generators, clipboard: e.clipboard })) : x.none() }, Mi = function (e, t) { return t.mergable() }, Li = function (e, t) { return t.unmergable() }, qi = function (n) { return { is: function (e) { return n === e }, isValue: y.always, isError: y.never, getOr: y.constant(n), getOrThunk: y.constant(n), getOrDie: y.constant(n), or: function (e) { return qi(n) }, orThunk: function (e) { return qi(n) }, fold: function (e, t) { return t(n) }, map: function (e) { return qi(e(n)) }, each: function (e) { e(n) }, bind: function (e) { return e(n) }, exists: function (e) { return e(n) }, forall: function (e) { return e(n) }, toOption: function () { return x.some(n) } } }, Fi = function (n) { return { is: y.never, isValue: y.never, isError: y.always, getOr: y.identity, getOrThunk: function (e) { return e() }, getOrDie: function () { return y.die(String(n))() }, or: function (e) { return e }, orThunk: function (e) { return e() }, fold: function (e, t) { return e(n) }, map: function (e) { return Fi(n) }, each: y.noop, bind: function (e) { return Fi(n) }, exists: y.never, forall: y.always, toOption: x.none } }, ji = { value: qi, error: Fi }, zi = function (e, t) { return E.map(e, function () { return G.elementnew(t.cell(), !0) }) }, _i = function (t, e, n) { return t.concat(Ko(e, function (e) { return zo.setCells(t[t.length - 1], zi(t[t.length - 1].cells(), n)) })) }, Hi = function (e, t, n) { return E.map(e, function (e) { return zo.setCells(e, e.cells().concat(zi($o(0, t), n))) }) }, Vi = function (e, t, n) { if (e.row() >= t.length || e.column() > zo.cellLength(t[0])) return ji.error("invalid start address out of table bounds, row: " + e.row() + ", column: " + e.column()); var r = t.slice(e.row()), o = r[0].cells().slice(e.column()), i = zo.cellLength(n[0]), u = n.length; return ji.value({ rowDelta: y.constant(r.length - u), colDelta: y.constant(o.length - i) }) }, Ui = function (e, t) { var n = zo.cellLength(e[0]), r = zo.cellLength(t[0]); return { rowDelta: y.constant(0), colDelta: y.constant(n - r) } }, Gi = function (e, t, n) { var r = t.colDelta() < 0 ? Hi : y.identity; return (t.rowDelta() < 0 ? _i : y.identity)(r(e, Math.abs(t.colDelta()), n), Math.abs(t.rowDelta()), n) }, Xi = function (e, t, n, r) { if (0 === e.length) return e; for (var o = t.startRow(); o <= t.finishRow(); o++)for (var i = t.startCol(); i <= t.finishCol(); i++)zo.mutateCell(e[o], i, G.elementnew(r(), !1)); return e }, Yi = function (e, t, n, r) { for (var o = !0, i = 0; i < e.length; i++)for (var u = 0; u < zo.cellLength(e[0]); u++) { var a = n(zo.getCellElement(e[i], u), t); !0 === a && !1 === o ? zo.mutateCell(e[i], u, G.elementnew(r(), !0)) : !0 === a && (o = !1) } return e }, Ki = function (i, u, a, c) { if (0 < u && u < i.length) { var e = i[u - 1].cells(), t = (n = e, r = a, E.foldl(n, function (e, t) { return E.exists(e, function (e) { return r(e.element(), t.element()) }) ? e : e.concat([t]) }, [])); E.each(t, function (e) { for (var t = x.none(), n = u; n < i.length; n++)for (var r = 0; r < zo.cellLength(i[0]); r++) { var o = i[n].cells()[r]; a(o.element(), e.element()) && (t.isNone() && (t = x.some(c())), t.each(function (e) { zo.mutateCell(i[n], r, G.elementnew(e, !0)) })) } }) } var n, r; return i }, $i = function (n, r, o, i, u) { return Vi(n, r, o).map(function (e) { var t = Gi(r, e, i); return function (e, t, n, r, o) { for (var i, u, a, c, l, s, f, d = e.row(), m = e.column(), g = d + n.length, p = m + zo.cellLength(n[0]), h = d; h < g; h++)for (var v = m; v < p; v++) { i = t, u = h, a = v, c = o, s = l = void 0, l = zo.getCell(i[u], a), s = y.curry(c, l.element()), f = i[u], 1 < i.length && 1 < zo.cellLength(f) && (0 < a && s(zo.getCellElement(f, a - 1)) || a < f.length - 1 && s(zo.getCellElement(f, a + 1)) || 0 < u && s(zo.getCellElement(i[u - 1], a)) || u < i.length - 1 && s(zo.getCellElement(i[u + 1], a))) && Yi(t, zo.getCellElement(t[h], v), o, r.cell); var b = zo.getCellElement(n[h - d], v - m), w = r.replace(b); zo.mutateCell(t[h], v, G.elementnew(w, !0)) } return t }(n, t, o, i, u) }) }, Ji = function (e, t, n, r, o) { Ki(t, e, o, r.cell); var i = Ui(n, t), u = Gi(n, i, r), a = Ui(t, u), c = Gi(t, a, r); return c.slice(0, e).concat(u).concat(c.slice(e, c.length)) }, Qi = function (n, r, e, o, i) { var t = n.slice(0, r), u = n.slice(r), a = zo.mapCells(n[e], function (e, t) { return 0 < r && r < n.length && o(zo.getCellElement(n[r - 1], t), zo.getCellElement(n[r], t)) ? zo.getCell(n[r], t) : G.elementnew(i(e.element(), o), !0) }); return t.concat([a]).concat(u) }, Zi = function (e, n, r, o, i) { return E.map(e, function (e) { var t = 0 < n && n < zo.cellLength(e) && o(zo.getCellElement(e, n - 1), zo.getCellElement(e, n)) ? zo.getCell(e, n) : G.elementnew(i(zo.getCellElement(e, r), o), !0); return zo.addCell(e, n, t) }) }, eu = function (e, r, o, i, u) { var a = o + 1; return E.map(e, function (e, t) { var n = t === r ? G.elementnew(u(zo.getCellElement(e, o), i), !0) : zo.getCell(e, o); return zo.addCell(e, a, n) }) }, tu = function (e, t, n, r, o) { var i = t + 1, u = e.slice(0, i), a = e.slice(i), c = zo.mapCells(e[t], function (e, t) { return t === n ? G.elementnew(o(e.element(), r), !0) : e }); return u.concat([c]).concat(a) }, nu = function (e, t, n) { return e.slice(0, t).concat(e.slice(n + 1)) }, ru = function (e, n, r) { var t = E.map(e, function (e) { var t = e.cells().slice(0, n).concat(e.cells().slice(r + 1)); return G.rowcells(t, e.section()) }); return E.filter(t, function (e) { return 0 < e.cells().length }) }, ou = function (e, n, r, o) { return E.map(e, function (e) { return zo.mapCells(e, function (e) { return t = e, E.exists(n, function (e) { return r(t.element(), e.element()) }) ? G.elementnew(o(e.element(), r), !0) : e; var t }) }) }, iu = function (e, t, n, r) { return zo.getCellElement(e[t], n) !== undefined && 0 < t && r(zo.getCellElement(e[t - 1], n), zo.getCellElement(e[t], n)) }, uu = function (e, t, n) { return 0 < t && n(zo.getCellElement(e, t - 1), zo.getCellElement(e, t)) }, au = function (n, r, o, e) { var t = E.bind(n, function (e, t) { return iu(n, t, r, o) || uu(e, r, o) ? [] : [zo.getCell(e, r)] }); return ou(n, t, o, e) }, cu = function (n, r, o, e) { var i = n[r], t = E.bind(i.cells(), function (e, t) { return iu(n, r, t, o) || uu(i, t, o) ? [] : [e] }); return ou(n, t, o, e) }, lu = function (e) { return { fold: e } }, su = function () { return lu(function (e, t, n, r, o) { return e() }) }, fu = function (i) { return lu(function (e, t, n, r, o) { return t(i) }) }, du = function (i, u) { return lu(function (e, t, n, r, o) { return n(i, u) }) }, mu = function (i, u, a) { return lu(function (e, t, n, r, o) { return r(i, u, a) }) }, gu = function (i, u) { return lu(function (e, t, n, r, o) { return o(i, u) }) }, pu = function (e, t, i, u) { var n, r, a = e.slice(0), o = (r = t, 0 === (n = e).length ? su() : 1 === n.length ? fu(0) : 0 === r ? du(0, 1) : r === n.length - 1 ? gu(r - 1, r) : 0 < r && r < n.length - 1 ? mu(r - 1, r, r + 1) : su()), c = function (e) { return E.map(e, y.constant(0)) }, l = y.constant(c(a)), s = function (e, t) { if (0 <= i) { var n = Math.max(u.minCellWidth(), a[t] - i); return c(a.slice(0, e)).concat([i, n - a[t]]).concat(c(a.slice(t + 1))) } var r = Math.max(u.minCellWidth(), a[e] + i), o = a[e] - r; return c(a.slice(0, e)).concat([r - a[e], o]).concat(c(a.slice(t + 1))) }, f = s; return o.fold(l, function (e) { return u.singleColumnWidth(a[e], i) }, f, function (e, t, n) { return s(t, n) }, function (e, t) { if (0 <= i) return c(a.slice(0, t)).concat([i]); var n = Math.max(u.minCellWidth(), a[t] + i); return c(a.slice(0, t)).concat([n - a[t]]) }) }, hu = function (e, t) { return vt.has(e, t) && 1 < parseInt(vt.get(e, t), 10) }, vu = { hasColspan: function (e) { return hu(e, "colspan") }, hasRowspan: function (e) { return hu(e, "rowspan") }, minWidth: y.constant(10), minHeight: y.constant(10), getInt: function (e, t) { return parseInt(Zt.get(e, t), 10) } }, bu = function (e, t, n) { return Zt.getRaw(e, t).fold(function () { return n(e) + "px" }, function (e) { return e }) }, wu = function (e) { return bu(e, "width", Hr.getPixelWidth) }, yu = function (e) { return bu(e, "height", Hr.getHeight) }, xu = function (e, t, n, r, o) { var i = Zo(e), u = E.map(i, function (e) { return e.map(t.edge) }); return E.map(i, function (e, t) { return e.filter(y.not(vu.hasColspan)).fold(function () { var e = Jo(u, t); return r(e) }, function (e) { return n(e, o) }) }) }, Su = function (e) { return e.map(function (e) { return e + "px" }).getOr("") }, Cu = function (e, t, n, r) { var o = ei(e), i = E.map(o, function (e) { return e.map(t.edge) }); return E.map(o, function (e, t) { return e.filter(y.not(vu.hasRowspan)).fold(function () { var e = Jo(i, t); return r(e) }, function (e) { return n(e) }) }) }, Ru = { getRawWidths: function (e, t) { return xu(e, t, wu, Su) }, getPixelWidths: function (e, t, n) { return xu(e, t, Hr.getPixelWidth, function (e) { return e.getOrThunk(n.minCellWidth) }, n) }, getPercentageWidths: function (e, t, n) { return xu(e, t, Hr.getPercentageWidth, function (e) { return e.fold(function () { return n.minCellWidth() }, function (e) { return e / n.pixelWidth() * 100 }) }, n) }, getPixelHeights: function (e, t) { return Cu(e, t, Hr.getHeight, function (e) { return e.getOrThunk(vu.minHeight) }) }, getRawHeights: function (e, t) { return Cu(e, t, yu, Su) } }, Tu = function (e, t, n) { for (var r = 0, o = e; o < t; o++)r += n[o] !== undefined ? n[o] : 0; return r }, Au = function (e, n) { var t = Gt.justCells(e); return E.map(t, function (e) { var t = Tu(e.column(), e.column() + e.colspan(), n); return { element: e.element, width: y.constant(t), colspan: e.colspan } }) }, Du = function (e, n) { var t = Gt.justCells(e); return E.map(t, function (e) { var t = Tu(e.row(), e.row() + e.rowspan(), n); return { element: e.element, height: y.constant(t), rowspan: e.rowspan } }) }, ku = function (e, n) { return E.map(e.all(), function (e, t) { return { element: e.element, height: y.constant(n[t]) } }) }, Nu = function (e) { var t = parseInt(e, 10), n = y.identity; return { width: y.constant(t), pixelWidth: y.constant(t), getWidths: Ru.getPixelWidths, getCellDelta: n, singleColumnWidth: function (e, t) { return [Math.max(vu.minWidth(), e + t) - e] }, minCellWidth: vu.minWidth, setElementWidth: Hr.setPixelWidth, setTableWidth: function (e, t, n) { var r = E.foldr(t, function (e, t) { return e + t }, 0); Hr.setPixelWidth(e, r) } } }, Eu = function (e, t) { if (Hr.percentageBasedSizeRegex().test(t)) { var n = Hr.percentageBasedSizeRegex().exec(t); return o = n[1], i = e, u = parseFloat(o), a = Nr(i), { width: y.constant(u), pixelWidth: y.constant(a), getWidths: Ru.getPercentageWidths, getCellDelta: function (e) { return e / a * 100 }, singleColumnWidth: function (e, t) { return [100 - e] }, minCellWidth: function () { return vu.minWidth() / a * 100 }, setElementWidth: Hr.setPercentageWidth, setTableWidth: function (e, t, n) { var r = u + n; Hr.setPercentageWidth(e, r) } } } if (Hr.pixelBasedSizeRegex().test(t)) { var r = Hr.pixelBasedSizeRegex().exec(t); return Nu(r[1]) } var o, i, u, a, c = Nr(e); return Nu(c) }, Ou = function (t) { return Hr.getRawWidth(t).fold(function () { var e = Nr(t); return Nu(e) }, function (e) { return Eu(t, e) }) }, Bu = function (e) { return Gt.generate(e) }, Pu = function (e) { var t = _t(e); return Bu(t) }, Iu = { adjustWidth: function (e, t, n, r) { var o = Ou(e), i = o.getCellDelta(t), u = Pu(e), a = o.getWidths(u, r, o), c = pu(a, n, i, o), l = E.map(c, function (e, t) { return e + a[t] }), s = Au(u, l); E.each(s, function (e) { o.setElementWidth(e.element(), e.width()) }), n === u.grid().columns() - 1 && o.setTableWidth(e, l, i) }, adjustHeight: function (e, n, r, t) { var o = Pu(e), i = Ru.getPixelHeights(o, t), u = E.map(i, function (e, t) { return r === t ? Math.max(n + e, vu.minHeight()) : e }), a = Du(o, u), c = ku(o, u); E.each(c, function (e) { Hr.setHeight(e.element(), e.height()) }), E.each(a, function (e) { Hr.setHeight(e.element(), e.height()) }); var l, s = (l = u, E.foldr(l, function (e, t) { return e + t }, 0)); Hr.setHeight(e, s) }, adjustWidthTo: function (e, t, n) { var r = Ou(e), o = Bu(t), i = r.getWidths(o, n, r), u = Au(o, i); E.each(u, function (e) { r.setElementWidth(e.element(), e.width()) }); var a = E.foldr(i, function (e, t) { return t + e }, 0); 0 < u.length && r.setElementWidth(e, a) } }, Wu = function (e) { 0 === zt.cells(e).length && un.remove(e) }, Mu = F.immutable("grid", "cursor"), Lu = function (e, t, n) { return qu(e, t, n).orThunk(function () { return qu(e, 0, 0) }) }, qu = function (e, t, n) { return x.from(e[t]).bind(function (e) { return x.from(e.cells()[n]).bind(function (e) { return x.from(e.element()) }) }) }, Fu = function (e, t, n) { return Mu(e, qu(e, t, n)) }, ju = function (e) { return E.foldl(e, function (e, t) { return E.exists(e, function (e) { return e.row() === t.row() }) ? e : e.concat([t]) }, []).sort(function (e, t) { return e.row() - t.row() }) }, zu = function (e) { return E.foldl(e, function (e, t) { return E.exists(e, function (e) { return e.column() === t.column() }) ? e : e.concat([t]) }, []).sort(function (e, t) { return e.column() - t.column() }) }, _u = function (e, t, n) { var r = Ht(e, n), o = Gt.generate(r); return Uo(o, t, !0) }, Hu = Iu.adjustWidthTo, Vu = { insertRowBefore: Ei(function (e, t, n, r) { var o = t.row(), i = t.row(), u = Qi(e, i, o, n, r.getOrInit); return Fu(u, i, t.column()) }, Bi, y.noop, y.noop, wo), insertRowsBefore: Ei(function (e, t, n, r) { var o = t[0].row(), i = t[0].row(), u = ju(t), a = E.foldl(u, function (e, t) { return Qi(e, i, o, n, r.getOrInit) }, e); return Fu(a, i, t[0].column()) }, Pi, y.noop, y.noop, wo), insertRowAfter: Ei(function (e, t, n, r) { var o = t.row(), i = t.row() + t.rowspan(), u = Qi(e, i, o, n, r.getOrInit); return Fu(u, i, t.column()) }, Bi, y.noop, y.noop, wo), insertRowsAfter: Ei(function (e, t, n, r) { var o = ju(t), i = o[o.length - 1].row(), u = o[o.length - 1].row() + o[o.length - 1].rowspan(), a = E.foldl(o, function (e, t) { return Qi(e, u, i, n, r.getOrInit) }, e); return Fu(a, u, t[0].column()) }, Pi, y.noop, y.noop, wo), insertColumnBefore: Ei(function (e, t, n, r) { var o = t.column(), i = t.column(), u = Zi(e, i, o, n, r.getOrInit); return Fu(u, t.row(), i) }, Bi, Hu, y.noop, wo), insertColumnsBefore: Ei(function (e, t, n, r) { var o = zu(t), i = o[0].column(), u = o[0].column(), a = E.foldl(o, function (e, t) { return Zi(e, u, i, n, r.getOrInit) }, e); return Fu(a, t[0].row(), u) }, Pi, Hu, y.noop, wo), insertColumnAfter: Ei(function (e, t, n, r) { var o = t.column(), i = t.column() + t.colspan(), u = Zi(e, i, o, n, r.getOrInit); return Fu(u, t.row(), i) }, Bi, Hu, y.noop, wo), insertColumnsAfter: Ei(function (e, t, n, r) { var o = t[t.length - 1].column(), i = t[t.length - 1].column() + t[t.length - 1].colspan(), u = zu(t), a = E.foldl(u, function (e, t) { return Zi(e, i, o, n, r.getOrInit) }, e); return Fu(a, t[0].row(), i) }, Pi, Hu, y.noop, wo), splitCellIntoColumns: Ei(function (e, t, n, r) { var o = eu(e, t.row(), t.column(), n, r.getOrInit); return Fu(o, t.row(), t.column()) }, Bi, Hu, y.noop, wo), splitCellIntoRows: Ei(function (e, t, n, r) { var o = tu(e, t.row(), t.column(), n, r.getOrInit); return Fu(o, t.row(), t.column()) }, Bi, y.noop, y.noop, wo), eraseColumns: Ei(function (e, t, n, r) { var o = zu(t), i = ru(e, o[0].column(), o[o.length - 1].column()), u = Lu(i, t[0].row(), t[0].column()); return Mu(i, u) }, Pi, Hu, Wu, wo), eraseRows: Ei(function (e, t, n, r) { var o = ju(t), i = nu(e, o[0].row(), o[o.length - 1].row()), u = Lu(i, t[0].row(), t[0].column()); return Mu(i, u) }, Pi, y.noop, Wu, wo), makeColumnHeader: Ei(function (e, t, n, r) { var o = au(e, t.column(), n, r.replaceOrInit); return Fu(o, t.row(), t.column()) }, Bi, y.noop, y.noop, yo("row", "th")), unmakeColumnHeader: Ei(function (e, t, n, r) { var o = au(e, t.column(), n, r.replaceOrInit); return Fu(o, t.row(), t.column()) }, Bi, y.noop, y.noop, yo(null, "td")), makeRowHeader: Ei(function (e, t, n, r) { var o = cu(e, t.row(), n, r.replaceOrInit); return Fu(o, t.row(), t.column()) }, Bi, y.noop, y.noop, yo("col", "th")), unmakeRowHeader: Ei(function (e, t, n, r) { var o = cu(e, t.row(), n, r.replaceOrInit); return Fu(o, t.row(), t.column()) }, Bi, y.noop, y.noop, yo(null, "td")), mergeCells: Ei(function (e, t, n, r) { var o = t.cells(); Bo(o); var i = Xi(e, t.bounds(), n, y.constant(o[0])); return Mu(i, x.from(o[0])) }, Mi, y.noop, y.noop, xo), unmergeCells: Ei(function (e, t, n, r) { var o = E.foldr(t, function (e, t) { return Yi(e, t, n, r.combine(t)) }, e); return Mu(o, x.from(t[0])) }, Li, Hu, y.noop, xo), pasteCells: Ei(function (e, n, t, r) { var o, i, u, a, c = (o = n.clipboard(), i = n.generators(), u = _t(o), a = Gt.generate(u), Uo(a, i, !0)), l = G.address(n.row(), n.column()); return $i(l, e, c, n.generators(), t).fold(function () { return Mu(e, x.some(n.element())) }, function (e) { var t = Lu(e, n.row(), n.column()); return Mu(e, t) }) }, Ii, Hu, y.noop, wo), pasteRowsBefore: Ei(function (e, t, n, r) { var o = e[t.cells[0].row()], i = t.cells[0].row(), u = _u(t.clipboard(), t.generators(), o), a = Ji(i, e, u, t.generators(), n), c = Lu(a, t.cells[0].row(), t.cells[0].column()); return Mu(a, c) }, Wi, y.noop, y.noop, wo), pasteRowsAfter: Ei(function (e, t, n, r) { var o = e[t.cells[0].row()], i = t.cells[t.cells.length - 1].row() + t.cells[t.cells.length - 1].rowspan(), u = _u(t.clipboard(), t.generators(), o), a = Ji(i, e, u, t.generators(), n), c = Lu(a, t.cells[0].row(), t.cells[0].column()); return Mu(a, c) }, Wi, y.noop, y.noop, wo) }, Uu = function (e) { return Y.fromDom(e.getBody()) }, Gu = { getBody: Uu, getIsRoot: function (t) { return function (e) { return Ke.eq(e, Uu(t)) } }, addSizeSuffix: function (e) { return /^[0-9]+$/.test(e) && (e += "px"), e }, removePxSuffix: function (e) { return e ? e.replace(/px$/, "") : "" } }, Xu = function (e) { return "rtl" === Zt.get(e, "direction") ? "rtl" : "ltr" }, Yu = { onDirection: function (t, n) { return function (e) { return "rtl" === Xu(e) ? n : t } }, getDirection: Xu }, Ku = { isRtl: y.constant(!1) }, $u = { isRtl: y.constant(!0) }, Ju = { directionAt: function (e) { return "rtl" === Yu.getDirection(e) ? $u : Ku } }, Qu = ["tableprops", "tabledelete", "|", "tableinsertrowbefore", "tableinsertrowafter", "tabledeleterow", "|", "tableinsertcolbefore", "tableinsertcolafter", "tabledeletecol"], Zu = { "border-collapse": "collapse", width: "100%" }, ea = { border: "1" }, ta = function (e) { return e.getParam("table_tab_navigation", !0, "boolean") }, na = function (e) { return e.getParam("table_cell_advtab", !0, "boolean") }, ra = function (e) { return e.getParam("table_row_advtab", !0, "boolean") }, oa = function (e) { return e.getParam("table_advtab", !0, "boolean") }, ia = function (e) { return e.getParam("table_style_by_css", !1, "boolean") }, ua = function (e) { return e.getParam("table_cell_class_list", [], "array") }, aa = function (e) { return e.getParam("table_row_class_list", [], "array") }, ca = function (e) { return e.getParam("table_class_list", [], "array") }, la = function (e) { return !1 === e.getParam("table_responsive_width") }, sa = function (e, t) { return e.fire("newrow", { node: t }) }, fa = function (e, t) { return e.fire("newcell", { node: t }) }, da = function (f, e) { var t, n = function (e) { return "table" === dt.name(Gu.getBody(e)) }, d = (t = f.getParam("table_clone_elements"), g.isString(t) ? x.some(t.split(/[ ,]/)) : Array.isArray(t) ? x.some(t) : x.none()), r = function (a, c, l, s) { return function (e, t) { var n = Ct.descendants(e, "td[data-mce-style],th[data-mce-style]"); E.each(n, function (e) { vt.remove(e, "data-mce-style") }); var r = s(), o = Y.fromDom(f.getDoc()), i = lo(Ju.directionAt), u = Dn(l, o, d); return c(e) ? a(r, e, t, u, i).bind(function (e) { return E.each(e.newRows(), function (e) { sa(f, e.dom()) }), E.each(e.newCells(), function (e) { fa(f, e.dom()) }), e.cursor().map(function (e) { var t = f.dom.createRng(); return t.setStart(e.dom(), 0), t.setEnd(e.dom(), 0), t }) }) : x.none() } }; return { deleteRow: r(Vu.eraseRows, function (e) { var t = so(e); return !1 === n(f) || 1 < t.rows() }, y.noop, e), deleteColumn: r(Vu.eraseColumns, function (e) { var t = so(e); return !1 === n(f) || 1 < t.columns() }, y.noop, e), insertRowsBefore: r(Vu.insertRowsBefore, y.always, y.noop, e), insertRowsAfter: r(Vu.insertRowsAfter, y.always, y.noop, e), insertColumnsBefore: r(Vu.insertColumnsBefore, y.always, Vr, e), insertColumnsAfter: r(Vu.insertColumnsAfter, y.always, Vr, e), mergeCells: r(Vu.mergeCells, y.always, y.noop, e), unmergeCells: r(Vu.unmergeCells, y.always, y.noop, e), pasteRowsBefore: r(Vu.pasteRowsBefore, y.always, y.noop, e), pasteRowsAfter: r(Vu.pasteRowsAfter, y.always, y.noop, e), pasteCells: r(Vu.pasteCells, y.always, y.noop, e) } }, ma = function (e, t, r) { var n = _t(e), o = Gt.generate(n); return Pi(o, t).map(function (e) { var t = Uo(o, r, !1).slice(e[0].row(), e[e.length - 1].row() + e[e.length - 1].rowspan()), n = Oi(t, r); return Yo(n) }) }, ga = tinymce.util.Tools.resolve("tinymce.util.Tools"), pa = { applyAlign: function (e, t, n) { n && e.formatter.apply("align" + n, {}, t) }, applyVAlign: function (e, t, n) { n && e.formatter.apply("valign" + n, {}, t) }, unApplyAlign: function (t, n) { ga.each("left center right".split(" "), function (e) { t.formatter.remove("align" + e, {}, n) }) }, unApplyVAlign: function (t, n) { ga.each("top middle bottom".split(" "), function (e) { t.formatter.remove("valign" + e, {}, n) }) }, getTDTHOverallStyle: function (o, e, i) { var t; return t = function (e, t) { for (var n = 0; n < t.length; n++) { var r = o.getStyle(t[n], i); if (void 0 === e && (e = r), e !== r) return "" } return e }(t, o.select("td,th", e)) } }, ha = function (e, t) { var n = e.dom, r = t.control.rootControl, o = r.toJSON(), i = n.parseStyle(o.style); "style" === t.control.name() ? (r.find("#borderStyle").value(i["border-style"] || "")[0].fire("select"), r.find("#borderColor").value(i["border-color"] || "")[0].fire("change"), r.find("#backgroundColor").value(i["background-color"] || "")[0].fire("change"), r.find("#width").value(i.width || "").fire("change"), r.find("#height").value(i.height || "").fire("change")) : (i["border-style"] = o.borderStyle, i["border-color"] = o.borderColor, i["background-color"] = o.backgroundColor, i.width = o.width ? Gu.addSizeSuffix(o.width) : "", i.height = o.height ? Gu.addSizeSuffix(o.height) : ""), r.find("#style").value(n.serializeStyle(n.parseStyle(n.serializeStyle(i)))) }, va = { createStyleForm: function (n) { var e = function () { var e = n.getParam("color_picker_callback"); if (e) return function (t) { return e.call(n, function (e) { t.control.value(e).fire("change") }, t.control.value()) } }; return { title: "Advanced", type: "form", defaults: { onchange: y.curry(ha, n) }, items: [{ label: "Style", name: "style", type: "textbox" }, { type: "form", padding: 0, formItemDefaults: { layout: "grid", alignH: ["start", "right"] }, defaults: { size: 7 }, items: [{ label: "Border style", type: "listbox", name: "borderStyle", width: 90, onselect: y.curry(ha, n), values: [{ text: "Select...", value: "" }, { text: "Solid", value: "solid" }, { text: "Dotted", value: "dotted" }, { text: "Dashed", value: "dashed" }, { text: "Double", value: "double" }, { text: "Groove", value: "groove" }, { text: "Ridge", value: "ridge" }, { text: "Inset", value: "inset" }, { text: "Outset", value: "outset" }, { text: "None", value: "none" }, { text: "Hidden", value: "hidden" }] }, { label: "Border color", type: "colorbox", name: "borderColor", onaction: e() }, { label: "Background color", type: "colorbox", name: "backgroundColor", onaction: e() }] }] } }, buildListItems: function (e, r, t) { var o = function (e, n) { return n = n || [], ga.each(e, function (e) { var t = { text: e.text || e.title }; e.menu ? t.menu = o(e.menu) : (t.value = e.value, r && r(t)), n.push(t) }), n }; return o(e, t || []) }, updateStyleField: ha, extractAdvancedStyles: function (e, t) { var n = e.parseStyle(e.getAttrib(t, "style")), r = {}; return n["border-style"] && (r.borderStyle = n["border-style"]), n["border-color"] && (r.borderColor = n["border-color"]), n["background-color"] && (r.backgroundColor = n["background-color"]), r.style = e.serializeStyle(n), r } }, ba = function (r, o, e) { var i, u = r.dom; function a(e, t, n) { n && u.setAttrib(e, t, n) } function c(e, t, n) { n && u.setStyle(e, t, n) } va.updateStyleField(r, e), i = e.control.rootControl.toJSON(), r.undoManager.transact(function () { ga.each(o, function (e) { var t, n; a(e, "scope", i.scope), 1 === o.length ? a(e, "style", i.style) : (t = e, n = i.style, delete t.dataset.mceStyle, t.style.cssText += ";" + n), a(e, "class", i["class"]), c(e, "width", Gu.addSizeSuffix(i.width)), c(e, "height", Gu.addSizeSuffix(i.height)), i.type && e.nodeName.toLowerCase() !== i.type && (e = u.rename(e, i.type)), 1 === o.length && (pa.unApplyAlign(r, e), pa.unApplyVAlign(r, e)), i.align && pa.applyAlign(r, e, i.align), i.valign && pa.applyVAlign(r, e, i.valign) }), r.focus() }) }, wa = function (t) { var e, n, r, o = []; if (o = t.dom.select("td[data-mce-selected],th[data-mce-selected]"), e = t.dom.getParent(t.selection.getStart(), "td,th"), !o.length && e && o.push(e), e = e || o[0]) { var i, u, a, c; 1 < o.length ? n = { width: "", height: "", scope: "", "class": "", align: "", valign: "", style: "", type: e.nodeName.toLowerCase() } : (u = e, a = (i = t).dom, c = { width: a.getStyle(u, "width") || a.getAttrib(u, "width"), height: a.getStyle(u, "height") || a.getAttrib(u, "height"), scope: a.getAttrib(u, "scope"), "class": a.getAttrib(u, "class"), type: u.nodeName.toLowerCase(), style: "", align: "", valign: "" }, ga.each("left center right".split(" "), function (e) { i.formatter.matchNode(u, "align" + e) && (c.align = e) }), ga.each("top middle bottom".split(" "), function (e) { i.formatter.matchNode(u, "valign" + e) && (c.valign = e) }), na(i) && ga.extend(c, va.extractAdvancedStyles(a, u)), n = c), 0 < ua(t).length && (r = { name: "class", type: "listbox", label: "Class", values: va.buildListItems(ua(t), function (e) { e.value && (e.textStyle = function () { return t.formatter.getCssText({ block: "td", classes: [e.value] }) }) }) }); var l = { type: "form", layout: "flex", direction: "column", labelGapCalc: "children", padding: 0, items: [{ type: "form", layout: "grid", columns: 2, labelGapCalc: !1, padding: 0, defaults: { type: "textbox", maxWidth: 50 }, items: [{ label: "Width", name: "width", onchange: y.curry(va.updateStyleField, t) }, { label: "Height", name: "height", onchange: y.curry(va.updateStyleField, t) }, { label: "Cell type", name: "type", type: "listbox", text: "None", minWidth: 90, maxWidth: null, values: [{ text: "Cell", value: "td" }, { text: "Header cell", value: "th" }] }, { label: "Scope", name: "scope", type: "listbox", text: "None", minWidth: 90, maxWidth: null, values: [{ text: "None", value: "" }, { text: "Row", value: "row" }, { text: "Column", value: "col" }, { text: "Row group", value: "rowgroup" }, { text: "Column group", value: "colgroup" }] }, { label: "H Align", name: "align", type: "listbox", text: "None", minWidth: 90, maxWidth: null, values: [{ text: "None", value: "" }, { text: "Left", value: "left" }, { text: "Center", value: "center" }, { text: "Right", value: "right" }] }, { label: "V Align", name: "valign", type: "listbox", text: "None", minWidth: 90, maxWidth: null, values: [{ text: "None", value: "" }, { text: "Top", value: "top" }, { text: "Middle", value: "middle" }, { text: "Bottom", value: "bottom" }] }] }, r] }; na(t) ? t.windowManager.open({ title: "Cell properties", bodyType: "tabpanel", data: n, body: [{ title: "General", type: "form", items: l }, va.createStyleForm(t)], onsubmit: y.curry(ba, t, o) }) : t.windowManager.open({ title: "Cell properties", data: n, body: l, onsubmit: y.curry(ba, t, o) }) } }, ya = function (e, t, n) { var r = e.getParent(t, "table"), o = t.parentNode, i = e.select(n, r)[0]; i || (i = e.create(n), r.firstChild ? "CAPTION" === r.firstChild.nodeName ? e.insertAfter(i, r.firstChild) : r.insertBefore(i, r.firstChild) : r.appendChild(i)), i.appendChild(t), o.hasChildNodes() || e.remove(o) }; function xa(o, e, i, t) { var u = o.dom; function a(e, t, n) { n && u.setAttrib(e, t, n) } va.updateStyleField(o, t); var c = t.control.rootControl.toJSON(); o.undoManager.transact(function () { ga.each(e, function (e) { var t, n, r; a(e, "scope", c.scope), a(e, "style", c.style), a(e, "class", c["class"]), t = e, n = "height", (r = Gu.addSizeSuffix(c.height)) && u.setStyle(t, n, r), c.type !== e.parentNode.nodeName.toLowerCase() && ya(o.dom, e, c.type), c.align !== i.align && (pa.unApplyAlign(o, e), pa.applyAlign(o, e, c.align)) }), o.focus() }) } var Sa = function (t) { var e, n, r, o, i, u, a, c, l, s, f = t.dom, d = []; e = f.getParent(t.selection.getStart(), "table"), n = f.getParent(t.selection.getStart(), "td,th"), ga.each(e.rows, function (t) { ga.each(t.cells, function (e) { if (f.getAttrib(e, "data-mce-selected") || e === n) return d.push(t), !1 }) }), (r = d[0]) && (1 < d.length ? i = { height: "", scope: "", style: "", "class": "", align: "", type: r.parentNode.nodeName.toLowerCase() } : (c = r, l = (a = t).dom, s = { height: l.getStyle(c, "height") || l.getAttrib(c, "height"), scope: l.getAttrib(c, "scope"), "class": l.getAttrib(c, "class"), align: "", style: "", type: c.parentNode.nodeName.toLowerCase() }, ga.each("left center right".split(" "), function (e) { a.formatter.matchNode(c, "align" + e) && (s.align = e) }), ra(a) && ga.extend(s, va.extractAdvancedStyles(l, c)), i = s), 0 < aa(t).length && (o = { name: "class", type: "listbox", label: "Class", values: va.buildListItems(aa(t), function (e) { e.value && (e.textStyle = function () { return t.formatter.getCssText({ block: "tr", classes: [e.value] }) }) }) }), u = { type: "form", columns: 2, padding: 0, defaults: { type: "textbox" }, items: [{ type: "listbox", name: "type", label: "Row type", text: "Header", maxWidth: null, values: [{ text: "Header", value: "thead" }, { text: "Body", value: "tbody" }, { text: "Footer", value: "tfoot" }] }, { type: "listbox", name: "align", label: "Alignment", text: "None", maxWidth: null, values: [{ text: "None", value: "" }, { text: "Left", value: "left" }, { text: "Center", value: "center" }, { text: "Right", value: "right" }] }, { label: "Height", name: "height" }, o] }, ra(t) ? t.windowManager.open({ title: "Row properties", data: i, bodyType: "tabpanel", body: [{ title: "General", type: "form", items: u }, va.createStyleForm(t)], onsubmit: y.curry(xa, t, d, i) }) : t.windowManager.open({ title: "Row properties", data: i, body: u, onsubmit: y.curry(xa, t, d, i) })) }, Ca = tinymce.util.Tools.resolve("tinymce.Env"), Ra = { styles: { "border-collapse": "collapse", width: "100%" }, attributes: { border: "1" }, percentages: !0 }, Ta = function (e, t, n, r, o) { void 0 === o && (o = Ra); var i = Y.fromTag("table"); Zt.setAll(i, o.styles), vt.setAll(i, o.attributes); var u = Y.fromTag("tbody"); nn.append(i, u); for (var a = [], c = 0; c < e; c++) { for (var l = Y.fromTag("tr"), s = 0; s < t; s++) { var f = c < n || s < r ? Y.fromTag("th") : Y.fromTag("td"); s < r && vt.set(f, "scope", "row"), c < n && vt.set(f, "scope", "col"), nn.append(f, Y.fromTag("br")), o.percentages && Zt.set(f, "width", 100 / t + "%"), nn.append(l, f) } a.push(l) } return rn.append(u, a), i }, Aa = function (e) { return e.dom().innerHTML }, Da = function (e) { var t = Y.fromTag("div"), n = Y.fromDom(e.dom().cloneNode(!0)); return nn.append(t, n), Aa(t) }, ka = function (e, t) { e.selection.select(t.dom(), !0), e.selection.collapse(!0) }, Na = function (i, e, t) { var n, r, o = i.getParam("table_default_styles", Zu, "object"), u = { styles: o, attributes: (r = i, r.getParam("table_default_attributes", ea, "object")), percentages: (n = o.width, g.isString(n) && -1 !== n.indexOf("%") && !la(i)) }, a = Ta(t, e, 0, 0, u); vt.set(a, "data-mce-id", "__mce"); var c = Da(a); return i.insertContent(c), Wt.descendant(Gu.getBody(i), 'table[data-mce-id="__mce"]').map(function (e) { var t, n, r, o; return la(i) && Zt.set(e, "width", Zt.get(e, "width")), vt.remove(e, "data-mce-id"), t = i, n = e, E.each(Ct.descendants(n, "tr"), function (e) { sa(t, e.dom()), E.each(Ct.descendants(e, "th,td"), function (e) { fa(t, e.dom()) }) }), r = i, o = e, Wt.descendant(o, "td,th").each(y.curry(ka, r)), e.dom() }).getOr(null) }; function Ea(e, t, n, r) { if ("TD" === t.tagName || "TH" === t.tagName) e.setStyle(t, n, r); else if (t.children) for (var o = 0; o < t.children.length; o++)Ea(e, t.children[o], n, r) } var Oa = function (e, t, n) { var r, o, i = e.dom; va.updateStyleField(e, n), !1 === (o = n.control.rootControl.toJSON())["class"] && delete o["class"], e.undoManager.transact(function () { t || (t = Na(e, o.cols || 1, o.rows || 1)), function (e, t, n) { var r = e.dom, o = {}, i = {}; if (o["class"] = n["class"], i.height = Gu.addSizeSuffix(n.height), r.getAttrib(t, "width") && !ia(e) ? o.width = Gu.removePxSuffix(n.width) : i.width = Gu.addSizeSuffix(n.width), ia(e) ? (i["border-width"] = Gu.addSizeSuffix(n.border), i["border-spacing"] = Gu.addSizeSuffix(n.cellspacing), ga.extend(o, { "data-mce-border-color": n.borderColor, "data-mce-cell-padding": n.cellpadding, "data-mce-border": n.border })) : ga.extend(o, { border: n.border, cellpadding: n.cellpadding, cellspacing: n.cellspacing }), ia(e) && t.children) for (var u = 0; u < t.children.length; u++)Ea(r, t.children[u], { "border-width": Gu.addSizeSuffix(n.border), "border-color": n.borderColor, padding: Gu.addSizeSuffix(n.cellpadding) }); n.style ? ga.extend(i, r.parseStyle(n.style)) : i = ga.extend({}, r.parseStyle(r.getAttrib(t, "style")), i), o.style = r.serializeStyle(i), r.setAttribs(t, o) }(e, t, o), (r = i.select("caption", t)[0]) && !o.caption && i.remove(r), !r && o.caption && ((r = i.create("caption")).innerHTML = Ca.ie ? "\xa0" : '<br data-mce-bogus="1"/>', t.insertBefore(r, t.firstChild)), pa.unApplyAlign(e, t), o.align && pa.applyAlign(e, t, o.align), e.focus(), e.addVisual() }) }, Ba = function (t, e) { var n, r, o, i, u, a, c, l, s, f, d = t.dom, m = {}; !0 === e ? (n = d.getParent(t.selection.getStart(), "table")) && (c = n, l = (a = t).dom, s = { width: l.getStyle(c, "width") || l.getAttrib(c, "width"), height: l.getStyle(c, "height") || l.getAttrib(c, "height"), cellspacing: l.getStyle(c, "border-spacing") || l.getAttrib(c, "cellspacing"), cellpadding: l.getAttrib(c, "data-mce-cell-padding") || l.getAttrib(c, "cellpadding") || pa.getTDTHOverallStyle(a.dom, c, "padding"), border: l.getAttrib(c, "data-mce-border") || l.getAttrib(c, "border") || pa.getTDTHOverallStyle(a.dom, c, "border"), borderColor: l.getAttrib(c, "data-mce-border-color"), caption: !!l.select("caption", c)[0], "class": l.getAttrib(c, "class") }, ga.each("left center right".split(" "), function (e) { a.formatter.matchNode(c, "align" + e) && (s.align = e) }), oa(a) && ga.extend(s, va.extractAdvancedStyles(l, c)), m = s) : (r = { label: "Cols", name: "cols" }, o = { label: "Rows", name: "rows" }), 0 < ca(t).length && (m["class"] && (m["class"] = m["class"].replace(/\s*mce\-item\-table\s*/g, "")), i = { name: "class", type: "listbox", label: "Class", values: va.buildListItems(ca(t), function (e) { e.value && (e.textStyle = function () { return t.formatter.getCssText({ block: "table", classes: [e.value] }) }) }) }), u = { type: "form", layout: "flex", direction: "column", labelGapCalc: "children", padding: 0, items: [{ type: "form", labelGapCalc: !1, padding: 0, layout: "grid", columns: 2, defaults: { type: "textbox", maxWidth: 50 }, items: (f = t, f.getParam("table_appearance_options", !0, "boolean") ? [r, o, { label: "Width", name: "width", onchange: y.curry(va.updateStyleField, t) }, { label: "Height", name: "height", onchange: y.curry(va.updateStyleField, t) }, { label: "Cell spacing", name: "cellspacing" }, { label: "Cell padding", name: "cellpadding" }, { label: "Border", name: "border" }, { label: "Caption", name: "caption", type: "checkbox" }] : [r, o, { label: "Width", name: "width", onchange: y.curry(va.updateStyleField, t) }, { label: "Height", name: "height", onchange: y.curry(va.updateStyleField, t) }]) }, { label: "Alignment", name: "align", type: "listbox", text: "None", values: [{ text: "None", value: "" }, { text: "Left", value: "left" }, { text: "Center", value: "center" }, { text: "Right", value: "right" }] }, i] }, oa(t) ? t.windowManager.open({ title: "Table properties", data: m, bodyType: "tabpanel", body: [{ title: "General", type: "form", items: u }, va.createStyleForm(t)], onsubmit: y.curry(Oa, t, n) }) : t.windowManager.open({ title: "Table properties", data: m, body: u, onsubmit: y.curry(Oa, t, n) }) }, Pa = ga.each, Ia = { registerCommands: function (a, t, c, l, n) { var r = Gu.getIsRoot(a), s = function () { return Y.fromDom(a.dom.getParent(a.selection.getStart(), "th,td")) }, f = function (e) { return zt.table(e, r) }, o = function (n) { var r = s(); f(r).each(function (t) { var e = Sr.forMenu(l, t, r); n(t, e).each(function (e) { a.selection.setRng(e), a.focus(), c.clear(t) }) }) }, i = function (e) { var o = s(); return f(o).bind(function (e) { var t = Y.fromDom(a.getDoc()), n = Sr.forMenu(l, e, o), r = Dn(y.noop, t, x.none()); return ma(e, n, r) }) }, u = function (u) { n.get().each(function (e) { var o = E.map(e, function (e) { return mn(e) }), i = s(); f(i).bind(function (t) { var e = Y.fromDom(a.getDoc()), n = kn(e), r = Sr.pasteRows(l, t, i, o, n); u(t, r).each(function (e) { a.selection.setRng(e), a.focus(), c.clear(t) }) }) }) }; Pa({ mceTableSplitCells: function () { o(t.unmergeCells) }, mceTableMergeCells: function () { o(t.mergeCells) }, mceTableInsertRowBefore: function () { o(t.insertRowsBefore) }, mceTableInsertRowAfter: function () { o(t.insertRowsAfter) }, mceTableInsertColBefore: function () { o(t.insertColumnsBefore) }, mceTableInsertColAfter: function () { o(t.insertColumnsAfter) }, mceTableDeleteCol: function () { o(t.deleteColumn) }, mceTableDeleteRow: function () { o(t.deleteRow) }, mceTableCutRow: function (e) { n.set(i()), o(t.deleteRow) }, mceTableCopyRow: function (e) { n.set(i()) }, mceTablePasteRowBefore: function (e) { u(t.pasteRowsBefore) }, mceTablePasteRowAfter: function (e) { u(t.pasteRowsAfter) }, mceTableDelete: function () { var e = Y.fromDom(a.dom.getParent(a.selection.getStart(), "th,td")); zt.table(e, r).filter(y.not(r)).each(function (e) { var t = Y.fromText(""); nn.after(e, t), un.remove(e); var n = a.dom.createRng(); n.setStart(t.dom(), 0), n.setEnd(t.dom(), 0), a.selection.setRng(n) }) } }, function (e, t) { a.addCommand(t, e) }), Pa({ mceInsertTable: y.curry(Ba, a), mceTableProps: y.curry(Ba, a, !0), mceTableRowProps: y.curry(Sa, a), mceTableCellProps: y.curry(wa, a) }, function (n, e) { a.addCommand(e, function (e, t) { n(t) }) }) } }, Wa = function (e) { var t = x.from(e.dom().documentElement).map(Y.fromDom).getOr(e); return { parent: y.constant(t), view: y.constant(e), origin: y.constant(Xr(0, 0)) } }, Ma = function (e, t) { return { parent: y.constant(t), view: y.constant(e), origin: y.constant(Xr(0, 0)) } }; function La(e) { var n = F.immutable.apply(null, e), r = []; return { bind: function (e) { if (e === undefined) throw "Event bind error: undefined handler"; r.push(e) }, unbind: function (t) { r = E.filter(r, function (e) { return e !== t }) }, trigger: function () { var t = n.apply(null, arguments); E.each(r, function (e) { e(t) }) } } } var qa = { create: function (e) { return { registry: M.map(e, function (e) { return { bind: e.bind, unbind: e.unbind } }), trigger: M.map(e, function (e) { return e.trigger }) } } }, Fa = { mode: ho.exactly(["compare", "extract", "mutate", "sink"]), sink: ho.exactly(["element", "start", "stop", "destroy"]), api: ho.exactly(["forceDrop", "drop", "move", "delayDrop"]) }, ja = { resolve: ri("ephox-dragster").resolve }, za = function (m, g) { return function (e) { if (m(e)) { var t, n, r, o, i, u, a, c = Y.fromDom(e.target), l = function () { e.stopPropagation() }, s = function () { e.preventDefault() }, f = y.compose(s, l), d = (t = c, n = e.clientX, r = e.clientY, o = l, i = s, u = f, a = e, { target: y.constant(t), x: y.constant(n), y: y.constant(r), stop: o, prevent: i, kill: u, raw: y.constant(a) }); g(d) } } }, _a = function (e, t, n, r, o) { var i = za(n, r); return e.dom().addEventListener(t, i, o), { unbind: y.curry(Ha, e, t, i, o) } }, Ha = function (e, t, n, r) { e.dom().removeEventListener(t, n, r) }, Va = function (e, t, n, r) { return _a(e, t, n, r, !1) }, Ua = function (e, t, n, r) { return _a(e, t, n, r, !0) }, Ga = y.constant(!0), Xa = { bind: function (e, t, n) { return Va(e, t, Ga, n) }, capture: function (e, t, n) { return Ua(e, t, Ga, n) } }, Ya = Fa.mode({ compare: function (e, t) { return Xr(t.left() - e.left(), t.top() - e.top()) }, extract: function (e) { return x.some(Xr(e.x(), e.y())) }, sink: function (e, t) { var n, r, o, i = (n = t, r = Mo.merge({ layerClass: ja.resolve("blocker") }, n), o = Y.fromTag("div"), vt.set(o, "role", "presentation"), Zt.setAll(o, { position: "fixed", left: "0px", top: "0px", width: "100%", height: "100%" }), bi.add(o, ja.resolve("blocker")), bi.add(o, r.layerClass), { element: function () { return o }, destroy: function () { un.remove(o) } }), u = Xa.bind(i.element(), "mousedown", e.forceDrop), a = Xa.bind(i.element(), "mouseup", e.drop), c = Xa.bind(i.element(), "mousemove", e.move), l = Xa.bind(i.element(), "mouseout", e.delayDrop); return Fa.sink({ element: i.element, start: function (e) { nn.append(e, i.element()) }, stop: function () { un.remove(i.element()) }, destroy: function () { i.destroy(), a.unbind(), c.unbind(), l.unbind(), u.unbind() } }) }, mutate: function (e, t) { e.mutate(t.left(), t.top()) } }); function Ka() { var i = x.none(), u = qa.create({ move: La(["info"]) }); return { onEvent: function (e, o) { o.extract(e).each(function (e) { var t, n, r; (t = o, n = e, r = i.map(function (e) { return t.compare(e, n) }), i = x.some(n), r).each(function (e) { u.trigger.move(e) }) }) }, reset: function () { i = x.none() }, events: u.registry } } function $a() { var e = { onEvent: function (e, t) { }, reset: y.noop }, t = Ka(), n = e; return { on: function () { n.reset(), n = t }, off: function () { n.reset(), n = e }, isOn: function () { return n === t }, onEvent: function (e, t) { n.onEvent(e, t) }, events: t.events } } var Ja = function (t, n) { var r = null; return { cancel: function () { null !== r && (clearTimeout(r), r = null) }, throttle: function () { var e = arguments; null !== r && clearTimeout(r), r = setTimeout(function () { t.apply(null, e), e = r = null }, n) } } }, Qa = function (t, n, e) { var r = !1, o = qa.create({ start: La([]), stop: La([]) }), i = $a(), u = function () { l.stop(), i.isOn() && (i.off(), o.trigger.stop()) }, a = Ja(u, 200); i.events.move.bind(function (e) { n.mutate(t, e.info()) }); var c = function (t) { return function () { var e = Array.prototype.slice.call(arguments, 0); if (r) return t.apply(null, e) } }, l = n.sink(Fa.api({ forceDrop: u, drop: c(u), move: c(function (e, t) { a.cancel(), i.onEvent(e, n) }), delayDrop: c(a.throttle) }), e); return { element: l.element, go: function (e) { l.start(e), i.on(), o.trigger.start() }, on: function () { r = !0 }, off: function () { r = !1 }, destroy: function () { l.destroy() }, events: o.registry } }, Za = { transform: function (e, t) { var n = t !== undefined ? t : {}, r = n.mode !== undefined ? n.mode : Ya; return Qa(e, r, t) } }; function ec() { var n, r = qa.create({ drag: La(["xDelta", "yDelta", "target"]) }), o = x.none(), e = { mutate: function (e, t) { n.trigger.drag(e, t) }, events: (n = qa.create({ drag: La(["xDelta", "yDelta"]) })).registry }; return e.events.drag.bind(function (t) { o.each(function (e) { r.trigger.drag(t.xDelta(), t.yDelta(), e) }) }), { assign: function (e) { o = x.some(e) }, get: function () { return o }, mutate: e.mutate, events: r.registry } } var tc = { any: function (e) { return Wt.first(e).isSome() }, ancestor: function (e, t, n) { return Wt.ancestor(e, t, n).isSome() }, sibling: function (e, t) { return Wt.sibling(e, t).isSome() }, child: function (e, t) { return Wt.child(e, t).isSome() }, descendant: function (e, t) { return Wt.descendant(e, t).isSome() }, closest: function (e, t, n) { return Wt.closest(e, t, n).isSome() } }, nc = oi.resolve("resizer-bar-dragging"); function rc(e, n) { var r = ao.height, t = function (o, t, i) { var n = ec(), r = Za.transform(n, {}), u = x.none(), e = function (e, t) { return x.from(vt.get(e, t)) }; n.events.drag.bind(function (n) { e(n.target(), "data-row").each(function (e) { var t = vu.getInt(n.target(), "top"); Zt.set(n.target(), "top", t + n.yDelta() + "px") }), e(n.target(), "data-column").each(function (e) { var t = vu.getInt(n.target(), "left"); Zt.set(n.target(), "left", t + n.xDelta() + "px") }) }); var a = function (e, t) { return vu.getInt(e, t) - parseInt(vt.get(e, "data-initial-" + t), 10) }; r.events.stop.bind(function () { n.get().each(function (r) { u.each(function (n) { e(r, "data-row").each(function (e) { var t = a(r, "top"); vt.remove(r, "data-initial-top"), d.trigger.adjustHeight(n, t, parseInt(e, 10)) }), e(r, "data-column").each(function (e) { var t = a(r, "left"); vt.remove(r, "data-initial-left"), d.trigger.adjustWidth(n, t, parseInt(e, 10)) }), Ai.refresh(o, n, i, t) }) }) }); var c = function (e, t) { d.trigger.startAdjust(), n.assign(e), vt.set(e, "data-initial-" + t, parseInt(Zt.get(e, t), 10)), bi.add(e, nc), Zt.set(e, "opacity", "0.2"), r.go(o.parent()) }, l = Xa.bind(o.parent(), "mousedown", function (e) { Ai.isRowBar(e.target()) && c(e.target(), "top"), Ai.isColBar(e.target()) && c(e.target(), "left") }), s = function (e) { return Ke.eq(e, o.view()) }, f = Xa.bind(o.view(), "mouseover", function (e) { "table" === dt.name(e.target()) || tc.closest(e.target(), "table", s) ? (u = "table" === dt.name(e.target()) ? x.some(e.target()) : Wt.ancestor(e.target(), "table", s)).each(function (e) { Ai.refresh(o, e, i, t) }) : yt.inBody(e.target()) && Ai.destroy(o) }), d = qa.create({ adjustHeight: La(["table", "delta", "row"]), adjustWidth: La(["table", "delta", "column"]), startAdjust: La([]) }); return { destroy: function () { l.unbind(), f.unbind(), r.destroy(), Ai.destroy(o) }, refresh: function (e) { Ai.refresh(o, e, i, t) }, on: r.on, off: r.off, hideBars: y.curry(Ai.hide, o), showBars: y.curry(Ai.show, o), events: d.registry } }(e, n, r), o = qa.create({ beforeResize: La(["table"]), afterResize: La(["table"]), startDrag: La([]) }); return t.events.adjustHeight.bind(function (e) { o.trigger.beforeResize(e.table()); var t = r.delta(e.delta(), e.table()); Iu.adjustHeight(e.table(), t, e.row(), r), o.trigger.afterResize(e.table()) }), t.events.startAdjust.bind(function (e) { o.trigger.startDrag() }), t.events.adjustWidth.bind(function (e) { o.trigger.beforeResize(e.table()); var t = n.delta(e.delta(), e.table()); Iu.adjustWidth(e.table(), t, e.column(), n), o.trigger.afterResize(e.table()) }), { on: t.on, off: t.off, hideBars: t.hideBars, showBars: t.showBars, destroy: t.destroy, events: o.registry } } var oc = function (e, t) { return e.inline ? Ma(Gu.getBody(e), (n = Y.fromTag("div"), Zt.setAll(n, { position: "static", height: "0", width: "0", padding: "0", margin: "0", border: "0" }), nn.append(yt.body(), n), n)) : Wa(Y.fromDom(e.getDoc())); var n }, ic = function (e, t) { e.inline && un.remove(t.parent()) }, uc = function (u) { var a, c, o = x.none(), i = x.none(), l = x.none(), s = /(\d+(\.\d+)?)%/, f = function (e) { return "TABLE" === e.nodeName }; return u.on("init", function () { var e, t = lo(Ju.directionAt), n = oc(u); if (l = x.some(n), ("table" === (e = u.getParam("object_resizing", !0)) || e) && u.getParam("table_resize_bars", !0, "boolean")) { var r = rc(n, t); r.on(), r.events.startDrag.bind(function (e) { o = x.some(u.selection.getRng()) }), r.events.afterResize.bind(function (e) { var t = e.table(), n = Ct.descendants(t, "td[data-mce-style],th[data-mce-style]"); E.each(n, function (e) { vt.remove(e, "data-mce-style") }), o.each(function (e) { u.selection.setRng(e), u.focus() }), u.undoManager.add() }), i = x.some(r) } }), u.on("ObjectResizeStart", function (e) { var t, n = e.target; f(n) && (a = e.width, t = n, c = u.dom.getStyle(t, "width") || u.dom.getAttrib(t, "width")) }), u.on("ObjectResized", function (e) { var t = e.target; if (f(t)) { var n = t; if (s.test(c)) { var r = parseFloat(s.exec(c)[1]), o = e.width * r / a; u.dom.setStyle(n, "width", o + "%") } else { var i = []; ga.each(n.rows, function (e) { ga.each(e.cells, function (e) { var t = u.dom.getStyle(e, "width", !0); i.push({ cell: e, width: t }) }) }), ga.each(i, function (e) { u.dom.setStyle(e.cell, "width", e.width), u.dom.setAttrib(e.cell, "width", null) }) } } }), { lazyResize: function () { return i }, lazyWire: function () { return l.getOr(Wa(Y.fromDom(u.getBody()))) }, destroy: function () { i.each(function (e) { e.destroy() }), l.each(function (e) { ic(u, e) }) } } }, ac = function (e) { return { fold: e } }, cc = function (o) { return ac(function (e, t, n, r) { return e(o) }) }, lc = function (o) { return ac(function (e, t, n, r) { return t(o) }) }, sc = function (o, i) { return ac(function (e, t, n, r) { return n(o, i) }) }, fc = function (o) { return ac(function (e, t, n, r) { return r(o) }) }, dc = function (n, e) { return zt.table(n, e).bind(function (e) { var t = zt.cells(e); return E.findIndex(t, function (e) { return Ke.eq(n, e) }).map(function (e) { return { index: y.constant(e), all: y.constant(t) } }) }) }, mc = function (t, e) { return dc(t, e).fold(function () { return cc(t) }, function (e) { return e.index() + 1 < e.all().length ? sc(t, e.all()[e.index() + 1]) : fc(t) }) }, gc = function (t, e) { return dc(t, e).fold(function () { return cc() }, function (e) { return 0 <= e.index() - 1 ? sc(t, e.all()[e.index() - 1]) : lc(t) }) }, pc = mr([{ before: ["element"] }, { on: ["element", "offset"] }, { after: ["element"] }]), hc = { before: pc.before, on: pc.on, after: pc.after, cata: function (e, t, n, r) { return e.fold(t, n, r) }, getStart: function (e) { return e.fold(y.identity, y.identity, y.identity) } }, vc = mr([{ domRange: ["rng"] }, { relative: ["startSitu", "finishSitu"] }, { exact: ["start", "soffset", "finish", "foffset"] }]), bc = F.immutable("start", "soffset", "finish", "foffset"), wc = { domRange: vc.domRange, relative: vc.relative, exact: vc.exact, exactFromRange: function (e) { return vc.exact(e.start(), e.soffset(), e.finish(), e.foffset()) }, range: bc, getWin: function (e) { var t = e.match({ domRange: function (e) { return Y.fromDom(e.startContainer) }, relative: function (e, t) { return hc.getStart(e) }, exact: function (e, t, n, r) { return e } }); return rt.defaultView(t) } }, yc = function (e, t, n, r) { var o = rt.owner(e).dom().createRange(); return o.setStart(e.dom(), t), o.setEnd(n.dom(), r), o }, xc = function (e, t, n, r) { var o = yc(e, t, n, r), i = Ke.eq(e, n) && t === r; return o.collapsed && !i }, Sc = function (e, t) { var n = (t || document).createDocumentFragment(); return E.each(e, function (e) { n.appendChild(e.dom()) }), Y.fromDom(n) }, Cc = function (e, t) { e.selectNodeContents(t.dom()) }, Rc = function (e) { e.deleteContents() }, Tc = function (e) { return { left: y.constant(e.left), top: y.constant(e.top), right: y.constant(e.right), bottom: y.constant(e.bottom), width: y.constant(e.width), height: y.constant(e.height) } }, Ac = { create: function (e) { return e.document.createRange() }, replaceWith: function (e, t) { Rc(e), e.insertNode(t.dom()) }, selectNodeContents: function (e, t) { var n = e.document.createRange(); return Cc(n, t), n }, selectNodeContentsUsing: Cc, relativeToNative: function (e, t, n) { var r, o, i = e.document.createRange(); return r = i, t.fold(function (e) { r.setStartBefore(e.dom()) }, function (e, t) { r.setStart(e.dom(), t) }, function (e) { r.setStartAfter(e.dom()) }), o = i, n.fold(function (e) { o.setEndBefore(e.dom()) }, function (e, t) { o.setEnd(e.dom(), t) }, function (e) { o.setEndAfter(e.dom()) }), i }, exactToNative: function (e, t, n, r, o) { var i = e.document.createRange(); return i.setStart(t.dom(), n), i.setEnd(r.dom(), o), i }, deleteContents: Rc, cloneFragment: function (e) { var t = e.cloneContents(); return Y.fromDom(t) }, getFirstRect: function (e) { var t = e.getClientRects(), n = 0 < t.length ? t[0] : e.getBoundingClientRect(); return 0 < n.width || 0 < n.height ? x.some(n).map(Tc) : x.none() }, getBounds: function (e) { var t = e.getBoundingClientRect(); return 0 < t.width || 0 < t.height ? x.some(t).map(Tc) : x.none() }, isWithin: function (e, t) { return t.compareBoundaryPoints(e.END_TO_START, e) < 1 && -1 < t.compareBoundaryPoints(e.START_TO_END, e) }, toString: function (e) { return e.toString() } }, Dc = mr([{ ltr: ["start", "soffset", "finish", "foffset"] }, { rtl: ["start", "soffset", "finish", "foffset"] }]), kc = function (e, t, n) { return t(Y.fromDom(n.startContainer), n.startOffset, Y.fromDom(n.endContainer), n.endOffset) }, Nc = function (e, t) { var o, n, r, i = (o = e, t.match({ domRange: function (e) { return { ltr: y.constant(e), rtl: x.none } }, relative: function (e, t) { return { ltr: fe(function () { return Ac.relativeToNative(o, e, t) }), rtl: fe(function () { return x.some(Ac.relativeToNative(o, t, e)) }) } }, exact: function (e, t, n, r) { return { ltr: fe(function () { return Ac.exactToNative(o, e, t, n, r) }), rtl: fe(function () { return x.some(Ac.exactToNative(o, n, r, e, t)) }) } } })); return (r = (n = i).ltr()).collapsed ? n.rtl().filter(function (e) { return !1 === e.collapsed }).map(function (e) { return Dc.rtl(Y.fromDom(e.endContainer), e.endOffset, Y.fromDom(e.startContainer), e.startOffset) }).getOrThunk(function () { return kc(0, Dc.ltr, r) }) : kc(0, Dc.ltr, r) }, Ec = { ltr: Dc.ltr, rtl: Dc.rtl, diagnose: Nc, asLtrRange: function (i, e) { return Nc(i, e).match({ ltr: function (e, t, n, r) { var o = i.document.createRange(); return o.setStart(e.dom(), t), o.setEnd(n.dom(), r), o }, rtl: function (e, t, n, r) { var o = i.document.createRange(); return o.setStart(n.dom(), r), o.setEnd(e.dom(), t), o } }) } }, Oc = function (e, t, n) { return t >= e.left && t <= e.right && n >= e.top && n <= e.bottom }, Bc = function (e, t, n, r, o) { if (0 === o) return 0; if (t === r) return o - 1; for (var i = r, u = 1; u < o; u++) { var a = e(u), c = Math.abs(t - a.left); if (n > a.bottom); else { if (n < a.top || i < c) return u - 1; i = c } } return 0 }, Pc = { locate: function (l, s, f, d) { var e = l.dom().createRange(); e.selectNode(s.dom()); var t = e.getClientRects(); return qo(t, function (e) { return Oc(e, f, d) ? x.some(e) : x.none() }).map(function (e) { return n = l, r = s, t = f, o = d, i = e, u = function (e) { var t = n.dom().createRange(); return t.setStart(r.dom(), e), t.collapse(!0), t }, a = hn.get(r).length, c = Bc(function (e) { return u(e).getBoundingClientRect() }, t, o, i.right, a), u(c); var n, r, t, o, i, u, a, c }) } }, Ic = function (t, e, n, r) { var o = t.dom().createRange(), i = rt.children(e); return qo(i, function (e) { return o.selectNode(e.dom()), Oc(o.getBoundingClientRect(), n, r) ? Wc(t, e, n, r) : x.none() }) }, Wc = function (e, t, n, r) { return (dt.isText(t) ? Pc.locate : Ic)(e, t, n, r) }, Mc = function (e, t, n, r) { var o = e.dom().createRange(); o.selectNode(t.dom()); var i = o.getBoundingClientRect(), u = Math.max(i.left, Math.min(i.right, n)), a = Math.max(i.top, Math.min(i.bottom, r)); return Wc(e, t, u, a) }, Lc = function (e, t) { return t - e.left < e.right - t }, qc = function (e, t, n) { var r = e.dom().createRange(); return r.selectNode(t.dom()), r.collapse(n), r }, Fc = function (t, e, n) { var r = t.dom().createRange(); r.selectNode(e.dom()); var o = r.getBoundingClientRect(), i = Lc(o, n); return (!0 === i ? Sn.first : Sn.last)(e).map(function (e) { return qc(t, e, i) }) }, jc = function (e, t, n) { var r = t.dom().getBoundingClientRect(), o = Lc(r, n); return x.some(qc(e, t, o)) }, zc = function (e, t, n) { return (0 === rt.children(t).length ? jc : Fc)(e, t, n) }, _c = document.caretPositionFromPoint ? function (n, e, t) { return x.from(n.dom().caretPositionFromPoint(e, t)).bind(function (e) { if (null === e.offsetNode) return x.none(); var t = n.dom().createRange(); return t.setStart(e.offsetNode, e.offset), t.collapse(), x.some(t) }) } : document.caretRangeFromPoint ? function (e, t, n) { return x.from(e.dom().caretRangeFromPoint(t, n)) } : function (n, r, o) { return Y.fromPoint(n, r, o).bind(function (e) { var t = function () { return zc(n, e, r) }; return 0 === rt.children(e).length ? t() : function (e, t, n, r) { var o = e.dom().createRange(); o.selectNode(t.dom()); var i = o.getBoundingClientRect(), u = Math.max(i.left, Math.min(i.right, n)), a = Math.max(i.top, Math.min(i.bottom, r)); return Mc(e, t, u, a) }(n, e, r, o).orThunk(t) }) }, Hc = function (e, t, n) { var r = Y.fromDom(e.document); return _c(r, t, n).map(function (e) { return wc.range(Y.fromDom(e.startContainer), e.startOffset, Y.fromDom(e.endContainer), e.endOffset) }) }, Vc = function (e, t, n) { var r, o, i, u, a, c, l = Ec.asLtrRange(e, t), s = Y.fromDom(l.commonAncestorContainer); return dt.isElement(s) ? (r = e, o = s, i = l, u = n, a = Ac.create(r), c = (ne.is(o, u) ? [o] : []).concat(Ct.descendants(o, u)), E.filter(c, function (e) { return Ac.selectNodeContentsUsing(a, e), Ac.isWithin(i, a) })) : [] }, Uc = function (e, t) { var n = dt.name(e); return "input" === n ? hc.after(e) : E.contains(["br", "img"], n) ? 0 === t ? hc.before(e) : hc.after(e) : hc.on(e, t) }, Gc = function (e, t) { var n = e.fold(hc.before, Uc, hc.after), r = t.fold(hc.before, Uc, hc.after); return wc.relative(n, r) }, Xc = function (e, t, n, r) { var o = Uc(e, t), i = Uc(n, r); return wc.relative(o, i) }, Yc = function (e) { return e.match({ domRange: function (e) { var t = Y.fromDom(e.startContainer), n = Y.fromDom(e.endContainer); return Xc(t, e.startOffset, n, e.endOffset) }, relative: Gc, exact: Xc }) }, Kc = Gc, $c = Xc, Jc = function (e, t) { x.from(e.getSelection()).each(function (e) { e.removeAllRanges(), e.addRange(t) }) }, Qc = function (e, t, n, r, o) { var i = Ac.exactToNative(e, t, n, r, o); Jc(e, i) }, Zc = function (i, e) { return Ec.diagnose(i, e).match({ ltr: function (e, t, n, r) { Qc(i, e, t, n, r) }, rtl: function (e, t, n, r) { var o = i.getSelection(); o.setBaseAndExtent ? o.setBaseAndExtent(e.dom(), t, n.dom(), r) : o.extend ? (o.collapse(e.dom(), t), o.extend(n.dom(), r)) : Qc(i, n, r, e, t) } }) }, el = function (e) { var t = Y.fromDom(e.anchorNode), n = Y.fromDom(e.focusNode); return xc(t, e.anchorOffset, n, e.focusOffset) ? x.some(wc.range(Y.fromDom(e.anchorNode), e.anchorOffset, Y.fromDom(e.focusNode), e.focusOffset)) : function (e) { if (0 < e.rangeCount) { var t = e.getRangeAt(0), n = e.getRangeAt(e.rangeCount - 1); return x.some(wc.range(Y.fromDom(t.startContainer), t.startOffset, Y.fromDom(n.endContainer), n.endOffset)) } return x.none() }(e) }, tl = function (e) { var t = e.getSelection(); return 0 < t.rangeCount ? el(t) : x.none() }, nl = { setExact: function (e, t, n, r, o) { var i = $c(t, n, r, o); Zc(e, i) }, getExact: tl, get: function (e) { return tl(e).map(function (e) { return wc.exact(e.start(), e.soffset(), e.finish(), e.foffset()) }) }, setRelative: function (e, t, n) { var r = Kc(t, n); Zc(e, r) }, toNative: function (e) { var o = wc.getWin(e).dom(), t = function (e, t, n, r) { return Ac.exactToNative(o, e, t, n, r) }, n = Yc(e); return Ec.diagnose(o, n).match({ ltr: t, rtl: t }) }, setToElement: function (e, t) { var n = Ac.selectNodeContents(e, t); Jc(e, n) }, clear: function (e) { e.getSelection().removeAllRanges() }, clone: function (e, t) { var n = Ec.asLtrRange(e, t); return Ac.cloneFragment(n) }, replace: function (e, t, n) { var r = Ec.asLtrRange(e, t), o = Sc(n, e.document); Ac.replaceWith(r, o) }, deleteAt: function (e, t) { var n = Ec.asLtrRange(e, t); Ac.deleteContents(n) }, forElement: function (e, t) { var n = Ac.selectNodeContents(e, t); return wc.range(Y.fromDom(n.startContainer), n.startOffset, Y.fromDom(n.endContainer), n.endOffset) }, getFirstRect: function (e, t) { var n = Ec.asLtrRange(e, t); return Ac.getFirstRect(n) }, getBounds: function (e, t) { var n = Ec.asLtrRange(e, t); return Ac.getBounds(n) }, getAtPoint: function (e, t, n) { return Hc(e, t, n) }, findWithin: function (e, t, n) { return Vc(e, t, n) }, getAsString: function (e, t) { var n = Ec.asLtrRange(e, t); return Ac.toString(n) }, isCollapsed: function (e, t, n, r) { return Ke.eq(e, n) && t === r } }, rl = tinymce.util.Tools.resolve("tinymce.util.VK"), ol = function (e, t, n, r) { return al(e, t, mc(n), r) }, il = function (e, t, n, r) { return al(e, t, gc(n), r) }, ul = function (e, t) { var n = wc.exact(t, 0, t, 0); return nl.toNative(n) }, al = function (i, e, t, u, n) { return t.fold(x.none, x.none, function (e, t) { return Sn.first(t).map(function (e) { return ul(0, e) }) }, function (o) { return zt.table(o, e).bind(function (e) { var t, n, r = Sr.noMenu(o); return i.undoManager.transact(function () { u.insertRowsAfter(e, r) }), t = e, n = Ct.descendants(t, "tr"), E.last(n).bind(function (e) { return Wt.descendant(e, "td,th").map(function (e) { return ul(0, e) }) }) }) }) }, cl = ["table", "li", "dl"], ll = { handle: function (t, n, r, o) { if (t.keyCode === rl.TAB) { var i = Gu.getBody(n), u = function (e) { var t = dt.name(e); return Ke.eq(e, i) || E.contains(cl, t) }, e = n.selection.getRng(); if (e.collapsed) { var a = Y.fromDom(e.startContainer); zt.cell(a, u).each(function (e) { t.preventDefault(), (t.shiftKey ? il : ol)(n, u, e, r, o).each(function (e) { n.selection.setRng(e) }) }) } } } }, sl = { response: F.immutable("selection", "kill") }, fl = function (t) { return function (e) { return e === t } }, dl = fl(38), ml = fl(40), gl = { ltr: { isBackward: fl(37), isForward: fl(39) }, rtl: { isBackward: fl(39), isForward: fl(37) }, isUp: dl, isDown: ml, isNavigation: function (e) { return 37 <= e && e <= 40 } }, pl = { convertToRange: function (e, t) { var n = Ec.asLtrRange(e, t); return { start: y.constant(Y.fromDom(n.startContainer)), soffset: y.constant(n.startOffset), finish: y.constant(Y.fromDom(n.endContainer)), foffset: y.constant(n.endOffset) } }, makeSitus: function (e, t, n, r) { return { start: y.constant(hc.on(e, t)), finish: y.constant(hc.on(n, r)) } } }, hl = Ge.detect().browser.isSafari(), vl = function (e) { var t = e !== undefined ? e.dom() : document, n = t.body.scrollLeft || t.documentElement.scrollLeft, r = t.body.scrollTop || t.documentElement.scrollTop; return Xr(n, r) }, bl = function (e, t, n) { (n !== undefined ? n.dom() : document).defaultView.scrollTo(e, t) }, wl = function (e, t) { hl && g.isFunction(e.dom().scrollIntoViewIfNeeded) ? e.dom().scrollIntoViewIfNeeded(!1) : e.dom().scrollIntoView(t) }, yl = { get: vl, to: bl, by: function (e, t, n) { (n !== undefined ? n.dom() : document).defaultView.scrollBy(e, t) }, preserve: function (e, t) { var n = vl(e); t(); var r = vl(e); n.top() === r.top() && n.left() === r.left() || bl(n.left(), n.top(), e) }, capture: function (t) { var e = x.none(), n = function () { e = x.some(vl(t)) }; return n(), { save: n, restore: function () { e.each(function (e) { bl(e.left(), e.top(), t) }) } } }, intoView: wl, intoViewIfNeeded: function (e, t) { var n = t.dom().getBoundingClientRect(), r = e.dom().getBoundingClientRect(); r.top < n.top ? wl(e, !0) : r.bottom > n.bottom && wl(e, !1) }, setToElement: function (e, t) { var n = $r(t), r = Y.fromDom(e.document); bl(n.left(), n.top(), r) }, scrollBarWidth: function () { var e = Y.fromHtml('<div style="width: 100px; height: 100px; overflow: scroll; position: absolute; top: -9999px;"></div>'); nn.after(yt.body(), e); var t = e.dom().offsetWidth - e.dom().clientWidth; return un.remove(e), t } }; function xl(i) { return { elementFromPoint: function (e, t) { return x.from(i.document.elementFromPoint(e, t)).map(Y.fromDom) }, getRect: function (e) { return e.dom().getBoundingClientRect() }, getRangedRect: function (e, t, n, r) { var o = wc.exact(e, t, n, r); return nl.getFirstRect(i, o).map(function (e) { return M.map(e, y.apply) }) }, getSelection: function () { return nl.get(i).map(function (e) { return pl.convertToRange(i, e) }) }, fromSitus: function (e) { var t = wc.relative(e.start(), e.finish()); return pl.convertToRange(i, t) }, situsFromPoint: function (e, t) { return nl.getAtPoint(i, e, t).map(function (e) { return { start: y.constant(hc.on(e.start(), e.soffset())), finish: y.constant(hc.on(e.finish(), e.foffset())) } }) }, clearSelection: function () { nl.clear(i) }, setSelection: function (e) { nl.setExact(i, e.start(), e.soffset(), e.finish(), e.foffset()) }, setRelativeSelection: function (e, t) { nl.setRelative(i, e, t) }, selectContents: function (e) { nl.setToElement(i, e) }, getInnerHeight: function () { return i.innerHeight }, getScrollY: function () { return yl.get(Y.fromDom(i.document)).top() }, scrollBy: function (e, t) { yl.by(e, t, Y.fromDom(i.document)) } } } var Sl = function (n, e, r, t, o) { return Ke.eq(r, t) ? x.none() : ur.identify(r, t, e).bind(function (e) { var t = e.boxes().getOr([]); return 0 < t.length ? (o(n, t, e.start(), e.finish()), x.some(sl.response(x.some(pl.makeSitus(r, 0, r, wn(r))), !0))) : x.none() }) }, Cl = { sync: function (n, r, e, t, o, i, u) { return Ke.eq(e, o) && t === i ? x.none() : Wt.closest(e, "td,th", r).bind(function (t) { return Wt.closest(o, "td,th", r).bind(function (e) { return Sl(n, r, t, e, u) }) }) }, detect: Sl, update: function (e, t, n, r, o) { return ur.shiftSelection(r, e, t, o.firstSelectedSelector(), o.lastSelectedSelector()).map(function (e) { return o.clear(n), o.selectRange(n, e.boxes(), e.start(), e.finish()), e.boxes() }) } }, Rl = F.immutableBag(["left", "top", "right", "bottom"], []), Tl = { nu: Rl, moveUp: function (e, t) { return Rl({ left: e.left(), top: e.top() - t, right: e.right(), bottom: e.bottom() - t }) }, moveDown: function (e, t) { return Rl({ left: e.left(), top: e.top() + t, right: e.right(), bottom: e.bottom() + t }) }, moveBottomTo: function (e, t) { var n = e.bottom() - e.top(); return Rl({ left: e.left(), top: t - n, right: e.right(), bottom: t }) }, moveTopTo: function (e, t) { var n = e.bottom() - e.top(); return Rl({ left: e.left(), top: t, right: e.right(), bottom: t + n }) }, getTop: function (e) { return e.top() }, getBottom: function (e) { return e.bottom() }, translate: function (e, t, n) { return Rl({ left: e.left() + t, top: e.top() + n, right: e.right() + t, bottom: e.bottom() + n }) }, toString: function (e) { return "(" + e.left() + ", " + e.top() + ") -> (" + e.right() + ", " + e.bottom() + ")" } }, Al = function (e) { return Tl.nu({ left: e.left, top: e.top, right: e.right, bottom: e.bottom }) }, Dl = function (e, t) { return x.some(e.getRect(t)) }, kl = function (e, t, n) { return dt.isElement(t) ? Dl(e, t).map(Al) : dt.isText(t) ? (r = e, o = t, i = n, 0 <= i && i < wn(o) ? r.getRangedRect(o, i, o, i + 1) : 0 < i ? r.getRangedRect(o, i - 1, o, i) : x.none()).map(Al) : x.none(); var r, o, i }, Nl = function (e, t) { return dt.isElement(t) ? Dl(e, t).map(Al) : dt.isText(t) ? e.getRangedRect(t, 0, t, wn(t)).map(Al) : x.none() }, El = F.immutable("item", "mode"), Ol = function (e, t, n, r) { var o = r !== undefined ? r : Bl; return e.property().parent(t).map(function (e) { return El(e, o) }) }, Bl = function (e, t, n, r) { var o = r !== undefined ? r : Pl; return n.sibling(e, t).map(function (e) { return El(e, o) }) }, Pl = function (e, t, n, r) { var o = r !== undefined ? r : Pl, i = e.property().children(t); return n.first(i).map(function (e) { return El(e, o) }) }, Il = [{ current: Ol, next: Bl, fallback: x.none() }, { current: Bl, next: Pl, fallback: x.some(Ol) }, { current: Pl, next: Pl, fallback: x.some(Bl) }], Wl = function (t, n, r, o, e) { return e = e !== undefined ? e : Il, E.find(e, function (e) { return e.current === r }).bind(function (e) { return e.current(t, n, o, e.next).orThunk(function () { return e.fallback.bind(function (e) { return Wl(t, n, e, o) }) }) }) }, Ml = { backtrack: Ol, sidestep: Bl, advance: Pl, go: Wl }, Ll = { left: function () { return { sibling: function (e, t) { return e.query().prevSibling(t) }, first: function (e) { return 0 < e.length ? x.some(e[e.length - 1]) : x.none() } } }, right: function () { return { sibling: function (e, t) { return e.query().nextSibling(t) }, first: function (e) { return 0 < e.length ? x.some(e[0]) : x.none() } } } }, ql = function (t, e, n, r, o, i) { return Ml.go(t, e, r, o).bind(function (e) { return i(e.item()) ? x.none() : n(e.item()) ? x.some(e.item()) : ql(t, e.item(), n, e.mode(), o, i) }) }, Fl = function (e, t, n, r) { return ql(e, t, n, Ml.sidestep, Ll.left(), r) }, jl = function (e, t, n, r) { return ql(e, t, n, Ml.sidestep, Ll.right(), r) }, zl = function (e, t) { return 0 === e.property().children(t).length }, _l = function (e, t, n, r) { return Fl(e, t, n, r) }, Hl = function (e, t, n, r) { return jl(e, t, n, r) }, Vl = { before: function (e, t, n) { return _l(e, t, y.curry(zl, e), n) }, after: function (e, t, n) { return Hl(e, t, y.curry(zl, e), n) }, seekLeft: _l, seekRight: Hl, walkers: function () { return { left: Ll.left, right: Ll.right } }, walk: function (e, t, n, r, o) { return Ml.go(e, t, n, r, o) }, backtrack: Ml.backtrack, sidestep: Ml.sidestep, advance: Ml.advance }, Ul = On(), Gl = { gather: function (e, t, n) { return Vl.gather(Ul, e, t, n) }, before: function (e, t) { return Vl.before(Ul, e, t) }, after: function (e, t) { return Vl.after(Ul, e, t) }, seekLeft: function (e, t, n) { return Vl.seekLeft(Ul, e, t, n) }, seekRight: function (e, t, n) { return Vl.seekRight(Ul, e, t, n) }, walkers: function () { return Vl.walkers() }, walk: function (e, t, n, r) { return Vl.walk(Ul, e, t, n, r) } }, Xl = mr([{ none: [] }, { retry: ["caret"] }]), Yl = function (t, e, r) { return Pt.closest(e, No).fold(y.constant(!1), function (e) { return Nl(t, e).exists(function (e) { return n = e, (t = r).left() < n.left() || Math.abs(n.right() - t.left()) < 1 || t.left() > n.right(); var t, n }) }) }, Kl = { point: Tl.getTop, adjuster: function (e, t, n, r, o) { var i = Tl.moveUp(o, 5); return Math.abs(n.top() - r.top()) < 1 ? Xl.retry(i) : n.bottom() < o.top() ? Xl.retry(i) : n.bottom() === o.top() ? Xl.retry(Tl.moveUp(o, 1)) : Yl(e, t, o) ? Xl.retry(Tl.translate(i, 5, 0)) : Xl.none() }, move: Tl.moveUp, gather: Gl.before }, $l = { point: Tl.getBottom, adjuster: function (e, t, n, r, o) { var i = Tl.moveDown(o, 5); return Math.abs(n.bottom() - r.bottom()) < 1 ? Xl.retry(i) : n.top() > o.bottom() ? Xl.retry(i) : n.top() === o.bottom() ? Xl.retry(Tl.moveDown(o, 1)) : Yl(e, t, o) ? Xl.retry(Tl.translate(i, 5, 0)) : Xl.none() }, move: Tl.moveDown, gather: Gl.after }, Jl = function (n, r, o, i, u) { return 0 === u ? x.some(i) : (c = n, l = i.left(), s = r.point(i), c.elementFromPoint(l, s).filter(function (e) { return "table" === dt.name(e) }).isSome() ? (t = i, a = u - 1, Jl(n, e = r, o, e.move(t, 5), a)) : n.situsFromPoint(i.left(), r.point(i)).bind(function (e) { return e.start().fold(x.none, function (t, e) { return Nl(n, t, e).bind(function (e) { return r.adjuster(n, t, e, o, i).fold(x.none, function (e) { return Jl(n, r, o, e, u - 1) }) }).orThunk(function () { return x.some(i) }) }, x.none) })); var e, t, a, c, l, s }, Ql = function (t, n, e) { var r, o, i, u = t.move(e, 5), a = Jl(n, t, e, u, 100).getOr(u); return (r = t, o = a, i = n, r.point(o) > i.getInnerHeight() ? x.some(r.point(o) - i.getInnerHeight()) : r.point(o) < 0 ? x.some(-r.point(o)) : x.none()).fold(function () { return n.situsFromPoint(a.left(), t.point(a)) }, function (e) { return n.scrollBy(0, e), n.situsFromPoint(a.left(), t.point(a) - e) }) }, Zl = { tryUp: y.curry(Ql, Kl), tryDown: y.curry(Ql, $l), ieTryUp: function (e, t) { return e.situsFromPoint(t.left(), t.top() - 5) }, ieTryDown: function (e, t) { return e.situsFromPoint(t.left(), t.bottom() + 5) }, getJumpSize: y.constant(5) }, es = mr([{ none: ["message"] }, { success: [] }, { failedUp: ["cell"] }, { failedDown: ["cell"] }]), ts = function (e) { return Wt.closest(e, "tr") }, ns = { verify: function (a, e, t, n, r, c, o) { return Wt.closest(n, "td,th", o).bind(function (u) { return Wt.closest(e, "td,th", o).map(function (i) { return Ke.eq(u, i) ? Ke.eq(n, u) && wn(u) === r ? c(i) : es.none("in same cell") : zn(ts, [u, i]).fold(function () { return t = i, n = u, r = (e = a).getRect(t), (o = e.getRect(n)).right > r.left && o.left < r.right ? es.success() : c(i); var e, t, n, r, o }, function (e) { return c(i) }) }) }).getOr(es.none("default")) }, cata: function (e, t, n, r, o) { return e.fold(t, n, r, o) }, adt: es }, rs = { point: F.immutable("element", "offset"), delta: F.immutable("element", "deltaOffset"), range: F.immutable("element", "start", "finish"), points: F.immutable("begin", "end"), text: F.immutable("element", "text") }, os = (F.immutable("ancestor", "descendants", "element", "index"), F.immutable("parent", "children", "element", "index")), is = function (e, t) { return E.findIndex(e, y.curry(Ke.eq, t)) }, us = function (r) { return rt.parent(r).bind(function (t) { var n = rt.children(t); return is(n, r).map(function (e) { return os(t, n, r, e) }) }) }, as = function (e) { return "br" === dt.name(e) }, cs = function (e, t, n) { return t(e, n).bind(function (e) { return dt.isText(e) && 0 === hn.get(e).trim().length ? cs(e, t, n) : x.some(e) }) }, ls = function (t, e, n, r) { return (o = e, i = n, rt.child(o, i).filter(as).orThunk(function () { return rt.child(o, i - 1).filter(as) })).bind(function (e) { return r.traverse(e).fold(function () { return cs(e, r.gather, t).map(r.relative) }, function (e) { return us(e).map(function (e) { return hc.on(e.parent(), e.index()) }) }) }); var o, i }, ss = function (e, t, n, r) { var o, i, u; return (as(t) ? (o = e, i = t, (u = r).traverse(i).orThunk(function () { return cs(i, u.gather, o) }).map(u.relative)) : ls(e, t, n, r)).map(function (e) { return { start: y.constant(e), finish: y.constant(e) } }) }, fs = function (e) { return ns.cata(e, function (e) { return x.none() }, function () { return x.none() }, function (e) { return x.some(rs.point(e, 0)) }, function (e) { return x.some(rs.point(e, wn(e))) }) }, ds = Ge.detect(), ms = function (r, o, i, u, a, c) { return 0 === c ? x.none() : hs(r, o, i, u, a).bind(function (e) { var t = r.fromSitus(e), n = ns.verify(r, i, u, t.finish(), t.foffset(), a.failure, o); return ns.cata(n, function () { return x.none() }, function () { return x.some(e) }, function (e) { return Ke.eq(i, e) && 0 === u ? gs(r, i, u, Tl.moveUp, a) : ms(r, o, e, 0, a, c - 1) }, function (e) { return Ke.eq(i, e) && u === wn(e) ? gs(r, i, u, Tl.moveDown, a) : ms(r, o, e, wn(e), a, c - 1) }) }) }, gs = function (t, e, n, r, o) { return kl(t, e, n).bind(function (e) { return ps(t, o, r(e, Zl.getJumpSize())) }) }, ps = function (e, t, n) { return ds.browser.isChrome() || ds.browser.isSafari() || ds.browser.isFirefox() || ds.browser.isEdge() ? t.otherRetry(e, n) : ds.browser.isIE() ? t.ieRetry(e, n) : x.none() }, hs = function (t, e, n, r, o) { return kl(t, n, r).bind(function (e) { return ps(t, o, e) }) }, vs = function (t, n, r) { return (o = t, i = n, u = r, o.getSelection().bind(function (r) { return ss(i, r.finish(), r.foffset(), u).fold(function () { return x.some(rs.point(r.finish(), r.foffset())) }, function (e) { var t = o.fromSitus(e), n = ns.verify(o, r.finish(), r.foffset(), t.finish(), t.foffset(), u.failure, i); return fs(n) }) })).bind(function (e) { return ms(t, n, e.element(), e.offset(), r, 20).map(t.fromSitus) }); var o, i, u }, bs = function (e, t, n) { return Pt.ancestor(e, t, n).isSome() }, ws = Ge.detect(), ys = function (r, o, i, e, u) { return Wt.closest(e, "td,th", o).bind(function (n) { return Wt.closest(n, "table", o).bind(function (e) { return t = e, bs(u, function (e) { return rt.parent(e).exists(function (e) { return Ke.eq(e, t) }) }) ? vs(r, o, i).bind(function (t) { return Wt.closest(t.finish(), "td,th", o).map(function (e) { return { start: y.constant(n), finish: y.constant(e), range: y.constant(t) } }) }) : x.none(); var t }) }) }, xs = function (e, t, n, r, o, i) { return ws.browser.isIE() ? x.none() : i(r, t).orThunk(function () { return ys(e, t, n, r, o).map(function (e) { var t = e.range(); return sl.response(x.some(pl.makeSitus(t.start(), t.soffset(), t.finish(), t.foffset())), !0) }) }) }, Ss = function (e, t, n, r, o, i, u) { return ys(e, n, r, o, i).bind(function (e) { return Cl.detect(t, n, e.start(), e.finish(), u) }) }, Cs = function (e, r) { return Wt.closest(e, "tr", r).bind(function (n) { return Wt.closest(n, "table", r).bind(function (e) { var t = Ct.descendants(e, "tr"); return Ke.eq(n, t[0]) ? Gl.seekLeft(e, function (e) { return Sn.last(e).isSome() }, r).map(function (e) { var t = wn(e); return sl.response(x.some(pl.makeSitus(e, t, e, t)), !0) }) : x.none() }) }) }, Rs = function (e, r) { return Wt.closest(e, "tr", r).bind(function (n) { return Wt.closest(n, "table", r).bind(function (e) { var t = Ct.descendants(e, "tr"); return Ke.eq(n, t[t.length - 1]) ? Gl.seekRight(e, function (e) { return Sn.first(e).isSome() }, r).map(function (e) { return sl.response(x.some(pl.makeSitus(e, 0, e, 0)), !0) }) : x.none() }) }) }, Ts = function (e, t) { return Wt.closest(e, "td,th", t) }, As = { down: { traverse: rt.nextSibling, gather: Gl.after, relative: hc.before, otherRetry: Zl.tryDown, ieRetry: Zl.ieTryDown, failure: ns.adt.failedDown }, up: { traverse: rt.prevSibling, gather: Gl.before, relative: hc.before, otherRetry: Zl.tryUp, ieRetry: Zl.ieTryUp, failure: ns.adt.failedUp } }, Ds = F.immutable("rows", "cols"), ks = { mouse: function (e, t, n, r) { var o, i, u, a, c, l, s = xl(e), f = (o = s, i = t, u = n, a = r, c = x.none(), l = function () { c = x.none() }, { mousedown: function (e) { a.clear(i), c = Ts(e.target(), u) }, mouseover: function (e) { c.each(function (r) { a.clear(i), Ts(e.target(), u).each(function (n) { ur.identify(r, n, u).each(function (e) { var t = e.boxes().getOr([]); (1 < t.length || 1 === t.length && !Ke.eq(r, n)) && (a.selectRange(i, t, e.start(), e.finish()), o.selectContents(n)) }) }) }) }, mouseup: function () { c.each(l) } }); return { mousedown: f.mousedown, mouseover: f.mouseover, mouseup: f.mouseup } }, keyboard: function (e, c, l, s) { var f = xl(e), d = function () { return s.clear(c), x.none() }; return { keydown: function (e, t, n, r, o, i) { var u = e.raw().which, a = !0 === e.raw().shiftKey; return ur.retrieve(c, s.selectedSelector()).fold(function () { return gl.isDown(u) && a ? y.curry(Ss, f, c, l, As.down, r, t, s.selectRange) : gl.isUp(u) && a ? y.curry(Ss, f, c, l, As.up, r, t, s.selectRange) : gl.isDown(u) ? y.curry(xs, f, l, As.down, r, t, Rs) : gl.isUp(u) ? y.curry(xs, f, l, As.up, r, t, Cs) : x.none }, function (t) { var e = function (e) { return function () { return qo(e, function (e) { return Cl.update(e.rows(), e.cols(), c, t, s) }).fold(function () { return ur.getEdges(c, s.firstSelectedSelector(), s.lastSelectedSelector()).map(function (e) { var t = gl.isDown(u) || i.isForward(u) ? hc.after : hc.before; return f.setRelativeSelection(hc.on(e.first(), 0), t(e.table())), s.clear(c), sl.response(x.none(), !0) }) }, function (e) { return x.some(sl.response(x.none(), !0)) }) } }; return gl.isDown(u) && a ? e([Ds(1, 0)]) : gl.isUp(u) && a ? e([Ds(-1, 0)]) : i.isBackward(u) && a ? e([Ds(0, -1), Ds(-1, 0)]) : i.isForward(u) && a ? e([Ds(0, 1), Ds(1, 0)]) : gl.isNavigation(u) && !1 === a ? d : x.none })() }, keyup: function (t, n, r, o, i) { return ur.retrieve(c, s.selectedSelector()).fold(function () { var e = t.raw().which; return 0 == (!0 === t.raw().shiftKey) ? x.none() : gl.isNavigation(e) ? Cl.sync(c, l, n, r, o, i, s.selectRange) : x.none() }, x.none) } } } }, Ns = function (t, e) { E.each(e, function (e) { bi.remove(t, e) }) }, Es = function (t) { return function (e) { bi.add(e, t) } }, Os = function (t) { return function (e) { Ns(e, t) } }, Bs = { byClass: function (o) { var i = Es(o.selected()), n = Os([o.selected(), o.lastSelected(), o.firstSelected()]), u = function (e) { var t = Ct.descendants(e, o.selectedSelector()); E.each(t, n) }; return { clear: u, selectRange: function (e, t, n, r) { u(e), E.each(t, i), bi.add(n, o.firstSelected()), bi.add(r, o.lastSelected()) }, selectedSelector: o.selectedSelector, firstSelectedSelector: o.firstSelectedSelector, lastSelectedSelector: o.lastSelectedSelector } }, byAttr: function (o) { var n = function (e) { vt.remove(e, o.selected()), vt.remove(e, o.firstSelected()), vt.remove(e, o.lastSelected()) }, i = function (e) { vt.set(e, o.selected(), "1") }, u = function (e) { var t = Ct.descendants(e, o.selectedSelector()); E.each(t, n) }; return { clear: u, selectRange: function (e, t, n, r) { u(e), E.each(t, i), vt.set(n, o.firstSelected(), "1"), vt.set(r, o.lastSelected(), "1") }, selectedSelector: o.selectedSelector, firstSelectedSelector: o.firstSelectedSelector, lastSelectedSelector: o.lastSelectedSelector } } }; function Ps(p, h) { var v = F.immutableBag(["mousedown", "mouseover", "mouseup", "keyup", "keydown"], []), b = x.none(), w = Bs.byAttr(dr); return p.on("init", function (e) { var r = p.getWin(), i = Gu.getBody(p), t = Gu.getIsRoot(p), n = ks.mouse(r, i, t, w), a = ks.keyboard(r, i, t, w), c = function (e, t) { !0 === e.raw().shiftKey && (t.kill() && e.kill(), t.selection().each(function (e) { var t = wc.relative(e.start(), e.finish()), n = Ec.asLtrRange(r, t); p.selection.setRng(n) })) }, o = function (e) { var t = s(e); if (t.raw().shiftKey && gl.isNavigation(t.raw().which)) { var n = p.selection.getRng(), r = Y.fromDom(n.startContainer), o = Y.fromDom(n.endContainer); a.keyup(t, r, n.startOffset, o, n.endOffset).each(function (e) { c(t, e) }) } }, u = function (e) { var t = s(e); h().each(function (e) { e.hideBars() }); var n = p.selection.getRng(), r = Y.fromDom(p.selection.getStart()), o = Y.fromDom(n.startContainer), i = Y.fromDom(n.endContainer), u = Ju.directionAt(r).isRtl() ? gl.rtl : gl.ltr; a.keydown(t, o, n.startOffset, i, n.endOffset, u).each(function (e) { c(t, e) }), h().each(function (e) { e.showBars() }) }, l = function (e) { return e.hasOwnProperty("x") && e.hasOwnProperty("y") }, s = function (e) { var t = Y.fromDom(e.target), n = function () { e.stopPropagation() }, r = function () { e.preventDefault() }, o = y.compose(r, n); return { target: y.constant(t), x: y.constant(l(e) ? e.x : null), y: y.constant(l(e) ? e.y : null), stop: n, prevent: r, kill: o, raw: y.constant(e) } }, f = function (e) { return 0 === e.button }, d = function (e) { f(e) && n.mousedown(s(e)) }, m = function (e) { var t; ((t = e).buttons === undefined || 0 != (1 & t.buttons)) && n.mouseover(s(e)) }, g = function (e) { f(e) && n.mouseup(s(e)) }; p.on("mousedown", d), p.on("mouseover", m), p.on("mouseup", g), p.on("keyup", o), p.on("keydown", u), p.on("nodechange", function () { var e = p.selection, t = Y.fromDom(e.getStart()), n = Y.fromDom(e.getEnd()), r = zt.table(t), o = zt.table(n); r.bind(function (t) { return o.bind(function (e) { return Ke.eq(t, e) ? x.some(!0) : x.none() }) }).fold(function () { w.clear(i) }, y.noop) }), b = x.some(v({ mousedown: d, mouseover: m, mouseup: g, keyup: o, keydown: u })) }), { clear: w.clear, destroy: function () { b.each(function (e) { }) } } } var Is = function (t) { return { get: function () { var e = Gu.getBody(t); return ar(e, dr.selectedSelector()).fold(function () { return t.selection.getStart() === undefined ? pr.none() : pr.single(t.selection) }, function (e) { return pr.multiple(e) }) } } }, Ws = ga.each, Ms = { addButtons: function (t) { var n = []; function e(e) { return function () { t.execCommand(e) } } Ws("inserttable tableprops deletetable | cell row column".split(" "), function (e) { "|" === e ? n.push({ text: "-" }) : n.push(t.menuItems[e]) }), t.addButton("table", { type: "menubutton", title: "Table", menu: n }), t.addButton("tableprops", { title: "Table properties", onclick: y.curry(Ba, t, !0), icon: "table" }), t.addButton("tabledelete", { title: "Delete table", onclick: e("mceTableDelete") }), t.addButton("tablecellprops", { title: "Cell properties", onclick: e("mceTableCellProps") }), t.addButton("tablemergecells", { title: "Merge cells", onclick: e("mceTableMergeCells") }), t.addButton("tablesplitcells", { title: "Split cell", onclick: e("mceTableSplitCells") }), t.addButton("tableinsertrowbefore", { title: "Insert row before", onclick: e("mceTableInsertRowBefore") }), t.addButton("tableinsertrowafter", { title: "Insert row after", onclick: e("mceTableInsertRowAfter") }), t.addButton("tabledeleterow", { title: "Delete row", onclick: e("mceTableDeleteRow") }), t.addButton("tablerowprops", { title: "Row properties", onclick: e("mceTableRowProps") }), t.addButton("tablecutrow", { title: "Cut row", onclick: e("mceTableCutRow") }), t.addButton("tablecopyrow", { title: "Copy row", onclick: e("mceTableCopyRow") }), t.addButton("tablepasterowbefore", { title: "Paste row before", onclick: e("mceTablePasteRowBefore") }), t.addButton("tablepasterowafter", { title: "Paste row after", onclick: e("mceTablePasteRowAfter") }), t.addButton("tableinsertcolbefore", { title: "Insert column before", onclick: e("mceTableInsertColBefore") }), t.addButton("tableinsertcolafter", { title: "Insert column after", onclick: e("mceTableInsertColAfter") }), t.addButton("tabledeletecol", { title: "Delete column", onclick: e("mceTableDeleteCol") }) }, addToolbars: function (t) { var e, n = "" === (e = t.getParam("table_toolbar", Qu)) || !1 === e ? [] : g.isString(e) ? e.split(/[ ,]/) : g.isArray(e) ? e : []; 0 < n.length && t.addContextToolbar(function (e) { return t.dom.is(e, "table") && t.getBody().contains(e) }, n.join(" ")) } }, Ls = { addMenuItems: function (o, n) { var r = x.none(), i = [], u = [], a = [], c = [], l = function (e) { e.disabled(!0) }, s = function (e) { e.disabled(!1) }, e = function () { var t = this; i.push(t), r.fold(function () { l(t) }, function (e) { s(t) }) }, t = function () { var t = this; u.push(t), r.fold(function () { l(t) }, function (e) { s(t) }) }; o.on("init", function () { o.on("nodechange", function (e) { var t = x.from(o.dom.getParent(o.selection.getStart(), "th,td")); (r = t.bind(function (e) { var t = Y.fromDom(e); return zt.table(t).map(function (e) { return Sr.forMenu(n, e, t) }) })).fold(function () { E.each(i, l), E.each(u, l), E.each(a, l), E.each(c, l) }, function (t) { E.each(i, s), E.each(u, s), E.each(a, function (e) { e.disabled(t.mergable().isNone()) }), E.each(c, function (e) { e.disabled(t.unmergable().isNone()) }) }) }) }); var f = function (e, t, n, r) { var o, i, u, a, c, l = r.getEl().getElementsByTagName("table")[0], s = r.isRtl() || "tl-tr" === r.parent().rel; for (l.nextSibling.innerHTML = t + 1 + " x " + (n + 1), s && (t = 9 - t), i = 0; i < 10; i++)for (o = 0; o < 10; o++)a = l.rows[i].childNodes[o].firstChild, c = (s ? t <= o : o <= t) && i <= n, e.dom.toggleClass(a, "mce-active", c), c && (u = a); return u.parentNode }, d = !1 === o.getParam("table_grid", !0, "boolean") ? { text: "Table", icon: "table", context: "table", onclick: y.curry(Ba, o) } : { text: "Table", icon: "table", context: "table", ariaHideMenu: !0, onclick: function (e) { e.aria && (this.parent().hideAll(), e.stopImmediatePropagation(), Ba(o)) }, onshow: function () { f(o, 0, 0, this.menu.items()[0]) }, onhide: function () { var e = this.menu.items()[0].getEl().getElementsByTagName("a"); o.dom.removeClass(e, "mce-active"), o.dom.addClass(e[0], "mce-active") }, menu: [{ type: "container", html: function () { var e = ""; e = '<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">'; for (var t = 0; t < 10; t++) { e += "<tr>"; for (var n = 0; n < 10; n++)e += '<td role="gridcell" tabindex="-1"><a id="mcegrid' + (10 * t + n) + '" href="#" data-mce-x="' + n + '" data-mce-y="' + t + '"></a></td>'; e += "</tr>" } return e += "</table>", e += '<div class="mce-text-center" role="presentation">1 x 1</div>' }(), onPostRender: function () { this.lastX = this.lastY = 0 }, onmousemove: function (e) { var t, n, r = e.target; "A" === r.tagName.toUpperCase() && (t = parseInt(r.getAttribute("data-mce-x"), 10), n = parseInt(r.getAttribute("data-mce-y"), 10), (this.isRtl() || "tl-tr" === this.parent().rel) && (t = 9 - t), t === this.lastX && n === this.lastY || (f(o, t, n, e.control), this.lastX = t, this.lastY = n)) }, onclick: function (e) { var t = this; "A" === e.target.tagName.toUpperCase() && (e.preventDefault(), e.stopPropagation(), t.parent().cancel(), o.undoManager.transact(function () { Na(o, t.lastX + 1, t.lastY + 1) }), o.addVisual()) } }] }; function m(e) { return function () { o.execCommand(e) } } var g = { text: "Table properties", context: "table", onPostRender: e, onclick: y.curry(Ba, o, !0) }, p = { text: "Delete table", context: "table", onPostRender: e, cmd: "mceTableDelete" }, h = { text: "Row", context: "table", menu: [{ text: "Insert row before", onclick: m("mceTableInsertRowBefore"), onPostRender: t }, { text: "Insert row after", onclick: m("mceTableInsertRowAfter"), onPostRender: t }, { text: "Delete row", onclick: m("mceTableDeleteRow"), onPostRender: t }, { text: "Row properties", onclick: m("mceTableRowProps"), onPostRender: t }, { text: "-" }, { text: "Cut row", onclick: m("mceTableCutRow"), onPostRender: t }, { text: "Copy row", onclick: m("mceTableCopyRow"), onPostRender: t }, { text: "Paste row before", onclick: m("mceTablePasteRowBefore"), onPostRender: t }, { text: "Paste row after", onclick: m("mceTablePasteRowAfter"), onPostRender: t }] }, v = { text: "Column", context: "table", menu: [{ text: "Insert column before", onclick: m("mceTableInsertColBefore"), onPostRender: t }, { text: "Insert column after", onclick: m("mceTableInsertColAfter"), onPostRender: t }, { text: "Delete column", onclick: m("mceTableDeleteCol"), onPostRender: t }] }, b = { separator: "before", text: "Cell", context: "table", menu: [{ text: "Cell properties", onclick: m("mceTableCellProps"), onPostRender: t }, { text: "Merge cells", onclick: m("mceTableMergeCells"), onPostRender: function () { var t = this; a.push(t), r.fold(function () { l(t) }, function (e) { t.disabled(e.mergable().isNone()) }) } }, { text: "Split cell", onclick: m("mceTableSplitCells"), onPostRender: function () { var t = this; c.push(t), r.fold(function () { l(t) }, function (e) { t.disabled(e.unmergable().isNone()) }) } }] }; o.addMenuItem("inserttable", d), o.addMenuItem("tableprops", g), o.addMenuItem("deletetable", p), o.addMenuItem("row", h), o.addMenuItem("column", v), o.addMenuItem("cell", b) } }, qs = function (n, o) { return { insertTable: function (e, t) { return Na(n, e, t) }, setClipboardRows: function (e) { return t = e, n = o, r = E.map(t, Y.fromDom), void n.set(x.from(r)); var t, n, r }, getClipboardRows: function () { return o.get().fold(function () { }, function (e) { return E.map(e, function (e) { return e.dom() }) }) } } }; u.add("table", function (t) { var n = uc(t), e = Ps(t, n.lazyResize), r = da(t, n.lazyWire), o = Is(t), i = fo(x.none()); return Ia.registerCommands(t, r, e, o, i), Cr.registerEvents(t, o, r, e), Ls.addMenuItems(t, o), Ms.addButtons(t), Ms.addToolbars(t), t.on("PreInit", function () { t.serializer.addTempAttr(dr.firstSelected()), t.serializer.addTempAttr(dr.lastSelected()) }), ta(t) && t.on("keydown", function (e) { ll.handle(e, t, r, n.lazyWire) }), t.on("remove", function () { n.destroy(), e.destroy() }), qs(t, i) }) }();
!function () { "use strict"; var e = tinymce.util.Tools.resolve("tinymce.PluginManager"), t = function (e) { return function () { return e } }, n = (t(!1), t(!0), function (l) { for (var e = [], t = 1; t < arguments.length; t++)e[t - 1] = arguments[t]; for (var c = new Array(arguments.length - 1), n = 1; n < arguments.length; n++)c[n - 1] = arguments[n]; return function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; for (var n = new Array(arguments.length), a = 0; a < n.length; a++)n[a] = arguments[a]; var r = c.concat(n); return l.apply(null, r) } }), o = tinymce.util.Tools.resolve("tinymce.util.Tools"), c = tinymce.util.Tools.resolve("tinymce.util.XHR"), a = tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"), i = function (e) { return e.getParam("template_cdate_classes", "cdate") }, s = function (e) { return e.getParam("template_mdate_classes", "mdate") }, u = function (e) { return e.getParam("template_selected_content_classes", "selcontent") }, p = function (e) { return e.getParam("template_preview_replace_values") }, m = function (e) { return e.getParam("template_replace_values") }, r = function (e) { return e.templates }, d = function (e) { return e.getParam("template_cdate_format", e.getLang("template.cdate_format")) }, f = function (e) { return e.getParam("template_mdate_format", e.getLang("template.mdate_format")) }, g = function (e) { return e.getParam("template_popup_width", 600) }, h = function (e) { return Math.min(a.DOM.getViewPort().h, e.getParam("template_popup_height", 500)) }, y = function (e, t) { if ((e = "" + e).length < t) for (var n = 0; n < t - e.length; n++)e = "0" + e; return e }, v = function (e, t, n) { var a = "Sun Mon Tue Wed Thu Fri Sat Sun".split(" "), r = "Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "), l = "Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "), c = "January February March April May June July August September October November December".split(" "); return n = n || new Date, t = (t = (t = (t = (t = (t = (t = (t = (t = (t = (t = (t = (t = (t = (t = (t = t.replace("%D", "%m/%d/%Y")).replace("%r", "%I:%M:%S %p")).replace("%Y", "" + n.getFullYear())).replace("%y", "" + n.getYear())).replace("%m", y(n.getMonth() + 1, 2))).replace("%d", y(n.getDate(), 2))).replace("%H", "" + y(n.getHours(), 2))).replace("%M", "" + y(n.getMinutes(), 2))).replace("%S", "" + y(n.getSeconds(), 2))).replace("%I", "" + ((n.getHours() + 11) % 12 + 1))).replace("%p", n.getHours() < 12 ? "AM" : "PM")).replace("%B", "" + e.translate(c[n.getMonth()]))).replace("%b", "" + e.translate(l[n.getMonth()]))).replace("%A", "" + e.translate(r[n.getDay()]))).replace("%a", "" + e.translate(a[n.getDay()]))).replace("%%", "%") }, M = function (e, n, t) { return o.each(t, function (e, t) { "function" == typeof e && (e = e(t)), n = n.replace(new RegExp("\\{\\$" + t + "\\}", "g"), e) }), n }, _ = function (e, t) { var a = e.dom, r = m(e); o.each(a.select("*", t), function (n) { o.each(r, function (e, t) { a.hasClass(n, t) && "function" == typeof r[t] && r[t](n) }) }) }, b = function (e, t) { return new RegExp("\\b" + t + "\\b", "g").test(e.className) }, l = function (t, n) { return function () { var e = r(t); "function" != typeof e ? "string" == typeof e ? c.send({ url: e, success: function (e) { n(JSON.parse(e)) } }) : n(e) : e(n) } }, T = M, x = _, P = function (t, e, n) { var a, r, l = t.dom, c = t.selection.getContent(); n = M(0, n, m(t)), a = l.create("div", null, n), (r = l.select(".mceTmpl", a)) && 0 < r.length && (a = l.create("div", null)).appendChild(r[0].cloneNode(!0)), o.each(l.select("*", a), function (e) { b(e, i(t).replace(/\s+/g, "|")) && (e.innerHTML = v(t, d(t))), b(e, s(t).replace(/\s+/g, "|")) && (e.innerHTML = v(t, f(t))), b(e, u(t).replace(/\s+/g, "|")) && (e.innerHTML = c) }), _(t, a), t.execCommand("mceInsertContent", !1, a.innerHTML), t.addVisual() }, S = function (e) { e.addCommand("mceInsertTemplate", n(P, e)) }, w = function (a) { a.on("PreProcess", function (e) { var t = a.dom, n = f(a); o.each(t.select("div", e.node), function (e) { t.hasClass(e, "mceTmpl") && (o.each(t.select("*", e), function (e) { t.hasClass(e, a.getParam("template_mdate_classes", "mdate").replace(/\s+/g, "|")) && (e.innerHTML = v(a, n)) }), x(a, e)) }) }) }, D = function (t, e, n) { if (-1 === n.indexOf("<html>")) { var a = ""; o.each(t.contentCSS, function (e) { a += '<link type="text/css" rel="stylesheet" href="' + t.documentBaseURI.toAbsolute(e) + '">' }); var r = t.settings.body_class || ""; -1 !== r.indexOf("=") && (r = (r = t.getParam("body_class", "", "hash"))[t.id] || ""), n = "<!DOCTYPE html><html><head>" + a + '</head><body class="' + r + '">' + n + "</body></html>" } n = T(t, n, p(t)); var l = e.find("iframe")[0].getEl().contentWindow.document; l.open(), l.write(n), l.close() }, H = function (n, e) { var a, r, t = []; if (e && 0 !== e.length) o.each(e, function (e) { t.push({ selected: !t.length, text: e.title, value: { url: e.url, content: e.content, description: e.description } }) }), (a = n.windowManager.open({ title: "Insert template", layout: "flex", direction: "column", align: "stretch", padding: 15, spacing: 10, items: [{ type: "form", flex: 0, padding: 0, items: [{ type: "container", label: "Templates", items: { type: "listbox", label: "Templates", name: "template", values: t, onselect: function (e) { var t = e.control.value(); t.url ? c.send({ url: t.url, success: function (e) { D(n, a, r = e) } }) : (r = t.content, D(n, a, r)), a.find("#description")[0].text(e.control.value().description) } } }] }, { type: "label", name: "description", label: "Description", text: "\xa0" }, { type: "iframe", flex: 1, border: 1 }], onsubmit: function () { P(n, !1, r) }, minWidth: g(n), minHeight: h(n) })).find("listbox")[0].fire("select"); else { var l = n.translate("No templates defined."); n.notificationManager.open({ text: l, type: "info" }) } }, C = function (t) { return function (e) { H(t, e) } }, A = function (e) { e.addButton("template", { title: "Insert template", onclick: l(e.settings, C(e)) }), e.addMenuItem("template", { text: "Template", onclick: l(e.settings, C(e)), icon: "template", context: "insert" }) }; e.add("template", function (e) { A(e), S(e), w(e) }) }();
!function () { "use strict"; var t = tinymce.util.Tools.resolve("tinymce.PluginManager"), n = function (t, o) { var r; return t.dom.getParents(t.selection.getStart(), function (t) { var e; (e = t.style["forecolor" === o ? "color" : "background-color"]) && (r = e) }), r }, g = function (t) { var e, o = []; for (e = 0; e < t.length; e += 2)o.push({ text: t[e + 1], color: "#" + t[e] }); return o }, r = function (t, e, o) { t.undoManager.transact(function () { t.focus(), t.formatter.apply(e, { value: o }), t.nodeChanged() }) }, e = function (t, e) { t.undoManager.transact(function () { t.focus(), t.formatter.remove(e, { value: null }, null, !0), t.nodeChanged() }) }, o = function (o) { o.addCommand("mceApplyTextcolor", function (t, e) { r(o, t, e) }), o.addCommand("mceRemoveTextcolor", function (t) { e(o, t) }) }, F = tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"), i = tinymce.util.Tools.resolve("tinymce.util.Tools"), a = ["000000", "Black", "993300", "Burnt orange", "333300", "Dark olive", "003300", "Dark green", "003366", "Dark azure", "000080", "Navy Blue", "333399", "Indigo", "333333", "Very dark gray", "800000", "Maroon", "FF6600", "Orange", "808000", "Olive", "008000", "Green", "008080", "Teal", "0000FF", "Blue", "666699", "Grayish blue", "808080", "Gray", "FF0000", "Red", "FF9900", "Amber", "99CC00", "Yellow green", "339966", "Sea green", "33CCCC", "Turquoise", "3366FF", "Royal blue", "800080", "Purple", "999999", "Medium gray", "FF00FF", "Magenta", "FFCC00", "Gold", "FFFF00", "Yellow", "00FF00", "Lime", "00FFFF", "Aqua", "00CCFF", "Sky blue", "993366", "Red violet", "FFFFFF", "White", "FF99CC", "Pink", "FFCC99", "Peach", "FFFF99", "Light yellow", "CCFFCC", "Pale green", "CCFFFF", "Pale cyan", "99CCFF", "Light sky blue", "CC99FF", "Plum"], l = function (t) { return t.getParam("textcolor_map", a) }, c = function (t) { return t.getParam("textcolor_rows", 5) }, u = function (t) { return t.getParam("textcolor_cols", 8) }, m = function (t) { return t.getParam("color_picker_callback", null) }, s = function (t) { return t.getParam("forecolor_map", l(t)) }, d = function (t) { return t.getParam("backcolor_map", l(t)) }, f = function (t) { return t.getParam("forecolor_rows", c(t)) }, b = function (t) { return t.getParam("backcolor_rows", c(t)) }, p = function (t) { return t.getParam("forecolor_cols", u(t)) }, C = function (t) { return t.getParam("backcolor_cols", u(t)) }, y = m, v = function (t) { return "function" == typeof m(t) }, h = tinymce.util.Tools.resolve("tinymce.util.I18n"), P = function (t, e, o, r) { var n, a, l, c, i, u, m, s = 0, d = F.DOM.uniqueId("mcearia"), f = function (t, e) { var o = "transparent" === t; return '<td class="mce-grid-cell' + (o ? " mce-colorbtn-trans" : "") + '"><div id="' + d + "-" + s++ + '" data-mce-color="' + (t || "") + '" role="option" tabIndex="-1" style="' + (t ? "background-color: " + t : "") + '" title="' + h.translate(e) + '">' + (o ? "&#215;" : "") + "</div></td>" }; for ((n = g(o)).push({ text: h.translate("No color"), color: "transparent" }), l = '<table class="mce-grid mce-grid-border mce-colorbutton-grid" role="list" cellspacing="0"><tbody>', c = n.length - 1, u = 0; u < e; u++) { for (l += "<tr>", i = 0; i < t; i++)l += c < (m = u * t + i) ? "<td></td>" : f((a = n[m]).color, a.text); l += "</tr>" } if (r) { for (l += '<tr><td colspan="' + t + '" class="mce-custom-color-btn"><div id="' + d + '-c" class="mce-widget mce-btn mce-btn-small mce-btn-flat" role="button" tabindex="-1" aria-labelledby="' + d + '-c" style="width: 100%"><button type="button" role="presentation" tabindex="-1">' + h.translate("Custom...") + "</button></div></td></tr>", l += "<tr>", i = 0; i < t; i++)l += f("", "Custom color"); l += "</tr>" } return l += "</tbody></table>" }, k = function (t, e) { t.style.background = e, t.setAttribute("data-mce-color", e) }, x = function (o) { return function (t) { var e = t.control; e._color ? o.execCommand("mceApplyTextcolor", e.settings.format, e._color) : o.execCommand("mceRemoveTextcolor", e.settings.format) } }, T = function (r, c) { return function (t) { var e, a = this.parent(), o = n(r, a.settings.format), l = function (t) { a.hidePanel(), a.color(t), r.execCommand("mceApplyTextcolor", a.settings.format, t) }; F.DOM.getParent(t.target, ".mce-custom-color-btn") && (a.hidePanel(), y(r).call(r, function (t) { var e, o, r, n = a.panel.getEl().getElementsByTagName("table")[0]; for (e = i.map(n.rows[n.rows.length - 1].childNodes, function (t) { return t.firstChild }), r = 0; r < e.length && (o = e[r]).getAttribute("data-mce-color"); r++); if (r === c) for (r = 0; r < c - 1; r++)k(e[r], e[r + 1].getAttribute("data-mce-color")); k(o, t), l(t) }, o)), (e = t.target.getAttribute("data-mce-color")) ? (this.lastId && F.DOM.get(this.lastId).setAttribute("aria-selected", "false"), t.target.setAttribute("aria-selected", !0), this.lastId = t.target.id, "transparent" === e ? (a.hidePanel(), a.resetColor(), r.execCommand("mceRemoveTextcolor", a.settings.format)) : l(e)) : null !== e && a.hidePanel() } }, _ = function (n, a) { return function () { var t = a ? p(n) : C(n), e = a ? f(n) : b(n), o = a ? s(n) : d(n), r = v(n); return P(t, e, o, r) } }, A = function (t) { t.addButton("forecolor", { type: "colorbutton", tooltip: "Text color", format: "forecolor", panel: { role: "application", ariaRemember: !0, html: _(t, !0), onclick: T(t, p(t)) }, onclick: x(t) }), t.addButton("backcolor", { type: "colorbutton", tooltip: "Background color", format: "hilitecolor", panel: { role: "application", ariaRemember: !0, html: _(t, !1), onclick: T(t, C(t)) }, onclick: x(t) }) }; t.add("textcolor", function (t) { o(t), A(t) }) }();
!function () { "use strict"; var r = function (t) { var e = t, n = function () { return e }; return { get: n, set: function (t) { e = t }, clone: function () { return r(n()) } } }, t = tinymce.util.Tools.resolve("tinymce.PluginManager"), n = function (e) { return { setPatterns: function (t) { e.set(t) }, getPatterns: function () { return e.get() } } }, e = [{ start: "*", end: "*", format: "italic" }, { start: "**", end: "**", format: "bold" }, { start: "***", end: "***", format: ["bold", "italic"] }, { start: "#", format: "h1" }, { start: "##", format: "h2" }, { start: "###", format: "h3" }, { start: "####", format: "h4" }, { start: "#####", format: "h5" }, { start: "######", format: "h6" }, { start: "1. ", cmd: "InsertOrderedList" }, { start: "* ", cmd: "InsertUnorderedList" }, { start: "- ", cmd: "InsertUnorderedList" }], a = function (t) { return t.textpattern_patterns !== undefined ? t.textpattern_patterns : e }, o = tinymce.util.Tools.resolve("tinymce.util.Delay"), i = tinymce.util.Tools.resolve("tinymce.util.VK"), g = tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"), h = tinymce.util.Tools.resolve("tinymce.util.Tools"), m = function (t, e) { for (var n = 0; n < t.length; n++)if (0 === e.indexOf(t[n].start) && (!t[n].end || e.lastIndexOf(t[n].end) === e.length - t[n].end.length)) return t[n] }, c = function (t, e, n, r) { var a, o, i, s, l, d, f = t.sort(function (t, e) { return t.start.length > e.start.length ? -1 : t.start.length < e.start.length ? 1 : 0 }); for (o = 0; o < f.length; o++)if ((a = f[o]).end !== undefined && (s = a, l = n, d = r, e.substr(l - s.end.length - d, s.end.length) === s.end) && 0 < n - r - (i = a).end.length - i.start.length) return a }, s = function (t, e, n) { if (!1 !== e.collapsed) { var r = e.startContainer, a = r.data, o = !0 === n ? 1 : 0; if (3 === r.nodeType) { var i = c(t, a, e.startOffset, o); if (i !== undefined) { var s = a.lastIndexOf(i.end, e.startOffset - o), l = a.lastIndexOf(i.start, s - i.end.length); if (s = a.indexOf(i.end, l + i.start.length), -1 !== l) { var d = document.createRange(); d.setStart(r, l), d.setEnd(r, s + i.end.length); var f = m(t, d.toString()); if (!(i === undefined || f !== i || r.data.length <= i.start.length + i.end.length)) return { pattern: i, startOffset: l, endOffset: s } } } } } }, l = function (t, e, n) { var r = t.selection.getRng(!0), a = s(e, r, n); if (a) return function (a, o, i, t) { var s = h.isArray(i.pattern.format) ? i.pattern.format : [i.pattern.format]; if (0 !== h.grep(s, function (t) { var e = a.formatter.get(t); return e && e[0].inline }).length) return a.undoManager.transact(function () { var t, e, n, r; t = o, e = i.pattern, n = i.endOffset, r = i.startOffset, (t = 0 < r ? t.splitText(r) : t).splitText(n - r + e.end.length), t.deleteData(0, e.start.length), t.deleteData(t.data.length - e.end.length, e.end.length), o = t, s.forEach(function (t) { a.formatter.apply(t, {}, o) }) }), o }(t, r.startContainer, a) }, d = { patternFromRng: s, applyInlineFormatSpace: function (t, e) { return l(t, e, !0) }, applyInlineFormatEnter: function (t, e) { return l(t, e, !1) }, applyBlockFormat: function (t, e) { var n, r, a, o, i, s, l, d, f, c, u; if (n = t.selection, r = t.dom, n.isCollapsed() && (l = r.getParent(n.getStart(), "p"))) { for (f = new g(l, l); i = f.next();)if (3 === i.nodeType) { o = i; break } if (o) { if (!(d = m(e, o.data))) return; if (a = (c = n.getRng(!0)).startContainer, u = c.startOffset, o === a && (u = Math.max(0, u - d.start.length)), h.trim(o.data).length === d.start.length) return; d.format && (s = t.formatter.get(d.format)) && s[0].block && (o.deleteData(0, d.start.length), t.formatter.apply(d.format, {}, o), c.setStart(a, u), c.collapse(!0), n.setRng(c)), d.cmd && t.undoManager.transact(function () { o.deleteData(0, d.start.length), t.execCommand(d.cmd) }) } } } }, f = function (t, e, n) { for (var r = 0; r < t.length; r++)if (n(t[r], e)) return !0 }, u = { handleEnter: function (t, e) { var n, r; (n = d.applyInlineFormatEnter(t, e)) && ((r = t.dom.createRng()).setStart(n, n.data.length), r.setEnd(n, n.data.length), t.selection.setRng(r)), d.applyBlockFormat(t, e) }, handleInlineKey: function (t, e) { var n, r, a, o, i; (n = d.applyInlineFormatSpace(t, e)) && (i = t.dom, r = n.data.slice(-1), /[\u00a0 ]/.test(r) && (n.deleteData(n.data.length - 1, 1), a = i.doc.createTextNode(r), i.insertAfter(a, n.parentNode), (o = i.createRng()).setStart(a, 1), o.setEnd(a, 1), t.selection.setRng(o))) }, checkCharCode: function (t, e) { return f(t, e, function (t, e) { return t.charCodeAt(0) === e.charCode }) }, checkKeyCode: function (t, e) { return f(t, e, function (t, e) { return t === e.keyCode && !1 === i.modifierPressed(e) }) } }, p = function (e, n) { var r = [",", ".", ";", ":", "!", "?"], a = [32]; e.on("keydown", function (t) { 13 !== t.keyCode || i.modifierPressed(t) || u.handleEnter(e, n.get()) }, !0), e.on("keyup", function (t) { u.checkKeyCode(a, t) && u.handleInlineKey(e, n.get()) }), e.on("keypress", function (t) { u.checkCharCode(r, t) && o.setEditorTimeout(e, function () { u.handleInlineKey(e, n.get()) }) }) }; t.add("textpattern", function (t) { var e = r(a(t.settings)); return p(t, e), n(e) }) }();
!function () { "use strict"; var e, n, t = tinymce.util.Tools.resolve("tinymce.PluginManager"), s = tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"), f = tinymce.util.Tools.resolve("tinymce.util.I18n"), i = tinymce.util.Tools.resolve("tinymce.util.Tools"), l = function (t) { return t.getParam("toc_class", "mce-toc") }, m = function (t) { var e = t.getParam("toc_header", "h2"); return /^h[1-6]$/.test(e) ? e : "h2" }, c = function (t) { var e = parseInt(t.getParam("toc_depth", "3"), 10); return 1 <= e && e <= 9 ? e : 3 }, a = (e = "mcetoc_", n = 0, function () { var t = (new Date).getTime().toString(32); return e + t + (n++).toString(32) }), v = function (n) { var o = l(n), t = m(n), e = function (t) { var e, n = []; for (e = 1; e <= t; e++)n.push("h" + e); return n.join(",") }(c(n)), r = n.$(e); return r.length && /^h[1-9]$/i.test(t) && (r = r.filter(function (t, e) { return !n.dom.hasClass(e.parentNode, o) })), i.map(r, function (t) { return { id: t.id ? t.id : a(), level: parseInt(t.nodeName.replace(/^H/i, ""), 10), title: n.$.text(t), element: t } }) }, d = function (t) { var e, n, o, r, i, c, l, a = "", d = v(t), u = function (t) { var e, n = 9; for (e = 0; e < t.length; e++)if (t[e].level < n && (n = t[e].level), 1 === n) return n; return n }(d) - 1; if (!d.length) return ""; for (a += (i = m(t), c = f.translate("Table of Contents"), l = "</" + i + ">", "<" + i + ' contenteditable="true">' + s.DOM.encode(c) + l), e = 0; e < d.length; e++) { if ((o = d[e]).element.id = o.id, r = d[e + 1] && d[e + 1].level, u === o.level) a += "<li>"; else for (n = u; n < o.level; n++)a += "<ul><li>"; if (a += '<a href="#' + o.id + '">' + o.title + "</a>", r !== o.level && r) for (n = o.level; r < n; n--)a += "</li></ul><li>"; else a += "</li>", r || (a += "</ul>"); u = o.level } return a }, u = function (t) { var e = l(t), n = t.$("." + e); n.length && t.undoManager.transact(function () { n.html(d(t)) }) }, o = { hasHeaders: function (t) { return 0 < v(t).length }, insertToc: function (t) { var e, n, o, r, i = l(t), c = t.$("." + i); o = t, !(r = c).length || 0 < o.dom.getParents(r[0], ".mce-offscreen-selection").length ? t.insertContent((n = d(e = t), '<div class="' + e.dom.encode(l(e)) + '" contenteditable="false">' + n + "</div>")) : u(t) }, updateToc: u }, r = function (t) { t.addCommand("mceInsertToc", function () { o.insertToc(t) }), t.addCommand("mceUpdateToc", function () { o.updateToc(t) }) }, h = function (t) { var n = t.$, o = l(t); t.on("PreProcess", function (t) { var e = n("." + o, t.node); e.length && (e.removeAttr("contentEditable"), e.find("[contenteditable]").removeAttr("contentEditable")) }), t.on("SetContent", function () { var t = n("." + o); t.length && (t.attr("contentEditable", !1), t.children(":first-child").attr("contentEditable", !0)) }) }, g = function (n) { return function (t) { var e = t.control; n.on("LoadContent SetContent change", function () { e.disabled(n.readonly || !o.hasHeaders(n)) }) } }, T = function (t) { var e; t.addButton("toc", { tooltip: "Table of Contents", cmd: "mceInsertToc", icon: "toc", onPostRender: g(t) }), t.addButton("tocupdate", { tooltip: "Update", cmd: "mceUpdateToc", icon: "reload" }), t.addMenuItem("toc", { text: "Table of Contents", context: "insert", cmd: "mceInsertToc", onPostRender: g(t) }), t.addContextToolbar((e = t, function (t) { return t && e.dom.is(t, "." + l(e)) && e.getBody().contains(t) }), "tocupdate") }; t.add("toc", function (t) { r(t), T(t), h(t) }) }();
!function () { "use strict"; var o = function (e) { var t = e, n = function () { return t }; return { get: n, set: function (e) { t = e }, clone: function () { return o(n()) } } }, e = tinymce.util.Tools.resolve("tinymce.PluginManager"), i = function (e, t) { e.fire("VisualBlocks", { state: t }) }, s = function (e) { return e.getParam("visualblocks_default_state", !1) }, c = function (e) { return e.settings.visualblocks_content_css }, l = tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"), u = tinymce.util.Tools.resolve("tinymce.util.Tools"), a = l.DOM.uniqueId(), r = function (e, t) { var n = u.toArray(e.getElementsByTagName("link")); if (0 === u.grep(n, function (e) { return e.id === a }).length) { var o = l.DOM.create("link", { id: a, rel: "stylesheet", href: t }); e.getElementsByTagName("head")[0].appendChild(o) } }, m = function (e, t, n) { var o = e.dom, s = c(e); r(e.getDoc(), s || t + "/css/visualblocks.css"), o.toggleClass(e.getBody(), "mce-visualblocks"), n.set(!n.get()), i(e, n.get()) }, f = function (e, t, n) { e.addCommand("mceVisualBlocks", function () { m(e, t, n) }) }, d = function (t, e, n) { t.on("PreviewFormats AfterPreviewFormats", function (e) { n.get() && t.dom.toggleClass(t.getBody(), "mce-visualblocks", "afterpreviewformats" === e.type) }), t.on("init", function () { s(t) && m(t, e, n) }), t.on("remove", function () { t.dom.removeClass(t.getBody(), "mce-visualblocks") }) }, n = function (n, o) { return function (e) { var t = e.control; t.active(o.get()), n.on("VisualBlocks", function (e) { t.active(e.state) }) } }, v = function (e, t) { e.addButton("visualblocks", { active: !1, title: "Show blocks", cmd: "mceVisualBlocks", onPostRender: n(e, t) }), e.addMenuItem("visualblocks", { text: "Show blocks", cmd: "mceVisualBlocks", onPostRender: n(e, t), selectable: !0, context: "view", prependToContext: !0 }) }; e.add("visualblocks", function (e, t) { var n = o(!1); f(e, t, n), v(e, n), d(e, t, n) }) }();
!function () { "use strict"; var n, e, t, r, o = function (n) { var e = n, t = function () { return e }; return { get: t, set: function (n) { e = n }, clone: function () { return o(t()) } } }, u = tinymce.util.Tools.resolve("tinymce.PluginManager"), i = function (n) { return { isEnabled: function () { return n.get() } } }, c = function (n, e) { return n.fire("VisualChars", { state: e }) }, a = { "\xa0": "nbsp", "\xad": "shy" }, f = function (n, e) { var t, r = ""; for (t in n) r += t; return new RegExp("[" + r + "]", e ? "g" : "") }, l = function (n) { var e, t = ""; for (e in n) t && (t += ","), t += "span.mce-" + n[e]; return t }, s = { charMap: a, regExp: f(a), regExpGlobal: f(a, !0), selector: l(a), charMapToRegExp: f, charMapToSelector: l }, d = function (n) { return function () { return n } }, m = { noop: function () { for (var n = [], e = 0; e < arguments.length; e++)n[e] = arguments[e] }, noarg: function (t) { return function () { for (var n = [], e = 0; e < arguments.length; e++)n[e] = arguments[e]; return t() } }, compose: function (t, r) { return function () { for (var n = [], e = 0; e < arguments.length; e++)n[e] = arguments[e]; return t(r.apply(null, arguments)) } }, constant: d, identity: function (n) { return n }, tripleEquals: function (n, e) { return n === e }, curry: function (u) { for (var n = [], e = 1; e < arguments.length; e++)n[e - 1] = arguments[e]; for (var i = new Array(arguments.length - 1), t = 1; t < arguments.length; t++)i[t - 1] = arguments[t]; return function () { for (var n = [], e = 0; e < arguments.length; e++)n[e] = arguments[e]; for (var t = new Array(arguments.length), r = 0; r < t.length; r++)t[r] = arguments[r]; var o = i.concat(t); return u.apply(null, o) } }, not: function (t) { return function () { for (var n = [], e = 0; e < arguments.length; e++)n[e] = arguments[e]; return !t.apply(null, arguments) } }, die: function (n) { return function () { throw new Error(n) } }, apply: function (n) { return n() }, call: function (n) { n() }, never: d(!1), always: d(!0) }, p = m.never, v = m.always, h = function () { return g }, g = (r = { fold: function (n, e) { return n() }, is: p, isSome: p, isNone: v, getOr: t = function (n) { return n }, getOrThunk: e = function (n) { return n() }, getOrDie: function (n) { throw new Error(n || "error: getOrDie called on none.") }, or: t, orThunk: e, map: h, ap: h, each: function () { }, bind: h, flatten: h, exists: p, forall: v, filter: h, equals: n = function (n) { return n.isNone() }, equals_: n, toArray: function () { return [] }, toString: m.constant("none()") }, Object.freeze && Object.freeze(r), r), y = function (t) { var n = function () { return t }, e = function () { return o }, r = function (n) { return n(t) }, o = { fold: function (n, e) { return e(t) }, is: function (n) { return t === n }, isSome: v, isNone: p, getOr: n, getOrThunk: n, getOrDie: n, or: e, orThunk: e, map: function (n) { return y(n(t)) }, ap: function (n) { return n.fold(h, function (n) { return y(n(t)) }) }, each: function (n) { n(t) }, bind: r, flatten: n, exists: r, forall: r, filter: function (n) { return n(t) ? o : g }, equals: function (n) { return n.is(t) }, equals_: function (n, e) { return n.fold(p, function (n) { return e(t, n) }) }, toArray: function () { return [t] }, toString: function () { return "some(" + t + ")" } }; return o }, b = { some: y, none: h, from: function (n) { return null === n || n === undefined ? g : y(n) } }, T = function (e) { return function (n) { return function (n) { if (null === n) return "null"; var e = typeof n; return "object" === e && Array.prototype.isPrototypeOf(n) ? "array" : "object" === e && String.prototype.isPrototypeOf(n) ? "string" : e }(n) === e } }, w = { isString: T("string"), isObject: T("object"), isArray: T("array"), isNull: T("null"), isBoolean: T("boolean"), isUndefined: T("undefined"), isFunction: T("function"), isNumber: T("number") }, x = (Array.prototype.indexOf, undefined, function (n, e) { for (var t = n.length, r = new Array(t), o = 0; o < t; o++) { var u = n[o]; r[o] = e(u, o, n) } return r }), E = function (n, e) { for (var t = 0, r = n.length; t < r; t++)e(n[t], t, n) }, N = (Array.prototype.push, Array.prototype.slice, w.isFunction(Array.from) && Array.from, x), k = E, A = function (n) { if (null === n || n === undefined) throw new Error("Node cannot be null or undefined"); return { dom: m.constant(n) } }, O = { fromHtml: function (n, e) { var t = (e || document).createElement("div"); if (t.innerHTML = n, !t.hasChildNodes() || 1 < t.childNodes.length) throw console.error("HTML does not have a single root node", n), "HTML must have a single root node"; return A(t.childNodes[0]) }, fromTag: function (n, e) { var t = (e || document).createElement(n); return A(t) }, fromText: function (n, e) { var t = (e || document).createTextNode(n); return A(t) }, fromDom: A, fromPoint: function (n, e, t) { return b.from(n.dom().elementFromPoint(e, t)).map(A) } }, C = 8, M = 9, S = 3, D = function (n) { return n.dom().nodeName.toLowerCase() }, P = function (n) { return n.dom().nodeType }, B = function (e) { return function (n) { return P(n) === e } }, j = B(1), V = B(S), q = B(M), H = { name: D, type: P, value: function (n) { return n.dom().nodeValue }, isElement: j, isText: V, isDocument: q, isComment: function (n) { return P(n) === C || "#comment" === D(n) } }, L = function (n) { return '<span data-mce-bogus="1" class="mce-' + s.charMap[n] + '">' + n + "</span>" }, R = function (n, e) { var t = [], r = n.dom(), o = N(r.childNodes, O.fromDom); return k(o, function (n) { e(n) && (t = t.concat([n])), t = t.concat(R(n, e)) }), t }, _ = { isMatch: function (n) { return H.isText(n) && H.value(n) !== undefined && s.regExp.test(H.value(n)) }, filterDescendants: R, findParentElm: function (n, e) { for (; n.parentNode;) { if (n.parentNode === e) return n; n = n.parentNode } }, replaceWithSpans: function (n) { return n.replace(s.regExpGlobal, L) } }, F = function (t, n) { var r, o, e = _.filterDescendants(O.fromDom(n), _.isMatch); k(e, function (n) { var e = _.replaceWithSpans(H.value(n)); for (o = t.dom.create("div", null, e); r = o.lastChild;)t.dom.insertAfter(r, n.dom()); t.dom.remove(n.dom()) }) }, z = function (e, n) { var t = e.dom.select(s.selector, n); k(t, function (n) { e.dom.remove(n, 1) }) }, G = F, W = z, I = function (n) { var e = n.getBody(), t = n.selection.getBookmark(), r = _.findParentElm(n.selection.getNode(), e); r = r !== undefined ? r : e, z(n, r), F(n, r), n.selection.moveToBookmark(t) }, U = function (n, e) { var t, r = n.getBody(), o = n.selection; e.set(!e.get()), c(n, e.get()), t = o.getBookmark(), !0 === e.get() ? G(n, r) : W(n, r), o.moveToBookmark(t) }, J = function (n, e) { n.addCommand("mceVisualChars", function () { U(n, e) }) }, K = tinymce.util.Tools.resolve("tinymce.util.Delay"), Q = function (e, t) { var r = K.debounce(function () { I(e) }, 300); !1 !== e.settings.forced_root_block && e.on("keydown", function (n) { !0 === t.get() && (13 === n.keyCode ? I(e) : r()) }) }, X = function (t) { return function (n) { var e = n.control; t.on("VisualChars", function (n) { e.active(n.state) }) } }; u.add("visualchars", function (n) { var e, t = o(!1); return J(n, t), (e = n).addButton("visualchars", { active: !1, title: "Show invisible characters", cmd: "mceVisualChars", onPostRender: X(e) }), e.addMenuItem("visualchars", { text: "Show invisible characters", cmd: "mceVisualChars", onPostRender: X(e), selectable: !0, context: "view", prependToContext: !0 }), Q(n, t), i(t) }) }();
!function () { "use strict"; var e = tinymce.util.Tools.resolve("tinymce.PluginManager"), n = "[-'\\.\u2018\u2019\u2024\ufe52\uff07\uff0e]", t = "[:\xb7\xb7\u05f4\u2027\ufe13\ufe55\uff1a]", r = "[+*/,;;\u0589\u060c\u060d\u066c\u07f8\u2044\ufe10\ufe14\ufe50\ufe54\uff0c\uff1b]", E = "[0-9\u0660-\u0669\u066b\u06f0-\u06f9\u07c0-\u07c9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\u1946-\u194f\u19d0-\u19d9\u1a80-\u1a89\u1a90-\u1a99\u1b50-\u1b59\u1bb0-\u1bb9\u1c40-\u1c49\u1c50-\u1c59\ua620-\ua629\ua8d0-\ua8d9\ua900-\ua909\ua9d0-\ua9d9\uaa50-\uaa59\uabf0-\uabf9]", T = "\\r", u = "\\n", i = "[\x0B\f\x85\u2028\u2029]", o = "[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065f\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0859-\u085b\u0900-\u0903\u093a-\u093c\u093e-\u094f\u0951-\u0957\u0962\u0963\u0981-\u0983\u09bc\u09be-\u09c4\u09c7\u09c8\u09cb-\u09cd\u09d7\u09e2\u09e3\u0a01-\u0a03\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81-\u0a83\u0abc\u0abe-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ae2\u0ae3\u0b01-\u0b03\u0b3c\u0b3e-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd7\u0c01-\u0c03\u0c3e-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0c82\u0c83\u0cbc\u0cbe-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d02\u0d03\u0d3e-\u0d44\u0d46-\u0d48\u0d4a-\u0d4d\u0d57\u0d62\u0d63\u0d82\u0d83\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0df2\u0df3\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f3e\u0f3f\u0f71-\u0f84\u0f86\u0f87\u0f8d-\u0f97\u0f99-\u0fbc\u0fc6\u102b-\u103e\u1056-\u1059\u105e-\u1060\u1062-\u1064\u1067-\u106d\u1071-\u1074\u1082-\u108d\u108f\u109a-\u109d\u135d-\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b6-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u192b\u1930-\u193b\u19b0-\u19c0\u19c8\u19c9\u1a17-\u1a1b\u1a55-\u1a5e\u1a60-\u1a7c\u1a7f\u1b00-\u1b04\u1b34-\u1b44\u1b6b-\u1b73\u1b80-\u1b82\u1ba1-\u1baa\u1be6-\u1bf3\u1c24-\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce8\u1ced\u1cf2\u1dc0-\u1de6\u1dfc-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2d7f\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua823-\ua827\ua880\ua881\ua8b4-\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua953\ua980-\ua983\ua9b3-\ua9c0\uaa29-\uaa36\uaa43\uaa4c\uaa4d\uaa7b\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe3-\uabea\uabec\uabed\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]", c = "[\xad\u0600-\u0603\u06dd\u070f\u17b4\u17b5\u200e\u200f\u202a-\u202e\u2060-\u2064\u206a-\u206f\ufeff\ufff9-\ufffb]", a = "[\u3031-\u3035\u309b\u309c\u30a0-\u30fa\u30fc-\u30ff\u31f0-\u31ff\u32d0-\u32fe\u3300-\u3357\uff66-\uff9d]", R = "[=_\u203f\u2040\u2054\ufe33\ufe34\ufe4d-\ufe4f\uff3f\u2200-\u22ff<>]", f = "[!-#%-*,-\\/:;?@\\[-\\]_{}\xa1\xab\xb7\xbb\xbf;\xb7\u055a-\u055f\u0589\u058a\u05be\u05c0\u05c3\u05c6\u05f3\u05f4\u0609\u060a\u060c\u060d\u061b\u061e\u061f\u066a-\u066d\u06d4\u0700-\u070d\u07f7-\u07f9\u0830-\u083e\u085e\u0964\u0965\u0970\u0df4\u0e4f\u0e5a\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u0fd9\u0fda\u104a-\u104f\u10fb\u1361-\u1368\u1400\u166d\u166e\u169b\u169c\u16eb-\u16ed\u1735\u1736\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u1944\u1945\u1a1e\u1a1f\u1aa0-\u1aa6\u1aa8-\u1aad\u1b5a-\u1b60\u1bfc-\u1bff\u1c3b-\u1c3f\u1c7e\u1c7f\u1cd3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u207d\u207e\u208d\u208e\u3008\u3009\u2768-\u2775\u27c5\u27c6\u27e6-\u27ef\u2983-\u2998\u29d8-\u29db\u29fc\u29fd\u2cf9-\u2cfc\u2cfe\u2cff\u2d70\u2e00-\u2e2e\u2e30\u2e31\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\ua4fe\ua4ff\ua60d-\ua60f\ua673\ua67e\ua6f2-\ua6f7\ua874-\ua877\ua8ce\ua8cf\ua8f8-\ua8fa\ua92e\ua92f\ua95f\ua9c1-\ua9cd\ua9de\ua9df\uaa5c-\uaa5f\uaade\uaadf\uabeb\ufd3e\ufd3f\ufe10-\ufe19\ufe30-\ufe52\ufe54-\ufe61\ufe63\ufe68\ufe6a\ufe6b\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a\uff1b\uff1f\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]", A = { characterIndices: { ALETTER: 0, MIDNUMLET: 1, MIDLETTER: 2, MIDNUM: 3, NUMERIC: 4, CR: 5, LF: 6, NEWLINE: 7, EXTEND: 8, FORMAT: 9, KATAKANA: 10, EXTENDNUMLET: 11, AT: 12, OTHER: 13 }, SETS: [new RegExp("[A-Za-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f3\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u10a0-\u10c5\u10d0-\u10fa\u10fc\u1100-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191c\u1a00-\u1a16\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bc0-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u24b6-\u24e9\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2d00-\u2d25\u2d30-\u2d65\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005\u303b\u303c\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua697\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790\ua791\ua7a0-\ua7a9\ua7fa-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]"), new RegExp(n), new RegExp(t), new RegExp(r), new RegExp(E), new RegExp(T), new RegExp(u), new RegExp(i), new RegExp(o), new RegExp(c), new RegExp(a), new RegExp(R), new RegExp("@")], EMPTY_STRING: "", PUNCTUATION: new RegExp("^" + f + "$"), WHITESPACE: /^\s+$/ }, N = function (e, n, t) { var r, E; if (!e) return 0; if (t = t || e, e.length !== undefined) { for (r = 0, E = e.length; r < E; r++)if (!1 === n.call(t, e[r], r, e)) return 0 } else for (r in e) if (e.hasOwnProperty(r) && !1 === n.call(t, e[r], r, e)) return 0; return 1 }, s = function (t, r) { var E = []; return N(t, function (e, n) { E.push(r(e, n, t)) }), E }, l = A.SETS, M = A.characterIndices.OTHER, d = function (e) { var n, t, r = M, E = l.length; for (n = 0; n < E; ++n)if ((t = l[n]) && t.test(e)) { r = n; break } return r }, I = function (e) { var t, r, n = (t = d, r = {}, function (e) { if (r[e]) return r[e]; var n = t(e); return r[e] = n }); return s(e.split(""), n) }, L = A.characterIndices, g = function (e, n) { var t, r, E = e[n], T = e[n + 1]; return !(n < 0 || n > e.length - 1 && 0 !== n || E === L.ALETTER && T === L.ALETTER || (r = e[n + 2], E === L.ALETTER && (T === L.MIDLETTER || T === L.MIDNUMLET || T === L.AT) && r === L.ALETTER || (t = e[n - 1], (E === L.MIDLETTER || E === L.MIDNUMLET || T === L.AT) && T === L.ALETTER && t === L.ALETTER || !(E !== L.NUMERIC && E !== L.ALETTER || T !== L.NUMERIC && T !== L.ALETTER) || (E === L.MIDNUM || E === L.MIDNUMLET) && T === L.NUMERIC && t === L.NUMERIC || E === L.NUMERIC && (T === L.MIDNUM || T === L.MIDNUMLET) && r === L.NUMERIC || E === L.EXTEND || E === L.FORMAT || t === L.EXTEND || t === L.FORMAT || T === L.EXTEND || T === L.FORMAT || E === L.CR && T === L.LF || E !== L.NEWLINE && E !== L.CR && E !== L.LF && T !== L.NEWLINE && T !== L.CR && T !== L.LF && (E === L.KATAKANA && T === L.KATAKANA || T === L.EXTENDNUMLET && (E === L.ALETTER || E === L.NUMERIC || E === L.KATAKANA || E === L.EXTENDNUMLET) || E === L.EXTENDNUMLET && (T === L.ALETTER || T === L.NUMERIC || T === L.KATAKANA) || E === L.AT)))) }, p = A.EMPTY_STRING, U = A.WHITESPACE, w = A.PUNCTUATION, h = function (e, n, t) { var r = function (e, n) { var t; for (t = n; t < e.length; ++t) { var r = e.charAt(t); if (U.test(r)) break } return t }(n, t + 1), E = n.substring(t + 1, r); return "://" === E.substr(0, 3) ? { word: e + E, index: r } : { word: e, index: t } }, v = function (e, n) { return function (e, n) { var t, r, E, T, u = 0, i = I(e), o = i.length, c = [], a = []; for (n || (n = {}), n.ignoreCase && (e = e.toLowerCase()), r = n.includePunctuation, E = n.includeWhitespace; u < o; ++u)if (t = e.charAt(u), c.push(t), g(i, u)) { if ((c = c.join(p)) && (E || !U.test(c)) && (r || !w.test(c))) if ("http" === (T = c) || "https" === T) { var R = h(c, e, u); a.push(R.word), u = R.index } else a.push(c); c = [] } return a }(e.replace(/\ufeff/g, ""), n) }, x = function (e) { return v((n = e, n.removed ? "" : n.getBody().innerText)).length; var n }, C = function (e) { return { getCount: function () { return x(e) } } }, D = tinymce.util.Tools.resolve("tinymce.util.Delay"), m = tinymce.util.Tools.resolve("tinymce.util.I18n"), y = function (t) { var r = function (e) { return m.translate(["{0} words", x(e)]) }, E = function () { t.theme.panel.find("#wordcount").text(r(t)) }; t.on("init", function () { var e = t.theme.panel && t.theme.panel.find("#statusbar")[0], n = D.debounce(E, 300); e && D.setEditorTimeout(t, function () { e.insert({ type: "label", name: "wordcount", text: r(t), classes: "wordcount", disabled: t.settings.readonly }, 0), t.on("setcontent beforeaddundo undo redo keyup", n) }, 0) }) }; e.add("wordcount", function (e) { return y(e), C(e) }) }();